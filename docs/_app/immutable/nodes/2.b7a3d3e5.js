import{s as co,n as Og,f as Ql,c as hh,u as dh,g as ph,d as fh,e as pa,h as gl,i as ys,j as YC,o as Ey,k as pf,l as vl,m as Wb,p as aD,t as $$,q as G$,b as Ty,r as q$,v as W$}from"../chunks/scheduler.0f657d3f.js";import{S as uo,i as ho,g as Hi,e as jb,y as j$,h as $i,f as An,k as Pe,x as ar,z as X$,a as qa,d as Pn,t as Bn,r as Cr,u as Er,v as Tr,w as Ar,s as Ju,c as Qu,b as pM,p as fM,j as lD,A as Y$}from"../chunks/index.584a5929.js";import{e as UP}from"../chunks/transform.3586df06.js";import{w as _a,d as KC,r as K$}from"../chunks/index.a295480f.js";function ZC(i,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in i)){const s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(i,r,s.get?s:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}function xg(i,t){const e={},n={},r={$$scope:1};let s=i.length;for(;s--;){const o=i[s],a=t[s];if(a){for(const l in o)l in a||(n[l]=1);for(const l in a)r[l]||(e[l]=a[l],r[l]=1);i[s]=a}else for(const l in o)r[l]=1}for(const o in n)o in e||(e[o]=void 0);return e}function wg(i){return typeof i=="object"&&i!==null?i:{}}function FP(i,t,e){const n=i.slice();return n[5]=t[e],n}function VP(i){let t,e;return{c(){t=Hi("link"),this.h()},l(n){t=$i(n,"LINK",{rel:!0,href:!0,as:!0,type:!0,crossorigin:!0}),this.h()},h(){Pe(t,"rel","preload"),Pe(t,"href",e=i[5]),Pe(t,"as","font"),Pe(t,"type","font/woff2"),Pe(t,"crossorigin","")},m(n,r){qa(n,t,r)},p(n,r){r&16&&e!==(e=n[5])&&Pe(t,"href",e)},d(n){n&&An(t)}}}function Z$(i){let t,e,n,r,s,o,a,l,c,u,h,p,m,v,_,b,y,M,S,E,A,R,O,L,P,D;document.title=t=i[0];let V=UP(i[4]),K=[];for(let W=0;W<V.length;W+=1)K[W]=VP(FP(i,V,W));return{c(){e=Hi("meta"),n=Hi("meta"),r=Hi("meta"),s=Hi("meta"),o=Hi("meta"),a=Hi("meta"),l=Hi("meta"),c=Hi("meta"),u=Hi("meta"),h=Hi("meta"),m=Hi("meta"),v=Hi("meta"),_=Hi("meta"),b=Hi("meta"),y=Hi("meta"),M=Hi("meta"),S=Hi("meta"),E=Hi("meta"),A=Hi("meta"),O=Hi("meta"),L=Hi("link");for(let W=0;W<K.length;W+=1)K[W].c();D=jb(),this.h()},l(W){const Z=j$("svelte-1htu80s",document.head);e=$i(Z,"META",{name:!0,content:!0}),n=$i(Z,"META",{name:!0,content:!0}),r=$i(Z,"META",{name:!0,content:!0}),s=$i(Z,"META",{property:!0,content:!0}),o=$i(Z,"META",{property:!0,content:!0}),a=$i(Z,"META",{property:!0,content:!0}),l=$i(Z,"META",{property:!0,content:!0}),c=$i(Z,"META",{property:!0,content:!0}),u=$i(Z,"META",{property:!0,content:!0}),h=$i(Z,"META",{property:!0,content:!0}),m=$i(Z,"META",{property:!0,content:!0}),v=$i(Z,"META",{property:!0,content:!0}),_=$i(Z,"META",{property:!0,content:!0}),b=$i(Z,"META",{name:!0,content:!0}),y=$i(Z,"META",{name:!0,content:!0}),M=$i(Z,"META",{name:!0,content:!0}),S=$i(Z,"META",{name:!0,content:!0}),E=$i(Z,"META",{name:!0,content:!0}),A=$i(Z,"META",{name:!0,content:!0}),O=$i(Z,"META",{name:!0,content:!0}),L=$i(Z,"LINK",{rel:!0,href:!0});for(let z=0;z<K.length;z+=1)K[z].l(Z);D=jb(),Z.forEach(An),this.h()},h(){Pe(e,"name","description"),Pe(e,"content",i[1]),Pe(n,"name","author"),Pe(n,"content","The Pudding"),Pe(r,"name","news_keywords"),Pe(r,"content",i[3]),Pe(s,"property","og:title"),Pe(s,"content",i[0]),Pe(o,"property","og:site_name"),Pe(o,"content","The Pudding"),Pe(a,"property","og:url"),Pe(a,"content",i[2]),Pe(l,"property","og:description"),Pe(l,"content",i[1]),Pe(c,"property","og:type"),Pe(c,"content","article"),Pe(u,"property","og:locale"),Pe(u,"content","en_US"),Pe(h,"property","og:image"),Pe(h,"content",p=i[2]+"/assets/social-facebook.jpg"),Pe(m,"property","og:image:type"),Pe(m,"content","image/jpeg"),Pe(v,"property","og:image:width"),Pe(v,"content","1200"),Pe(_,"property","og:image:height"),Pe(_,"content","600"),Pe(b,"name","twitter:card"),Pe(b,"content","summary_large_image"),Pe(y,"name","twitter:site"),Pe(y,"content","https://pudding.cool"),Pe(M,"name","twitter:creator"),Pe(M,"content","@puddingviz"),Pe(S,"name","twitter:title"),Pe(S,"content",i[0]),Pe(E,"name","twitter:description"),Pe(E,"content",i[1]),Pe(A,"name","twitter:image:src"),Pe(A,"content",R=i[2]+"/assets/social-twitter.jpg"),Pe(O,"name","robots"),Pe(O,"content","max-image-preview:large"),Pe(L,"rel","canonical"),Pe(L,"href",P=i[2]+"/")},m(W,Z){ar(document.head,e),ar(document.head,n),ar(document.head,r),ar(document.head,s),ar(document.head,o),ar(document.head,a),ar(document.head,l),ar(document.head,c),ar(document.head,u),ar(document.head,h),ar(document.head,m),ar(document.head,v),ar(document.head,_),ar(document.head,b),ar(document.head,y),ar(document.head,M),ar(document.head,S),ar(document.head,E),ar(document.head,A),ar(document.head,O),ar(document.head,L);for(let z=0;z<K.length;z+=1)K[z]&&K[z].m(document.head,null);ar(document.head,D)},p(W,[Z]){if(Z&1&&t!==(t=W[0])&&(document.title=t),Z&2&&Pe(e,"content",W[1]),Z&8&&Pe(r,"content",W[3]),Z&1&&Pe(s,"content",W[0]),Z&4&&Pe(a,"content",W[2]),Z&2&&Pe(l,"content",W[1]),Z&4&&p!==(p=W[2]+"/assets/social-facebook.jpg")&&Pe(h,"content",p),Z&1&&Pe(S,"content",W[0]),Z&2&&Pe(E,"content",W[1]),Z&4&&R!==(R=W[2]+"/assets/social-twitter.jpg")&&Pe(A,"content",R),Z&4&&P!==(P=W[2]+"/")&&Pe(L,"href",P),Z&16){V=UP(W[4]);let z;for(z=0;z<V.length;z+=1){const ut=FP(W,V,z);K[z]?K[z].p(ut,Z):(K[z]=VP(ut),K[z].c(),K[z].m(D.parentNode,D))}for(;z<K.length;z+=1)K[z].d(1);K.length=V.length}},i:Og,o:Og,d(W){An(e),An(n),An(r),An(s),An(o),An(a),An(l),An(c),An(u),An(h),An(m),An(v),An(_),An(b),An(y),An(M),An(S),An(E),An(A),An(O),An(L),X$(K,W),An(D)}}}function J$(i,t,e){let{title:n="Title TK"}=t,{description:r="Description TK"}=t,{url:s="https://pudding.cool"}=t,{keywords:o=""}=t,{preloadFont:a=[]}=t;return i.$$set=l=>{"title"in l&&e(0,n=l.title),"description"in l&&e(1,r=l.description),"url"in l&&e(2,s=l.url),"keywords"in l&&e(3,o=l.keywords),"preloadFont"in l&&e(4,a=l.preloadFont)},[n,r,s,o,a]}class Q$ extends uo{constructor(t){super(),ho(this,t,J$,Z$,co,{title:0,description:1,url:2,keywords:3,preloadFont:4})}}var zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function tG(i){if(i.__esModule)return i;var t=i.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var r=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return i[n]}})}),e}var eG=typeof zt=="object"&&zt&&zt.Object===Object&&zt,nG=typeof self=="object"&&self&&self.Object===Object&&self;eG||nG||Function("return this")();/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Ay="155dev",rd={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},sd={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},cD=0,mM=1,uD=2,iG=3,rG=0,JC=1,Py=2,Bl=3,Kc=0,ao=1,pr=2,sG=2,Wc=0,Hu=1,gM=2,vM=3,_M=4,hD=5,Nu=100,QC=101,tE=102,bM=103,yM=104,eE=200,nE=201,iE=202,rE=203,Ry=204,ky=205,sE=206,oE=207,aE=208,lE=209,cE=210,dD=0,pD=1,fD=2,Xb=3,mD=4,gD=5,vD=6,_D=7,vv=0,bD=1,yD=2,jc=0,xD=1,wD=2,SD=3,uE=4,MD=5,_v=300,Zc=301,th=302,Dg=303,Ig=304,zf=306,ff=1e3,es=1001,mf=1002,si=1003,Yb=1004,hE=1004,Sg=1005,dE=1005,Ji=1006,pE=1007,fE=1007,eh=1008,mE=1008,lo=1009,bv=1010,yv=1011,Ud=1012,Uf=1013,Fa=1014,Hr=1015,gf=1016,Ly=1017,Oy=1018,$u=1020,gE=1021,Es=1023,Dy=1024,Iy=1025,Gu=1026,Td=1027,CD=1028,vE=1029,ED=1030,_E=1031,bE=1033,Tb=33776,Ab=33777,Pb=33778,Rb=33779,xM=35840,wM=35841,SM=35842,MM=35843,TD=36196,CM=37492,EM=37496,TM=37808,AM=37809,PM=37810,RM=37811,kM=37812,LM=37813,OM=37814,DM=37815,IM=37816,NM=37817,zM=37818,UM=37819,FM=37820,VM=37821,kb=36492,AD=36283,BM=36284,HM=36285,$M=36286,PD=2200,RD=2201,kD=2202,Ng=2300,zg=2301,Lb=2302,pd=2400,fd=2401,Ug=2402,Ny=2500,yE=2501,oG=0,aG=1,lG=2,Fg=3e3,Xc=3001,LD=3200,OD=3201,mh=0,DD=1,qu="",cn="srgb",bl="srgb-linear",xE="display-p3",cG=0,Ob=7680,uG=7681,hG=7682,dG=7683,pG=34055,fG=34056,mG=5386,gG=512,vG=513,_G=514,bG=515,yG=516,xG=517,wG=518,ID=519,ND=512,zD=513,UD=514,FD=515,VD=516,BD=517,HD=518,$D=519,Vg=35044,SG=35048,MG=35040,CG=35045,EG=35049,TG=35041,AG=35046,PG=35050,RG=35042,kG="100",GM="300 es",Kb=1035,$l=2e3,Bg=2001;class ma{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const r=this._listeners[t];if(r!==void 0){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,t);t.target=null}}}const Is=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let BP=1234567;const bd=Math.PI/180,vf=180/Math.PI;function ga(){const i=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Is[i&255]+Is[i>>8&255]+Is[i>>16&255]+Is[i>>24&255]+"-"+Is[t&255]+Is[t>>8&255]+"-"+Is[t>>16&15|64]+Is[t>>24&255]+"-"+Is[e&63|128]+Is[e>>8&255]+"-"+Is[e>>16&255]+Is[e>>24&255]+Is[n&255]+Is[n>>8&255]+Is[n>>16&255]+Is[n>>24&255]).toLowerCase()}function hr(i,t,e){return Math.max(t,Math.min(e,i))}function wE(i,t){return(i%t+t)%t}function LG(i,t,e,n,r){return n+(i-t)*(r-n)/(e-t)}function OG(i,t,e){return i!==t?(e-i)/(t-i):0}function Mg(i,t,e){return(1-e)*i+e*t}function DG(i,t,e,n){return Mg(i,t,1-Math.exp(-e*n))}function IG(i,t=1){return t-Math.abs(wE(i,t*2)-t)}function NG(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t),i*i*(3-2*i))}function zG(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t),i*i*i*(i*(i*6-15)+10))}function UG(i,t){return i+Math.floor(Math.random()*(t-i+1))}function FG(i,t){return i+Math.random()*(t-i)}function VG(i){return i*(.5-Math.random())}function BG(i){i!==void 0&&(BP=i);let t=BP+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function HG(i){return i*bd}function $G(i){return i*vf}function qM(i){return(i&i-1)===0&&i!==0}function GD(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Zb(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function GG(i,t,e,n,r){const s=Math.cos,o=Math.sin,a=s(e/2),l=o(e/2),c=s((t+n)/2),u=o((t+n)/2),h=s((t-n)/2),p=o((t-n)/2),m=s((n-t)/2),v=o((n-t)/2);switch(r){case"XYX":i.set(a*u,l*h,l*p,a*c);break;case"YZY":i.set(l*p,a*u,l*h,a*c);break;case"ZXZ":i.set(l*h,l*p,a*u,a*c);break;case"XZX":i.set(a*u,l*v,l*m,a*c);break;case"YXY":i.set(l*m,a*u,l*v,a*c);break;case"ZYZ":i.set(l*v,l*m,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function fa(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function bn(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const qD={DEG2RAD:bd,RAD2DEG:vf,generateUUID:ga,clamp:hr,euclideanModulo:wE,mapLinear:LG,inverseLerp:OG,lerp:Mg,damp:DG,pingpong:IG,smoothstep:NG,smootherstep:zG,randInt:UG,randFloat:FG,randFloatSpread:VG,seededRandom:BG,degToRad:HG,radToDeg:$G,isPowerOfTwo:qM,ceilPowerOfTwo:GD,floorPowerOfTwo:Zb,setQuaternionFromProperEuler:GG,normalize:bn,denormalize:fa};let Vt=class WD{constructor(t=0,e=0){WD.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(hr(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),s=this.x-t.x,o=this.y-t.y;return this.x=s*n-o*r+t.x,this.y=s*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},wn=class jD{constructor(t,e,n,r,s,o,a,l,c){jD.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,n,r,s,o,a,l,c)}set(t,e,n,r,s,o,a,l,c){const u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],p=n[2],m=n[5],v=n[8],_=r[0],b=r[3],y=r[6],M=r[1],S=r[4],E=r[7],A=r[2],R=r[5],O=r[8];return s[0]=o*_+a*M+l*A,s[3]=o*b+a*S+l*R,s[6]=o*y+a*E+l*O,s[1]=c*_+u*M+h*A,s[4]=c*b+u*S+h*R,s[7]=c*y+u*E+h*O,s[2]=p*_+m*M+v*A,s[5]=p*b+m*S+v*R,s[8]=p*y+m*E+v*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e*o*u-e*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*o-a*c,p=a*l-u*s,m=c*s-o*l,v=e*h+n*p+r*m;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/v;return t[0]=h*_,t[1]=(r*c-u*n)*_,t[2]=(a*n-r*o)*_,t[3]=p*_,t[4]=(u*e-r*l)*_,t[5]=(r*s-a*e)*_,t[6]=m*_,t[7]=(n*l-c*e)*_,t[8]=(o*e-n*s)*_,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+t,-r*c,r*l,-r*(-c*o+l*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(z1.makeScale(t,e)),this}rotate(t){return this.premultiply(z1.makeRotation(-t)),this}translate(t,e){return this.premultiply(z1.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}};const z1=new wn;function XD(i){for(let t=i.length-1;t>=0;--t)if(i[t]>=65535)return!0;return!1}const qG={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Yp(i,t){return new qG[i](t)}function Hg(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const HP={};function Cg(i){i in HP||(HP[i]=!0,console.warn(i))}function af(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function U1(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const WG=new wn().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),jG=new wn().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function XG(i){return i.convertSRGBToLinear().applyMatrix3(jG)}function YG(i){return i.applyMatrix3(WG).convertLinearToSRGB()}const KG={[bl]:i=>i,[cn]:i=>i.convertSRGBToLinear(),[xE]:XG},ZG={[bl]:i=>i,[cn]:i=>i.convertLinearToSRGB(),[xE]:YG},oa={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return bl},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,t,e){if(this.enabled===!1||t===e||!t||!e)return i;const n=KG[t],r=ZG[e];if(n===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${t}" to "${e}".`);return r(n(i))},fromWorkingColorSpace:function(i,t){return this.convert(i,this.workingColorSpace,t)},toWorkingColorSpace:function(i,t){return this.convert(i,t,this.workingColorSpace)}};let xp;class SE{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{xp===void 0&&(xp=Hg("canvas")),xp.width=t.width,xp.height=t.height;const n=xp.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=xp}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=Hg("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=af(s[o]/255)*255;return n.putImageData(r,0,0),e}else if(t.data){const e=t.data.slice(0);for(let n=0;n<e.length;n++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[n]=Math.floor(af(e[n]/255)*255):e[n]=af(e[n]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let JG=0,md=class{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:JG++}),this.uuid=ga(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(F1(r[o].image)):s.push(F1(r[o]))}else s=F1(r);n.url=s}return e||(t.images[this.uuid]=n),n}};function F1(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?SE.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let QG=0;class mr extends ma{constructor(t=mr.DEFAULT_IMAGE,e=mr.DEFAULT_MAPPING,n=es,r=es,s=Ji,o=eh,a=Es,l=lo,c=mr.DEFAULT_ANISOTROPY,u=qu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:QG++}),this.uuid=ga(),this.name="",this.source=new md(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Vt(0,0),this.repeat=new Vt(1,1),this.center=new Vt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new wn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(Cg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Xc?cn:qu),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==_v)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ff:t.x=t.x-Math.floor(t.x);break;case es:t.x=t.x<0?0:1;break;case mf:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case ff:t.y=t.y-Math.floor(t.y);break;case es:t.y=t.y<0?0:1;break;case mf:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Cg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===cn?Xc:Fg}set encoding(t){Cg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Xc?cn:qu}}mr.DEFAULT_IMAGE=null;mr.DEFAULT_MAPPING=_v;mr.DEFAULT_ANISOTROPY=1;let Vn=class YD{constructor(t=0,e=0,n=0,r=1){YD.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,s=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,s;const l=t.elements,c=l[0],u=l[4],h=l[8],p=l[1],m=l[5],v=l[9],_=l[2],b=l[6],y=l[10];if(Math.abs(u-p)<.01&&Math.abs(h-_)<.01&&Math.abs(v-b)<.01){if(Math.abs(u+p)<.1&&Math.abs(h+_)<.1&&Math.abs(v+b)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const S=(c+1)/2,E=(m+1)/2,A=(y+1)/2,R=(u+p)/4,O=(h+_)/4,L=(v+b)/4;return S>E&&S>A?S<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(S),r=R/n,s=O/n):E>A?E<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(E),n=R/r,s=L/r):A<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(A),n=O/s,r=L/s),this.set(n,r,s,e),this}let M=Math.sqrt((b-v)*(b-v)+(h-_)*(h-_)+(p-u)*(p-u));return Math.abs(M)<.001&&(M=1),this.x=(b-v)/M,this.y=(h-_)/M,this.z=(p-u)/M,this.w=Math.acos((c+m+y-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};class ba extends ma{constructor(t=1,e=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Vn(0,0,t,e),this.scissorTest=!1,this.viewport=new Vn(0,0,t,e);const r={width:t,height:e,depth:1};n.encoding!==void 0&&(Cg("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Xc?cn:qu),this.texture=new mr(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Ji,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new md(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class zy extends mr{constructor(t=null,e=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=si,this.minFilter=si,this.wrapR=es,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class tq extends ba{constructor(t=1,e=1,n=1){super(t,e),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new zy(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class ME extends mr{constructor(t=null,e=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=si,this.minFilter=si,this.wrapR=es,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eq extends ba{constructor(t=1,e=1,n=1){super(t,e),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new ME(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class nq extends ba{constructor(t=1,e=1,n=1,r={}){super(t,e,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=n;this.dispose()}this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}}let $r=class{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const p=s[o+0],m=s[o+1],v=s[o+2],_=s[o+3];if(a===0){t[e+0]=l,t[e+1]=c,t[e+2]=u,t[e+3]=h;return}if(a===1){t[e+0]=p,t[e+1]=m,t[e+2]=v,t[e+3]=_;return}if(h!==_||l!==p||c!==m||u!==v){let b=1-a;const y=l*p+c*m+u*v+h*_,M=y>=0?1:-1,S=1-y*y;if(S>Number.EPSILON){const A=Math.sqrt(S),R=Math.atan2(A,y*M);b=Math.sin(b*R)/A,a=Math.sin(a*R)/A}const E=a*M;if(l=l*b+p*E,c=c*b+m*E,u=u*b+v*E,h=h*b+_*E,b===1-a){const A=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=A,c*=A,u*=A,h*=A}}t[e]=l,t[e+1]=c,t[e+2]=u,t[e+3]=h}static multiplyQuaternionsFlat(t,e,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],p=s[o+1],m=s[o+2],v=s[o+3];return t[e]=a*v+u*h+l*m-c*p,t[e+1]=l*v+u*p+c*h-a*m,t[e+2]=c*v+u*m+a*p-l*h,t[e+3]=u*v-a*h-l*p-c*m,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const n=t._x,r=t._y,s=t._z,o=t._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),p=l(n/2),m=l(r/2),v=l(s/2);switch(o){case"XYZ":this._x=p*u*h+c*m*v,this._y=c*m*h-p*u*v,this._z=c*u*v+p*m*h,this._w=c*u*h-p*m*v;break;case"YXZ":this._x=p*u*h+c*m*v,this._y=c*m*h-p*u*v,this._z=c*u*v-p*m*h,this._w=c*u*h+p*m*v;break;case"ZXY":this._x=p*u*h-c*m*v,this._y=c*m*h+p*u*v,this._z=c*u*v+p*m*h,this._w=c*u*h-p*m*v;break;case"ZYX":this._x=p*u*h-c*m*v,this._y=c*m*h+p*u*v,this._z=c*u*v-p*m*h,this._w=c*u*h+p*m*v;break;case"YZX":this._x=p*u*h+c*m*v,this._y=c*m*h+p*u*v,this._z=c*u*v-p*m*h,this._w=c*u*h-p*m*v;break;case"XZY":this._x=p*u*h-c*m*v,this._y=c*m*h-p*u*v,this._z=c*u*v+p*m*h,this._w=c*u*h+p*m*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],s=e[8],o=e[1],a=e[5],l=e[9],c=e[2],u=e[6],h=e[10],p=n+a+h;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(n>a&&n>h){const m=2*Math.sqrt(1+n-a-h);this._w=(u-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>h){const m=2*Math.sqrt(1+a-n-h);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+h-n-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(hr(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,s=t._z,o=t._w,a=e._x,l=e._y,c=e._z,u=e._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+s*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*n+e*this._x,this._y=m*r+e*this._y,this._z=m*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-e)*u)/c,p=Math.sin(e*u)/c;return this._w=o*h+this._w*p,this._x=n*h+this._x*p,this._y=r*h+this._y*p,this._z=s*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(s),n*Math.cos(s),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Y=class KD{constructor(t=0,e=0,n=0){KD.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion($P.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion($P.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[3]*n+s[6]*r,this.y=s[1]*e+s[4]*n+s[7]*r,this.z=s[2]*e+s[5]*n+s[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,s=t.elements,o=1/(s[3]*e+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*e+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*e+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*e+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,s=t.x,o=t.y,a=t.z,l=t.w,c=l*e+o*r-a*n,u=l*n+a*e-s*r,h=l*r+s*n-o*e,p=-s*e-o*n-a*r;return this.x=c*l+p*-s+u*-a-h*-o,this.y=u*l+p*-o+h*-s-c*-a,this.z=h*l+p*-a+c*-o-u*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r,this.y=s[1]*e+s[5]*n+s[9]*r,this.z=s[2]*e+s[6]*n+s[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,s=t.z,o=e.x,a=e.y,l=e.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return V1.copy(this).projectOnVector(t),this.sub(V1)}reflect(t){return this.sub(V1.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(hr(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const V1=new Y,$P=new $r;class sc{constructor(t=new Y(1/0,1/0,1/0),e=new Y(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(kc.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(kc.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=kc.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){if(t.updateWorldMatrix(!1,!1),t.boundingBox!==void 0)t.boundingBox===null&&t.computeBoundingBox(),wp.copy(t.boundingBox),wp.applyMatrix4(t.matrixWorld),this.union(wp);else{const r=t.geometry;if(r!==void 0)if(e&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)kc.fromBufferAttribute(s,o).applyMatrix4(t.matrixWorld),this.expandByPoint(kc)}else r.boundingBox===null&&r.computeBoundingBox(),wp.copy(r.boundingBox),wp.applyMatrix4(t.matrixWorld),this.union(wp)}const n=t.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,kc),kc.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(zm),d0.subVectors(this.max,zm),Sp.subVectors(t.a,zm),Mp.subVectors(t.b,zm),Cp.subVectors(t.c,zm),Tu.subVectors(Mp,Sp),Au.subVectors(Cp,Mp),Gh.subVectors(Sp,Cp);let e=[0,-Tu.z,Tu.y,0,-Au.z,Au.y,0,-Gh.z,Gh.y,Tu.z,0,-Tu.x,Au.z,0,-Au.x,Gh.z,0,-Gh.x,-Tu.y,Tu.x,0,-Au.y,Au.x,0,-Gh.y,Gh.x,0];return!B1(e,Sp,Mp,Cp,d0)||(e=[1,0,0,0,1,0,0,0,1],!B1(e,Sp,Mp,Cp,d0))?!1:(p0.crossVectors(Tu,Au),e=[p0.x,p0.y,p0.z],B1(e,Sp,Mp,Cp,d0))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,kc).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(kc).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Rc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Rc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Rc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Rc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Rc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Rc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Rc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Rc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Rc),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Rc=[new Y,new Y,new Y,new Y,new Y,new Y,new Y,new Y],kc=new Y,wp=new sc,Sp=new Y,Mp=new Y,Cp=new Y,Tu=new Y,Au=new Y,Gh=new Y,zm=new Y,d0=new Y,p0=new Y,qh=new Y;function B1(i,t,e,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){qh.fromArray(i,s);const a=r.x*Math.abs(qh.x)+r.y*Math.abs(qh.y)+r.z*Math.abs(qh.z),l=t.dot(qh),c=e.dot(qh),u=n.dot(qh);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const iq=new sc,Um=new Y,H1=new Y;let wl=class{constructor(t=new Y,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):iq.setFromPoints(t).getCenter(n);let r=0;for(let s=0,o=t.length;s<o;s++)r=Math.max(r,n.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Um.subVectors(t,this.center);const e=Um.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),r=(n-this.radius)*.5;this.center.addScaledVector(Um,r/n),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(H1.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Um.copy(t.center).add(H1)),this.expandByPoint(Um.copy(t.center).sub(H1))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}};const Lc=new Y,$1=new Y,f0=new Y,Pu=new Y,G1=new Y,m0=new Y,q1=new Y;class Fd{constructor(t=new Y,e=new Y(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Lc)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Lc.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Lc.copy(this.origin).addScaledVector(this.direction,e),Lc.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){$1.copy(t).add(e).multiplyScalar(.5),f0.copy(e).sub(t).normalize(),Pu.copy(this.origin).sub($1);const s=t.distanceTo(e)*.5,o=-this.direction.dot(f0),a=Pu.dot(this.direction),l=-Pu.dot(f0),c=Pu.lengthSq(),u=Math.abs(1-o*o);let h,p,m,v;if(u>0)if(h=o*l-a,p=o*a-l,v=s*u,h>=0)if(p>=-v)if(p<=v){const _=1/u;h*=_,p*=_,m=h*(h+o*p+2*a)+p*(o*h+p+2*l)+c}else p=s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;else p=-s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;else p<=-v?(h=Math.max(0,-(-o*s+a)),p=h>0?-s:Math.min(Math.max(-s,-l),s),m=-h*h+p*(p+2*l)+c):p<=v?(h=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(h=Math.max(0,-(o*s+a)),p=h>0?s:Math.min(Math.max(-s,-l),s),m=-h*h+p*(p+2*l)+c);else p=o>0?-s:s,h=Math.max(0,-(o*p+a)),m=-h*h+p*(p+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy($1).addScaledVector(f0,p),m}intersectSphere(t,e){Lc.subVectors(t.center,this.origin);const n=Lc.dot(this.direction),r=Lc.dot(Lc)-n*n,s=t.radius*t.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,p=this.origin;return c>=0?(n=(t.min.x-p.x)*c,r=(t.max.x-p.x)*c):(n=(t.max.x-p.x)*c,r=(t.min.x-p.x)*c),u>=0?(s=(t.min.y-p.y)*u,o=(t.max.y-p.y)*u):(s=(t.max.y-p.y)*u,o=(t.min.y-p.y)*u),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(t.min.z-p.z)*h,l=(t.max.z-p.z)*h):(a=(t.max.z-p.z)*h,l=(t.min.z-p.z)*h),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,e)}intersectsBox(t){return this.intersectBox(t,Lc)!==null}intersectTriangle(t,e,n,r,s){G1.subVectors(e,t),m0.subVectors(n,t),q1.crossVectors(G1,m0);let o=this.direction.dot(q1),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Pu.subVectors(this.origin,t);const l=a*this.direction.dot(m0.crossVectors(Pu,m0));if(l<0)return null;const c=a*this.direction.dot(G1.cross(Pu));if(c<0||l+c>o)return null;const u=-a*Pu.dot(q1);return u<0?null:this.at(u/o,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}let rn=class WM{constructor(t,e,n,r,s,o,a,l,c,u,h,p,m,v,_,b){WM.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,n,r,s,o,a,l,c,u,h,p,m,v,_,b)}set(t,e,n,r,s,o,a,l,c,u,h,p,m,v,_,b){const y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=h,y[14]=p,y[3]=m,y[7]=v,y[11]=_,y[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new WM().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/Ep.setFromMatrixColumn(t,0).length(),s=1/Ep.setFromMatrixColumn(t,1).length(),o=1/Ep.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,s=t.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(t.order==="XYZ"){const p=o*u,m=o*h,v=a*u,_=a*h;e[0]=l*u,e[4]=-l*h,e[8]=c,e[1]=m+v*c,e[5]=p-_*c,e[9]=-a*l,e[2]=_-p*c,e[6]=v+m*c,e[10]=o*l}else if(t.order==="YXZ"){const p=l*u,m=l*h,v=c*u,_=c*h;e[0]=p+_*a,e[4]=v*a-m,e[8]=o*c,e[1]=o*h,e[5]=o*u,e[9]=-a,e[2]=m*a-v,e[6]=_+p*a,e[10]=o*l}else if(t.order==="ZXY"){const p=l*u,m=l*h,v=c*u,_=c*h;e[0]=p-_*a,e[4]=-o*h,e[8]=v+m*a,e[1]=m+v*a,e[5]=o*u,e[9]=_-p*a,e[2]=-o*c,e[6]=a,e[10]=o*l}else if(t.order==="ZYX"){const p=o*u,m=o*h,v=a*u,_=a*h;e[0]=l*u,e[4]=v*c-m,e[8]=p*c+_,e[1]=l*h,e[5]=_*c+p,e[9]=m*c-v,e[2]=-c,e[6]=a*l,e[10]=o*l}else if(t.order==="YZX"){const p=o*l,m=o*c,v=a*l,_=a*c;e[0]=l*u,e[4]=_-p*h,e[8]=v*h+m,e[1]=h,e[5]=o*u,e[9]=-a*u,e[2]=-c*u,e[6]=m*h+v,e[10]=p-_*h}else if(t.order==="XZY"){const p=o*l,m=o*c,v=a*l,_=a*c;e[0]=l*u,e[4]=-h,e[8]=c*u,e[1]=p*h+_,e[5]=o*u,e[9]=m*h-v,e[2]=v*h-m,e[6]=a*u,e[10]=_*h+p}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(rq,t,sq)}lookAt(t,e,n){const r=this.elements;return ia.subVectors(t,e),ia.lengthSq()===0&&(ia.z=1),ia.normalize(),Ru.crossVectors(n,ia),Ru.lengthSq()===0&&(Math.abs(n.z)===1?ia.x+=1e-4:ia.z+=1e-4,ia.normalize(),Ru.crossVectors(n,ia)),Ru.normalize(),g0.crossVectors(ia,Ru),r[0]=Ru.x,r[4]=g0.x,r[8]=ia.x,r[1]=Ru.y,r[5]=g0.y,r[9]=ia.y,r[2]=Ru.z,r[6]=g0.z,r[10]=ia.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],p=n[9],m=n[13],v=n[2],_=n[6],b=n[10],y=n[14],M=n[3],S=n[7],E=n[11],A=n[15],R=r[0],O=r[4],L=r[8],P=r[12],D=r[1],V=r[5],K=r[9],W=r[13],Z=r[2],z=r[6],ut=r[10],nt=r[14],Q=r[3],St=r[7],Pt=r[11],dt=r[15];return s[0]=o*R+a*D+l*Z+c*Q,s[4]=o*O+a*V+l*z+c*St,s[8]=o*L+a*K+l*ut+c*Pt,s[12]=o*P+a*W+l*nt+c*dt,s[1]=u*R+h*D+p*Z+m*Q,s[5]=u*O+h*V+p*z+m*St,s[9]=u*L+h*K+p*ut+m*Pt,s[13]=u*P+h*W+p*nt+m*dt,s[2]=v*R+_*D+b*Z+y*Q,s[6]=v*O+_*V+b*z+y*St,s[10]=v*L+_*K+b*ut+y*Pt,s[14]=v*P+_*W+b*nt+y*dt,s[3]=M*R+S*D+E*Z+A*Q,s[7]=M*O+S*V+E*z+A*St,s[11]=M*L+S*K+E*ut+A*Pt,s[15]=M*P+S*W+E*nt+A*dt,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],s=t[12],o=t[1],a=t[5],l=t[9],c=t[13],u=t[2],h=t[6],p=t[10],m=t[14],v=t[3],_=t[7],b=t[11],y=t[15];return v*(+s*l*h-r*c*h-s*a*p+n*c*p+r*a*m-n*l*m)+_*(+e*l*m-e*c*p+s*o*p-r*o*m+r*c*u-s*l*u)+b*(+e*c*h-e*a*m-s*o*h+n*o*m+s*a*u-n*c*u)+y*(-r*a*u-e*l*h+e*a*p+r*o*h-n*o*p+n*l*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],p=t[10],m=t[11],v=t[12],_=t[13],b=t[14],y=t[15],M=h*b*c-_*p*c+_*l*m-a*b*m-h*l*y+a*p*y,S=v*p*c-u*b*c-v*l*m+o*b*m+u*l*y-o*p*y,E=u*_*c-v*h*c+v*a*m-o*_*m-u*a*y+o*h*y,A=v*h*l-u*_*l-v*a*p+o*_*p+u*a*b-o*h*b,R=e*M+n*S+r*E+s*A;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const O=1/R;return t[0]=M*O,t[1]=(_*p*s-h*b*s-_*r*m+n*b*m+h*r*y-n*p*y)*O,t[2]=(a*b*s-_*l*s+_*r*c-n*b*c-a*r*y+n*l*y)*O,t[3]=(h*l*s-a*p*s-h*r*c+n*p*c+a*r*m-n*l*m)*O,t[4]=S*O,t[5]=(u*b*s-v*p*s+v*r*m-e*b*m-u*r*y+e*p*y)*O,t[6]=(v*l*s-o*b*s-v*r*c+e*b*c+o*r*y-e*l*y)*O,t[7]=(o*p*s-u*l*s+u*r*c-e*p*c-o*r*m+e*l*m)*O,t[8]=E*O,t[9]=(v*h*s-u*_*s-v*n*m+e*_*m+u*n*y-e*h*y)*O,t[10]=(o*_*s-v*a*s+v*n*c-e*_*c-o*n*y+e*a*y)*O,t[11]=(u*a*s-o*h*s-u*n*c+e*h*c+o*n*m-e*a*m)*O,t[12]=A*O,t[13]=(u*_*r-v*h*r+v*n*p-e*_*p-u*n*b+e*h*b)*O,t[14]=(v*a*r-o*_*r-v*n*l+e*_*l+o*n*b-e*a*b)*O,t[15]=(o*h*r-u*a*r+u*n*l-e*h*l-o*n*p+e*a*p)*O,this}scale(t){const e=this.elements,n=t.x,r=t.y,s=t.z;return e[0]*=n,e[4]*=r,e[8]*=s,e[1]*=n,e[5]*=r,e[9]*=s,e[2]*=n,e[6]*=r,e[10]*=s,e[3]*=n,e[7]*=r,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),s=1-n,o=t.x,a=t.y,l=t.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,s,o){return this.set(1,n,s,0,t,1,o,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,s=e._x,o=e._y,a=e._z,l=e._w,c=s+s,u=o+o,h=a+a,p=s*c,m=s*u,v=s*h,_=o*u,b=o*h,y=a*h,M=l*c,S=l*u,E=l*h,A=n.x,R=n.y,O=n.z;return r[0]=(1-(_+y))*A,r[1]=(m+E)*A,r[2]=(v-S)*A,r[3]=0,r[4]=(m-E)*R,r[5]=(1-(p+y))*R,r[6]=(b+M)*R,r[7]=0,r[8]=(v+S)*O,r[9]=(b-M)*O,r[10]=(1-(p+_))*O,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let s=Ep.set(r[0],r[1],r[2]).length();const o=Ep.set(r[4],r[5],r[6]).length(),a=Ep.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),t.x=r[12],t.y=r[13],t.z=r[14],al.copy(this);const c=1/s,u=1/o,h=1/a;return al.elements[0]*=c,al.elements[1]*=c,al.elements[2]*=c,al.elements[4]*=u,al.elements[5]*=u,al.elements[6]*=u,al.elements[8]*=h,al.elements[9]*=h,al.elements[10]*=h,e.setFromRotationMatrix(al),n.x=s,n.y=o,n.z=a,this}makePerspective(t,e,n,r,s,o,a=$l){const l=this.elements,c=2*s/(e-t),u=2*s/(n-r),h=(e+t)/(e-t),p=(n+r)/(n-r);let m,v;if(a===$l)m=-(o+s)/(o-s),v=-2*o*s/(o-s);else if(a===Bg)m=-o/(o-s),v=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,e,n,r,s,o,a=$l){const l=this.elements,c=1/(e-t),u=1/(n-r),h=1/(o-s),p=(e+t)*c,m=(n+r)*u;let v,_;if(a===$l)v=(o+s)*h,_=-2*h;else if(a===Bg)v=s*h,_=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=_,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}};const Ep=new Y,al=new rn,rq=new Y(0,0,0),sq=new Y(1,1,1),Ru=new Y,g0=new Y,ia=new Y,GP=new rn,qP=new $r;class Vd{constructor(t=0,e=0,n=0,r=Vd.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],h=r[2],p=r[6],m=r[10];switch(e){case"XYZ":this._y=Math.asin(hr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-hr(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(hr(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-hr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(hr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-hr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return GP.makeRotationFromQuaternion(t),this.setFromRotationMatrix(GP,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return qP.setFromEuler(this),this.setFromQuaternion(qP,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Vd.DEFAULT_ORDER="XYZ";class Uy{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let oq=0;const WP=new Y,Tp=new $r,Oc=new rn,v0=new Y,Fm=new Y,aq=new Y,lq=new $r,jP=new Y(1,0,0),XP=new Y(0,1,0),YP=new Y(0,0,1),cq={type:"added"},KP={type:"removed"};class qn extends ma{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:oq++}),this.uuid=ga(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=qn.DEFAULT_UP.clone();const t=new Y,e=new Vd,n=new $r,r=new Y(1,1,1);function s(){n.setFromEuler(e,!1)}function o(){e.setFromQuaternion(n,void 0,!1)}e._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new rn},normalMatrix:{value:new wn}}),this.matrix=new rn,this.matrixWorld=new rn,this.matrixAutoUpdate=qn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=qn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Uy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Tp.setFromAxisAngle(t,e),this.quaternion.multiply(Tp),this}rotateOnWorldAxis(t,e){return Tp.setFromAxisAngle(t,e),this.quaternion.premultiply(Tp),this}rotateX(t){return this.rotateOnAxis(jP,t)}rotateY(t){return this.rotateOnAxis(XP,t)}rotateZ(t){return this.rotateOnAxis(YP,t)}translateOnAxis(t,e){return WP.copy(t).applyQuaternion(this.quaternion),this.position.add(WP.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(jP,t)}translateY(t){return this.translateOnAxis(XP,t)}translateZ(t){return this.translateOnAxis(YP,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Oc.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?v0.copy(t):v0.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Fm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Oc.lookAt(Fm,v0,this.up):Oc.lookAt(v0,Fm,this.up),this.quaternion.setFromRotationMatrix(Oc),r&&(Oc.extractRotation(r.matrixWorld),Tp.setFromRotationMatrix(Oc),this.quaternion.premultiply(Tp.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(cq)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(KP)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(KP)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Oc.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Oc.multiply(t.parent.matrixWorld)),t.applyMatrix4(Oc),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getObjectsByProperty(t,e){let n=[];this[t]===e&&n.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(t,e);o.length>0&&(n=n.concat(o))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fm,t,aq),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fm,lq,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++){const s=e[n];(s.matrixWorldAutoUpdate===!0||t===!0)&&s.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const h=l[c];s(t.shapes,h)}else s(t.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(t.materials,this.material[l]));r.material=a}else r.material=s(t.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(t.animations,l))}}if(e){const a=o(t.geometries),l=o(t.materials),c=o(t.textures),u=o(t.images),h=o(t.shapes),p=o(t.skeletons),m=o(t.animations),v=o(t.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),h.length>0&&(n.shapes=h),p.length>0&&(n.skeletons=p),m.length>0&&(n.animations=m),v.length>0&&(n.nodes=v)}return n.object=r,n;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const r=t.children[n];this.add(r.clone())}return this}}qn.DEFAULT_UP=new Y(0,1,0);qn.DEFAULT_MATRIX_AUTO_UPDATE=!0;qn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ll=new Y,Dc=new Y,W1=new Y,Ic=new Y,Ap=new Y,Pp=new Y,ZP=new Y,j1=new Y,X1=new Y,Y1=new Y;let _0=!1;class Po{constructor(t=new Y,e=new Y,n=new Y){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),ll.subVectors(t,e),r.cross(ll);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(t,e,n,r,s){ll.subVectors(r,e),Dc.subVectors(n,e),W1.subVectors(t,e);const o=ll.dot(ll),a=ll.dot(Dc),l=ll.dot(W1),c=Dc.dot(Dc),u=Dc.dot(W1),h=o*c-a*a;if(h===0)return s.set(-2,-1,-1);const p=1/h,m=(c*l-a*u)*p,v=(o*u-a*l)*p;return s.set(1-m-v,v,m)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Ic),Ic.x>=0&&Ic.y>=0&&Ic.x+Ic.y<=1}static getUV(t,e,n,r,s,o,a,l){return _0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),_0=!0),this.getInterpolation(t,e,n,r,s,o,a,l)}static getInterpolation(t,e,n,r,s,o,a,l){return this.getBarycoord(t,e,n,r,Ic),l.setScalar(0),l.addScaledVector(s,Ic.x),l.addScaledVector(o,Ic.y),l.addScaledVector(a,Ic.z),l}static isFrontFacing(t,e,n,r){return ll.subVectors(n,e),Dc.subVectors(t,e),ll.cross(Dc).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return ll.subVectors(this.c,this.b),Dc.subVectors(this.a,this.b),ll.cross(Dc).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Po.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Po.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,s){return _0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),_0=!0),Po.getInterpolation(t,this.a,this.b,this.c,e,n,r,s)}getInterpolation(t,e,n,r,s){return Po.getInterpolation(t,this.a,this.b,this.c,e,n,r,s)}containsPoint(t){return Po.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Po.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,s=this.c;let o,a;Ap.subVectors(r,n),Pp.subVectors(s,n),j1.subVectors(t,n);const l=Ap.dot(j1),c=Pp.dot(j1);if(l<=0&&c<=0)return e.copy(n);X1.subVectors(t,r);const u=Ap.dot(X1),h=Pp.dot(X1);if(u>=0&&h<=u)return e.copy(r);const p=l*h-u*c;if(p<=0&&l>=0&&u<=0)return o=l/(l-u),e.copy(n).addScaledVector(Ap,o);Y1.subVectors(t,s);const m=Ap.dot(Y1),v=Pp.dot(Y1);if(v>=0&&m<=v)return e.copy(s);const _=m*c-l*v;if(_<=0&&c>=0&&v<=0)return a=c/(c-v),e.copy(n).addScaledVector(Pp,a);const b=u*v-m*h;if(b<=0&&h-u>=0&&m-v>=0)return ZP.subVectors(s,r),a=(h-u)/(h-u+(m-v)),e.copy(r).addScaledVector(ZP,a);const y=1/(b+_+p);return o=_*y,a=p*y,e.copy(n).addScaledVector(Ap,o).addScaledVector(Pp,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let uq=0,Hs=class extends ma{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:uq++}),this.uuid=ga(),this.name="",this.type="Material",this.blending=Hu,this.side=Kc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Ry,this.blendDst=ky,this.blendEquation=Nu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Xb,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ID,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ob,this.stencilZFail=Ob,this.stencilZPass=Ob,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const r=this[e];if(r===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Hu&&(n.blending=this.blending),this.side!==Kc&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=this.alphaHash),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(e){const s=r(t.textures),o=r(t.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const r=e.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=e[s].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}};const ZD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},cl={h:0,s:0,l:0},b0={h:0,s:0,l:0};function K1(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*6*(2/3-e):i}let me=class{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(e===void 0&&n===void 0){const r=t;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=cn){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,oa.toWorkingColorSpace(this,e),this}setRGB(t,e,n,r=oa.workingColorSpace){return this.r=t,this.g=e,this.b=n,oa.toWorkingColorSpace(this,r),this}setHSL(t,e,n,r=oa.workingColorSpace){if(t=wE(t,1),e=hr(e,0,1),n=hr(n,0,1),e===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+e):n+e-n*e,o=2*n-s;this.r=K1(o,s,t+1/3),this.g=K1(o,s,t),this.b=K1(o,s,t-1/3)}return oa.toWorkingColorSpace(this,r),this}setStyle(t,e=cn){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e);if(o===6)return this.setHex(parseInt(s,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=cn){const n=ZD[t.toLowerCase()];return n!==void 0?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=af(t.r),this.g=af(t.g),this.b=af(t.b),this}copyLinearToSRGB(t){return this.r=U1(t.r),this.g=U1(t.g),this.b=U1(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=cn){return oa.fromWorkingColorSpace(Ns.copy(this),t),Math.round(hr(Ns.r*255,0,255))*65536+Math.round(hr(Ns.g*255,0,255))*256+Math.round(hr(Ns.b*255,0,255))}getHexString(t=cn){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=oa.workingColorSpace){oa.fromWorkingColorSpace(Ns.copy(this),e);const n=Ns.r,r=Ns.g,s=Ns.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=u<=.5?h/(o+a):h/(2-o-a),o){case n:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-n)/h+2;break;case s:l=(n-r)/h+4;break}l/=6}return t.h=l,t.s=c,t.l=u,t}getRGB(t,e=oa.workingColorSpace){return oa.fromWorkingColorSpace(Ns.copy(this),e),t.r=Ns.r,t.g=Ns.g,t.b=Ns.b,t}getStyle(t=cn){oa.fromWorkingColorSpace(Ns.copy(this),t);const e=Ns.r,n=Ns.g,r=Ns.b;return t!==cn?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(t,e,n){return this.getHSL(cl),cl.h+=t,cl.s+=e,cl.l+=n,this.setHSL(cl.h,cl.s,cl.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(cl),t.getHSL(b0);const n=Mg(cl.h,b0.h,e),r=Mg(cl.s,b0.s,e),s=Mg(cl.l,b0.l,e);return this.setHSL(n,r,s),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,r=this.b,s=t.elements;return this.r=s[0]*e+s[3]*n+s[6]*r,this.g=s[1]*e+s[4]*n+s[7]*r,this.b=s[2]*e+s[5]*n+s[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ns=new me;me.NAMES=ZD;class iu extends Hs{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new me(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const qc=hq();function hq(){const i=new ArrayBuffer(4),t=new Float32Array(i),e=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:t,uint32View:e,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function To(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=hr(i,-65504,65504),qc.floatView[0]=i;const t=qc.uint32View[0],e=t>>23&511;return qc.baseTable[e]+((t&8388607)>>qc.shiftTable[e])}function dg(i){const t=i>>10;return qc.uint32View[0]=qc.mantissaTable[qc.offsetTable[t]+(i&1023)]+qc.exponentTable[t],qc.floatView[0]}const dq={toHalfFloat:To,fromHalfFloat:dg},Vr=new Y,y0=new Vt;class tn{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n,this.usage=Vg,this.updateRange={offset:0,count:-1},this.gpuType=Hr,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)y0.fromBufferAttribute(this,e),y0.applyMatrix3(t),this.setXY(e,y0.x,y0.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)Vr.fromBufferAttribute(this,e),Vr.applyMatrix3(t),this.setXYZ(e,Vr.x,Vr.y,Vr.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Vr.fromBufferAttribute(this,e),Vr.applyMatrix4(t),this.setXYZ(e,Vr.x,Vr.y,Vr.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Vr.fromBufferAttribute(this,e),Vr.applyNormalMatrix(t),this.setXYZ(e,Vr.x,Vr.y,Vr.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Vr.fromBufferAttribute(this,e),Vr.transformDirection(t),this.setXYZ(e,Vr.x,Vr.y,Vr.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=fa(e,this.array)),e}setX(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=fa(e,this.array)),e}setY(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=fa(e,this.array)),e}setZ(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=fa(e,this.array)),e}setW(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array),r=bn(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,s){return t*=this.itemSize,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array),r=bn(r,this.array),s=bn(s,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Vg&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}}class pq extends tn{constructor(t,e,n){super(new Int8Array(t),e,n)}}class fq extends tn{constructor(t,e,n){super(new Uint8Array(t),e,n)}}class mq extends tn{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}}class gq extends tn{constructor(t,e,n){super(new Int16Array(t),e,n)}}class CE extends tn{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class vq extends tn{constructor(t,e,n){super(new Int32Array(t),e,n)}}class EE extends tn{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class _q extends tn{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}getX(t){let e=dg(this.array[t*this.itemSize]);return this.normalized&&(e=fa(e,this.array)),e}setX(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize]=To(e),this}getY(t){let e=dg(this.array[t*this.itemSize+1]);return this.normalized&&(e=fa(e,this.array)),e}setY(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize+1]=To(e),this}getZ(t){let e=dg(this.array[t*this.itemSize+2]);return this.normalized&&(e=fa(e,this.array)),e}setZ(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize+2]=To(e),this}getW(t){let e=dg(this.array[t*this.itemSize+3]);return this.normalized&&(e=fa(e,this.array)),e}setW(t,e){return this.normalized&&(e=bn(e,this.array)),this.array[t*this.itemSize+3]=To(e),this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array)),this.array[t+0]=To(e),this.array[t+1]=To(n),this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array),r=bn(r,this.array)),this.array[t+0]=To(e),this.array[t+1]=To(n),this.array[t+2]=To(r),this}setXYZW(t,e,n,r,s){return t*=this.itemSize,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array),r=bn(r,this.array),s=bn(s,this.array)),this.array[t+0]=To(e),this.array[t+1]=To(n),this.array[t+2]=To(r),this.array[t+3]=To(s),this}}class Se extends tn{constructor(t,e,n){super(new Float32Array(t),e,n)}}class bq extends tn{constructor(t,e,n){super(new Float64Array(t),e,n)}}let yq=0;const Da=new rn,Z1=new qn,Rp=new Y,ra=new sc,Vm=new sc,gs=new Y;class fn extends ma{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:yq++}),this.uuid=ga(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(XD(t)?EE:CE)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new wn().getNormalMatrix(t);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Da.makeRotationFromQuaternion(t),this.applyMatrix4(Da),this}rotateX(t){return Da.makeRotationX(t),this.applyMatrix4(Da),this}rotateY(t){return Da.makeRotationY(t),this.applyMatrix4(Da),this}rotateZ(t){return Da.makeRotationZ(t),this.applyMatrix4(Da),this}translate(t,e,n){return Da.makeTranslation(t,e,n),this.applyMatrix4(Da),this}scale(t,e,n){return Da.makeScale(t,e,n),this.applyMatrix4(Da),this}lookAt(t){return Z1.lookAt(t),Z1.updateMatrix(),this.applyMatrix4(Z1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Rp).negate(),this.translate(Rp.x,Rp.y,Rp.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=t[n];e.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Se(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new sc);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Y(-1/0,-1/0,-1/0),new Y(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const s=e[n];ra.setFromBufferAttribute(s),this.morphTargetsRelative?(gs.addVectors(this.boundingBox.min,ra.min),this.boundingBox.expandByPoint(gs),gs.addVectors(this.boundingBox.max,ra.max),this.boundingBox.expandByPoint(gs)):(this.boundingBox.expandByPoint(ra.min),this.boundingBox.expandByPoint(ra.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new wl);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Y,1/0);return}if(t){const n=this.boundingSphere.center;if(ra.setFromBufferAttribute(t),e)for(let s=0,o=e.length;s<o;s++){const a=e[s];Vm.setFromBufferAttribute(a),this.morphTargetsRelative?(gs.addVectors(ra.min,Vm.min),ra.expandByPoint(gs),gs.addVectors(ra.max,Vm.max),ra.expandByPoint(gs)):(ra.expandByPoint(Vm.min),ra.expandByPoint(Vm.max))}ra.getCenter(n);let r=0;for(let s=0,o=t.count;s<o;s++)gs.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(gs));if(e)for(let s=0,o=e.length;s<o;s++){const a=e[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)gs.fromBufferAttribute(a,c),l&&(Rp.fromBufferAttribute(t,c),gs.add(Rp)),r=Math.max(r,n.distanceToSquared(gs))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.array,r=e.position.array,s=e.normal.array,o=e.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new tn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let D=0;D<a;D++)c[D]=new Y,u[D]=new Y;const h=new Y,p=new Y,m=new Y,v=new Vt,_=new Vt,b=new Vt,y=new Y,M=new Y;function S(D,V,K){h.fromArray(r,D*3),p.fromArray(r,V*3),m.fromArray(r,K*3),v.fromArray(o,D*2),_.fromArray(o,V*2),b.fromArray(o,K*2),p.sub(h),m.sub(h),_.sub(v),b.sub(v);const W=1/(_.x*b.y-b.x*_.y);isFinite(W)&&(y.copy(p).multiplyScalar(b.y).addScaledVector(m,-_.y).multiplyScalar(W),M.copy(m).multiplyScalar(_.x).addScaledVector(p,-b.x).multiplyScalar(W),c[D].add(y),c[V].add(y),c[K].add(y),u[D].add(M),u[V].add(M),u[K].add(M))}let E=this.groups;E.length===0&&(E=[{start:0,count:n.length}]);for(let D=0,V=E.length;D<V;++D){const K=E[D],W=K.start,Z=K.count;for(let z=W,ut=W+Z;z<ut;z+=3)S(n[z+0],n[z+1],n[z+2])}const A=new Y,R=new Y,O=new Y,L=new Y;function P(D){O.fromArray(s,D*3),L.copy(O);const V=c[D];A.copy(V),A.sub(O.multiplyScalar(O.dot(V))).normalize(),R.crossVectors(L,V);const W=R.dot(u[D])<0?-1:1;l[D*4]=A.x,l[D*4+1]=A.y,l[D*4+2]=A.z,l[D*4+3]=W}for(let D=0,V=E.length;D<V;++D){const K=E[D],W=K.start,Z=K.count;for(let z=W,ut=W+Z;z<ut;z+=3)P(n[z+0]),P(n[z+1]),P(n[z+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new tn(new Float32Array(e.count*3),3),this.setAttribute("normal",n);else for(let p=0,m=n.count;p<m;p++)n.setXYZ(p,0,0,0);const r=new Y,s=new Y,o=new Y,a=new Y,l=new Y,c=new Y,u=new Y,h=new Y;if(t)for(let p=0,m=t.count;p<m;p+=3){const v=t.getX(p+0),_=t.getX(p+1),b=t.getX(p+2);r.fromBufferAttribute(e,v),s.fromBufferAttribute(e,_),o.fromBufferAttribute(e,b),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,v),l.fromBufferAttribute(n,_),c.fromBufferAttribute(n,b),a.add(u),l.add(u),c.add(u),n.setXYZ(v,a.x,a.y,a.z),n.setXYZ(_,l.x,l.y,l.z),n.setXYZ(b,c.x,c.y,c.z)}else for(let p=0,m=e.count;p<m;p+=3)r.fromBufferAttribute(e,p+0),s.fromBufferAttribute(e,p+1),o.fromBufferAttribute(e,p+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(p+0,u.x,u.y,u.z),n.setXYZ(p+1,u.x,u.y,u.z),n.setXYZ(p+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)gs.fromBufferAttribute(t,e),gs.normalize(),t.setXYZ(e,gs.x,gs.y,gs.z)}toNonIndexed(){function t(a,l){const c=a.array,u=a.itemSize,h=a.normalized,p=new c.constructor(l.length*u);let m=0,v=0;for(let _=0,b=l.length;_<b;_++){a.isInterleavedBufferAttribute?m=l[_]*a.data.stride+a.offset:m=l[_]*u;for(let y=0;y<u;y++)p[v++]=c[m++]}return new tn(p,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new fn,n=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=t(l,n);e.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const p=c[u],m=t(p,n);l.push(m)}e.morphAttributes[a]=l}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];e.addGroup(c.start,c.count,c.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(t[c]=l[c]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const l in n){const c=n[l];t.data.attributes[l]=c.toJSON(t.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,p=c.length;h<p;h++){const m=c[h];u.push(m.toJSON(t.data))}u.length>0&&(r[l]=u,s=!0)}s&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const r=t.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(e))}const s=t.morphAttributes;for(const c in s){const u=[],h=s[c];for(let p=0,m=h.length;p<m;p++)u.push(h[p].clone(e));this.morphAttributes[c]=u}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const JP=new rn,Wh=new Fd,x0=new wl,QP=new Y,kp=new Y,Lp=new Y,Op=new Y,J1=new Y,w0=new Y,S0=new Vt,M0=new Vt,C0=new Vt,t2=new Y,e2=new Y,n2=new Y,E0=new Y,T0=new Y;class fi extends qn{constructor(t=new fn,e=new iu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(t,e){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;e.fromBufferAttribute(r,t);const a=this.morphTargetInfluences;if(s&&a){w0.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],h=s[l];u!==0&&(J1.fromBufferAttribute(h,t),o?w0.addScaledVector(J1,u):w0.addScaledVector(J1.sub(e),u))}e.add(w0)}return e}raycast(t,e){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),x0.copy(n.boundingSphere),x0.applyMatrix4(s),Wh.copy(t.ray).recast(t.near),!(x0.containsPoint(Wh.origin)===!1&&(Wh.intersectSphere(x0,QP)===null||Wh.origin.distanceToSquared(QP)>(t.far-t.near)**2))&&(JP.copy(s).invert(),Wh.copy(t.ray).applyMatrix4(JP),!(n.boundingBox!==null&&Wh.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(t,e,Wh)))}_computeIntersections(t,e,n){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,p=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let v=0,_=p.length;v<_;v++){const b=p[v],y=o[b.materialIndex],M=Math.max(b.start,m.start),S=Math.min(a.count,Math.min(b.start+b.count,m.start+m.count));for(let E=M,A=S;E<A;E+=3){const R=a.getX(E),O=a.getX(E+1),L=a.getX(E+2);r=A0(this,y,t,n,c,u,h,R,O,L),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=b.materialIndex,e.push(r))}}else{const v=Math.max(0,m.start),_=Math.min(a.count,m.start+m.count);for(let b=v,y=_;b<y;b+=3){const M=a.getX(b),S=a.getX(b+1),E=a.getX(b+2);r=A0(this,o,t,n,c,u,h,M,S,E),r&&(r.faceIndex=Math.floor(b/3),e.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let v=0,_=p.length;v<_;v++){const b=p[v],y=o[b.materialIndex],M=Math.max(b.start,m.start),S=Math.min(l.count,Math.min(b.start+b.count,m.start+m.count));for(let E=M,A=S;E<A;E+=3){const R=E,O=E+1,L=E+2;r=A0(this,y,t,n,c,u,h,R,O,L),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=b.materialIndex,e.push(r))}}else{const v=Math.max(0,m.start),_=Math.min(l.count,m.start+m.count);for(let b=v,y=_;b<y;b+=3){const M=b,S=b+1,E=b+2;r=A0(this,o,t,n,c,u,h,M,S,E),r&&(r.faceIndex=Math.floor(b/3),e.push(r))}}}}function xq(i,t,e,n,r,s,o,a){let l;if(t.side===ao?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,t.side===Kc,a),l===null)return null;T0.copy(a),T0.applyMatrix4(i.matrixWorld);const c=e.ray.origin.distanceTo(T0);return c<e.near||c>e.far?null:{distance:c,point:T0.clone(),object:i}}function A0(i,t,e,n,r,s,o,a,l,c){i.getVertexPosition(a,kp),i.getVertexPosition(l,Lp),i.getVertexPosition(c,Op);const u=xq(i,t,e,n,kp,Lp,Op,E0);if(u){r&&(S0.fromBufferAttribute(r,a),M0.fromBufferAttribute(r,l),C0.fromBufferAttribute(r,c),u.uv=Po.getInterpolation(E0,kp,Lp,Op,S0,M0,C0,new Vt)),s&&(S0.fromBufferAttribute(s,a),M0.fromBufferAttribute(s,l),C0.fromBufferAttribute(s,c),u.uv1=Po.getInterpolation(E0,kp,Lp,Op,S0,M0,C0,new Vt),u.uv2=u.uv1),o&&(t2.fromBufferAttribute(o,a),e2.fromBufferAttribute(o,l),n2.fromBufferAttribute(o,c),u.normal=Po.getInterpolation(E0,kp,Lp,Op,t2,e2,n2,new Y),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new Y,materialIndex:0};Po.getNormal(kp,Lp,Op,h.normal),u.face=h}return u}class Bd extends fn{constructor(t=1,e=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let p=0,m=0;v("z","y","x",-1,-1,n,e,t,o,s,0),v("z","y","x",1,-1,n,e,-t,o,s,1),v("x","z","y",1,1,t,n,e,r,o,2),v("x","z","y",1,-1,t,n,-e,r,o,3),v("x","y","z",1,-1,t,e,n,r,s,4),v("x","y","z",-1,-1,t,e,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new Se(c,3)),this.setAttribute("normal",new Se(u,3)),this.setAttribute("uv",new Se(h,2));function v(_,b,y,M,S,E,A,R,O,L,P){const D=E/O,V=A/L,K=E/2,W=A/2,Z=R/2,z=O+1,ut=L+1;let nt=0,Q=0;const St=new Y;for(let Pt=0;Pt<ut;Pt++){const dt=Pt*V-W;for(let Rt=0;Rt<z;Rt++){const Jt=Rt*D-K;St[_]=Jt*M,St[b]=dt*S,St[y]=Z,c.push(St.x,St.y,St.z),St[_]=0,St[b]=0,St[y]=R>0?1:-1,u.push(St.x,St.y,St.z),h.push(Rt/O),h.push(1-Pt/L),nt+=1}}for(let Pt=0;Pt<L;Pt++)for(let dt=0;dt<O;dt++){const Rt=p+dt+z*Pt,Jt=p+dt+z*(Pt+1),Bt=p+(dt+1)+z*(Pt+1),Wt=p+(dt+1)+z*Pt;l.push(Rt,Jt,Wt),l.push(Jt,Bt,Wt),Q+=6}a.addGroup(m,Q,P),m+=Q,p+=nt}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Bd(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function _f(i){const t={};for(const e in i){t[e]={};for(const n in i[e]){const r=i[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[e][n]=null):t[e][n]=r.clone():Array.isArray(r)?t[e][n]=r.slice():t[e][n]=r}}return t}function ro(i){const t={};for(let e=0;e<i.length;e++){const n=_f(i[e]);for(const r in n)t[r]=n[r]}return t}function wq(i){const t=[];for(let e=0;e<i.length;e++)t.push(i[e].clone());return t}function JD(i){return i.getRenderTarget()===null?i.outputColorSpace:bl}const QD={clone:_f,merge:ro};var Sq=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Mq=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class yl extends Hs{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Sq,this.fragmentShader=Mq,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=_f(t.uniforms),this.uniformsGroups=wq(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?e.uniforms[r]={type:"t",value:o.toJSON(t).uuid}:o&&o.isColor?e.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?e.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?e.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?e.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?e.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?e.uniforms[r]={type:"m4",value:o.toArray()}:e.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}let Ff=class extends qn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rn,this.projectionMatrix=new rn,this.projectionMatrixInverse=new rn,this.coordinateSystem=$l}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};class Di extends Ff{constructor(t=50,e=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=vf*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(bd*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return vf*2*Math.atan(Math.tan(bd*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,s,o){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(bd*.5*this.fov)/this.zoom,n=2*e,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,e-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;a!==0&&(s+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,e,e-n,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const Dp=-90,Ip=1;class tI extends qn{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const r=new Di(Dp,Ip,t,e);r.layers=this.layers,this.add(r);const s=new Di(Dp,Ip,t,e);s.layers=this.layers,this.add(s);const o=new Di(Dp,Ip,t,e);o.layers=this.layers,this.add(o);const a=new Di(Dp,Ip,t,e);a.layers=this.layers,this.add(a);const l=new Di(Dp,Ip,t,e);l.layers=this.layers,this.add(l);const c=new Di(Dp,Ip,t,e);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[n,r,s,o,a,l]=e;for(const c of e)this.remove(c);if(t===$l)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(t===Bg)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);for(const c of e)this.add(c),c.updateMatrixWorld()}update(t,e){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,u=t.getRenderTarget(),h=t.xr.enabled;t.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,s),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=p,t.setRenderTarget(n,5),t.render(e,c),t.setRenderTarget(u),t.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class xv extends mr{constructor(t,e,n,r,s,o,a,l,c,u){t=t!==void 0?t:[],e=e!==void 0?e:Zc,super(t,e,n,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class eI extends ba{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];e.encoding!==void 0&&(Cg("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),e.colorSpace=e.encoding===Xc?cn:qu),this.texture=new xv(r,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:Ji}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Bd(5,5,5),s=new yl({name:"CubemapFromEquirect",uniforms:_f(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ao,blending:Wc});s.uniforms.tEquirect.value=e;const o=new fi(r,s),a=e.minFilter;return e.minFilter===eh&&(e.minFilter=Ji),new tI(1,10,this).update(t,o),e.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(t,e,n,r){const s=t.getRenderTarget();for(let o=0;o<6;o++)t.setRenderTarget(this,o),t.clear(e,n,r);t.setRenderTarget(s)}}const Q1=new Y,Cq=new Y,Eq=new wn;class $c{constructor(t=new Y(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=Q1.subVectors(n,e).cross(Cq.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(Q1),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;const s=-(t.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:e.copy(t.start).addScaledVector(n,s)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Eq.getNormalMatrix(t),r=this.coplanarPoint(Q1).applyMatrix4(t),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const jh=new wl,P0=new Y;class Fy{constructor(t=new $c,e=new $c,n=new $c,r=new $c,s=new $c,o=new $c){this.planes=[t,e,n,r,s,o]}set(t,e,n,r,s,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t,e=$l){const n=this.planes,r=t.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],h=r[6],p=r[7],m=r[8],v=r[9],_=r[10],b=r[11],y=r[12],M=r[13],S=r[14],E=r[15];if(n[0].setComponents(l-s,p-c,b-m,E-y).normalize(),n[1].setComponents(l+s,p+c,b+m,E+y).normalize(),n[2].setComponents(l+o,p+u,b+v,E+M).normalize(),n[3].setComponents(l-o,p-u,b-v,E-M).normalize(),n[4].setComponents(l-a,p-h,b-_,E-S).normalize(),e===$l)n[5].setComponents(l+a,p+h,b+_,E+S).normalize();else if(e===Bg)n[5].setComponents(a,h,_,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),jh.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;e.boundingSphere===null&&e.computeBoundingSphere(),jh.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(jh)}intersectsSprite(t){return jh.center.set(0,0,0),jh.radius=.7071067811865476,jh.applyMatrix4(t.matrixWorld),this.intersectsSphere(jh)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let s=0;s<6;s++)if(e[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(P0.x=r.normal.x>0?t.max.x:t.min.x,P0.y=r.normal.y>0?t.max.y:t.min.y,P0.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(P0)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function nI(){let i=null,t=!1,e=null,n=null;function r(s,o){e(s,o),n=i.requestAnimationFrame(r)}return{start:function(){t!==!0&&e!==null&&(n=i.requestAnimationFrame(r),t=!0)},stop:function(){i.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(s){e=s},setContext:function(s){i=s}}}function Tq(i,t){const e=t.isWebGL2,n=new WeakMap;function r(c,u){const h=c.array,p=c.usage,m=i.createBuffer();i.bindBuffer(u,m),i.bufferData(u,h,p),c.onUploadCallback();let v;if(h instanceof Float32Array)v=i.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(e)v=i.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else v=i.UNSIGNED_SHORT;else if(h instanceof Int16Array)v=i.SHORT;else if(h instanceof Uint32Array)v=i.UNSIGNED_INT;else if(h instanceof Int32Array)v=i.INT;else if(h instanceof Int8Array)v=i.BYTE;else if(h instanceof Uint8Array)v=i.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)v=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:m,type:v,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){const p=u.array,m=u.updateRange;i.bindBuffer(h,c),m.count===-1?i.bufferSubData(h,0,p):(e?i.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):i.bufferSubData(h,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u&&(i.deleteBuffer(u.buffer),n.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const p=n.get(c);(!p||p.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);h===void 0?n.set(c,r(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:o,remove:a,update:l}}class Vf extends fn{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const s=t/2,o=e/2,a=Math.floor(n),l=Math.floor(r),c=a+1,u=l+1,h=t/a,p=e/l,m=[],v=[],_=[],b=[];for(let y=0;y<u;y++){const M=y*p-o;for(let S=0;S<c;S++){const E=S*h-s;v.push(E,-M,0),_.push(0,0,1),b.push(S/a),b.push(1-y/l)}}for(let y=0;y<l;y++)for(let M=0;M<a;M++){const S=M+c*y,E=M+c*(y+1),A=M+1+c*(y+1),R=M+1+c*y;m.push(S,E,R),m.push(E,A,R)}this.setIndex(m),this.setAttribute("position",new Se(v,3)),this.setAttribute("normal",new Se(_,3)),this.setAttribute("uv",new Se(b,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Vf(t.width,t.height,t.widthSegments,t.heightSegments)}}var Aq=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Pq=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Rq=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,kq=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Lq=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Oq=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Dq=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Iq=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Nq=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zq=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Uq=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Fq=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Vq=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Bq=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Hq=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,$q=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Gq=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,qq=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Wq=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,jq=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Xq=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Yq=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Kq=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Zq=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Jq=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Qq=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,tW=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,eW=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,nW="gl_FragColor = linearToOutputTexel( gl_FragColor );",iW=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,rW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,sW=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,oW=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,aW=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,lW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,cW=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,uW=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,hW=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,dW=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,pW=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,fW=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,mW=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,gW=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,vW=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,_W=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,bW=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,yW=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,xW=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,wW=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,SW=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,MW=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,CW=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,EW=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,TW=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,AW=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,PW=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,RW=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,kW=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,LW=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,OW=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,DW=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,IW=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,NW=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,zW=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,UW=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,FW=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,VW=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,BW=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,HW=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,$W=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,GW=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,qW=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,WW=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,jW=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,XW=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,YW=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,KW=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,ZW=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,JW=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,QW=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,tj=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,ej=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,nj=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ij=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,rj=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,sj=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,oj=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,aj=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,lj=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,cj=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,uj=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,hj=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,dj=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,pj=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,fj=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,mj=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,gj=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,vj=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,_j=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,bj=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,yj=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,xj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,wj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Sj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Mj=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Cj=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Ej=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Tj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Aj=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Pj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Rj=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,kj=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Lj=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Oj=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Dj=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Ij=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Nj=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zj=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Uj=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Fj=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Vj=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bj=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Hj=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$j=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Gj=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qj=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Wj=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,jj=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Xj=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yj=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Kj=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zj=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Jj=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qj=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,t6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,e6=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,n6=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,i6=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,r6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,dn={alphahash_fragment:Aq,alphahash_pars_fragment:Pq,alphamap_fragment:Rq,alphamap_pars_fragment:kq,alphatest_fragment:Lq,alphatest_pars_fragment:Oq,aomap_fragment:Dq,aomap_pars_fragment:Iq,begin_vertex:Nq,beginnormal_vertex:zq,bsdfs:Uq,iridescence_fragment:Fq,bumpmap_pars_fragment:Vq,clipping_planes_fragment:Bq,clipping_planes_pars_fragment:Hq,clipping_planes_pars_vertex:$q,clipping_planes_vertex:Gq,color_fragment:qq,color_pars_fragment:Wq,color_pars_vertex:jq,color_vertex:Xq,common:Yq,cube_uv_reflection_fragment:Kq,defaultnormal_vertex:Zq,displacementmap_pars_vertex:Jq,displacementmap_vertex:Qq,emissivemap_fragment:tW,emissivemap_pars_fragment:eW,colorspace_fragment:nW,colorspace_pars_fragment:iW,envmap_fragment:rW,envmap_common_pars_fragment:sW,envmap_pars_fragment:oW,envmap_pars_vertex:aW,envmap_physical_pars_fragment:bW,envmap_vertex:lW,fog_vertex:cW,fog_pars_vertex:uW,fog_fragment:hW,fog_pars_fragment:dW,gradientmap_pars_fragment:pW,lightmap_fragment:fW,lightmap_pars_fragment:mW,lights_lambert_fragment:gW,lights_lambert_pars_fragment:vW,lights_pars_begin:_W,lights_toon_fragment:yW,lights_toon_pars_fragment:xW,lights_phong_fragment:wW,lights_phong_pars_fragment:SW,lights_physical_fragment:MW,lights_physical_pars_fragment:CW,lights_fragment_begin:EW,lights_fragment_maps:TW,lights_fragment_end:AW,logdepthbuf_fragment:PW,logdepthbuf_pars_fragment:RW,logdepthbuf_pars_vertex:kW,logdepthbuf_vertex:LW,map_fragment:OW,map_pars_fragment:DW,map_particle_fragment:IW,map_particle_pars_fragment:NW,metalnessmap_fragment:zW,metalnessmap_pars_fragment:UW,morphcolor_vertex:FW,morphnormal_vertex:VW,morphtarget_pars_vertex:BW,morphtarget_vertex:HW,normal_fragment_begin:$W,normal_fragment_maps:GW,normal_pars_fragment:qW,normal_pars_vertex:WW,normal_vertex:jW,normalmap_pars_fragment:XW,clearcoat_normal_fragment_begin:YW,clearcoat_normal_fragment_maps:KW,clearcoat_pars_fragment:ZW,iridescence_pars_fragment:JW,opaque_fragment:QW,packing:tj,premultiplied_alpha_fragment:ej,project_vertex:nj,dithering_fragment:ij,dithering_pars_fragment:rj,roughnessmap_fragment:sj,roughnessmap_pars_fragment:oj,shadowmap_pars_fragment:aj,shadowmap_pars_vertex:lj,shadowmap_vertex:cj,shadowmask_pars_fragment:uj,skinbase_vertex:hj,skinning_pars_vertex:dj,skinning_vertex:pj,skinnormal_vertex:fj,specularmap_fragment:mj,specularmap_pars_fragment:gj,tonemapping_fragment:vj,tonemapping_pars_fragment:_j,transmission_fragment:bj,transmission_pars_fragment:yj,uv_pars_fragment:xj,uv_pars_vertex:wj,uv_vertex:Sj,worldpos_vertex:Mj,background_vert:Cj,background_frag:Ej,backgroundCube_vert:Tj,backgroundCube_frag:Aj,cube_vert:Pj,cube_frag:Rj,depth_vert:kj,depth_frag:Lj,distanceRGBA_vert:Oj,distanceRGBA_frag:Dj,equirect_vert:Ij,equirect_frag:Nj,linedashed_vert:zj,linedashed_frag:Uj,meshbasic_vert:Fj,meshbasic_frag:Vj,meshlambert_vert:Bj,meshlambert_frag:Hj,meshmatcap_vert:$j,meshmatcap_frag:Gj,meshnormal_vert:qj,meshnormal_frag:Wj,meshphong_vert:jj,meshphong_frag:Xj,meshphysical_vert:Yj,meshphysical_frag:Kj,meshtoon_vert:Zj,meshtoon_frag:Jj,points_vert:Qj,points_frag:t6,shadow_vert:e6,shadow_frag:n6,sprite_vert:i6,sprite_frag:r6},pe={common:{diffuse:{value:new me(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new wn},alphaMap:{value:null},alphaMapTransform:{value:new wn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new wn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new wn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new wn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new wn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new wn},normalScale:{value:new Vt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new wn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new wn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new wn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new wn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new me(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new me(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new wn},alphaTest:{value:0},uvTransform:{value:new wn}},sprite:{diffuse:{value:new me(16777215)},opacity:{value:1},center:{value:new Vt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new wn},alphaMap:{value:null},alphaMapTransform:{value:new wn},alphaTest:{value:0}}},pl={basic:{uniforms:ro([pe.common,pe.specularmap,pe.envmap,pe.aomap,pe.lightmap,pe.fog]),vertexShader:dn.meshbasic_vert,fragmentShader:dn.meshbasic_frag},lambert:{uniforms:ro([pe.common,pe.specularmap,pe.envmap,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.fog,pe.lights,{emissive:{value:new me(0)}}]),vertexShader:dn.meshlambert_vert,fragmentShader:dn.meshlambert_frag},phong:{uniforms:ro([pe.common,pe.specularmap,pe.envmap,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.fog,pe.lights,{emissive:{value:new me(0)},specular:{value:new me(1118481)},shininess:{value:30}}]),vertexShader:dn.meshphong_vert,fragmentShader:dn.meshphong_frag},standard:{uniforms:ro([pe.common,pe.envmap,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.roughnessmap,pe.metalnessmap,pe.fog,pe.lights,{emissive:{value:new me(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:dn.meshphysical_vert,fragmentShader:dn.meshphysical_frag},toon:{uniforms:ro([pe.common,pe.aomap,pe.lightmap,pe.emissivemap,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.gradientmap,pe.fog,pe.lights,{emissive:{value:new me(0)}}]),vertexShader:dn.meshtoon_vert,fragmentShader:dn.meshtoon_frag},matcap:{uniforms:ro([pe.common,pe.bumpmap,pe.normalmap,pe.displacementmap,pe.fog,{matcap:{value:null}}]),vertexShader:dn.meshmatcap_vert,fragmentShader:dn.meshmatcap_frag},points:{uniforms:ro([pe.points,pe.fog]),vertexShader:dn.points_vert,fragmentShader:dn.points_frag},dashed:{uniforms:ro([pe.common,pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:dn.linedashed_vert,fragmentShader:dn.linedashed_frag},depth:{uniforms:ro([pe.common,pe.displacementmap]),vertexShader:dn.depth_vert,fragmentShader:dn.depth_frag},normal:{uniforms:ro([pe.common,pe.bumpmap,pe.normalmap,pe.displacementmap,{opacity:{value:1}}]),vertexShader:dn.meshnormal_vert,fragmentShader:dn.meshnormal_frag},sprite:{uniforms:ro([pe.sprite,pe.fog]),vertexShader:dn.sprite_vert,fragmentShader:dn.sprite_frag},background:{uniforms:{uvTransform:{value:new wn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:dn.background_vert,fragmentShader:dn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:dn.backgroundCube_vert,fragmentShader:dn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:dn.cube_vert,fragmentShader:dn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:dn.equirect_vert,fragmentShader:dn.equirect_frag},distanceRGBA:{uniforms:ro([pe.common,pe.displacementmap,{referencePosition:{value:new Y},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:dn.distanceRGBA_vert,fragmentShader:dn.distanceRGBA_frag},shadow:{uniforms:ro([pe.lights,pe.fog,{color:{value:new me(0)},opacity:{value:1}}]),vertexShader:dn.shadow_vert,fragmentShader:dn.shadow_frag}};pl.physical={uniforms:ro([pl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new wn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new wn},clearcoatNormalScale:{value:new Vt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new wn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new wn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new wn},sheen:{value:0},sheenColor:{value:new me(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new wn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new wn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new wn},transmissionSamplerSize:{value:new Vt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new wn},attenuationDistance:{value:0},attenuationColor:{value:new me(0)},specularColor:{value:new me(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new wn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new wn},anisotropyVector:{value:new Vt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new wn}}]),vertexShader:dn.meshphysical_vert,fragmentShader:dn.meshphysical_frag};const R0={r:0,b:0,g:0};function s6(i,t,e,n,r,s,o){const a=new me(0);let l=s===!0?0:1,c,u,h=null,p=0,m=null;function v(b,y){let M=!1,S=y.isScene===!0?y.background:null;switch(S&&S.isTexture&&(S=(y.backgroundBlurriness>0?e:t).get(S)),S===null?_(a,l):S&&S.isColor&&(_(S,1),M=!0),i.xr.getEnvironmentBlendMode()){case"opaque":M=!0;break;case"additive":n.buffers.color.setClear(0,0,0,1,o),M=!0;break;case"alpha-blend":n.buffers.color.setClear(0,0,0,0,o),M=!0;break}(i.autoClear||M)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),S&&(S.isCubeTexture||S.mapping===zf)?(u===void 0&&(u=new fi(new Bd(1,1,1),new yl({name:"BackgroundCubeMaterial",uniforms:_f(pl.backgroundCube.uniforms),vertexShader:pl.backgroundCube.vertexShader,fragmentShader:pl.backgroundCube.fragmentShader,side:ao,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(R,O,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=S,u.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=S.colorSpace!==cn,(h!==S||p!==S.version||m!==i.toneMapping)&&(u.material.needsUpdate=!0,h=S,p=S.version,m=i.toneMapping),u.layers.enableAll(),b.unshift(u,u.geometry,u.material,0,0,null)):S&&S.isTexture&&(c===void 0&&(c=new fi(new Vf(2,2),new yl({name:"BackgroundMaterial",uniforms:_f(pl.background.uniforms),vertexShader:pl.background.vertexShader,fragmentShader:pl.background.fragmentShader,side:Kc,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=S,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=S.colorSpace!==cn,S.matrixAutoUpdate===!0&&S.updateMatrix(),c.material.uniforms.uvTransform.value.copy(S.matrix),(h!==S||p!==S.version||m!==i.toneMapping)&&(c.material.needsUpdate=!0,h=S,p=S.version,m=i.toneMapping),c.layers.enableAll(),b.unshift(c,c.geometry,c.material,0,0,null))}function _(b,y){b.getRGB(R0,JD(i)),n.buffers.color.setClear(R0.r,R0.g,R0.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(b,y=1){a.set(b),l=y,_(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(b){l=b,_(a,l)},render:v}}function o6(i,t,e,n){const r=i.getParameter(i.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=b(null);let c=l,u=!1;function h(Z,z,ut,nt,Q){let St=!1;if(o){const Pt=_(nt,ut,z);c!==Pt&&(c=Pt,m(c.object)),St=y(Z,nt,ut,Q),St&&M(Z,nt,ut,Q)}else{const Pt=z.wireframe===!0;(c.geometry!==nt.id||c.program!==ut.id||c.wireframe!==Pt)&&(c.geometry=nt.id,c.program=ut.id,c.wireframe=Pt,St=!0)}Q!==null&&e.update(Q,i.ELEMENT_ARRAY_BUFFER),(St||u)&&(u=!1,L(Z,z,ut,nt),Q!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(Q).buffer))}function p(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}function m(Z){return n.isWebGL2?i.bindVertexArray(Z):s.bindVertexArrayOES(Z)}function v(Z){return n.isWebGL2?i.deleteVertexArray(Z):s.deleteVertexArrayOES(Z)}function _(Z,z,ut){const nt=ut.wireframe===!0;let Q=a[Z.id];Q===void 0&&(Q={},a[Z.id]=Q);let St=Q[z.id];St===void 0&&(St={},Q[z.id]=St);let Pt=St[nt];return Pt===void 0&&(Pt=b(p()),St[nt]=Pt),Pt}function b(Z){const z=[],ut=[],nt=[];for(let Q=0;Q<r;Q++)z[Q]=0,ut[Q]=0,nt[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:ut,attributeDivisors:nt,object:Z,attributes:{},index:null}}function y(Z,z,ut,nt){const Q=c.attributes,St=z.attributes;let Pt=0;const dt=ut.getAttributes();for(const Rt in dt)if(dt[Rt].location>=0){const Bt=Q[Rt];let Wt=St[Rt];if(Wt===void 0&&(Rt==="instanceMatrix"&&Z.instanceMatrix&&(Wt=Z.instanceMatrix),Rt==="instanceColor"&&Z.instanceColor&&(Wt=Z.instanceColor)),Bt===void 0||Bt.attribute!==Wt||Wt&&Bt.data!==Wt.data)return!0;Pt++}return c.attributesNum!==Pt||c.index!==nt}function M(Z,z,ut,nt){const Q={},St=z.attributes;let Pt=0;const dt=ut.getAttributes();for(const Rt in dt)if(dt[Rt].location>=0){let Bt=St[Rt];Bt===void 0&&(Rt==="instanceMatrix"&&Z.instanceMatrix&&(Bt=Z.instanceMatrix),Rt==="instanceColor"&&Z.instanceColor&&(Bt=Z.instanceColor));const Wt={};Wt.attribute=Bt,Bt&&Bt.data&&(Wt.data=Bt.data),Q[Rt]=Wt,Pt++}c.attributes=Q,c.attributesNum=Pt,c.index=nt}function S(){const Z=c.newAttributes;for(let z=0,ut=Z.length;z<ut;z++)Z[z]=0}function E(Z){A(Z,0)}function A(Z,z){const ut=c.newAttributes,nt=c.enabledAttributes,Q=c.attributeDivisors;ut[Z]=1,nt[Z]===0&&(i.enableVertexAttribArray(Z),nt[Z]=1),Q[Z]!==z&&((n.isWebGL2?i:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Z,z),Q[Z]=z)}function R(){const Z=c.newAttributes,z=c.enabledAttributes;for(let ut=0,nt=z.length;ut<nt;ut++)z[ut]!==Z[ut]&&(i.disableVertexAttribArray(ut),z[ut]=0)}function O(Z,z,ut,nt,Q,St,Pt){Pt===!0?i.vertexAttribIPointer(Z,z,ut,Q,St):i.vertexAttribPointer(Z,z,ut,nt,Q,St)}function L(Z,z,ut,nt){if(n.isWebGL2===!1&&(Z.isInstancedMesh||nt.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;S();const Q=nt.attributes,St=ut.getAttributes(),Pt=z.defaultAttributeValues;for(const dt in St){const Rt=St[dt];if(Rt.location>=0){let Jt=Q[dt];if(Jt===void 0&&(dt==="instanceMatrix"&&Z.instanceMatrix&&(Jt=Z.instanceMatrix),dt==="instanceColor"&&Z.instanceColor&&(Jt=Z.instanceColor)),Jt!==void 0){const Bt=Jt.normalized,Wt=Jt.itemSize,be=e.get(Jt);if(be===void 0)continue;const re=be.buffer,It=be.type,ye=be.bytesPerElement,ce=n.isWebGL2===!0&&(It===i.INT||It===i.UNSIGNED_INT||Jt.gpuType===Uf);if(Jt.isInterleavedBufferAttribute){const ne=Jt.data,Gt=ne.stride,J=Jt.offset;if(ne.isInstancedInterleavedBuffer){for(let $t=0;$t<Rt.locationSize;$t++)A(Rt.location+$t,ne.meshPerAttribute);Z.isInstancedMesh!==!0&&nt._maxInstanceCount===void 0&&(nt._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let $t=0;$t<Rt.locationSize;$t++)E(Rt.location+$t);i.bindBuffer(i.ARRAY_BUFFER,re);for(let $t=0;$t<Rt.locationSize;$t++)O(Rt.location+$t,Wt/Rt.locationSize,It,Bt,Gt*ye,(J+Wt/Rt.locationSize*$t)*ye,ce)}else{if(Jt.isInstancedBufferAttribute){for(let ne=0;ne<Rt.locationSize;ne++)A(Rt.location+ne,Jt.meshPerAttribute);Z.isInstancedMesh!==!0&&nt._maxInstanceCount===void 0&&(nt._maxInstanceCount=Jt.meshPerAttribute*Jt.count)}else for(let ne=0;ne<Rt.locationSize;ne++)E(Rt.location+ne);i.bindBuffer(i.ARRAY_BUFFER,re);for(let ne=0;ne<Rt.locationSize;ne++)O(Rt.location+ne,Wt/Rt.locationSize,It,Bt,Wt*ye,Wt/Rt.locationSize*ne*ye,ce)}}else if(Pt!==void 0){const Bt=Pt[dt];if(Bt!==void 0)switch(Bt.length){case 2:i.vertexAttrib2fv(Rt.location,Bt);break;case 3:i.vertexAttrib3fv(Rt.location,Bt);break;case 4:i.vertexAttrib4fv(Rt.location,Bt);break;default:i.vertexAttrib1fv(Rt.location,Bt)}}}}R()}function P(){K();for(const Z in a){const z=a[Z];for(const ut in z){const nt=z[ut];for(const Q in nt)v(nt[Q].object),delete nt[Q];delete z[ut]}delete a[Z]}}function D(Z){if(a[Z.id]===void 0)return;const z=a[Z.id];for(const ut in z){const nt=z[ut];for(const Q in nt)v(nt[Q].object),delete nt[Q];delete z[ut]}delete a[Z.id]}function V(Z){for(const z in a){const ut=a[z];if(ut[Z.id]===void 0)continue;const nt=ut[Z.id];for(const Q in nt)v(nt[Q].object),delete nt[Q];delete ut[Z.id]}}function K(){W(),u=!0,c!==l&&(c=l,m(c.object))}function W(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:K,resetDefaultState:W,dispose:P,releaseStatesOfGeometry:D,releaseStatesOfProgram:V,initAttributes:S,enableAttribute:E,disableUnusedAttributes:R}}function a6(i,t,e,n){const r=n.isWebGL2;let s;function o(c){s=c}function a(c,u){i.drawArrays(s,c,u),e.update(u,s,1)}function l(c,u,h){if(h===0)return;let p,m;if(r)p=i,m="drawArraysInstanced";else if(p=t.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[m](s,c,u,h),e.update(u,s,h)}this.setMode=o,this.render=a,this.renderInstances=l}function l6(i,t,e){let n;function r(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){const O=t.get("EXT_texture_filter_anisotropic");n=i.getParameter(O.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(O){if(O==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";O="mediump"}return O==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&i.constructor.name==="WebGL2RenderingContext";let a=e.precision!==void 0?e.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||t.has("WEBGL_draw_buffers"),u=e.logarithmicDepthBuffer===!0,h=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),p=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=i.getParameter(i.MAX_TEXTURE_SIZE),v=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),_=i.getParameter(i.MAX_VERTEX_ATTRIBS),b=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),y=i.getParameter(i.MAX_VARYING_VECTORS),M=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),S=p>0,E=o||t.has("OES_texture_float"),A=S&&E,R=o?i.getParameter(i.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:v,maxAttributes:_,maxVertexUniforms:b,maxVaryings:y,maxFragmentUniforms:M,vertexTextures:S,floatFragmentTextures:E,floatVertexTextures:A,maxSamples:R}}function c6(i){const t=this;let e=null,n=0,r=!1,s=!1;const o=new $c,a=new wn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,p){const m=h.length!==0||p||n!==0||r;return r=p,n=h.length,m},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,p){e=u(h,p,0)},this.setState=function(h,p,m){const v=h.clippingPlanes,_=h.clipIntersection,b=h.clipShadows,y=i.get(h);if(!r||v===null||v.length===0||s&&!b)s?u(null):c();else{const M=s?0:n,S=M*4;let E=y.clippingState||null;l.value=E,E=u(v,p,S,m);for(let A=0;A!==S;++A)E[A]=e[A];y.clippingState=E,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=M}};function c(){l.value!==e&&(l.value=e,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(h,p,m,v){const _=h!==null?h.length:0;let b=null;if(_!==0){if(b=l.value,v!==!0||b===null){const y=m+_*4,M=p.matrixWorldInverse;a.getNormalMatrix(M),(b===null||b.length<y)&&(b=new Float32Array(y));for(let S=0,E=m;S!==_;++S,E+=4)o.copy(h[S]).applyMatrix4(M,a),o.normal.toArray(b,E),b[E+3]=o.constant}l.value=b,l.needsUpdate=!0}return t.numPlanes=_,t.numIntersection=0,b}}function u6(i){let t=new WeakMap;function e(o,a){return a===Dg?o.mapping=Zc:a===Ig&&(o.mapping=th),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===Dg||a===Ig)if(t.has(o)){const l=t.get(o).texture;return e(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new eI(l.height/2);return c.fromEquirectangularTexture(i,o),t.set(o,c),o.addEventListener("dispose",r),e(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=t.get(a);l!==void 0&&(t.delete(a),l.dispose())}function s(){t=new WeakMap}return{get:n,dispose:s}}class wv extends Ff{constructor(t=-1,e=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-t,o=n+t,a=r+e,l=r-e;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}}const Kp=4,i2=[.125,.215,.35,.446,.526,.582],ud=20,tS=new wv,r2=new me;let eS=null;const od=(1+Math.sqrt(5))/2,Np=1/od,s2=[new Y(1,1,1),new Y(-1,1,1),new Y(1,1,-1),new Y(-1,1,-1),new Y(0,od,Np),new Y(0,od,-Np),new Y(Np,0,od),new Y(-Np,0,od),new Y(od,Np,0),new Y(-od,Np,0)];class jM{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,r=100){eS=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(t,n,r,s),e>0&&this._blur(s,0,0,e),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=l2(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=a2(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(eS),t.scissorTest=!1,k0(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===Zc||t.mapping===th?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),eS=this._renderer.getRenderTarget();const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:Ji,minFilter:Ji,generateMipmaps:!1,type:gf,format:Es,colorSpace:bl,depthBuffer:!1},r=o2(t,e,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=o2(t,e,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=h6(s)),this._blurMaterial=d6(s,t,e)}return r}_compileMaterial(t){const e=new fi(this._lodPlanes[0],t);this._renderer.compile(e,tS)}_sceneToCubeUV(t,e,n,r){const a=new Di(90,1,e,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,p=u.toneMapping;u.getClearColor(r2),u.toneMapping=jc,u.autoClear=!1;const m=new iu({name:"PMREM.Background",side:ao,depthWrite:!1,depthTest:!1}),v=new fi(new Bd,m);let _=!1;const b=t.background;b?b.isColor&&(m.color.copy(b),t.background=null,_=!0):(m.color.copy(r2),_=!0);for(let y=0;y<6;y++){const M=y%3;M===0?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):M===1?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const S=this._cubeSize;k0(r,M*S,y>2?S:0,S,S),u.setRenderTarget(r),_&&u.render(v,a),u.render(t,a)}v.geometry.dispose(),v.material.dispose(),u.toneMapping=p,u.autoClear=h,t.background=b}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===Zc||t.mapping===th;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=l2()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=a2());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new fi(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=t;const l=this._cubeSize;k0(e,0,0,3*l,2*l),n.setRenderTarget(e),n.render(o,tS)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=s2[(r-1)%s2.length];this._blur(t,r-1,r,s,o)}e.autoClear=n}_blur(t,e,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,r,"latitudinal",s),this._halfBlur(o,t,n,n,r,"longitudinal",s)}_halfBlur(t,e,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new fi(this._lodPlanes[r],c),p=c.uniforms,m=this._sizeLods[n]-1,v=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*ud-1),_=s/v,b=isFinite(s)?1+Math.floor(u*_):ud;b>ud&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${ud}`);const y=[];let M=0;for(let O=0;O<ud;++O){const L=O/_,P=Math.exp(-L*L/2);y.push(P),O===0?M+=P:O<b&&(M+=2*P)}for(let O=0;O<y.length;O++)y[O]=y[O]/M;p.envMap.value=t.texture,p.samples.value=b,p.weights.value=y,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:S}=this;p.dTheta.value=v,p.mipInt.value=S-n;const E=this._sizeLods[r],A=3*E*(r>S-Kp?r-S+Kp:0),R=4*(this._cubeSize-E);k0(e,A,R,3*E,2*E),l.setRenderTarget(e),l.render(h,tS)}}function h6(i){const t=[],e=[],n=[];let r=i;const s=i-Kp+1+i2.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);e.push(a);let l=1/a;o>i-Kp?l=i2[o-i+Kp-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),u=-c,h=1+c,p=[u,u,h,u,h,h,u,u,h,h,u,h],m=6,v=6,_=3,b=2,y=1,M=new Float32Array(_*v*m),S=new Float32Array(b*v*m),E=new Float32Array(y*v*m);for(let R=0;R<m;R++){const O=R%3*2/3-1,L=R>2?0:-1,P=[O,L,0,O+2/3,L,0,O+2/3,L+1,0,O,L,0,O+2/3,L+1,0,O,L+1,0];M.set(P,_*v*R),S.set(p,b*v*R);const D=[R,R,R,R,R,R];E.set(D,y*v*R)}const A=new fn;A.setAttribute("position",new tn(M,_)),A.setAttribute("uv",new tn(S,b)),A.setAttribute("faceIndex",new tn(E,y)),t.push(A),r>Kp&&r--}return{lodPlanes:t,sizeLods:e,sigmas:n}}function o2(i,t,e){const n=new ba(i,t,e);return n.texture.mapping=zf,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function k0(i,t,e,n,r){i.viewport.set(t,e,n,r),i.scissor.set(t,e,n,r)}function d6(i,t,e){const n=new Float32Array(ud),r=new Y(0,1,0);return new yl({name:"SphericalGaussianBlur",defines:{n:ud,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/e,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:TE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Wc,depthTest:!1,depthWrite:!1})}function a2(){return new yl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:TE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Wc,depthTest:!1,depthWrite:!1})}function l2(){return new yl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:TE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Wc,depthTest:!1,depthWrite:!1})}function TE(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function p6(i){let t=new WeakMap,e=null;function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===Dg||l===Ig,u=l===Zc||l===th;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=t.get(a);return e===null&&(e=new jM(i)),h=c?e.fromEquirectangular(a,h):e.fromCubemap(a,h),t.set(a,h),h.texture}else{if(t.has(a))return t.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&r(h)){e===null&&(e=new jM(i));const p=c?e.fromEquirectangular(a):e.fromCubemap(a);return t.set(a,p),a.addEventListener("dispose",s),p.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function o(){t=new WeakMap,e!==null&&(e.dispose(),e=null)}return{get:n,dispose:o}}function f6(i){const t={};function e(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return t[n]=r,r}return{has:function(n){return e(n)!==null},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e("WEBGL_multisampled_render_to_texture")},get:function(n){const r=e(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function m6(i,t,e,n){const r={},s=new WeakMap;function o(h){const p=h.target;p.index!==null&&t.remove(p.index);for(const v in p.attributes)t.remove(p.attributes[v]);for(const v in p.morphAttributes){const _=p.morphAttributes[v];for(let b=0,y=_.length;b<y;b++)t.remove(_[b])}p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(t.remove(m),s.delete(p)),n.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,e.memory.geometries--}function a(h,p){return r[p.id]===!0||(p.addEventListener("dispose",o),r[p.id]=!0,e.memory.geometries++),p}function l(h){const p=h.attributes;for(const v in p)t.update(p[v],i.ARRAY_BUFFER);const m=h.morphAttributes;for(const v in m){const _=m[v];for(let b=0,y=_.length;b<y;b++)t.update(_[b],i.ARRAY_BUFFER)}}function c(h){const p=[],m=h.index,v=h.attributes.position;let _=0;if(m!==null){const M=m.array;_=m.version;for(let S=0,E=M.length;S<E;S+=3){const A=M[S+0],R=M[S+1],O=M[S+2];p.push(A,R,R,O,O,A)}}else{const M=v.array;_=v.version;for(let S=0,E=M.length/3-1;S<E;S+=3){const A=S+0,R=S+1,O=S+2;p.push(A,R,R,O,O,A)}}const b=new(XD(p)?EE:CE)(p,1);b.version=_;const y=s.get(h);y&&t.remove(y),s.set(h,b)}function u(h){const p=s.get(h);if(p){const m=h.index;m!==null&&p.version<m.version&&c(h)}else c(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:u}}function g6(i,t,e,n){const r=n.isWebGL2;let s;function o(p){s=p}let a,l;function c(p){a=p.type,l=p.bytesPerElement}function u(p,m){i.drawElements(s,m,a,p*l),e.update(m,s,1)}function h(p,m,v){if(v===0)return;let _,b;if(r)_=i,b="drawElementsInstanced";else if(_=t.get("ANGLE_instanced_arrays"),b="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[b](s,m,a,p*l,v),e.update(m,s,v)}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=h}function v6(i){const t={geometries:0,textures:0},e={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(e.calls++,o){case i.TRIANGLES:e.triangles+=a*(s/3);break;case i.LINES:e.lines+=a*(s/2);break;case i.LINE_STRIP:e.lines+=a*(s-1);break;case i.LINE_LOOP:e.lines+=a*s;break;case i.POINTS:e.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){e.calls=0,e.triangles=0,e.points=0,e.lines=0}return{memory:t,render:e,programs:null,autoReset:!0,reset:r,update:n}}function _6(i,t){return i[0]-t[0]}function b6(i,t){return Math.abs(t[1])-Math.abs(i[1])}function y6(i,t,e){const n={},r=new Float32Array(8),s=new WeakMap,o=new Vn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,h){const p=c.morphTargetInfluences;if(t.isWebGL2===!0){const m=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=m!==void 0?m.length:0;let _=s.get(u);if(_===void 0||_.count!==v){let Z=function(){K.dispose(),s.delete(u),u.removeEventListener("dispose",Z)};_!==void 0&&_.texture.dispose();const M=u.morphAttributes.position!==void 0,S=u.morphAttributes.normal!==void 0,E=u.morphAttributes.color!==void 0,A=u.morphAttributes.position||[],R=u.morphAttributes.normal||[],O=u.morphAttributes.color||[];let L=0;M===!0&&(L=1),S===!0&&(L=2),E===!0&&(L=3);let P=u.attributes.position.count*L,D=1;P>t.maxTextureSize&&(D=Math.ceil(P/t.maxTextureSize),P=t.maxTextureSize);const V=new Float32Array(P*D*4*v),K=new zy(V,P,D,v);K.type=Hr,K.needsUpdate=!0;const W=L*4;for(let z=0;z<v;z++){const ut=A[z],nt=R[z],Q=O[z],St=P*D*4*z;for(let Pt=0;Pt<ut.count;Pt++){const dt=Pt*W;M===!0&&(o.fromBufferAttribute(ut,Pt),V[St+dt+0]=o.x,V[St+dt+1]=o.y,V[St+dt+2]=o.z,V[St+dt+3]=0),S===!0&&(o.fromBufferAttribute(nt,Pt),V[St+dt+4]=o.x,V[St+dt+5]=o.y,V[St+dt+6]=o.z,V[St+dt+7]=0),E===!0&&(o.fromBufferAttribute(Q,Pt),V[St+dt+8]=o.x,V[St+dt+9]=o.y,V[St+dt+10]=o.z,V[St+dt+11]=Q.itemSize===4?o.w:1)}}_={count:v,texture:K,size:new Vt(P,D)},s.set(u,_),u.addEventListener("dispose",Z)}let b=0;for(let M=0;M<p.length;M++)b+=p[M];const y=u.morphTargetsRelative?1:1-b;h.getUniforms().setValue(i,"morphTargetBaseInfluence",y),h.getUniforms().setValue(i,"morphTargetInfluences",p),h.getUniforms().setValue(i,"morphTargetsTexture",_.texture,e),h.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}else{const m=p===void 0?0:p.length;let v=n[u.id];if(v===void 0||v.length!==m){v=[];for(let S=0;S<m;S++)v[S]=[S,0];n[u.id]=v}for(let S=0;S<m;S++){const E=v[S];E[0]=S,E[1]=p[S]}v.sort(b6);for(let S=0;S<8;S++)S<m&&v[S][1]?(a[S][0]=v[S][0],a[S][1]=v[S][1]):(a[S][0]=Number.MAX_SAFE_INTEGER,a[S][1]=0);a.sort(_6);const _=u.morphAttributes.position,b=u.morphAttributes.normal;let y=0;for(let S=0;S<8;S++){const E=a[S],A=E[0],R=E[1];A!==Number.MAX_SAFE_INTEGER&&R?(_&&u.getAttribute("morphTarget"+S)!==_[A]&&u.setAttribute("morphTarget"+S,_[A]),b&&u.getAttribute("morphNormal"+S)!==b[A]&&u.setAttribute("morphNormal"+S,b[A]),r[S]=R,y+=R):(_&&u.hasAttribute("morphTarget"+S)===!0&&u.deleteAttribute("morphTarget"+S),b&&u.hasAttribute("morphNormal"+S)===!0&&u.deleteAttribute("morphNormal"+S),r[S]=0)}const M=u.morphTargetsRelative?1:1-y;h.getUniforms().setValue(i,"morphTargetBaseInfluence",M),h.getUniforms().setValue(i,"morphTargetInfluences",r)}}return{update:l}}function x6(i,t,e,n){let r=new WeakMap;function s(l){const c=n.render.frame,u=l.geometry,h=t.get(l,u);if(r.get(h)!==c&&(t.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(e.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&e.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return h}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),e.remove(c.instanceMatrix),c.instanceColor!==null&&e.remove(c.instanceColor)}return{update:s,dispose:o}}const iI=new mr,rI=new zy,sI=new ME,oI=new xv,c2=[],u2=[],h2=new Float32Array(16),d2=new Float32Array(9),p2=new Float32Array(4);function Bf(i,t,e){const n=i[0];if(n<=0||n>0)return i;const r=t*e;let s=c2[r];if(s===void 0&&(s=new Float32Array(r),c2[r]=s),t!==0){n.toArray(s,0);for(let o=1,a=0;o!==t;++o)a+=e,i[o].toArray(s,a)}return s}function is(i,t){if(i.length!==t.length)return!1;for(let e=0,n=i.length;e<n;e++)if(i[e]!==t[e])return!1;return!0}function rs(i,t){for(let e=0,n=t.length;e<n;e++)i[e]=t[e]}function Vy(i,t){let e=u2[t];e===void 0&&(e=new Int32Array(t),u2[t]=e);for(let n=0;n!==t;++n)e[n]=i.allocateTextureUnit();return e}function w6(i,t){const e=this.cache;e[0]!==t&&(i.uniform1f(this.addr,t),e[0]=t)}function S6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(is(e,t))return;i.uniform2fv(this.addr,t),rs(e,t)}}function M6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)(e[0]!==t.r||e[1]!==t.g||e[2]!==t.b)&&(i.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(is(e,t))return;i.uniform3fv(this.addr,t),rs(e,t)}}function C6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(is(e,t))return;i.uniform4fv(this.addr,t),rs(e,t)}}function E6(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(is(e,t))return;i.uniformMatrix2fv(this.addr,!1,t),rs(e,t)}else{if(is(e,n))return;p2.set(n),i.uniformMatrix2fv(this.addr,!1,p2),rs(e,n)}}function T6(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(is(e,t))return;i.uniformMatrix3fv(this.addr,!1,t),rs(e,t)}else{if(is(e,n))return;d2.set(n),i.uniformMatrix3fv(this.addr,!1,d2),rs(e,n)}}function A6(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(is(e,t))return;i.uniformMatrix4fv(this.addr,!1,t),rs(e,t)}else{if(is(e,n))return;h2.set(n),i.uniformMatrix4fv(this.addr,!1,h2),rs(e,n)}}function P6(i,t){const e=this.cache;e[0]!==t&&(i.uniform1i(this.addr,t),e[0]=t)}function R6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2i(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(is(e,t))return;i.uniform2iv(this.addr,t),rs(e,t)}}function k6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3i(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else{if(is(e,t))return;i.uniform3iv(this.addr,t),rs(e,t)}}function L6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4i(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(is(e,t))return;i.uniform4iv(this.addr,t),rs(e,t)}}function O6(i,t){const e=this.cache;e[0]!==t&&(i.uniform1ui(this.addr,t),e[0]=t)}function D6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(i.uniform2ui(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(is(e,t))return;i.uniform2uiv(this.addr,t),rs(e,t)}}function I6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(i.uniform3ui(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else{if(is(e,t))return;i.uniform3uiv(this.addr,t),rs(e,t)}}function N6(i,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(i.uniform4ui(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(is(e,t))return;i.uniform4uiv(this.addr,t),rs(e,t)}}function z6(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2D(t||iI,r)}function U6(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture3D(t||sI,r)}function F6(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTextureCube(t||oI,r)}function V6(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2DArray(t||rI,r)}function B6(i){switch(i){case 5126:return w6;case 35664:return S6;case 35665:return M6;case 35666:return C6;case 35674:return E6;case 35675:return T6;case 35676:return A6;case 5124:case 35670:return P6;case 35667:case 35671:return R6;case 35668:case 35672:return k6;case 35669:case 35673:return L6;case 5125:return O6;case 36294:return D6;case 36295:return I6;case 36296:return N6;case 35678:case 36198:case 36298:case 36306:case 35682:return z6;case 35679:case 36299:case 36307:return U6;case 35680:case 36300:case 36308:case 36293:return F6;case 36289:case 36303:case 36311:case 36292:return V6}}function H6(i,t){i.uniform1fv(this.addr,t)}function $6(i,t){const e=Bf(t,this.size,2);i.uniform2fv(this.addr,e)}function G6(i,t){const e=Bf(t,this.size,3);i.uniform3fv(this.addr,e)}function q6(i,t){const e=Bf(t,this.size,4);i.uniform4fv(this.addr,e)}function W6(i,t){const e=Bf(t,this.size,4);i.uniformMatrix2fv(this.addr,!1,e)}function j6(i,t){const e=Bf(t,this.size,9);i.uniformMatrix3fv(this.addr,!1,e)}function X6(i,t){const e=Bf(t,this.size,16);i.uniformMatrix4fv(this.addr,!1,e)}function Y6(i,t){i.uniform1iv(this.addr,t)}function K6(i,t){i.uniform2iv(this.addr,t)}function Z6(i,t){i.uniform3iv(this.addr,t)}function J6(i,t){i.uniform4iv(this.addr,t)}function Q6(i,t){i.uniform1uiv(this.addr,t)}function t8(i,t){i.uniform2uiv(this.addr,t)}function e8(i,t){i.uniform3uiv(this.addr,t)}function n8(i,t){i.uniform4uiv(this.addr,t)}function i8(i,t,e){const n=this.cache,r=t.length,s=Vy(e,r);is(n,s)||(i.uniform1iv(this.addr,s),rs(n,s));for(let o=0;o!==r;++o)e.setTexture2D(t[o]||iI,s[o])}function r8(i,t,e){const n=this.cache,r=t.length,s=Vy(e,r);is(n,s)||(i.uniform1iv(this.addr,s),rs(n,s));for(let o=0;o!==r;++o)e.setTexture3D(t[o]||sI,s[o])}function s8(i,t,e){const n=this.cache,r=t.length,s=Vy(e,r);is(n,s)||(i.uniform1iv(this.addr,s),rs(n,s));for(let o=0;o!==r;++o)e.setTextureCube(t[o]||oI,s[o])}function o8(i,t,e){const n=this.cache,r=t.length,s=Vy(e,r);is(n,s)||(i.uniform1iv(this.addr,s),rs(n,s));for(let o=0;o!==r;++o)e.setTexture2DArray(t[o]||rI,s[o])}function a8(i){switch(i){case 5126:return H6;case 35664:return $6;case 35665:return G6;case 35666:return q6;case 35674:return W6;case 35675:return j6;case 35676:return X6;case 5124:case 35670:return Y6;case 35667:case 35671:return K6;case 35668:case 35672:return Z6;case 35669:case 35673:return J6;case 5125:return Q6;case 36294:return t8;case 36295:return e8;case 36296:return n8;case 35678:case 36198:case 36298:case 36306:case 35682:return i8;case 35679:case 36299:case 36307:return r8;case 35680:case 36300:case 36308:case 36293:return s8;case 36289:case 36303:case 36311:case 36292:return o8}}class l8{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=B6(e.type)}}class c8{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=a8(e.type)}}class u8{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(t,e[a.id],n)}}}const nS=/(\w+)(\])?(\[|\.)?/g;function f2(i,t){i.seq.push(t),i.map[t.id]=t}function h8(i,t,e){const n=i.name,r=n.length;for(nS.lastIndex=0;;){const s=nS.exec(n),o=nS.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){f2(e,c===void 0?new l8(a,i,t):new c8(a,i,t));break}else{let h=e.map[a];h===void 0&&(h=new u8(a),f2(e,h)),e=h}}}class Db{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=t.getActiveUniform(e,r),o=t.getUniformLocation(e,s.name);h8(s,o,this)}}setValue(t,e,n,r){const s=this.map[e];s!==void 0&&s.setValue(t,n,r)}setOptional(t,e,n){const r=e[n];r!==void 0&&this.setValue(t,n,r)}static upload(t,e,n,r){for(let s=0,o=e.length;s!==o;++s){const a=e[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(t,l.value,r)}}static seqWithValue(t,e){const n=[];for(let r=0,s=t.length;r!==s;++r){const o=t[r];o.id in e&&n.push(o)}return n}}function m2(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}let d8=0;function p8(i,t){const e=i.split(`
`),n=[],r=Math.max(t-6,0),s=Math.min(t+6,e.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===t?">":" "} ${a}: ${e[o]}`)}return n.join(`
`)}function f8(i){switch(i){case bl:return["Linear","( value )"];case cn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),["Linear","( value )"]}}function g2(i,t,e){const n=i.getShaderParameter(t,i.COMPILE_STATUS),r=i.getShaderInfoLog(t).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return e.toUpperCase()+`

`+r+`

`+p8(i.getShaderSource(t),o)}else return r}function m8(i,t){const e=f8(t);return"vec4 "+i+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function g8(i,t){let e;switch(t){case xD:e="Linear";break;case wD:e="Reinhard";break;case SD:e="OptimizedCineon";break;case uE:e="ACESFilmic";break;case MD:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+i+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function v8(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.normalMapTangentSpace||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(pg).join(`
`)}function _8(i){const t=[];for(const e in i){const n=i[e];n!==!1&&t.push("#define "+e+" "+n)}return t.join(`
`)}function b8(i,t){const e={},n=i.getProgramParameter(t,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(t,r),o=s.name;let a=1;s.type===i.FLOAT_MAT2&&(a=2),s.type===i.FLOAT_MAT3&&(a=3),s.type===i.FLOAT_MAT4&&(a=4),e[o]={type:s.type,location:i.getAttribLocation(t,o),locationSize:a}}return e}function pg(i){return i!==""}function v2(i,t){const e=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,e).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function _2(i,t){return i.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const y8=/^[ \t]*#include +<([\w\d./]+)>/gm;function XM(i){return i.replace(y8,w8)}const x8=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function w8(i,t){let e=dn[t];if(e===void 0){const n=x8.get(t);if(n!==void 0)e=dn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,n);else throw new Error("Can not resolve #include <"+t+">")}return XM(e)}const S8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function b2(i){return i.replace(S8,M8)}function M8(i,t,e,n){let r="";for(let s=parseInt(t);s<parseInt(e);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function y2(i){let t="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?t+=`
#define HIGH_PRECISION`:i.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function C8(i){let t="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===JC?t="SHADOWMAP_TYPE_PCF":i.shadowMapType===Py?t="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Bl&&(t="SHADOWMAP_TYPE_VSM"),t}function E8(i){let t="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Zc:case th:t="ENVMAP_TYPE_CUBE";break;case zf:t="ENVMAP_TYPE_CUBE_UV";break}return t}function T8(i){let t="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case th:t="ENVMAP_MODE_REFRACTION";break}return t}function A8(i){let t="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case vv:t="ENVMAP_BLENDING_MULTIPLY";break;case bD:t="ENVMAP_BLENDING_MIX";break;case yD:t="ENVMAP_BLENDING_ADD";break}return t}function P8(i){const t=i.envMapCubeUVHeight;if(t===null)return null;const e=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:n,maxMip:e}}function R8(i,t,e,n){const r=i.getContext(),s=e.defines;let o=e.vertexShader,a=e.fragmentShader;const l=C8(e),c=E8(e),u=T8(e),h=A8(e),p=P8(e),m=e.isWebGL2?"":v8(e),v=_8(s),_=r.createProgram();let b,y,M=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(b=["#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,v].filter(pg).join(`
`),b.length>0&&(b+=`
`),y=[m,"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,v].filter(pg).join(`
`),y.length>0&&(y+=`
`)):(b=[y2(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,v,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+u:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",e.displacementMap?"#define USE_DISPLACEMENTMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",e.mapUv?"#define MAP_UV "+e.mapUv:"",e.alphaMapUv?"#define ALPHAMAP_UV "+e.alphaMapUv:"",e.lightMapUv?"#define LIGHTMAP_UV "+e.lightMapUv:"",e.aoMapUv?"#define AOMAP_UV "+e.aoMapUv:"",e.emissiveMapUv?"#define EMISSIVEMAP_UV "+e.emissiveMapUv:"",e.bumpMapUv?"#define BUMPMAP_UV "+e.bumpMapUv:"",e.normalMapUv?"#define NORMALMAP_UV "+e.normalMapUv:"",e.displacementMapUv?"#define DISPLACEMENTMAP_UV "+e.displacementMapUv:"",e.metalnessMapUv?"#define METALNESSMAP_UV "+e.metalnessMapUv:"",e.roughnessMapUv?"#define ROUGHNESSMAP_UV "+e.roughnessMapUv:"",e.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+e.anisotropyMapUv:"",e.clearcoatMapUv?"#define CLEARCOATMAP_UV "+e.clearcoatMapUv:"",e.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+e.clearcoatNormalMapUv:"",e.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+e.clearcoatRoughnessMapUv:"",e.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+e.iridescenceMapUv:"",e.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+e.iridescenceThicknessMapUv:"",e.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+e.sheenColorMapUv:"",e.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+e.sheenRoughnessMapUv:"",e.specularMapUv?"#define SPECULARMAP_UV "+e.specularMapUv:"",e.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+e.specularColorMapUv:"",e.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+e.specularIntensityMapUv:"",e.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+e.transmissionMapUv:"",e.thicknessMapUv?"#define THICKNESSMAP_UV "+e.thicknessMapUv:"",e.vertexTangents&&e.flatShading===!1?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.morphColors&&e.isWebGL2?"#define USE_MORPHCOLORS":"",e.morphTargetsCount>0&&e.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",e.morphTargetsCount>0&&e.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+e.morphTextureStride:"",e.morphTargetsCount>0&&e.isWebGL2?"#define MORPHTARGETS_COUNT "+e.morphTargetsCount:"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.useLegacyLights?"#define LEGACY_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(pg).join(`
`),y=[m,y2(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,v,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+c:"",e.envMap?"#define "+u:"",e.envMap?"#define "+h:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropy?"#define USE_ANISOTROPY":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoat?"#define USE_CLEARCOAT":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.iridescence?"#define USE_IRIDESCENCE":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaTest?"#define USE_ALPHATEST":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.sheen?"#define USE_SHEEN":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents&&e.flatShading===!1?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.useLegacyLights?"#define LEGACY_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==jc?"#define TONE_MAPPING":"",e.toneMapping!==jc?dn.tonemapping_pars_fragment:"",e.toneMapping!==jc?g8("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.opaque?"#define OPAQUE":"",dn.colorspace_pars_fragment,m8("linearToOutputTexel",e.outputColorSpace),e.useDepthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(pg).join(`
`)),o=XM(o),o=v2(o,e),o=_2(o,e),a=XM(a),a=v2(a,e),a=_2(a,e),o=b2(o),a=b2(a),e.isWebGL2&&e.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,y=["#define varying in",e.glslVersion===GM?"":"layout(location = 0) out highp vec4 pc_fragColor;",e.glslVersion===GM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const S=M+b+o,E=M+y+a,A=m2(r,r.VERTEX_SHADER,S),R=m2(r,r.FRAGMENT_SHADER,E);if(r.attachShader(_,A),r.attachShader(_,R),e.index0AttributeName!==void 0?r.bindAttribLocation(_,0,e.index0AttributeName):e.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),i.debug.checkShaderErrors){const P=r.getProgramInfoLog(_).trim(),D=r.getShaderInfoLog(A).trim(),V=r.getShaderInfoLog(R).trim();let K=!0,W=!0;if(r.getProgramParameter(_,r.LINK_STATUS)===!1)if(K=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,_,A,R);else{const Z=g2(r,A,"vertex"),z=g2(r,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+`

Program Info Log: `+P+`
`+Z+`
`+z)}else P!==""?console.warn("THREE.WebGLProgram: Program Info Log:",P):(D===""||V==="")&&(W=!1);W&&(this.diagnostics={runnable:K,programLog:P,vertexShader:{log:D,prefix:b},fragmentShader:{log:V,prefix:y}})}r.deleteShader(A),r.deleteShader(R);let O;this.getUniforms=function(){return O===void 0&&(O=new Db(r,_)),O};let L;return this.getAttributes=function(){return L===void 0&&(L=b8(r,_)),L},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=e.shaderType,this.name=e.shaderName,this.id=d8++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=A,this.fragmentShader=R,this}let k8=0;class L8{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(e),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return n===void 0&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return n===void 0&&(n=new O8(t),e.set(t,n)),n}}class O8{constructor(t){this.id=k8++,this.code=t,this.usedTimes=0}}function D8(i,t,e,n,r,s,o){const a=new Uy,l=new L8,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(P){return P===0?"uv":`uv${P}`}function b(P,D,V,K,W){const Z=K.fog,z=W.geometry,ut=P.isMeshStandardMaterial?K.environment:null,nt=(P.isMeshStandardMaterial?e:t).get(P.envMap||ut),Q=nt&&nt.mapping===zf?nt.image.height:null,St=v[P.type];P.precision!==null&&(m=r.getMaxPrecision(P.precision),m!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",m,"instead."));const Pt=z.morphAttributes.position||z.morphAttributes.normal||z.morphAttributes.color,dt=Pt!==void 0?Pt.length:0;let Rt=0;z.morphAttributes.position!==void 0&&(Rt=1),z.morphAttributes.normal!==void 0&&(Rt=2),z.morphAttributes.color!==void 0&&(Rt=3);let Jt,Bt,Wt,be;if(St){const mn=pl[St];Jt=mn.vertexShader,Bt=mn.fragmentShader}else Jt=P.vertexShader,Bt=P.fragmentShader,l.update(P),Wt=l.getVertexShaderID(P),be=l.getFragmentShaderID(P);const re=i.getRenderTarget(),It=W.isInstancedMesh===!0,ye=!!P.map,ce=!!P.matcap,ne=!!nt,Gt=!!P.aoMap,J=!!P.lightMap,$t=!!P.bumpMap,et=!!P.normalMap,ft=!!P.displacementMap,kt=!!P.emissiveMap,Qt=!!P.metalnessMap,qt=!!P.roughnessMap,ot=P.anisotropy>0,st=P.clearcoat>0,_t=P.iridescence>0,$=P.sheen>0,B=P.transmission>0,Lt=ot&&!!P.anisotropyMap,jt=st&&!!P.clearcoatMap,Kt=st&&!!P.clearcoatNormalMap,se=st&&!!P.clearcoatRoughnessMap,we=_t&&!!P.iridescenceMap,ht=_t&&!!P.iridescenceThicknessMap,mt=$&&!!P.sheenColorMap,tt=$&&!!P.sheenRoughnessMap,Ut=!!P.specularMap,oe=!!P.specularColorMap,ue=!!P.specularIntensityMap,ae=B&&!!P.transmissionMap,xe=B&&!!P.thicknessMap,Ze=!!P.gradientMap,pt=!!P.alphaMap,ee=P.alphaTest>0,Mt=!!P.alphaHash,ie=!!P.extensions,le=!!z.attributes.uv1,Xe=!!z.attributes.uv2,Rn=!!z.attributes.uv3;let Zn=jc;return P.toneMapped&&(re===null||re.isXRRenderTarget===!0)&&(Zn=i.toneMapping),{isWebGL2:u,shaderID:St,shaderType:P.type,shaderName:P.name,vertexShader:Jt,fragmentShader:Bt,defines:P.defines,customVertexShaderID:Wt,customFragmentShaderID:be,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:m,instancing:It,instancingColor:It&&W.instanceColor!==null,supportsVertexTextures:p,outputColorSpace:re===null?i.outputColorSpace:re.isXRRenderTarget===!0?re.texture.colorSpace:bl,map:ye,matcap:ce,envMap:ne,envMapMode:ne&&nt.mapping,envMapCubeUVHeight:Q,aoMap:Gt,lightMap:J,bumpMap:$t,normalMap:et,displacementMap:p&&ft,emissiveMap:kt,normalMapObjectSpace:et&&P.normalMapType===DD,normalMapTangentSpace:et&&P.normalMapType===mh,metalnessMap:Qt,roughnessMap:qt,anisotropy:ot,anisotropyMap:Lt,clearcoat:st,clearcoatMap:jt,clearcoatNormalMap:Kt,clearcoatRoughnessMap:se,iridescence:_t,iridescenceMap:we,iridescenceThicknessMap:ht,sheen:$,sheenColorMap:mt,sheenRoughnessMap:tt,specularMap:Ut,specularColorMap:oe,specularIntensityMap:ue,transmission:B,transmissionMap:ae,thicknessMap:xe,gradientMap:Ze,opaque:P.transparent===!1&&P.blending===Hu,alphaMap:pt,alphaTest:ee,alphaHash:Mt,combine:P.combine,mapUv:ye&&_(P.map.channel),aoMapUv:Gt&&_(P.aoMap.channel),lightMapUv:J&&_(P.lightMap.channel),bumpMapUv:$t&&_(P.bumpMap.channel),normalMapUv:et&&_(P.normalMap.channel),displacementMapUv:ft&&_(P.displacementMap.channel),emissiveMapUv:kt&&_(P.emissiveMap.channel),metalnessMapUv:Qt&&_(P.metalnessMap.channel),roughnessMapUv:qt&&_(P.roughnessMap.channel),anisotropyMapUv:Lt&&_(P.anisotropyMap.channel),clearcoatMapUv:jt&&_(P.clearcoatMap.channel),clearcoatNormalMapUv:Kt&&_(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:se&&_(P.clearcoatRoughnessMap.channel),iridescenceMapUv:we&&_(P.iridescenceMap.channel),iridescenceThicknessMapUv:ht&&_(P.iridescenceThicknessMap.channel),sheenColorMapUv:mt&&_(P.sheenColorMap.channel),sheenRoughnessMapUv:tt&&_(P.sheenRoughnessMap.channel),specularMapUv:Ut&&_(P.specularMap.channel),specularColorMapUv:oe&&_(P.specularColorMap.channel),specularIntensityMapUv:ue&&_(P.specularIntensityMap.channel),transmissionMapUv:ae&&_(P.transmissionMap.channel),thicknessMapUv:xe&&_(P.thicknessMap.channel),alphaMapUv:pt&&_(P.alphaMap.channel),vertexTangents:!!z.attributes.tangent&&(et||ot),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!z.attributes.color&&z.attributes.color.itemSize===4,vertexUv1s:le,vertexUv2s:Xe,vertexUv3s:Rn,pointsUvs:W.isPoints===!0&&!!z.attributes.uv&&(ye||pt),fog:!!Z,useFog:P.fog===!0,fogExp2:Z&&Z.isFogExp2,flatShading:P.flatShading===!0,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:W.isSkinnedMesh===!0,morphTargets:z.morphAttributes.position!==void 0,morphNormals:z.morphAttributes.normal!==void 0,morphColors:z.morphAttributes.color!==void 0,morphTargetsCount:dt,morphTextureStride:Rt,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numSpotLightMaps:D.spotLightMap.length,numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numSpotLightShadowsWithMaps:D.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:P.dithering,shadowMapEnabled:i.shadowMap.enabled&&V.length>0,shadowMapType:i.shadowMap.type,toneMapping:Zn,useLegacyLights:i._useLegacyLights,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===pr,flipSided:P.side===ao,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionDerivatives:ie&&P.extensions.derivatives===!0,extensionFragDepth:ie&&P.extensions.fragDepth===!0,extensionDrawBuffers:ie&&P.extensions.drawBuffers===!0,extensionShaderTextureLOD:ie&&P.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:P.customProgramCacheKey()}}function y(P){const D=[];if(P.shaderID?D.push(P.shaderID):(D.push(P.customVertexShaderID),D.push(P.customFragmentShaderID)),P.defines!==void 0)for(const V in P.defines)D.push(V),D.push(P.defines[V]);return P.isRawShaderMaterial===!1&&(M(D,P),S(D,P),D.push(i.outputColorSpace)),D.push(P.customProgramCacheKey),D.join()}function M(P,D){P.push(D.precision),P.push(D.outputColorSpace),P.push(D.envMapMode),P.push(D.envMapCubeUVHeight),P.push(D.mapUv),P.push(D.alphaMapUv),P.push(D.lightMapUv),P.push(D.aoMapUv),P.push(D.bumpMapUv),P.push(D.normalMapUv),P.push(D.displacementMapUv),P.push(D.emissiveMapUv),P.push(D.metalnessMapUv),P.push(D.roughnessMapUv),P.push(D.anisotropyMapUv),P.push(D.clearcoatMapUv),P.push(D.clearcoatNormalMapUv),P.push(D.clearcoatRoughnessMapUv),P.push(D.iridescenceMapUv),P.push(D.iridescenceThicknessMapUv),P.push(D.sheenColorMapUv),P.push(D.sheenRoughnessMapUv),P.push(D.specularMapUv),P.push(D.specularColorMapUv),P.push(D.specularIntensityMapUv),P.push(D.transmissionMapUv),P.push(D.thicknessMapUv),P.push(D.combine),P.push(D.fogExp2),P.push(D.sizeAttenuation),P.push(D.morphTargetsCount),P.push(D.morphAttributeCount),P.push(D.numDirLights),P.push(D.numPointLights),P.push(D.numSpotLights),P.push(D.numSpotLightMaps),P.push(D.numHemiLights),P.push(D.numRectAreaLights),P.push(D.numDirLightShadows),P.push(D.numPointLightShadows),P.push(D.numSpotLightShadows),P.push(D.numSpotLightShadowsWithMaps),P.push(D.shadowMapType),P.push(D.toneMapping),P.push(D.numClippingPlanes),P.push(D.numClipIntersection),P.push(D.depthPacking)}function S(P,D){a.disableAll(),D.isWebGL2&&a.enable(0),D.supportsVertexTextures&&a.enable(1),D.instancing&&a.enable(2),D.instancingColor&&a.enable(3),D.matcap&&a.enable(4),D.envMap&&a.enable(5),D.normalMapObjectSpace&&a.enable(6),D.normalMapTangentSpace&&a.enable(7),D.clearcoat&&a.enable(8),D.iridescence&&a.enable(9),D.alphaTest&&a.enable(10),D.vertexColors&&a.enable(11),D.vertexAlphas&&a.enable(12),D.vertexUv1s&&a.enable(13),D.vertexUv2s&&a.enable(14),D.vertexUv3s&&a.enable(15),D.vertexTangents&&a.enable(16),D.anisotropy&&a.enable(17),P.push(a.mask),a.disableAll(),D.fog&&a.enable(0),D.useFog&&a.enable(1),D.flatShading&&a.enable(2),D.logarithmicDepthBuffer&&a.enable(3),D.skinning&&a.enable(4),D.morphTargets&&a.enable(5),D.morphNormals&&a.enable(6),D.morphColors&&a.enable(7),D.premultipliedAlpha&&a.enable(8),D.shadowMapEnabled&&a.enable(9),D.useLegacyLights&&a.enable(10),D.doubleSided&&a.enable(11),D.flipSided&&a.enable(12),D.useDepthPacking&&a.enable(13),D.dithering&&a.enable(14),D.transmission&&a.enable(15),D.sheen&&a.enable(16),D.opaque&&a.enable(17),D.pointsUvs&&a.enable(18),P.push(a.mask)}function E(P){const D=v[P.type];let V;if(D){const K=pl[D];V=QD.clone(K.uniforms)}else V=P.uniforms;return V}function A(P,D){let V;for(let K=0,W=c.length;K<W;K++){const Z=c[K];if(Z.cacheKey===D){V=Z,++V.usedTimes;break}}return V===void 0&&(V=new R8(i,D,P,s),c.push(V)),V}function R(P){if(--P.usedTimes===0){const D=c.indexOf(P);c[D]=c[c.length-1],c.pop(),P.destroy()}}function O(P){l.remove(P)}function L(){l.dispose()}return{getParameters:b,getProgramCacheKey:y,getUniforms:E,acquireProgram:A,releaseProgram:R,releaseShaderCache:O,programs:c,dispose:L}}function I8(){let i=new WeakMap;function t(s){let o=i.get(s);return o===void 0&&(o={},i.set(s,o)),o}function e(s){i.delete(s)}function n(s,o,a){i.get(s)[o]=a}function r(){i=new WeakMap}return{get:t,remove:e,update:n,dispose:r}}function N8(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.material.id!==t.material.id?i.material.id-t.material.id:i.z!==t.z?i.z-t.z:i.id-t.id}function x2(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.z!==t.z?t.z-i.z:i.id-t.id}function w2(){const i=[];let t=0;const e=[],n=[],r=[];function s(){t=0,e.length=0,n.length=0,r.length=0}function o(h,p,m,v,_,b){let y=i[t];return y===void 0?(y={id:h.id,object:h,geometry:p,material:m,groupOrder:v,renderOrder:h.renderOrder,z:_,group:b},i[t]=y):(y.id=h.id,y.object=h,y.geometry=p,y.material=m,y.groupOrder=v,y.renderOrder=h.renderOrder,y.z=_,y.group=b),t++,y}function a(h,p,m,v,_,b){const y=o(h,p,m,v,_,b);m.transmission>0?n.push(y):m.transparent===!0?r.push(y):e.push(y)}function l(h,p,m,v,_,b){const y=o(h,p,m,v,_,b);m.transmission>0?n.unshift(y):m.transparent===!0?r.unshift(y):e.unshift(y)}function c(h,p){e.length>1&&e.sort(h||N8),n.length>1&&n.sort(p||x2),r.length>1&&r.sort(p||x2)}function u(){for(let h=t,p=i.length;h<p;h++){const m=i[h];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:e,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function z8(){let i=new WeakMap;function t(n,r){const s=i.get(n);let o;return s===void 0?(o=new w2,i.set(n,[o])):r>=s.length?(o=new w2,s.push(o)):o=s[r],o}function e(){i=new WeakMap}return{get:t,dispose:e}}function U8(){const i={};return{get:function(t){if(i[t.id]!==void 0)return i[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new Y,color:new me};break;case"SpotLight":e={position:new Y,direction:new Y,color:new me,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new Y,color:new me,distance:0,decay:0};break;case"HemisphereLight":e={direction:new Y,skyColor:new me,groundColor:new me};break;case"RectAreaLight":e={color:new me,position:new Y,halfWidth:new Y,halfHeight:new Y};break}return i[t.id]=e,e}}}function F8(){const i={};return{get:function(t){if(i[t.id]!==void 0)return i[t.id];let e;switch(t.type){case"DirectionalLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vt};break;case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vt};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vt,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[t.id]=e,e}}}let V8=0;function B8(i,t){return(t.castShadow?2:0)-(i.castShadow?2:0)+(t.map?1:0)-(i.map?1:0)}function H8(i,t){const e=new U8,n=F8(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new Y);const s=new Y,o=new rn,a=new rn;function l(u,h){let p=0,m=0,v=0;for(let V=0;V<9;V++)r.probe[V].set(0,0,0);let _=0,b=0,y=0,M=0,S=0,E=0,A=0,R=0,O=0,L=0;u.sort(B8);const P=h===!0?Math.PI:1;for(let V=0,K=u.length;V<K;V++){const W=u[V],Z=W.color,z=W.intensity,ut=W.distance,nt=W.shadow&&W.shadow.map?W.shadow.map.texture:null;if(W.isAmbientLight)p+=Z.r*z*P,m+=Z.g*z*P,v+=Z.b*z*P;else if(W.isLightProbe)for(let Q=0;Q<9;Q++)r.probe[Q].addScaledVector(W.sh.coefficients[Q],z);else if(W.isDirectionalLight){const Q=e.get(W);if(Q.color.copy(W.color).multiplyScalar(W.intensity*P),W.castShadow){const St=W.shadow,Pt=n.get(W);Pt.shadowBias=St.bias,Pt.shadowNormalBias=St.normalBias,Pt.shadowRadius=St.radius,Pt.shadowMapSize=St.mapSize,r.directionalShadow[_]=Pt,r.directionalShadowMap[_]=nt,r.directionalShadowMatrix[_]=W.shadow.matrix,E++}r.directional[_]=Q,_++}else if(W.isSpotLight){const Q=e.get(W);Q.position.setFromMatrixPosition(W.matrixWorld),Q.color.copy(Z).multiplyScalar(z*P),Q.distance=ut,Q.coneCos=Math.cos(W.angle),Q.penumbraCos=Math.cos(W.angle*(1-W.penumbra)),Q.decay=W.decay,r.spot[y]=Q;const St=W.shadow;if(W.map&&(r.spotLightMap[O]=W.map,O++,St.updateMatrices(W),W.castShadow&&L++),r.spotLightMatrix[y]=St.matrix,W.castShadow){const Pt=n.get(W);Pt.shadowBias=St.bias,Pt.shadowNormalBias=St.normalBias,Pt.shadowRadius=St.radius,Pt.shadowMapSize=St.mapSize,r.spotShadow[y]=Pt,r.spotShadowMap[y]=nt,R++}y++}else if(W.isRectAreaLight){const Q=e.get(W);Q.color.copy(Z).multiplyScalar(z),Q.halfWidth.set(W.width*.5,0,0),Q.halfHeight.set(0,W.height*.5,0),r.rectArea[M]=Q,M++}else if(W.isPointLight){const Q=e.get(W);if(Q.color.copy(W.color).multiplyScalar(W.intensity*P),Q.distance=W.distance,Q.decay=W.decay,W.castShadow){const St=W.shadow,Pt=n.get(W);Pt.shadowBias=St.bias,Pt.shadowNormalBias=St.normalBias,Pt.shadowRadius=St.radius,Pt.shadowMapSize=St.mapSize,Pt.shadowCameraNear=St.camera.near,Pt.shadowCameraFar=St.camera.far,r.pointShadow[b]=Pt,r.pointShadowMap[b]=nt,r.pointShadowMatrix[b]=W.shadow.matrix,A++}r.point[b]=Q,b++}else if(W.isHemisphereLight){const Q=e.get(W);Q.skyColor.copy(W.color).multiplyScalar(z*P),Q.groundColor.copy(W.groundColor).multiplyScalar(z*P),r.hemi[S]=Q,S++}}M>0&&(t.isWebGL2||i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=pe.LTC_FLOAT_1,r.rectAreaLTC2=pe.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=pe.LTC_HALF_1,r.rectAreaLTC2=pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=v;const D=r.hash;(D.directionalLength!==_||D.pointLength!==b||D.spotLength!==y||D.rectAreaLength!==M||D.hemiLength!==S||D.numDirectionalShadows!==E||D.numPointShadows!==A||D.numSpotShadows!==R||D.numSpotMaps!==O)&&(r.directional.length=_,r.spot.length=y,r.rectArea.length=M,r.point.length=b,r.hemi.length=S,r.directionalShadow.length=E,r.directionalShadowMap.length=E,r.pointShadow.length=A,r.pointShadowMap.length=A,r.spotShadow.length=R,r.spotShadowMap.length=R,r.directionalShadowMatrix.length=E,r.pointShadowMatrix.length=A,r.spotLightMatrix.length=R+O-L,r.spotLightMap.length=O,r.numSpotLightShadowsWithMaps=L,D.directionalLength=_,D.pointLength=b,D.spotLength=y,D.rectAreaLength=M,D.hemiLength=S,D.numDirectionalShadows=E,D.numPointShadows=A,D.numSpotShadows=R,D.numSpotMaps=O,r.version=V8++)}function c(u,h){let p=0,m=0,v=0,_=0,b=0;const y=h.matrixWorldInverse;for(let M=0,S=u.length;M<S;M++){const E=u[M];if(E.isDirectionalLight){const A=r.directional[p];A.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(y),p++}else if(E.isSpotLight){const A=r.spot[v];A.position.setFromMatrixPosition(E.matrixWorld),A.position.applyMatrix4(y),A.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(y),v++}else if(E.isRectAreaLight){const A=r.rectArea[_];A.position.setFromMatrixPosition(E.matrixWorld),A.position.applyMatrix4(y),a.identity(),o.copy(E.matrixWorld),o.premultiply(y),a.extractRotation(o),A.halfWidth.set(E.width*.5,0,0),A.halfHeight.set(0,E.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),_++}else if(E.isPointLight){const A=r.point[m];A.position.setFromMatrixPosition(E.matrixWorld),A.position.applyMatrix4(y),m++}else if(E.isHemisphereLight){const A=r.hemi[b];A.direction.setFromMatrixPosition(E.matrixWorld),A.direction.transformDirection(y),b++}}}return{setup:l,setupView:c,state:r}}function S2(i,t){const e=new H8(i,t),n=[],r=[];function s(){n.length=0,r.length=0}function o(h){n.push(h)}function a(h){r.push(h)}function l(h){e.setup(n,h)}function c(h){e.setupView(n,h)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:e},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function $8(i,t){let e=new WeakMap;function n(s,o=0){const a=e.get(s);let l;return a===void 0?(l=new S2(i,t),e.set(s,[l])):o>=a.length?(l=new S2(i,t),a.push(l)):l=a[o],l}function r(){e=new WeakMap}return{get:n,dispose:r}}class AE extends Hs{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=LD,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class PE extends Hs{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const G8=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,q8=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function W8(i,t,e){let n=new Fy;const r=new Vt,s=new Vt,o=new Vn,a=new AE({depthPacking:OD}),l=new PE,c={},u=e.maxTextureSize,h={[Kc]:ao,[ao]:Kc,[pr]:pr},p=new yl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vt},radius:{value:4}},vertexShader:G8,fragmentShader:q8}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const v=new fn;v.setAttribute("position",new tn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new fi(v,p),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=JC;let y=this.type;this.render=function(A,R,O){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||A.length===0)return;const L=i.getRenderTarget(),P=i.getActiveCubeFace(),D=i.getActiveMipmapLevel(),V=i.state;V.setBlending(Wc),V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);const K=y!==Bl&&this.type===Bl,W=y===Bl&&this.type!==Bl;for(let Z=0,z=A.length;Z<z;Z++){const ut=A[Z],nt=ut.shadow;if(nt===void 0){console.warn("THREE.WebGLShadowMap:",ut,"has no shadow.");continue}if(nt.autoUpdate===!1&&nt.needsUpdate===!1)continue;r.copy(nt.mapSize);const Q=nt.getFrameExtents();if(r.multiply(Q),s.copy(nt.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/Q.x),r.x=s.x*Q.x,nt.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/Q.y),r.y=s.y*Q.y,nt.mapSize.y=s.y)),nt.map===null||K===!0||W===!0){const Pt=this.type!==Bl?{minFilter:si,magFilter:si}:{};nt.map!==null&&nt.map.dispose(),nt.map=new ba(r.x,r.y,Pt),nt.map.texture.name=ut.name+".shadowMap",nt.camera.updateProjectionMatrix()}i.setRenderTarget(nt.map),i.clear();const St=nt.getViewportCount();for(let Pt=0;Pt<St;Pt++){const dt=nt.getViewport(Pt);o.set(s.x*dt.x,s.y*dt.y,s.x*dt.z,s.y*dt.w),V.viewport(o),nt.updateMatrices(ut,Pt),n=nt.getFrustum(),E(R,O,nt.camera,ut,this.type)}nt.isPointLightShadow!==!0&&this.type===Bl&&M(nt,O),nt.needsUpdate=!1}y=this.type,b.needsUpdate=!1,i.setRenderTarget(L,P,D)};function M(A,R){const O=t.update(_);p.defines.VSM_SAMPLES!==A.blurSamples&&(p.defines.VSM_SAMPLES=A.blurSamples,m.defines.VSM_SAMPLES=A.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new ba(r.x,r.y)),p.uniforms.shadow_pass.value=A.map.texture,p.uniforms.resolution.value=A.mapSize,p.uniforms.radius.value=A.radius,i.setRenderTarget(A.mapPass),i.clear(),i.renderBufferDirect(R,null,O,p,_,null),m.uniforms.shadow_pass.value=A.mapPass.texture,m.uniforms.resolution.value=A.mapSize,m.uniforms.radius.value=A.radius,i.setRenderTarget(A.map),i.clear(),i.renderBufferDirect(R,null,O,m,_,null)}function S(A,R,O,L){let P=null;const D=O.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(D!==void 0)P=D;else if(P=O.isPointLight===!0?l:a,i.localClippingEnabled&&R.clipShadows===!0&&Array.isArray(R.clippingPlanes)&&R.clippingPlanes.length!==0||R.displacementMap&&R.displacementScale!==0||R.alphaMap&&R.alphaTest>0||R.map&&R.alphaTest>0){const V=P.uuid,K=R.uuid;let W=c[V];W===void 0&&(W={},c[V]=W);let Z=W[K];Z===void 0&&(Z=P.clone(),W[K]=Z),P=Z}if(P.visible=R.visible,P.wireframe=R.wireframe,L===Bl?P.side=R.shadowSide!==null?R.shadowSide:R.side:P.side=R.shadowSide!==null?R.shadowSide:h[R.side],P.alphaMap=R.alphaMap,P.alphaTest=R.alphaTest,P.map=R.map,P.clipShadows=R.clipShadows,P.clippingPlanes=R.clippingPlanes,P.clipIntersection=R.clipIntersection,P.displacementMap=R.displacementMap,P.displacementScale=R.displacementScale,P.displacementBias=R.displacementBias,P.wireframeLinewidth=R.wireframeLinewidth,P.linewidth=R.linewidth,O.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const V=i.properties.get(P);V.light=O}return P}function E(A,R,O,L,P){if(A.visible===!1)return;if(A.layers.test(R.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&P===Bl)&&(!A.frustumCulled||n.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,A.matrixWorld);const K=t.update(A),W=A.material;if(Array.isArray(W)){const Z=K.groups;for(let z=0,ut=Z.length;z<ut;z++){const nt=Z[z],Q=W[nt.materialIndex];if(Q&&Q.visible){const St=S(A,Q,L,P);i.renderBufferDirect(O,null,K,St,A,nt)}}}else if(W.visible){const Z=S(A,W,L,P);i.renderBufferDirect(O,null,K,Z,A,null)}}const V=A.children;for(let K=0,W=V.length;K<W;K++)E(V[K],R,O,L,P)}}function j8(i,t,e){const n=e.isWebGL2;function r(){let pt=!1;const ee=new Vn;let Mt=null;const ie=new Vn(0,0,0,0);return{setMask:function(le){Mt!==le&&!pt&&(i.colorMask(le,le,le,le),Mt=le)},setLocked:function(le){pt=le},setClear:function(le,Xe,Rn,Zn,Wr){Wr===!0&&(le*=Zn,Xe*=Zn,Rn*=Zn),ee.set(le,Xe,Rn,Zn),ie.equals(ee)===!1&&(i.clearColor(le,Xe,Rn,Zn),ie.copy(ee))},reset:function(){pt=!1,Mt=null,ie.set(-1,0,0,0)}}}function s(){let pt=!1,ee=null,Mt=null,ie=null;return{setTest:function(le){le?re(i.DEPTH_TEST):It(i.DEPTH_TEST)},setMask:function(le){ee!==le&&!pt&&(i.depthMask(le),ee=le)},setFunc:function(le){if(Mt!==le){switch(le){case dD:i.depthFunc(i.NEVER);break;case pD:i.depthFunc(i.ALWAYS);break;case fD:i.depthFunc(i.LESS);break;case Xb:i.depthFunc(i.LEQUAL);break;case mD:i.depthFunc(i.EQUAL);break;case gD:i.depthFunc(i.GEQUAL);break;case vD:i.depthFunc(i.GREATER);break;case _D:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Mt=le}},setLocked:function(le){pt=le},setClear:function(le){ie!==le&&(i.clearDepth(le),ie=le)},reset:function(){pt=!1,ee=null,Mt=null,ie=null}}}function o(){let pt=!1,ee=null,Mt=null,ie=null,le=null,Xe=null,Rn=null,Zn=null,Wr=null;return{setTest:function(mn){pt||(mn?re(i.STENCIL_TEST):It(i.STENCIL_TEST))},setMask:function(mn){ee!==mn&&!pt&&(i.stencilMask(mn),ee=mn)},setFunc:function(mn,jr,Jn){(Mt!==mn||ie!==jr||le!==Jn)&&(i.stencilFunc(mn,jr,Jn),Mt=mn,ie=jr,le=Jn)},setOp:function(mn,jr,Jn){(Xe!==mn||Rn!==jr||Zn!==Jn)&&(i.stencilOp(mn,jr,Jn),Xe=mn,Rn=jr,Zn=Jn)},setLocked:function(mn){pt=mn},setClear:function(mn){Wr!==mn&&(i.clearStencil(mn),Wr=mn)},reset:function(){pt=!1,ee=null,Mt=null,ie=null,le=null,Xe=null,Rn=null,Zn=null,Wr=null}}}const a=new r,l=new s,c=new o,u=new WeakMap,h=new WeakMap;let p={},m={},v=new WeakMap,_=[],b=null,y=!1,M=null,S=null,E=null,A=null,R=null,O=null,L=null,P=!1,D=null,V=null,K=null,W=null,Z=null;const z=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ut=!1,nt=0;const Q=i.getParameter(i.VERSION);Q.indexOf("WebGL")!==-1?(nt=parseFloat(/^WebGL (\d)/.exec(Q)[1]),ut=nt>=1):Q.indexOf("OpenGL ES")!==-1&&(nt=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),ut=nt>=2);let St=null,Pt={};const dt=i.getParameter(i.SCISSOR_BOX),Rt=i.getParameter(i.VIEWPORT),Jt=new Vn().fromArray(dt),Bt=new Vn().fromArray(Rt);function Wt(pt,ee,Mt,ie){const le=new Uint8Array(4),Xe=i.createTexture();i.bindTexture(pt,Xe),i.texParameteri(pt,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(pt,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Rn=0;Rn<Mt;Rn++)n&&(pt===i.TEXTURE_3D||pt===i.TEXTURE_2D_ARRAY)?i.texImage3D(ee,0,i.RGBA,1,1,ie,0,i.RGBA,i.UNSIGNED_BYTE,le):i.texImage2D(ee+Rn,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,le);return Xe}const be={};be[i.TEXTURE_2D]=Wt(i.TEXTURE_2D,i.TEXTURE_2D,1),be[i.TEXTURE_CUBE_MAP]=Wt(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(be[i.TEXTURE_2D_ARRAY]=Wt(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),be[i.TEXTURE_3D]=Wt(i.TEXTURE_3D,i.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),re(i.DEPTH_TEST),l.setFunc(Xb),ft(!1),kt(mM),re(i.CULL_FACE),$t(Wc);function re(pt){p[pt]!==!0&&(i.enable(pt),p[pt]=!0)}function It(pt){p[pt]!==!1&&(i.disable(pt),p[pt]=!1)}function ye(pt,ee){return m[pt]!==ee?(i.bindFramebuffer(pt,ee),m[pt]=ee,n&&(pt===i.DRAW_FRAMEBUFFER&&(m[i.FRAMEBUFFER]=ee),pt===i.FRAMEBUFFER&&(m[i.DRAW_FRAMEBUFFER]=ee)),!0):!1}function ce(pt,ee){let Mt=_,ie=!1;if(pt)if(Mt=v.get(ee),Mt===void 0&&(Mt=[],v.set(ee,Mt)),pt.isWebGLMultipleRenderTargets){const le=pt.texture;if(Mt.length!==le.length||Mt[0]!==i.COLOR_ATTACHMENT0){for(let Xe=0,Rn=le.length;Xe<Rn;Xe++)Mt[Xe]=i.COLOR_ATTACHMENT0+Xe;Mt.length=le.length,ie=!0}}else Mt[0]!==i.COLOR_ATTACHMENT0&&(Mt[0]=i.COLOR_ATTACHMENT0,ie=!0);else Mt[0]!==i.BACK&&(Mt[0]=i.BACK,ie=!0);ie&&(e.isWebGL2?i.drawBuffers(Mt):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(Mt))}function ne(pt){return b!==pt?(i.useProgram(pt),b=pt,!0):!1}const Gt={[Nu]:i.FUNC_ADD,[QC]:i.FUNC_SUBTRACT,[tE]:i.FUNC_REVERSE_SUBTRACT};if(n)Gt[bM]=i.MIN,Gt[yM]=i.MAX;else{const pt=t.get("EXT_blend_minmax");pt!==null&&(Gt[bM]=pt.MIN_EXT,Gt[yM]=pt.MAX_EXT)}const J={[eE]:i.ZERO,[nE]:i.ONE,[iE]:i.SRC_COLOR,[Ry]:i.SRC_ALPHA,[cE]:i.SRC_ALPHA_SATURATE,[aE]:i.DST_COLOR,[sE]:i.DST_ALPHA,[rE]:i.ONE_MINUS_SRC_COLOR,[ky]:i.ONE_MINUS_SRC_ALPHA,[lE]:i.ONE_MINUS_DST_COLOR,[oE]:i.ONE_MINUS_DST_ALPHA};function $t(pt,ee,Mt,ie,le,Xe,Rn,Zn){if(pt===Wc){y===!0&&(It(i.BLEND),y=!1);return}if(y===!1&&(re(i.BLEND),y=!0),pt!==hD){if(pt!==M||Zn!==P){if((S!==Nu||R!==Nu)&&(i.blendEquation(i.FUNC_ADD),S=Nu,R=Nu),Zn)switch(pt){case Hu:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case gM:i.blendFunc(i.ONE,i.ONE);break;case vM:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case _M:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",pt);break}else switch(pt){case Hu:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case gM:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case vM:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case _M:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",pt);break}E=null,A=null,O=null,L=null,M=pt,P=Zn}return}le=le||ee,Xe=Xe||Mt,Rn=Rn||ie,(ee!==S||le!==R)&&(i.blendEquationSeparate(Gt[ee],Gt[le]),S=ee,R=le),(Mt!==E||ie!==A||Xe!==O||Rn!==L)&&(i.blendFuncSeparate(J[Mt],J[ie],J[Xe],J[Rn]),E=Mt,A=ie,O=Xe,L=Rn),M=pt,P=!1}function et(pt,ee){pt.side===pr?It(i.CULL_FACE):re(i.CULL_FACE);let Mt=pt.side===ao;ee&&(Mt=!Mt),ft(Mt),pt.blending===Hu&&pt.transparent===!1?$t(Wc):$t(pt.blending,pt.blendEquation,pt.blendSrc,pt.blendDst,pt.blendEquationAlpha,pt.blendSrcAlpha,pt.blendDstAlpha,pt.premultipliedAlpha),l.setFunc(pt.depthFunc),l.setTest(pt.depthTest),l.setMask(pt.depthWrite),a.setMask(pt.colorWrite);const ie=pt.stencilWrite;c.setTest(ie),ie&&(c.setMask(pt.stencilWriteMask),c.setFunc(pt.stencilFunc,pt.stencilRef,pt.stencilFuncMask),c.setOp(pt.stencilFail,pt.stencilZFail,pt.stencilZPass)),qt(pt.polygonOffset,pt.polygonOffsetFactor,pt.polygonOffsetUnits),pt.alphaToCoverage===!0?re(i.SAMPLE_ALPHA_TO_COVERAGE):It(i.SAMPLE_ALPHA_TO_COVERAGE)}function ft(pt){D!==pt&&(pt?i.frontFace(i.CW):i.frontFace(i.CCW),D=pt)}function kt(pt){pt!==cD?(re(i.CULL_FACE),pt!==V&&(pt===mM?i.cullFace(i.BACK):pt===uD?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):It(i.CULL_FACE),V=pt}function Qt(pt){pt!==K&&(ut&&i.lineWidth(pt),K=pt)}function qt(pt,ee,Mt){pt?(re(i.POLYGON_OFFSET_FILL),(W!==ee||Z!==Mt)&&(i.polygonOffset(ee,Mt),W=ee,Z=Mt)):It(i.POLYGON_OFFSET_FILL)}function ot(pt){pt?re(i.SCISSOR_TEST):It(i.SCISSOR_TEST)}function st(pt){pt===void 0&&(pt=i.TEXTURE0+z-1),St!==pt&&(i.activeTexture(pt),St=pt)}function _t(pt,ee,Mt){Mt===void 0&&(St===null?Mt=i.TEXTURE0+z-1:Mt=St);let ie=Pt[Mt];ie===void 0&&(ie={type:void 0,texture:void 0},Pt[Mt]=ie),(ie.type!==pt||ie.texture!==ee)&&(St!==Mt&&(i.activeTexture(Mt),St=Mt),i.bindTexture(pt,ee||be[pt]),ie.type=pt,ie.texture=ee)}function $(){const pt=Pt[St];pt!==void 0&&pt.type!==void 0&&(i.bindTexture(pt.type,null),pt.type=void 0,pt.texture=void 0)}function B(){try{i.compressedTexImage2D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function Lt(){try{i.compressedTexImage3D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function jt(){try{i.texSubImage2D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function Kt(){try{i.texSubImage3D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function se(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function we(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function ht(){try{i.texStorage2D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function mt(){try{i.texStorage3D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function tt(){try{i.texImage2D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function Ut(){try{i.texImage3D.apply(i,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}}function oe(pt){Jt.equals(pt)===!1&&(i.scissor(pt.x,pt.y,pt.z,pt.w),Jt.copy(pt))}function ue(pt){Bt.equals(pt)===!1&&(i.viewport(pt.x,pt.y,pt.z,pt.w),Bt.copy(pt))}function ae(pt,ee){let Mt=h.get(ee);Mt===void 0&&(Mt=new WeakMap,h.set(ee,Mt));let ie=Mt.get(pt);ie===void 0&&(ie=i.getUniformBlockIndex(ee,pt.name),Mt.set(pt,ie))}function xe(pt,ee){const ie=h.get(ee).get(pt);u.get(ee)!==ie&&(i.uniformBlockBinding(ee,ie,pt.__bindingPointIndex),u.set(ee,ie))}function Ze(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),n===!0&&(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),p={},St=null,Pt={},m={},v=new WeakMap,_=[],b=null,y=!1,M=null,S=null,E=null,A=null,R=null,O=null,L=null,P=!1,D=null,V=null,K=null,W=null,Z=null,Jt.set(0,0,i.canvas.width,i.canvas.height),Bt.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:re,disable:It,bindFramebuffer:ye,drawBuffers:ce,useProgram:ne,setBlending:$t,setMaterial:et,setFlipSided:ft,setCullFace:kt,setLineWidth:Qt,setPolygonOffset:qt,setScissorTest:ot,activeTexture:st,bindTexture:_t,unbindTexture:$,compressedTexImage2D:B,compressedTexImage3D:Lt,texImage2D:tt,texImage3D:Ut,updateUBOMapping:ae,uniformBlockBinding:xe,texStorage2D:ht,texStorage3D:mt,texSubImage2D:jt,texSubImage3D:Kt,compressedTexSubImage2D:se,compressedTexSubImage3D:we,scissor:oe,viewport:ue,reset:Ze}}function X8(i,t,e,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,p=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),v=new WeakMap;let _;const b=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M($,B){return y?new OffscreenCanvas($,B):Hg("canvas")}function S($,B,Lt,jt){let Kt=1;if(($.width>jt||$.height>jt)&&(Kt=jt/Math.max($.width,$.height)),Kt<1||B===!0)if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap){const se=B?Zb:Math.floor,we=se(Kt*$.width),ht=se(Kt*$.height);_===void 0&&(_=M(we,ht));const mt=Lt?M(we,ht):_;return mt.width=we,mt.height=ht,mt.getContext("2d").drawImage($,0,0,we,ht),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$.width+"x"+$.height+") to ("+we+"x"+ht+")."),mt}else return"data"in $&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$.width+"x"+$.height+")."),$;return $}function E($){return qM($.width)&&qM($.height)}function A($){return a?!1:$.wrapS!==es||$.wrapT!==es||$.minFilter!==si&&$.minFilter!==Ji}function R($,B){return $.generateMipmaps&&B&&$.minFilter!==si&&$.minFilter!==Ji}function O($){i.generateMipmap($)}function L($,B,Lt,jt,Kt=!1){if(a===!1)return B;if($!==null){if(i[$]!==void 0)return i[$];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$+"'")}let se=B;return B===i.RED&&(Lt===i.FLOAT&&(se=i.R32F),Lt===i.HALF_FLOAT&&(se=i.R16F),Lt===i.UNSIGNED_BYTE&&(se=i.R8)),B===i.RG&&(Lt===i.FLOAT&&(se=i.RG32F),Lt===i.HALF_FLOAT&&(se=i.RG16F),Lt===i.UNSIGNED_BYTE&&(se=i.RG8)),B===i.RGBA&&(Lt===i.FLOAT&&(se=i.RGBA32F),Lt===i.HALF_FLOAT&&(se=i.RGBA16F),Lt===i.UNSIGNED_BYTE&&(se=jt===cn&&Kt===!1?i.SRGB8_ALPHA8:i.RGBA8),Lt===i.UNSIGNED_SHORT_4_4_4_4&&(se=i.RGBA4),Lt===i.UNSIGNED_SHORT_5_5_5_1&&(se=i.RGB5_A1)),(se===i.R16F||se===i.R32F||se===i.RG16F||se===i.RG32F||se===i.RGBA16F||se===i.RGBA32F)&&t.get("EXT_color_buffer_float"),se}function P($,B,Lt){return R($,Lt)===!0||$.isFramebufferTexture&&$.minFilter!==si&&$.minFilter!==Ji?Math.log2(Math.max(B.width,B.height))+1:$.mipmaps!==void 0&&$.mipmaps.length>0?$.mipmaps.length:$.isCompressedTexture&&Array.isArray($.image)?B.mipmaps.length:1}function D($){return $===si||$===Yb||$===Sg?i.NEAREST:i.LINEAR}function V($){const B=$.target;B.removeEventListener("dispose",V),W(B),B.isVideoTexture&&v.delete(B)}function K($){const B=$.target;B.removeEventListener("dispose",K),z(B)}function W($){const B=n.get($);if(B.__webglInit===void 0)return;const Lt=$.source,jt=b.get(Lt);if(jt){const Kt=jt[B.__cacheKey];Kt.usedTimes--,Kt.usedTimes===0&&Z($),Object.keys(jt).length===0&&b.delete(Lt)}n.remove($)}function Z($){const B=n.get($);i.deleteTexture(B.__webglTexture);const Lt=$.source,jt=b.get(Lt);delete jt[B.__cacheKey],o.memory.textures--}function z($){const B=$.texture,Lt=n.get($),jt=n.get(B);if(jt.__webglTexture!==void 0&&(i.deleteTexture(jt.__webglTexture),o.memory.textures--),$.depthTexture&&$.depthTexture.dispose(),$.isWebGLCubeRenderTarget)for(let Kt=0;Kt<6;Kt++)i.deleteFramebuffer(Lt.__webglFramebuffer[Kt]),Lt.__webglDepthbuffer&&i.deleteRenderbuffer(Lt.__webglDepthbuffer[Kt]);else{if(i.deleteFramebuffer(Lt.__webglFramebuffer),Lt.__webglDepthbuffer&&i.deleteRenderbuffer(Lt.__webglDepthbuffer),Lt.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Lt.__webglMultisampledFramebuffer),Lt.__webglColorRenderbuffer)for(let Kt=0;Kt<Lt.__webglColorRenderbuffer.length;Kt++)Lt.__webglColorRenderbuffer[Kt]&&i.deleteRenderbuffer(Lt.__webglColorRenderbuffer[Kt]);Lt.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Lt.__webglDepthRenderbuffer)}if($.isWebGLMultipleRenderTargets)for(let Kt=0,se=B.length;Kt<se;Kt++){const we=n.get(B[Kt]);we.__webglTexture&&(i.deleteTexture(we.__webglTexture),o.memory.textures--),n.remove(B[Kt])}n.remove(B),n.remove($)}let ut=0;function nt(){ut=0}function Q(){const $=ut;return $>=l&&console.warn("THREE.WebGLTextures: Trying to use "+$+" texture units while this GPU supports only "+l),ut+=1,$}function St($){const B=[];return B.push($.wrapS),B.push($.wrapT),B.push($.wrapR||0),B.push($.magFilter),B.push($.minFilter),B.push($.anisotropy),B.push($.internalFormat),B.push($.format),B.push($.type),B.push($.generateMipmaps),B.push($.premultiplyAlpha),B.push($.flipY),B.push($.unpackAlignment),B.push($.colorSpace),B.join()}function Pt($,B){const Lt=n.get($);if($.isVideoTexture&&st($),$.isRenderTargetTexture===!1&&$.version>0&&Lt.__version!==$.version){const jt=$.image;if(jt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(jt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ye(Lt,$,B);return}}e.bindTexture(i.TEXTURE_2D,Lt.__webglTexture,i.TEXTURE0+B)}function dt($,B){const Lt=n.get($);if($.version>0&&Lt.__version!==$.version){ye(Lt,$,B);return}e.bindTexture(i.TEXTURE_2D_ARRAY,Lt.__webglTexture,i.TEXTURE0+B)}function Rt($,B){const Lt=n.get($);if($.version>0&&Lt.__version!==$.version){ye(Lt,$,B);return}e.bindTexture(i.TEXTURE_3D,Lt.__webglTexture,i.TEXTURE0+B)}function Jt($,B){const Lt=n.get($);if($.version>0&&Lt.__version!==$.version){ce(Lt,$,B);return}e.bindTexture(i.TEXTURE_CUBE_MAP,Lt.__webglTexture,i.TEXTURE0+B)}const Bt={[ff]:i.REPEAT,[es]:i.CLAMP_TO_EDGE,[mf]:i.MIRRORED_REPEAT},Wt={[si]:i.NEAREST,[Yb]:i.NEAREST_MIPMAP_NEAREST,[Sg]:i.NEAREST_MIPMAP_LINEAR,[Ji]:i.LINEAR,[pE]:i.LINEAR_MIPMAP_NEAREST,[eh]:i.LINEAR_MIPMAP_LINEAR},be={[ND]:i.NEVER,[$D]:i.ALWAYS,[zD]:i.LESS,[FD]:i.LEQUAL,[UD]:i.EQUAL,[HD]:i.GEQUAL,[VD]:i.GREATER,[BD]:i.NOTEQUAL};function re($,B,Lt){if(Lt?(i.texParameteri($,i.TEXTURE_WRAP_S,Bt[B.wrapS]),i.texParameteri($,i.TEXTURE_WRAP_T,Bt[B.wrapT]),($===i.TEXTURE_3D||$===i.TEXTURE_2D_ARRAY)&&i.texParameteri($,i.TEXTURE_WRAP_R,Bt[B.wrapR]),i.texParameteri($,i.TEXTURE_MAG_FILTER,Wt[B.magFilter]),i.texParameteri($,i.TEXTURE_MIN_FILTER,Wt[B.minFilter])):(i.texParameteri($,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri($,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),($===i.TEXTURE_3D||$===i.TEXTURE_2D_ARRAY)&&i.texParameteri($,i.TEXTURE_WRAP_R,i.CLAMP_TO_EDGE),(B.wrapS!==es||B.wrapT!==es)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri($,i.TEXTURE_MAG_FILTER,D(B.magFilter)),i.texParameteri($,i.TEXTURE_MIN_FILTER,D(B.minFilter)),B.minFilter!==si&&B.minFilter!==Ji&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),B.compareFunction&&(i.texParameteri($,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri($,i.TEXTURE_COMPARE_FUNC,be[B.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){const jt=t.get("EXT_texture_filter_anisotropic");if(B.magFilter===si||B.minFilter!==Sg&&B.minFilter!==eh||B.type===Hr&&t.has("OES_texture_float_linear")===!1||a===!1&&B.type===gf&&t.has("OES_texture_half_float_linear")===!1)return;(B.anisotropy>1||n.get(B).__currentAnisotropy)&&(i.texParameterf($,jt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(B.anisotropy,r.getMaxAnisotropy())),n.get(B).__currentAnisotropy=B.anisotropy)}}function It($,B){let Lt=!1;$.__webglInit===void 0&&($.__webglInit=!0,B.addEventListener("dispose",V));const jt=B.source;let Kt=b.get(jt);Kt===void 0&&(Kt={},b.set(jt,Kt));const se=St(B);if(se!==$.__cacheKey){Kt[se]===void 0&&(Kt[se]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,Lt=!0),Kt[se].usedTimes++;const we=Kt[$.__cacheKey];we!==void 0&&(Kt[$.__cacheKey].usedTimes--,we.usedTimes===0&&Z(B)),$.__cacheKey=se,$.__webglTexture=Kt[se].texture}return Lt}function ye($,B,Lt){let jt=i.TEXTURE_2D;(B.isDataArrayTexture||B.isCompressedArrayTexture)&&(jt=i.TEXTURE_2D_ARRAY),B.isData3DTexture&&(jt=i.TEXTURE_3D);const Kt=It($,B),se=B.source;e.bindTexture(jt,$.__webglTexture,i.TEXTURE0+Lt);const we=n.get(se);if(se.version!==we.__version||Kt===!0){e.activeTexture(i.TEXTURE0+Lt),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,B.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,B.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);const ht=A(B)&&E(B.image)===!1;let mt=S(B.image,ht,!1,u);mt=_t(B,mt);const tt=E(mt)||a,Ut=s.convert(B.format,B.colorSpace);let oe=s.convert(B.type),ue=L(B.internalFormat,Ut,oe,B.colorSpace);re(jt,B,tt);let ae;const xe=B.mipmaps,Ze=a&&B.isVideoTexture!==!0,pt=we.__version===void 0||Kt===!0,ee=P(B,mt,tt);if(B.isDepthTexture)ue=i.DEPTH_COMPONENT,a?B.type===Hr?ue=i.DEPTH_COMPONENT32F:B.type===Fa?ue=i.DEPTH_COMPONENT24:B.type===$u?ue=i.DEPTH24_STENCIL8:ue=i.DEPTH_COMPONENT16:B.type===Hr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),B.format===Gu&&ue===i.DEPTH_COMPONENT&&B.type!==Ud&&B.type!==Fa&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),B.type=Fa,oe=s.convert(B.type)),B.format===Td&&ue===i.DEPTH_COMPONENT&&(ue=i.DEPTH_STENCIL,B.type!==$u&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),B.type=$u,oe=s.convert(B.type))),pt&&(Ze?e.texStorage2D(i.TEXTURE_2D,1,ue,mt.width,mt.height):e.texImage2D(i.TEXTURE_2D,0,ue,mt.width,mt.height,0,Ut,oe,null));else if(B.isDataTexture)if(xe.length>0&&tt){Ze&&pt&&e.texStorage2D(i.TEXTURE_2D,ee,ue,xe[0].width,xe[0].height);for(let Mt=0,ie=xe.length;Mt<ie;Mt++)ae=xe[Mt],Ze?e.texSubImage2D(i.TEXTURE_2D,Mt,0,0,ae.width,ae.height,Ut,oe,ae.data):e.texImage2D(i.TEXTURE_2D,Mt,ue,ae.width,ae.height,0,Ut,oe,ae.data);B.generateMipmaps=!1}else Ze?(pt&&e.texStorage2D(i.TEXTURE_2D,ee,ue,mt.width,mt.height),e.texSubImage2D(i.TEXTURE_2D,0,0,0,mt.width,mt.height,Ut,oe,mt.data)):e.texImage2D(i.TEXTURE_2D,0,ue,mt.width,mt.height,0,Ut,oe,mt.data);else if(B.isCompressedTexture)if(B.isCompressedArrayTexture){Ze&&pt&&e.texStorage3D(i.TEXTURE_2D_ARRAY,ee,ue,xe[0].width,xe[0].height,mt.depth);for(let Mt=0,ie=xe.length;Mt<ie;Mt++)ae=xe[Mt],B.format!==Es?Ut!==null?Ze?e.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Mt,0,0,0,ae.width,ae.height,mt.depth,Ut,ae.data,0,0):e.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Mt,ue,ae.width,ae.height,mt.depth,0,ae.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ze?e.texSubImage3D(i.TEXTURE_2D_ARRAY,Mt,0,0,0,ae.width,ae.height,mt.depth,Ut,oe,ae.data):e.texImage3D(i.TEXTURE_2D_ARRAY,Mt,ue,ae.width,ae.height,mt.depth,0,Ut,oe,ae.data)}else{Ze&&pt&&e.texStorage2D(i.TEXTURE_2D,ee,ue,xe[0].width,xe[0].height);for(let Mt=0,ie=xe.length;Mt<ie;Mt++)ae=xe[Mt],B.format!==Es?Ut!==null?Ze?e.compressedTexSubImage2D(i.TEXTURE_2D,Mt,0,0,ae.width,ae.height,Ut,ae.data):e.compressedTexImage2D(i.TEXTURE_2D,Mt,ue,ae.width,ae.height,0,ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ze?e.texSubImage2D(i.TEXTURE_2D,Mt,0,0,ae.width,ae.height,Ut,oe,ae.data):e.texImage2D(i.TEXTURE_2D,Mt,ue,ae.width,ae.height,0,Ut,oe,ae.data)}else if(B.isDataArrayTexture)Ze?(pt&&e.texStorage3D(i.TEXTURE_2D_ARRAY,ee,ue,mt.width,mt.height,mt.depth),e.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,mt.width,mt.height,mt.depth,Ut,oe,mt.data)):e.texImage3D(i.TEXTURE_2D_ARRAY,0,ue,mt.width,mt.height,mt.depth,0,Ut,oe,mt.data);else if(B.isData3DTexture)Ze?(pt&&e.texStorage3D(i.TEXTURE_3D,ee,ue,mt.width,mt.height,mt.depth),e.texSubImage3D(i.TEXTURE_3D,0,0,0,0,mt.width,mt.height,mt.depth,Ut,oe,mt.data)):e.texImage3D(i.TEXTURE_3D,0,ue,mt.width,mt.height,mt.depth,0,Ut,oe,mt.data);else if(B.isFramebufferTexture){if(pt)if(Ze)e.texStorage2D(i.TEXTURE_2D,ee,ue,mt.width,mt.height);else{let Mt=mt.width,ie=mt.height;for(let le=0;le<ee;le++)e.texImage2D(i.TEXTURE_2D,le,ue,Mt,ie,0,Ut,oe,null),Mt>>=1,ie>>=1}}else if(xe.length>0&&tt){Ze&&pt&&e.texStorage2D(i.TEXTURE_2D,ee,ue,xe[0].width,xe[0].height);for(let Mt=0,ie=xe.length;Mt<ie;Mt++)ae=xe[Mt],Ze?e.texSubImage2D(i.TEXTURE_2D,Mt,0,0,Ut,oe,ae):e.texImage2D(i.TEXTURE_2D,Mt,ue,Ut,oe,ae);B.generateMipmaps=!1}else Ze?(pt&&e.texStorage2D(i.TEXTURE_2D,ee,ue,mt.width,mt.height),e.texSubImage2D(i.TEXTURE_2D,0,0,0,Ut,oe,mt)):e.texImage2D(i.TEXTURE_2D,0,ue,Ut,oe,mt);R(B,tt)&&O(jt),we.__version=se.version,B.onUpdate&&B.onUpdate(B)}$.__version=B.version}function ce($,B,Lt){if(B.image.length!==6)return;const jt=It($,B),Kt=B.source;e.bindTexture(i.TEXTURE_CUBE_MAP,$.__webglTexture,i.TEXTURE0+Lt);const se=n.get(Kt);if(Kt.version!==se.__version||jt===!0){e.activeTexture(i.TEXTURE0+Lt),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,B.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,B.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);const we=B.isCompressedTexture||B.image[0].isCompressedTexture,ht=B.image[0]&&B.image[0].isDataTexture,mt=[];for(let Mt=0;Mt<6;Mt++)!we&&!ht?mt[Mt]=S(B.image[Mt],!1,!0,c):mt[Mt]=ht?B.image[Mt].image:B.image[Mt],mt[Mt]=_t(B,mt[Mt]);const tt=mt[0],Ut=E(tt)||a,oe=s.convert(B.format,B.colorSpace),ue=s.convert(B.type),ae=L(B.internalFormat,oe,ue,B.colorSpace),xe=a&&B.isVideoTexture!==!0,Ze=se.__version===void 0||jt===!0;let pt=P(B,tt,Ut);re(i.TEXTURE_CUBE_MAP,B,Ut);let ee;if(we){xe&&Ze&&e.texStorage2D(i.TEXTURE_CUBE_MAP,pt,ae,tt.width,tt.height);for(let Mt=0;Mt<6;Mt++){ee=mt[Mt].mipmaps;for(let ie=0;ie<ee.length;ie++){const le=ee[ie];B.format!==Es?oe!==null?xe?e.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie,0,0,le.width,le.height,oe,le.data):e.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie,ae,le.width,le.height,0,le.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):xe?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie,0,0,le.width,le.height,oe,ue,le.data):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie,ae,le.width,le.height,0,oe,ue,le.data)}}}else{ee=B.mipmaps,xe&&Ze&&(ee.length>0&&pt++,e.texStorage2D(i.TEXTURE_CUBE_MAP,pt,ae,mt[0].width,mt[0].height));for(let Mt=0;Mt<6;Mt++)if(ht){xe?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,0,0,0,mt[Mt].width,mt[Mt].height,oe,ue,mt[Mt].data):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,0,ae,mt[Mt].width,mt[Mt].height,0,oe,ue,mt[Mt].data);for(let ie=0;ie<ee.length;ie++){const Xe=ee[ie].image[Mt].image;xe?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie+1,0,0,Xe.width,Xe.height,oe,ue,Xe.data):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie+1,ae,Xe.width,Xe.height,0,oe,ue,Xe.data)}}else{xe?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,0,0,0,oe,ue,mt[Mt]):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,0,ae,oe,ue,mt[Mt]);for(let ie=0;ie<ee.length;ie++){const le=ee[ie];xe?e.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie+1,0,0,oe,ue,le.image[Mt]):e.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,ie+1,ae,oe,ue,le.image[Mt])}}}R(B,Ut)&&O(i.TEXTURE_CUBE_MAP),se.__version=Kt.version,B.onUpdate&&B.onUpdate(B)}$.__version=B.version}function ne($,B,Lt,jt,Kt){const se=s.convert(Lt.format,Lt.colorSpace),we=s.convert(Lt.type),ht=L(Lt.internalFormat,se,we,Lt.colorSpace);n.get(B).__hasExternalTextures||(Kt===i.TEXTURE_3D||Kt===i.TEXTURE_2D_ARRAY?e.texImage3D(Kt,0,ht,B.width,B.height,B.depth,0,se,we,null):e.texImage2D(Kt,0,ht,B.width,B.height,0,se,we,null)),e.bindFramebuffer(i.FRAMEBUFFER,$),ot(B)?p.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,jt,Kt,n.get(Lt).__webglTexture,0,qt(B)):(Kt===i.TEXTURE_2D||Kt>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Kt<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,jt,Kt,n.get(Lt).__webglTexture,0),e.bindFramebuffer(i.FRAMEBUFFER,null)}function Gt($,B,Lt){if(i.bindRenderbuffer(i.RENDERBUFFER,$),B.depthBuffer&&!B.stencilBuffer){let jt=i.DEPTH_COMPONENT16;if(Lt||ot(B)){const Kt=B.depthTexture;Kt&&Kt.isDepthTexture&&(Kt.type===Hr?jt=i.DEPTH_COMPONENT32F:Kt.type===Fa&&(jt=i.DEPTH_COMPONENT24));const se=qt(B);ot(B)?p.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,se,jt,B.width,B.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,se,jt,B.width,B.height)}else i.renderbufferStorage(i.RENDERBUFFER,jt,B.width,B.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,$)}else if(B.depthBuffer&&B.stencilBuffer){const jt=qt(B);Lt&&ot(B)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,jt,i.DEPTH24_STENCIL8,B.width,B.height):ot(B)?p.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,jt,i.DEPTH24_STENCIL8,B.width,B.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,B.width,B.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,$)}else{const jt=B.isWebGLMultipleRenderTargets===!0?B.texture:[B.texture];for(let Kt=0;Kt<jt.length;Kt++){const se=jt[Kt],we=s.convert(se.format,se.colorSpace),ht=s.convert(se.type),mt=L(se.internalFormat,we,ht,se.colorSpace),tt=qt(B);Lt&&ot(B)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,tt,mt,B.width,B.height):ot(B)?p.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,tt,mt,B.width,B.height):i.renderbufferStorage(i.RENDERBUFFER,mt,B.width,B.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function J($,B){if(B&&B.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(i.FRAMEBUFFER,$),!(B.depthTexture&&B.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(B.depthTexture).__webglTexture||B.depthTexture.image.width!==B.width||B.depthTexture.image.height!==B.height)&&(B.depthTexture.image.width=B.width,B.depthTexture.image.height=B.height,B.depthTexture.needsUpdate=!0),Pt(B.depthTexture,0);const jt=n.get(B.depthTexture).__webglTexture,Kt=qt(B);if(B.depthTexture.format===Gu)ot(B)?p.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,jt,0,Kt):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,jt,0);else if(B.depthTexture.format===Td)ot(B)?p.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,jt,0,Kt):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,jt,0);else throw new Error("Unknown depthTexture format")}function $t($){const B=n.get($),Lt=$.isWebGLCubeRenderTarget===!0;if($.depthTexture&&!B.__autoAllocateDepthBuffer){if(Lt)throw new Error("target.depthTexture not supported in Cube render targets");J(B.__webglFramebuffer,$)}else if(Lt){B.__webglDepthbuffer=[];for(let jt=0;jt<6;jt++)e.bindFramebuffer(i.FRAMEBUFFER,B.__webglFramebuffer[jt]),B.__webglDepthbuffer[jt]=i.createRenderbuffer(),Gt(B.__webglDepthbuffer[jt],$,!1)}else e.bindFramebuffer(i.FRAMEBUFFER,B.__webglFramebuffer),B.__webglDepthbuffer=i.createRenderbuffer(),Gt(B.__webglDepthbuffer,$,!1);e.bindFramebuffer(i.FRAMEBUFFER,null)}function et($,B,Lt){const jt=n.get($);B!==void 0&&ne(jt.__webglFramebuffer,$,$.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D),Lt!==void 0&&$t($)}function ft($){const B=$.texture,Lt=n.get($),jt=n.get(B);$.addEventListener("dispose",K),$.isWebGLMultipleRenderTargets!==!0&&(jt.__webglTexture===void 0&&(jt.__webglTexture=i.createTexture()),jt.__version=B.version,o.memory.textures++);const Kt=$.isWebGLCubeRenderTarget===!0,se=$.isWebGLMultipleRenderTargets===!0,we=E($)||a;if(Kt){Lt.__webglFramebuffer=[];for(let ht=0;ht<6;ht++)Lt.__webglFramebuffer[ht]=i.createFramebuffer()}else{if(Lt.__webglFramebuffer=i.createFramebuffer(),se)if(r.drawBuffers){const ht=$.texture;for(let mt=0,tt=ht.length;mt<tt;mt++){const Ut=n.get(ht[mt]);Ut.__webglTexture===void 0&&(Ut.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&$.samples>0&&ot($)===!1){const ht=se?B:[B];Lt.__webglMultisampledFramebuffer=i.createFramebuffer(),Lt.__webglColorRenderbuffer=[],e.bindFramebuffer(i.FRAMEBUFFER,Lt.__webglMultisampledFramebuffer);for(let mt=0;mt<ht.length;mt++){const tt=ht[mt];Lt.__webglColorRenderbuffer[mt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Lt.__webglColorRenderbuffer[mt]);const Ut=s.convert(tt.format,tt.colorSpace),oe=s.convert(tt.type),ue=L(tt.internalFormat,Ut,oe,tt.colorSpace,$.isXRRenderTarget===!0),ae=qt($);i.renderbufferStorageMultisample(i.RENDERBUFFER,ae,ue,$.width,$.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+mt,i.RENDERBUFFER,Lt.__webglColorRenderbuffer[mt])}i.bindRenderbuffer(i.RENDERBUFFER,null),$.depthBuffer&&(Lt.__webglDepthRenderbuffer=i.createRenderbuffer(),Gt(Lt.__webglDepthRenderbuffer,$,!0)),e.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Kt){e.bindTexture(i.TEXTURE_CUBE_MAP,jt.__webglTexture),re(i.TEXTURE_CUBE_MAP,B,we);for(let ht=0;ht<6;ht++)ne(Lt.__webglFramebuffer[ht],$,B,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ht);R(B,we)&&O(i.TEXTURE_CUBE_MAP),e.unbindTexture()}else if(se){const ht=$.texture;for(let mt=0,tt=ht.length;mt<tt;mt++){const Ut=ht[mt],oe=n.get(Ut);e.bindTexture(i.TEXTURE_2D,oe.__webglTexture),re(i.TEXTURE_2D,Ut,we),ne(Lt.__webglFramebuffer,$,Ut,i.COLOR_ATTACHMENT0+mt,i.TEXTURE_2D),R(Ut,we)&&O(i.TEXTURE_2D)}e.unbindTexture()}else{let ht=i.TEXTURE_2D;($.isWebGL3DRenderTarget||$.isWebGLArrayRenderTarget)&&(a?ht=$.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),e.bindTexture(ht,jt.__webglTexture),re(ht,B,we),ne(Lt.__webglFramebuffer,$,B,i.COLOR_ATTACHMENT0,ht),R(B,we)&&O(ht),e.unbindTexture()}$.depthBuffer&&$t($)}function kt($){const B=E($)||a,Lt=$.isWebGLMultipleRenderTargets===!0?$.texture:[$.texture];for(let jt=0,Kt=Lt.length;jt<Kt;jt++){const se=Lt[jt];if(R(se,B)){const we=$.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,ht=n.get(se).__webglTexture;e.bindTexture(we,ht),O(we),e.unbindTexture()}}}function Qt($){if(a&&$.samples>0&&ot($)===!1){const B=$.isWebGLMultipleRenderTargets?$.texture:[$.texture],Lt=$.width,jt=$.height;let Kt=i.COLOR_BUFFER_BIT;const se=[],we=$.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ht=n.get($),mt=$.isWebGLMultipleRenderTargets===!0;if(mt)for(let tt=0;tt<B.length;tt++)e.bindFramebuffer(i.FRAMEBUFFER,ht.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+tt,i.RENDERBUFFER,null),e.bindFramebuffer(i.FRAMEBUFFER,ht.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+tt,i.TEXTURE_2D,null,0);e.bindFramebuffer(i.READ_FRAMEBUFFER,ht.__webglMultisampledFramebuffer),e.bindFramebuffer(i.DRAW_FRAMEBUFFER,ht.__webglFramebuffer);for(let tt=0;tt<B.length;tt++){se.push(i.COLOR_ATTACHMENT0+tt),$.depthBuffer&&se.push(we);const Ut=ht.__ignoreDepthValues!==void 0?ht.__ignoreDepthValues:!1;if(Ut===!1&&($.depthBuffer&&(Kt|=i.DEPTH_BUFFER_BIT),$.stencilBuffer&&(Kt|=i.STENCIL_BUFFER_BIT)),mt&&i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,ht.__webglColorRenderbuffer[tt]),Ut===!0&&(i.invalidateFramebuffer(i.READ_FRAMEBUFFER,[we]),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[we])),mt){const oe=n.get(B[tt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,oe,0)}i.blitFramebuffer(0,0,Lt,jt,0,0,Lt,jt,Kt,i.NEAREST),m&&i.invalidateFramebuffer(i.READ_FRAMEBUFFER,se)}if(e.bindFramebuffer(i.READ_FRAMEBUFFER,null),e.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),mt)for(let tt=0;tt<B.length;tt++){e.bindFramebuffer(i.FRAMEBUFFER,ht.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+tt,i.RENDERBUFFER,ht.__webglColorRenderbuffer[tt]);const Ut=n.get(B[tt]).__webglTexture;e.bindFramebuffer(i.FRAMEBUFFER,ht.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+tt,i.TEXTURE_2D,Ut,0)}e.bindFramebuffer(i.DRAW_FRAMEBUFFER,ht.__webglMultisampledFramebuffer)}}function qt($){return Math.min(h,$.samples)}function ot($){const B=n.get($);return a&&$.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&B.__useRenderToTexture!==!1}function st($){const B=o.render.frame;v.get($)!==B&&(v.set($,B),$.update())}function _t($,B){const Lt=$.colorSpace,jt=$.format,Kt=$.type;return $.isCompressedTexture===!0||$.format===Kb||Lt!==bl&&Lt!==qu&&(Lt===cn?a===!1?t.has("EXT_sRGB")===!0&&jt===Es?($.format=Kb,$.minFilter=Ji,$.generateMipmaps=!1):B=SE.sRGBToLinear(B):(jt!==Es||Kt!==lo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Lt)),B}this.allocateTextureUnit=Q,this.resetTextureUnits=nt,this.setTexture2D=Pt,this.setTexture2DArray=dt,this.setTexture3D=Rt,this.setTextureCube=Jt,this.rebindTextures=et,this.setupRenderTarget=ft,this.updateRenderTargetMipmap=kt,this.updateMultisampleRenderTarget=Qt,this.setupDepthRenderbuffer=$t,this.setupFrameBufferTexture=ne,this.useMultisampledRTT=ot}function aI(i,t,e){const n=e.isWebGL2;function r(s,o=qu){let a;if(s===lo)return i.UNSIGNED_BYTE;if(s===Ly)return i.UNSIGNED_SHORT_4_4_4_4;if(s===Oy)return i.UNSIGNED_SHORT_5_5_5_1;if(s===bv)return i.BYTE;if(s===yv)return i.SHORT;if(s===Ud)return i.UNSIGNED_SHORT;if(s===Uf)return i.INT;if(s===Fa)return i.UNSIGNED_INT;if(s===Hr)return i.FLOAT;if(s===gf)return n?i.HALF_FLOAT:(a=t.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===gE)return i.ALPHA;if(s===Es)return i.RGBA;if(s===Dy)return i.LUMINANCE;if(s===Iy)return i.LUMINANCE_ALPHA;if(s===Gu)return i.DEPTH_COMPONENT;if(s===Td)return i.DEPTH_STENCIL;if(s===Kb)return a=t.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===CD)return i.RED;if(s===vE)return i.RED_INTEGER;if(s===ED)return i.RG;if(s===_E)return i.RG_INTEGER;if(s===bE)return i.RGBA_INTEGER;if(s===Tb||s===Ab||s===Pb||s===Rb)if(o===cn)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Tb)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Ab)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Pb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Rb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Tb)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Ab)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Pb)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Rb)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===xM||s===wM||s===SM||s===MM)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===xM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===wM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===SM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===MM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===TD)return a=t.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===CM||s===EM)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(s===CM)return o===cn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===EM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===TM||s===AM||s===PM||s===RM||s===kM||s===LM||s===OM||s===DM||s===IM||s===NM||s===zM||s===UM||s===FM||s===VM)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(s===TM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===AM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===PM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===RM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===kM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===LM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===OM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===DM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===IM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===NM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===zM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===UM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===FM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===VM)return o===cn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===kb)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(s===kb)return o===cn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===AD||s===BM||s===HM||s===$M)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(s===kb)return a.COMPRESSED_RED_RGTC1_EXT;if(s===BM)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===HM)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===$M)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===$u?n?i.UNSIGNED_INT_24_8:(a=t.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):i[s]!==void 0?i[s]:null}return{convert:r}}class lI extends Di{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}let Zp=class extends qn{constructor(){super(),this.isGroup=!0,this.type="Group"}};const Y8={type:"move"};class iS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Zp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Zp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Y,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Y),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Zp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Y,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Y),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(c&&t.hand){o=!0;for(const _ of t.hand.values()){const b=e.getJointPose(_,n),y=this._getHandJoint(c,_);b!==null&&(y.matrix.fromArray(b.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=b.radius),y.visible=b!==null}const u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],p=u.position.distanceTo(h.position),m=.02,v=.005;c.inputState.pinching&&p>m+v?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!c.inputState.pinching&&p<=m-v&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(s=e.getPose(t.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=e.getPose(t.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Y8)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(t,e){if(t.joints[e.jointName]===void 0){const n=new Zp;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class cI extends mr{constructor(t,e,n,r,s,o,a,l,c,u){if(u=u!==void 0?u:Gu,u!==Gu&&u!==Td)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===Gu&&(n=Fa),n===void 0&&u===Td&&(n=$u),super(null,r,s,o,a,l,u,n,c),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=a!==void 0?a:si,this.minFilter=l!==void 0?l:si,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return this.compareFunction!==null&&(e.compareFunction=this.compareFunction),e}}class K8 extends ma{constructor(t,e){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,h=null,p=null,m=null,v=null;const _=e.getContextAttributes();let b=null,y=null;const M=[],S=[],E=new Di;E.layers.enable(1),E.viewport=new Vn;const A=new Di;A.layers.enable(2),A.viewport=new Vn;const R=[E,A],O=new lI;O.layers.enable(1),O.layers.enable(2);let L=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(dt){let Rt=M[dt];return Rt===void 0&&(Rt=new iS,M[dt]=Rt),Rt.getTargetRaySpace()},this.getControllerGrip=function(dt){let Rt=M[dt];return Rt===void 0&&(Rt=new iS,M[dt]=Rt),Rt.getGripSpace()},this.getHand=function(dt){let Rt=M[dt];return Rt===void 0&&(Rt=new iS,M[dt]=Rt),Rt.getHandSpace()};function D(dt){const Rt=S.indexOf(dt.inputSource);if(Rt===-1)return;const Jt=M[Rt];Jt!==void 0&&(Jt.update(dt.inputSource,dt.frame,c||o),Jt.dispatchEvent({type:dt.type,data:dt.inputSource}))}function V(){r.removeEventListener("select",D),r.removeEventListener("selectstart",D),r.removeEventListener("selectend",D),r.removeEventListener("squeeze",D),r.removeEventListener("squeezestart",D),r.removeEventListener("squeezeend",D),r.removeEventListener("end",V),r.removeEventListener("inputsourceschange",K);for(let dt=0;dt<M.length;dt++){const Rt=S[dt];Rt!==null&&(S[dt]=null,M[dt].disconnect(Rt))}L=null,P=null,t.setRenderTarget(b),m=null,p=null,h=null,r=null,y=null,Pt.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(dt){s=dt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(dt){a=dt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(dt){c=dt},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return h},this.getFrame=function(){return v},this.getSession=function(){return r},this.setSession=async function(dt){if(r=dt,r!==null){if(b=t.getRenderTarget(),r.addEventListener("select",D),r.addEventListener("selectstart",D),r.addEventListener("selectend",D),r.addEventListener("squeeze",D),r.addEventListener("squeezestart",D),r.addEventListener("squeezeend",D),r.addEventListener("end",V),r.addEventListener("inputsourceschange",K),_.xrCompatible!==!0&&await e.makeXRCompatible(),r.renderState.layers===void 0||t.capabilities.isWebGL2===!1){const Rt={antialias:r.renderState.layers===void 0?_.antialias:!0,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,e,Rt),r.updateRenderState({baseLayer:m}),y=new ba(m.framebufferWidth,m.framebufferHeight,{format:Es,type:lo,colorSpace:t.outputColorSpace,stencilBuffer:_.stencil})}else{let Rt=null,Jt=null,Bt=null;_.depth&&(Bt=_.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,Rt=_.stencil?Td:Gu,Jt=_.stencil?$u:Fa);const Wt={colorFormat:e.RGBA8,depthFormat:Bt,scaleFactor:s};h=new XRWebGLBinding(r,e),p=h.createProjectionLayer(Wt),r.updateRenderState({layers:[p]}),y=new ba(p.textureWidth,p.textureHeight,{format:Es,type:lo,depthTexture:new cI(p.textureWidth,p.textureHeight,Jt,void 0,void 0,void 0,void 0,void 0,void 0,Rt),stencilBuffer:_.stencil,colorSpace:t.outputColorSpace,samples:_.antialias?4:0});const be=t.properties.get(y);be.__ignoreDepthValues=p.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),Pt.setContext(r),Pt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function K(dt){for(let Rt=0;Rt<dt.removed.length;Rt++){const Jt=dt.removed[Rt],Bt=S.indexOf(Jt);Bt>=0&&(S[Bt]=null,M[Bt].disconnect(Jt))}for(let Rt=0;Rt<dt.added.length;Rt++){const Jt=dt.added[Rt];let Bt=S.indexOf(Jt);if(Bt===-1){for(let be=0;be<M.length;be++)if(be>=S.length){S.push(Jt),Bt=be;break}else if(S[be]===null){S[be]=Jt,Bt=be;break}if(Bt===-1)break}const Wt=M[Bt];Wt&&Wt.connect(Jt)}}const W=new Y,Z=new Y;function z(dt,Rt,Jt){W.setFromMatrixPosition(Rt.matrixWorld),Z.setFromMatrixPosition(Jt.matrixWorld);const Bt=W.distanceTo(Z),Wt=Rt.projectionMatrix.elements,be=Jt.projectionMatrix.elements,re=Wt[14]/(Wt[10]-1),It=Wt[14]/(Wt[10]+1),ye=(Wt[9]+1)/Wt[5],ce=(Wt[9]-1)/Wt[5],ne=(Wt[8]-1)/Wt[0],Gt=(be[8]+1)/be[0],J=re*ne,$t=re*Gt,et=Bt/(-ne+Gt),ft=et*-ne;Rt.matrixWorld.decompose(dt.position,dt.quaternion,dt.scale),dt.translateX(ft),dt.translateZ(et),dt.matrixWorld.compose(dt.position,dt.quaternion,dt.scale),dt.matrixWorldInverse.copy(dt.matrixWorld).invert();const kt=re+et,Qt=It+et,qt=J-ft,ot=$t+(Bt-ft),st=ye*It/Qt*kt,_t=ce*It/Qt*kt;dt.projectionMatrix.makePerspective(qt,ot,st,_t,kt,Qt),dt.projectionMatrixInverse.copy(dt.projectionMatrix).invert()}function ut(dt,Rt){Rt===null?dt.matrixWorld.copy(dt.matrix):dt.matrixWorld.multiplyMatrices(Rt.matrixWorld,dt.matrix),dt.matrixWorldInverse.copy(dt.matrixWorld).invert()}this.updateCamera=function(dt){if(r===null)return;O.near=A.near=E.near=dt.near,O.far=A.far=E.far=dt.far,(L!==O.near||P!==O.far)&&(r.updateRenderState({depthNear:O.near,depthFar:O.far}),L=O.near,P=O.far);const Rt=dt.parent,Jt=O.cameras;ut(O,Rt);for(let Bt=0;Bt<Jt.length;Bt++)ut(Jt[Bt],Rt);Jt.length===2?z(O,E,A):O.projectionMatrix.copy(E.projectionMatrix),nt(dt,O,Rt)};function nt(dt,Rt,Jt){Jt===null?dt.matrix.copy(Rt.matrixWorld):(dt.matrix.copy(Jt.matrixWorld),dt.matrix.invert(),dt.matrix.multiply(Rt.matrixWorld)),dt.matrix.decompose(dt.position,dt.quaternion,dt.scale),dt.updateMatrixWorld(!0);const Bt=dt.children;for(let Wt=0,be=Bt.length;Wt<be;Wt++)Bt[Wt].updateMatrixWorld(!0);dt.projectionMatrix.copy(Rt.projectionMatrix),dt.projectionMatrixInverse.copy(Rt.projectionMatrixInverse),dt.isPerspectiveCamera&&(dt.fov=vf*2*Math.atan(1/dt.projectionMatrix.elements[5]),dt.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function(dt){l=dt,p!==null&&(p.fixedFoveation=dt),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=dt)};let Q=null;function St(dt,Rt){if(u=Rt.getViewerPose(c||o),v=Rt,u!==null){const Jt=u.views;m!==null&&(t.setRenderTargetFramebuffer(y,m.framebuffer),t.setRenderTarget(y));let Bt=!1;Jt.length!==O.cameras.length&&(O.cameras.length=0,Bt=!0);for(let Wt=0;Wt<Jt.length;Wt++){const be=Jt[Wt];let re=null;if(m!==null)re=m.getViewport(be);else{const ye=h.getViewSubImage(p,be);re=ye.viewport,Wt===0&&(t.setRenderTargetTextures(y,ye.colorTexture,p.ignoreDepthValues?void 0:ye.depthStencilTexture),t.setRenderTarget(y))}let It=R[Wt];It===void 0&&(It=new Di,It.layers.enable(Wt),It.viewport=new Vn,R[Wt]=It),It.matrix.fromArray(be.transform.matrix),It.matrix.decompose(It.position,It.quaternion,It.scale),It.projectionMatrix.fromArray(be.projectionMatrix),It.projectionMatrixInverse.copy(It.projectionMatrix).invert(),It.viewport.set(re.x,re.y,re.width,re.height),Wt===0&&(O.matrix.copy(It.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),Bt===!0&&O.cameras.push(It)}}for(let Jt=0;Jt<M.length;Jt++){const Bt=S[Jt],Wt=M[Jt];Bt!==null&&Wt!==void 0&&Wt.update(Bt,Rt,c||o)}Q&&Q(dt,Rt),Rt.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Rt}),v=null}const Pt=new nI;Pt.setAnimationLoop(St),this.setAnimationLoop=function(dt){Q=dt},this.dispose=function(){}}}function Z8(i,t){function e(b,y){b.matrixAutoUpdate===!0&&b.updateMatrix(),y.value.copy(b.matrix)}function n(b,y){y.color.getRGB(b.fogColor.value,JD(i)),y.isFog?(b.fogNear.value=y.near,b.fogFar.value=y.far):y.isFogExp2&&(b.fogDensity.value=y.density)}function r(b,y,M,S,E){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(b,y):y.isMeshToonMaterial?(s(b,y),h(b,y)):y.isMeshPhongMaterial?(s(b,y),u(b,y)):y.isMeshStandardMaterial?(s(b,y),p(b,y),y.isMeshPhysicalMaterial&&m(b,y,E)):y.isMeshMatcapMaterial?(s(b,y),v(b,y)):y.isMeshDepthMaterial?s(b,y):y.isMeshDistanceMaterial?(s(b,y),_(b,y)):y.isMeshNormalMaterial?s(b,y):y.isLineBasicMaterial?(o(b,y),y.isLineDashedMaterial&&a(b,y)):y.isPointsMaterial?l(b,y,M,S):y.isSpriteMaterial?c(b,y):y.isShadowMaterial?(b.color.value.copy(y.color),b.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(b,y){b.opacity.value=y.opacity,y.color&&b.diffuse.value.copy(y.color),y.emissive&&b.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(b.map.value=y.map,e(y.map,b.mapTransform)),y.alphaMap&&(b.alphaMap.value=y.alphaMap,e(y.alphaMap,b.alphaMapTransform)),y.bumpMap&&(b.bumpMap.value=y.bumpMap,e(y.bumpMap,b.bumpMapTransform),b.bumpScale.value=y.bumpScale,y.side===ao&&(b.bumpScale.value*=-1)),y.normalMap&&(b.normalMap.value=y.normalMap,e(y.normalMap,b.normalMapTransform),b.normalScale.value.copy(y.normalScale),y.side===ao&&b.normalScale.value.negate()),y.displacementMap&&(b.displacementMap.value=y.displacementMap,e(y.displacementMap,b.displacementMapTransform),b.displacementScale.value=y.displacementScale,b.displacementBias.value=y.displacementBias),y.emissiveMap&&(b.emissiveMap.value=y.emissiveMap,e(y.emissiveMap,b.emissiveMapTransform)),y.specularMap&&(b.specularMap.value=y.specularMap,e(y.specularMap,b.specularMapTransform)),y.alphaTest>0&&(b.alphaTest.value=y.alphaTest);const M=t.get(y).envMap;if(M&&(b.envMap.value=M,b.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,b.reflectivity.value=y.reflectivity,b.ior.value=y.ior,b.refractionRatio.value=y.refractionRatio),y.lightMap){b.lightMap.value=y.lightMap;const S=i._useLegacyLights===!0?Math.PI:1;b.lightMapIntensity.value=y.lightMapIntensity*S,e(y.lightMap,b.lightMapTransform)}y.aoMap&&(b.aoMap.value=y.aoMap,b.aoMapIntensity.value=y.aoMapIntensity,e(y.aoMap,b.aoMapTransform))}function o(b,y){b.diffuse.value.copy(y.color),b.opacity.value=y.opacity,y.map&&(b.map.value=y.map,e(y.map,b.mapTransform))}function a(b,y){b.dashSize.value=y.dashSize,b.totalSize.value=y.dashSize+y.gapSize,b.scale.value=y.scale}function l(b,y,M,S){b.diffuse.value.copy(y.color),b.opacity.value=y.opacity,b.size.value=y.size*M,b.scale.value=S*.5,y.map&&(b.map.value=y.map,e(y.map,b.uvTransform)),y.alphaMap&&(b.alphaMap.value=y.alphaMap,e(y.alphaMap,b.alphaMapTransform)),y.alphaTest>0&&(b.alphaTest.value=y.alphaTest)}function c(b,y){b.diffuse.value.copy(y.color),b.opacity.value=y.opacity,b.rotation.value=y.rotation,y.map&&(b.map.value=y.map,e(y.map,b.mapTransform)),y.alphaMap&&(b.alphaMap.value=y.alphaMap,e(y.alphaMap,b.alphaMapTransform)),y.alphaTest>0&&(b.alphaTest.value=y.alphaTest)}function u(b,y){b.specular.value.copy(y.specular),b.shininess.value=Math.max(y.shininess,1e-4)}function h(b,y){y.gradientMap&&(b.gradientMap.value=y.gradientMap)}function p(b,y){b.metalness.value=y.metalness,y.metalnessMap&&(b.metalnessMap.value=y.metalnessMap,e(y.metalnessMap,b.metalnessMapTransform)),b.roughness.value=y.roughness,y.roughnessMap&&(b.roughnessMap.value=y.roughnessMap,e(y.roughnessMap,b.roughnessMapTransform)),t.get(y).envMap&&(b.envMapIntensity.value=y.envMapIntensity)}function m(b,y,M){b.ior.value=y.ior,y.sheen>0&&(b.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),b.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(b.sheenColorMap.value=y.sheenColorMap,e(y.sheenColorMap,b.sheenColorMapTransform)),y.sheenRoughnessMap&&(b.sheenRoughnessMap.value=y.sheenRoughnessMap,e(y.sheenRoughnessMap,b.sheenRoughnessMapTransform))),y.clearcoat>0&&(b.clearcoat.value=y.clearcoat,b.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(b.clearcoatMap.value=y.clearcoatMap,e(y.clearcoatMap,b.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(b.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,e(y.clearcoatRoughnessMap,b.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(b.clearcoatNormalMap.value=y.clearcoatNormalMap,e(y.clearcoatNormalMap,b.clearcoatNormalMapTransform),b.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===ao&&b.clearcoatNormalScale.value.negate())),y.iridescence>0&&(b.iridescence.value=y.iridescence,b.iridescenceIOR.value=y.iridescenceIOR,b.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],b.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(b.iridescenceMap.value=y.iridescenceMap,e(y.iridescenceMap,b.iridescenceMapTransform)),y.iridescenceThicknessMap&&(b.iridescenceThicknessMap.value=y.iridescenceThicknessMap,e(y.iridescenceThicknessMap,b.iridescenceThicknessMapTransform))),y.transmission>0&&(b.transmission.value=y.transmission,b.transmissionSamplerMap.value=M.texture,b.transmissionSamplerSize.value.set(M.width,M.height),y.transmissionMap&&(b.transmissionMap.value=y.transmissionMap,e(y.transmissionMap,b.transmissionMapTransform)),b.thickness.value=y.thickness,y.thicknessMap&&(b.thicknessMap.value=y.thicknessMap,e(y.thicknessMap,b.thicknessMapTransform)),b.attenuationDistance.value=y.attenuationDistance,b.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(b.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(b.anisotropyMap.value=y.anisotropyMap,e(y.anisotropyMap,b.anisotropyMapTransform))),b.specularIntensity.value=y.specularIntensity,b.specularColor.value.copy(y.specularColor),y.specularColorMap&&(b.specularColorMap.value=y.specularColorMap,e(y.specularColorMap,b.specularColorMapTransform)),y.specularIntensityMap&&(b.specularIntensityMap.value=y.specularIntensityMap,e(y.specularIntensityMap,b.specularIntensityMapTransform))}function v(b,y){y.matcap&&(b.matcap.value=y.matcap)}function _(b,y){const M=t.get(y).light;b.referencePosition.value.setFromMatrixPosition(M.matrixWorld),b.nearDistance.value=M.shadow.camera.near,b.farDistance.value=M.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function J8(i,t,e,n){let r={},s={},o=[];const a=e.isWebGL2?i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(M,S){const E=S.program;n.uniformBlockBinding(M,E)}function c(M,S){let E=r[M.id];E===void 0&&(v(M),E=u(M),r[M.id]=E,M.addEventListener("dispose",b));const A=S.program;n.updateUBOMapping(M,A);const R=t.render.frame;s[M.id]!==R&&(p(M),s[M.id]=R)}function u(M){const S=h();M.__bindingPointIndex=S;const E=i.createBuffer(),A=M.__size,R=M.usage;return i.bindBuffer(i.UNIFORM_BUFFER,E),i.bufferData(i.UNIFORM_BUFFER,A,R),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,S,E),E}function h(){for(let M=0;M<a;M++)if(o.indexOf(M)===-1)return o.push(M),M;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(M){const S=r[M.id],E=M.uniforms,A=M.__cache;i.bindBuffer(i.UNIFORM_BUFFER,S);for(let R=0,O=E.length;R<O;R++){const L=E[R];if(m(L,R,A)===!0){const P=L.__offset,D=Array.isArray(L.value)?L.value:[L.value];let V=0;for(let K=0;K<D.length;K++){const W=D[K],Z=_(W);typeof W=="number"?(L.__data[0]=W,i.bufferSubData(i.UNIFORM_BUFFER,P+V,L.__data)):W.isMatrix3?(L.__data[0]=W.elements[0],L.__data[1]=W.elements[1],L.__data[2]=W.elements[2],L.__data[3]=W.elements[0],L.__data[4]=W.elements[3],L.__data[5]=W.elements[4],L.__data[6]=W.elements[5],L.__data[7]=W.elements[0],L.__data[8]=W.elements[6],L.__data[9]=W.elements[7],L.__data[10]=W.elements[8],L.__data[11]=W.elements[0]):(W.toArray(L.__data,V),V+=Z.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,P,L.__data)}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function m(M,S,E){const A=M.value;if(E[S]===void 0){if(typeof A=="number")E[S]=A;else{const R=Array.isArray(A)?A:[A],O=[];for(let L=0;L<R.length;L++)O.push(R[L].clone());E[S]=O}return!0}else if(typeof A=="number"){if(E[S]!==A)return E[S]=A,!0}else{const R=Array.isArray(E[S])?E[S]:[E[S]],O=Array.isArray(A)?A:[A];for(let L=0;L<R.length;L++){const P=R[L];if(P.equals(O[L])===!1)return P.copy(O[L]),!0}}return!1}function v(M){const S=M.uniforms;let E=0;const A=16;let R=0;for(let O=0,L=S.length;O<L;O++){const P=S[O],D={boundary:0,storage:0},V=Array.isArray(P.value)?P.value:[P.value];for(let K=0,W=V.length;K<W;K++){const Z=V[K],z=_(Z);D.boundary+=z.boundary,D.storage+=z.storage}if(P.__data=new Float32Array(D.storage/Float32Array.BYTES_PER_ELEMENT),P.__offset=E,O>0){R=E%A;const K=A-R;R!==0&&K-D.boundary<0&&(E+=A-R,P.__offset=E)}E+=D.storage}return R=E%A,R>0&&(E+=A-R),M.__size=E,M.__cache={},this}function _(M){const S={boundary:0,storage:0};return typeof M=="number"?(S.boundary=4,S.storage=4):M.isVector2?(S.boundary=8,S.storage=8):M.isVector3||M.isColor?(S.boundary=16,S.storage=12):M.isVector4?(S.boundary=16,S.storage=16):M.isMatrix3?(S.boundary=48,S.storage=48):M.isMatrix4?(S.boundary=64,S.storage=64):M.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",M),S}function b(M){const S=M.target;S.removeEventListener("dispose",b);const E=o.indexOf(S.__bindingPointIndex);o.splice(E,1),i.deleteBuffer(r[S.id]),delete r[S.id],delete s[S.id]}function y(){for(const M in r)i.deleteBuffer(r[M]);o=[],r={},s={}}return{bind:l,update:c,dispose:y}}function Q8(){const i=Hg("canvas");return i.style.display="block",i}class RE{constructor(t={}){const{canvas:e=Q8(),context:n=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1,webgl1:p=!1}=t;this.isWebGLRenderer=!0,p&&(this.isWebGL1Renderer=!0);let m;n!==null?m=n.getContextAttributes().alpha:m=o;const v=new Uint32Array(4),_=new Int32Array(4);let b=null,y=null;const M=[],S=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=cn,this._useLegacyLights=!1,this.toneMapping=jc,this.toneMappingExposure=1;const E=this;let A=!1,R=0,O=0,L=null,P=-1,D=null;const V=new Vn,K=new Vn;let W=null;const Z=new me(0);let z=0,ut=e.width,nt=e.height,Q=1,St=null,Pt=null;const dt=new Vn(0,0,ut,nt),Rt=new Vn(0,0,ut,nt);let Jt=!1;const Bt=new Fy;let Wt=!1,be=!1,re=null;const It=new rn,ye=new Vt,ce=new Y,ne={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Gt(){return L===null?Q:1}let J=n;function $t(X,At){for(let Nt=0;Nt<X.length;Nt++){const wt=X[Nt],Ft=e.getContext(wt,At);if(Ft!==null)return Ft}return null}try{const X={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Ay}`),e.addEventListener("webglcontextlost",Mt,!1),e.addEventListener("webglcontextrestored",ie,!1),e.addEventListener("webglcontextcreationerror",le,!1),J===null){const At=["webgl2","webgl","experimental-webgl"];if(E.isWebGL1Renderer===!0&&At.shift(),J=$t(At,X),J===null)throw $t(At)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&J instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),J.getShaderPrecisionFormat===void 0&&(J.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(X){throw console.error("THREE.WebGLRenderer: "+X.message),X}let et,ft,kt,Qt,qt,ot,st,_t,$,B,Lt,jt,Kt,se,we,ht,mt,tt,Ut,oe,ue,ae,xe,Ze;function pt(){et=new f6(J),ft=new l6(J,et,t),et.init(ft),ae=new aI(J,et,ft),kt=new j8(J,et,ft),Qt=new v6(J),qt=new I8,ot=new X8(J,et,kt,qt,ft,ae,Qt),st=new u6(E),_t=new p6(E),$=new Tq(J,ft),xe=new o6(J,et,$,ft),B=new m6(J,$,Qt,xe),Lt=new x6(J,B,$,Qt),Ut=new y6(J,ft,ot),ht=new c6(qt),jt=new D8(E,st,_t,et,ft,xe,ht),Kt=new Z8(E,qt),se=new z8,we=new $8(et,ft),tt=new s6(E,st,_t,kt,Lt,m,l),mt=new W8(E,Lt,ft),Ze=new J8(J,Qt,ft,kt),oe=new a6(J,et,Qt,ft),ue=new g6(J,et,Qt,ft),Qt.programs=jt.programs,E.capabilities=ft,E.extensions=et,E.properties=qt,E.renderLists=se,E.shadowMap=mt,E.state=kt,E.info=Qt}pt();const ee=new K8(E,J);this.xr=ee,this.getContext=function(){return J},this.getContextAttributes=function(){return J.getContextAttributes()},this.forceContextLoss=function(){const X=et.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){const X=et.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return Q},this.setPixelRatio=function(X){X!==void 0&&(Q=X,this.setSize(ut,nt,!1))},this.getSize=function(X){return X.set(ut,nt)},this.setSize=function(X,At,Nt=!0){if(ee.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ut=X,nt=At,e.width=Math.floor(X*Q),e.height=Math.floor(At*Q),Nt===!0&&(e.style.width=X+"px",e.style.height=At+"px"),this.setViewport(0,0,X,At)},this.getDrawingBufferSize=function(X){return X.set(ut*Q,nt*Q).floor()},this.setDrawingBufferSize=function(X,At,Nt){ut=X,nt=At,Q=Nt,e.width=Math.floor(X*Nt),e.height=Math.floor(At*Nt),this.setViewport(0,0,X,At)},this.getCurrentViewport=function(X){return X.copy(V)},this.getViewport=function(X){return X.copy(dt)},this.setViewport=function(X,At,Nt,wt){X.isVector4?dt.set(X.x,X.y,X.z,X.w):dt.set(X,At,Nt,wt),kt.viewport(V.copy(dt).multiplyScalar(Q).floor())},this.getScissor=function(X){return X.copy(Rt)},this.setScissor=function(X,At,Nt,wt){X.isVector4?Rt.set(X.x,X.y,X.z,X.w):Rt.set(X,At,Nt,wt),kt.scissor(K.copy(Rt).multiplyScalar(Q).floor())},this.getScissorTest=function(){return Jt},this.setScissorTest=function(X){kt.setScissorTest(Jt=X)},this.setOpaqueSort=function(X){St=X},this.setTransparentSort=function(X){Pt=X},this.getClearColor=function(X){return X.copy(tt.getClearColor())},this.setClearColor=function(){tt.setClearColor.apply(tt,arguments)},this.getClearAlpha=function(){return tt.getClearAlpha()},this.setClearAlpha=function(){tt.setClearAlpha.apply(tt,arguments)},this.clear=function(X=!0,At=!0,Nt=!0){let wt=0;if(X){let Ft=!1;if(L!==null){const fe=L.texture.format;Ft=fe===bE||fe===_E||fe===vE}if(Ft){const fe=L.texture.type,Re=fe===lo||fe===Fa||fe===Ud||fe===$u||fe===Ly||fe===Oy,Me=tt.getClearColor(),ze=tt.getClearAlpha(),Ye=Me.r,De=Me.g,Ue=Me.b;Re?(v[0]=Ye,v[1]=De,v[2]=Ue,v[3]=ze,J.clearBufferuiv(J.COLOR,0,v)):(_[0]=Ye,_[1]=De,_[2]=Ue,_[3]=ze,J.clearBufferiv(J.COLOR,0,_))}else wt|=J.COLOR_BUFFER_BIT}At&&(wt|=J.DEPTH_BUFFER_BIT),Nt&&(wt|=J.STENCIL_BUFFER_BIT),J.clear(wt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Mt,!1),e.removeEventListener("webglcontextrestored",ie,!1),e.removeEventListener("webglcontextcreationerror",le,!1),se.dispose(),we.dispose(),qt.dispose(),st.dispose(),_t.dispose(),Lt.dispose(),xe.dispose(),Ze.dispose(),jt.dispose(),ee.dispose(),ee.removeEventListener("sessionstart",jr),ee.removeEventListener("sessionend",Jn),re&&(re.dispose(),re=null),Xr.stop()};function Mt(X){X.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),A=!0}function ie(){console.log("THREE.WebGLRenderer: Context Restored."),A=!1;const X=Qt.autoReset,At=mt.enabled,Nt=mt.autoUpdate,wt=mt.needsUpdate,Ft=mt.type;pt(),Qt.autoReset=X,mt.enabled=At,mt.autoUpdate=Nt,mt.needsUpdate=wt,mt.type=Ft}function le(X){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",X.statusMessage)}function Xe(X){const At=X.target;At.removeEventListener("dispose",Xe),Rn(At)}function Rn(X){Zn(X),qt.remove(X)}function Zn(X){const At=qt.get(X).programs;At!==void 0&&(At.forEach(function(Nt){jt.releaseProgram(Nt)}),X.isShaderMaterial&&jt.releaseShaderCache(X))}this.renderBufferDirect=function(X,At,Nt,wt,Ft,fe){At===null&&(At=ne);const Re=Ft.isMesh&&Ft.matrixWorld.determinant()<0,Me=Ws(X,At,Nt,wt,Ft);kt.setMaterial(wt,Re);let ze=Nt.index,Ye=1;wt.wireframe===!0&&(ze=B.getWireframeAttribute(Nt),Ye=2);const De=Nt.drawRange,Ue=Nt.attributes.position;let Qn=De.start*Ye,kn=(De.start+De.count)*Ye;fe!==null&&(Qn=Math.max(Qn,fe.start*Ye),kn=Math.min(kn,(fe.start+fe.count)*Ye)),ze!==null?(Qn=Math.max(Qn,0),kn=Math.min(kn,ze.count)):Ue!=null&&(Qn=Math.max(Qn,0),kn=Math.min(kn,Ue.count));const qi=kn-Qn;if(qi<0||qi===1/0)return;xe.setup(Ft,wt,Me,Nt,ze);let Rr,Qe=oe;if(ze!==null&&(Rr=$.get(ze),Qe=ue,Qe.setIndex(Rr)),Ft.isMesh)wt.wireframe===!0?(kt.setLineWidth(wt.wireframeLinewidth*Gt()),Qe.setMode(J.LINES)):Qe.setMode(J.TRIANGLES);else if(Ft.isLine){let Ve=wt.linewidth;Ve===void 0&&(Ve=1),kt.setLineWidth(Ve*Gt()),Ft.isLineSegments?Qe.setMode(J.LINES):Ft.isLineLoop?Qe.setMode(J.LINE_LOOP):Qe.setMode(J.LINE_STRIP)}else Ft.isPoints?Qe.setMode(J.POINTS):Ft.isSprite&&Qe.setMode(J.TRIANGLES);if(Ft.isInstancedMesh)Qe.renderInstances(Qn,qi,Ft.count);else if(Nt.isInstancedBufferGeometry){const Ve=Nt._maxInstanceCount!==void 0?Nt._maxInstanceCount:1/0,js=Math.min(Nt.instanceCount,Ve);Qe.renderInstances(Qn,qi,js)}else Qe.render(Qn,qi)},this.compile=function(X,At){function Nt(wt,Ft,fe){wt.transparent===!0&&wt.side===pr&&wt.forceSinglePass===!1?(wt.side=ao,wt.needsUpdate=!0,Tl(wt,Ft,fe),wt.side=Kc,wt.needsUpdate=!0,Tl(wt,Ft,fe),wt.side=pr):Tl(wt,Ft,fe)}y=we.get(X),y.init(),S.push(y),X.traverseVisible(function(wt){wt.isLight&&wt.layers.test(At.layers)&&(y.pushLight(wt),wt.castShadow&&y.pushShadow(wt))}),y.setupLights(E._useLegacyLights),X.traverse(function(wt){const Ft=wt.material;if(Ft)if(Array.isArray(Ft))for(let fe=0;fe<Ft.length;fe++){const Re=Ft[fe];Nt(Re,X,wt)}else Nt(Ft,X,wt)}),S.pop(),y=null};let Wr=null;function mn(X){Wr&&Wr(X)}function jr(){Xr.stop()}function Jn(){Xr.start()}const Xr=new nI;Xr.setAnimationLoop(mn),typeof self<"u"&&Xr.setContext(self),this.setAnimationLoop=function(X){Wr=X,ee.setAnimationLoop(X),X===null?Xr.stop():Xr.start()},ee.addEventListener("sessionstart",jr),ee.addEventListener("sessionend",Jn),this.render=function(X,At){if(At!==void 0&&At.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(A===!0)return;X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),At.parent===null&&At.matrixWorldAutoUpdate===!0&&At.updateMatrixWorld(),ee.enabled===!0&&ee.isPresenting===!0&&(ee.cameraAutoUpdate===!0&&ee.updateCamera(At),At=ee.getCamera()),X.isScene===!0&&X.onBeforeRender(E,X,At,L),y=we.get(X,S.length),y.init(),S.push(y),It.multiplyMatrices(At.projectionMatrix,At.matrixWorldInverse),Bt.setFromProjectionMatrix(It),be=this.localClippingEnabled,Wt=ht.init(this.clippingPlanes,be),b=se.get(X,M.length),b.init(),M.push(b),qo(X,At,0,E.sortObjects),b.finish(),E.sortObjects===!0&&b.sort(St,Pt),this.info.render.frame++,Wt===!0&&ht.beginShadows();const Nt=y.state.shadowsArray;if(mt.render(Nt,X,At),Wt===!0&&ht.endShadows(),this.info.autoReset===!0&&this.info.reset(),tt.render(b,X),y.setupLights(E._useLegacyLights),At.isArrayCamera){const wt=At.cameras;for(let Ft=0,fe=wt.length;Ft<fe;Ft++){const Re=wt[Ft];xa(b,X,Re,Re.viewport)}}else xa(b,X,At);L!==null&&(ot.updateMultisampleRenderTarget(L),ot.updateRenderTargetMipmap(L)),X.isScene===!0&&X.onAfterRender(E,X,At),xe.resetDefaultState(),P=-1,D=null,S.pop(),S.length>0?y=S[S.length-1]:y=null,M.pop(),M.length>0?b=M[M.length-1]:b=null};function qo(X,At,Nt,wt){if(X.visible===!1)return;if(X.layers.test(At.layers)){if(X.isGroup)Nt=X.renderOrder;else if(X.isLOD)X.autoUpdate===!0&&X.update(At);else if(X.isLight)y.pushLight(X),X.castShadow&&y.pushShadow(X);else if(X.isSprite){if(!X.frustumCulled||Bt.intersectsSprite(X)){wt&&ce.setFromMatrixPosition(X.matrixWorld).applyMatrix4(It);const Re=Lt.update(X),Me=X.material;Me.visible&&b.push(X,Re,Me,Nt,ce.z,null)}}else if((X.isMesh||X.isLine||X.isPoints)&&(!X.frustumCulled||Bt.intersectsObject(X))){const Re=Lt.update(X),Me=X.material;if(wt&&(X.boundingSphere!==void 0?(X.boundingSphere===null&&X.computeBoundingSphere(),ce.copy(X.boundingSphere.center)):(Re.boundingSphere===null&&Re.computeBoundingSphere(),ce.copy(Re.boundingSphere.center)),ce.applyMatrix4(X.matrixWorld).applyMatrix4(It)),Array.isArray(Me)){const ze=Re.groups;for(let Ye=0,De=ze.length;Ye<De;Ye++){const Ue=ze[Ye],Qn=Me[Ue.materialIndex];Qn&&Qn.visible&&b.push(X,Re,Qn,Nt,ce.z,Ue)}}else Me.visible&&b.push(X,Re,Me,Nt,ce.z,null)}}const fe=X.children;for(let Re=0,Me=fe.length;Re<Me;Re++)qo(fe[Re],At,Nt,wt)}function xa(X,At,Nt,wt){const Ft=X.opaque,fe=X.transmissive,Re=X.transparent;y.setupLightsView(Nt),Wt===!0&&ht.setGlobalState(E.clippingPlanes,Nt),fe.length>0&&As(Ft,fe,At,Nt),wt&&kt.viewport(V.copy(wt)),Ft.length>0&&Wo(Ft,At,Nt),fe.length>0&&Wo(fe,At,Nt),Re.length>0&&Wo(Re,At,Nt),kt.buffers.depth.setTest(!0),kt.buffers.depth.setMask(!0),kt.buffers.color.setMask(!0),kt.setPolygonOffset(!1)}function As(X,At,Nt,wt){const Ft=ft.isWebGL2;re===null&&(re=new ba(1,1,{generateMipmaps:!0,type:et.has("EXT_color_buffer_half_float")?gf:lo,minFilter:eh,samples:Ft?4:0})),E.getDrawingBufferSize(ye),Ft?re.setSize(ye.x,ye.y):re.setSize(Zb(ye.x),Zb(ye.y));const fe=E.getRenderTarget();E.setRenderTarget(re),E.getClearColor(Z),z=E.getClearAlpha(),z<1&&E.setClearColor(16777215,.5),E.clear();const Re=E.toneMapping;E.toneMapping=jc,Wo(X,Nt,wt),ot.updateMultisampleRenderTarget(re),ot.updateRenderTargetMipmap(re);let Me=!1;for(let ze=0,Ye=At.length;ze<Ye;ze++){const De=At[ze],Ue=De.object,Qn=De.geometry,kn=De.material,qi=De.group;if(kn.side===pr&&Ue.layers.test(wt.layers)){const Rr=kn.side;kn.side=ao,kn.needsUpdate=!0,ja(Ue,Nt,wt,Qn,kn,qi),kn.side=Rr,kn.needsUpdate=!0,Me=!0}}Me===!0&&(ot.updateMultisampleRenderTarget(re),ot.updateRenderTargetMipmap(re)),E.setRenderTarget(fe),E.setClearColor(Z,z),E.toneMapping=Re}function Wo(X,At,Nt){const wt=At.isScene===!0?At.overrideMaterial:null;for(let Ft=0,fe=X.length;Ft<fe;Ft++){const Re=X[Ft],Me=Re.object,ze=Re.geometry,Ye=wt===null?Re.material:wt,De=Re.group;Me.layers.test(Nt.layers)&&ja(Me,At,Nt,ze,Ye,De)}}function ja(X,At,Nt,wt,Ft,fe){X.onBeforeRender(E,At,Nt,wt,Ft,fe),X.modelViewMatrix.multiplyMatrices(Nt.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),Ft.onBeforeRender(E,At,Nt,wt,X,fe),Ft.transparent===!0&&Ft.side===pr&&Ft.forceSinglePass===!1?(Ft.side=ao,Ft.needsUpdate=!0,E.renderBufferDirect(Nt,At,wt,Ft,X,fe),Ft.side=Kc,Ft.needsUpdate=!0,E.renderBufferDirect(Nt,At,wt,Ft,X,fe),Ft.side=pr):E.renderBufferDirect(Nt,At,wt,Ft,X,fe),X.onAfterRender(E,At,Nt,wt,Ft,fe)}function Tl(X,At,Nt){At.isScene!==!0&&(At=ne);const wt=qt.get(X),Ft=y.state.lights,fe=y.state.shadowsArray,Re=Ft.state.version,Me=jt.getParameters(X,Ft.state,fe,At,Nt),ze=jt.getProgramCacheKey(Me);let Ye=wt.programs;wt.environment=X.isMeshStandardMaterial?At.environment:null,wt.fog=At.fog,wt.envMap=(X.isMeshStandardMaterial?_t:st).get(X.envMap||wt.environment),Ye===void 0&&(X.addEventListener("dispose",Xe),Ye=new Map,wt.programs=Ye);let De=Ye.get(ze);if(De!==void 0){if(wt.currentProgram===De&&wt.lightsStateVersion===Re)return uu(X,Me),De}else Me.uniforms=jt.getUniforms(X),X.onBuild(Nt,Me,E),X.onBeforeCompile(Me,E),De=jt.acquireProgram(Me,ze),Ye.set(ze,De),wt.uniforms=Me.uniforms;const Ue=wt.uniforms;(!X.isShaderMaterial&&!X.isRawShaderMaterial||X.clipping===!0)&&(Ue.clippingPlanes=ht.uniform),uu(X,Me),wt.needsLights=vr(X),wt.lightsStateVersion=Re,wt.needsLights&&(Ue.ambientLightColor.value=Ft.state.ambient,Ue.lightProbe.value=Ft.state.probe,Ue.directionalLights.value=Ft.state.directional,Ue.directionalLightShadows.value=Ft.state.directionalShadow,Ue.spotLights.value=Ft.state.spot,Ue.spotLightShadows.value=Ft.state.spotShadow,Ue.rectAreaLights.value=Ft.state.rectArea,Ue.ltc_1.value=Ft.state.rectAreaLTC1,Ue.ltc_2.value=Ft.state.rectAreaLTC2,Ue.pointLights.value=Ft.state.point,Ue.pointLightShadows.value=Ft.state.pointShadow,Ue.hemisphereLights.value=Ft.state.hemi,Ue.directionalShadowMap.value=Ft.state.directionalShadowMap,Ue.directionalShadowMatrix.value=Ft.state.directionalShadowMatrix,Ue.spotShadowMap.value=Ft.state.spotShadowMap,Ue.spotLightMatrix.value=Ft.state.spotLightMatrix,Ue.spotLightMap.value=Ft.state.spotLightMap,Ue.pointShadowMap.value=Ft.state.pointShadowMap,Ue.pointShadowMatrix.value=Ft.state.pointShadowMatrix);const Qn=De.getUniforms(),kn=Db.seqWithValue(Qn.seq,Ue);return wt.currentProgram=De,wt.uniformsList=kn,De}function uu(X,At){const Nt=qt.get(X);Nt.outputColorSpace=At.outputColorSpace,Nt.instancing=At.instancing,Nt.skinning=At.skinning,Nt.morphTargets=At.morphTargets,Nt.morphNormals=At.morphNormals,Nt.morphColors=At.morphColors,Nt.morphTargetsCount=At.morphTargetsCount,Nt.numClippingPlanes=At.numClippingPlanes,Nt.numIntersection=At.numClipIntersection,Nt.vertexAlphas=At.vertexAlphas,Nt.vertexTangents=At.vertexTangents,Nt.toneMapping=At.toneMapping}function Ws(X,At,Nt,wt,Ft){At.isScene!==!0&&(At=ne),ot.resetTextureUnits();const fe=At.fog,Re=wt.isMeshStandardMaterial?At.environment:null,Me=L===null?E.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:bl,ze=(wt.isMeshStandardMaterial?_t:st).get(wt.envMap||Re),Ye=wt.vertexColors===!0&&!!Nt.attributes.color&&Nt.attributes.color.itemSize===4,De=!!Nt.attributes.tangent&&(!!wt.normalMap||wt.anisotropy>0),Ue=!!Nt.morphAttributes.position,Qn=!!Nt.morphAttributes.normal,kn=!!Nt.morphAttributes.color;let qi=jc;wt.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(qi=E.toneMapping);const Rr=Nt.morphAttributes.position||Nt.morphAttributes.normal||Nt.morphAttributes.color,Qe=Rr!==void 0?Rr.length:0,Ve=qt.get(wt),js=y.state.lights;if(Wt===!0&&(be===!0||X!==D)){const kr=X===D&&wt.id===P;ht.setState(wt,X,kr)}let yi=!1;wt.version===Ve.__version?(Ve.needsLights&&Ve.lightsStateVersion!==js.state.version||Ve.outputColorSpace!==Me||Ft.isInstancedMesh&&Ve.instancing===!1||!Ft.isInstancedMesh&&Ve.instancing===!0||Ft.isSkinnedMesh&&Ve.skinning===!1||!Ft.isSkinnedMesh&&Ve.skinning===!0||Ve.envMap!==ze||wt.fog===!0&&Ve.fog!==fe||Ve.numClippingPlanes!==void 0&&(Ve.numClippingPlanes!==ht.numPlanes||Ve.numIntersection!==ht.numIntersection)||Ve.vertexAlphas!==Ye||Ve.vertexTangents!==De||Ve.morphTargets!==Ue||Ve.morphNormals!==Qn||Ve.morphColors!==kn||Ve.toneMapping!==qi||ft.isWebGL2===!0&&Ve.morphTargetsCount!==Qe)&&(yi=!0):(yi=!0,Ve.__version=wt.version);let oi=Ve.currentProgram;yi===!0&&(oi=Tl(wt,At,Ft));let Ni=!1,wa=!1,jo=!1;const ai=oi.getUniforms(),Ps=Ve.uniforms;if(kt.useProgram(oi.program)&&(Ni=!0,wa=!0,jo=!0),wt.id!==P&&(P=wt.id,wa=!0),Ni||D!==X){if(ai.setValue(J,"projectionMatrix",X.projectionMatrix),ft.logarithmicDepthBuffer&&ai.setValue(J,"logDepthBufFC",2/(Math.log(X.far+1)/Math.LN2)),D!==X&&(D=X,wa=!0,jo=!0),wt.isShaderMaterial||wt.isMeshPhongMaterial||wt.isMeshToonMaterial||wt.isMeshStandardMaterial||wt.envMap){const kr=ai.map.cameraPosition;kr!==void 0&&kr.setValue(J,ce.setFromMatrixPosition(X.matrixWorld))}(wt.isMeshPhongMaterial||wt.isMeshToonMaterial||wt.isMeshLambertMaterial||wt.isMeshBasicMaterial||wt.isMeshStandardMaterial||wt.isShaderMaterial)&&ai.setValue(J,"isOrthographic",X.isOrthographicCamera===!0),(wt.isMeshPhongMaterial||wt.isMeshToonMaterial||wt.isMeshLambertMaterial||wt.isMeshBasicMaterial||wt.isMeshStandardMaterial||wt.isShaderMaterial||wt.isShadowMaterial||Ft.isSkinnedMesh)&&ai.setValue(J,"viewMatrix",X.matrixWorldInverse)}if(Ft.isSkinnedMesh){ai.setOptional(J,Ft,"bindMatrix"),ai.setOptional(J,Ft,"bindMatrixInverse");const kr=Ft.skeleton;kr&&(ft.floatVertexTextures?(kr.boneTexture===null&&kr.computeBoneTexture(),ai.setValue(J,"boneTexture",kr.boneTexture,ot),ai.setValue(J,"boneTextureSize",kr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Xo=Nt.morphAttributes;if((Xo.position!==void 0||Xo.normal!==void 0||Xo.color!==void 0&&ft.isWebGL2===!0)&&Ut.update(Ft,Nt,oi),(wa||Ve.receiveShadow!==Ft.receiveShadow)&&(Ve.receiveShadow=Ft.receiveShadow,ai.setValue(J,"receiveShadow",Ft.receiveShadow)),wt.isMeshGouraudMaterial&&wt.envMap!==null&&(Ps.envMap.value=ze,Ps.flipEnvMap.value=ze.isCubeTexture&&ze.isRenderTargetTexture===!1?-1:1),wa&&(ai.setValue(J,"toneMappingExposure",E.toneMappingExposure),Ve.needsLights&&Al(Ps,jo),fe&&wt.fog===!0&&Kt.refreshFogUniforms(Ps,fe),Kt.refreshMaterialUniforms(Ps,wt,Q,nt,re),Db.upload(J,Ve.uniformsList,Ps,ot)),wt.isShaderMaterial&&wt.uniformsNeedUpdate===!0&&(Db.upload(J,Ve.uniformsList,Ps,ot),wt.uniformsNeedUpdate=!1),wt.isSpriteMaterial&&ai.setValue(J,"center",Ft.center),ai.setValue(J,"modelViewMatrix",Ft.modelViewMatrix),ai.setValue(J,"normalMatrix",Ft.normalMatrix),ai.setValue(J,"modelMatrix",Ft.matrixWorld),wt.isShaderMaterial||wt.isRawShaderMaterial){const kr=wt.uniformsGroups;for(let Xa=0,uc=kr.length;Xa<uc;Xa++)if(ft.isWebGL2){const Sa=kr[Xa];Ze.update(Sa,oi),Ze.bind(Sa,oi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return oi}function Al(X,At){X.ambientLightColor.needsUpdate=At,X.lightProbe.needsUpdate=At,X.directionalLights.needsUpdate=At,X.directionalLightShadows.needsUpdate=At,X.pointLights.needsUpdate=At,X.pointLightShadows.needsUpdate=At,X.spotLights.needsUpdate=At,X.spotLightShadows.needsUpdate=At,X.rectAreaLights.needsUpdate=At,X.hemisphereLights.needsUpdate=At}function vr(X){return X.isMeshLambertMaterial||X.isMeshToonMaterial||X.isMeshPhongMaterial||X.isMeshStandardMaterial||X.isShadowMaterial||X.isShaderMaterial&&X.lights===!0}this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return O},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(X,At,Nt){qt.get(X.texture).__webglTexture=At,qt.get(X.depthTexture).__webglTexture=Nt;const wt=qt.get(X);wt.__hasExternalTextures=!0,wt.__hasExternalTextures&&(wt.__autoAllocateDepthBuffer=Nt===void 0,wt.__autoAllocateDepthBuffer||et.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),wt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(X,At){const Nt=qt.get(X);Nt.__webglFramebuffer=At,Nt.__useDefaultFramebuffer=At===void 0},this.setRenderTarget=function(X,At=0,Nt=0){L=X,R=At,O=Nt;let wt=!0,Ft=null,fe=!1,Re=!1;if(X){const ze=qt.get(X);ze.__useDefaultFramebuffer!==void 0?(kt.bindFramebuffer(J.FRAMEBUFFER,null),wt=!1):ze.__webglFramebuffer===void 0?ot.setupRenderTarget(X):ze.__hasExternalTextures&&ot.rebindTextures(X,qt.get(X.texture).__webglTexture,qt.get(X.depthTexture).__webglTexture);const Ye=X.texture;(Ye.isData3DTexture||Ye.isDataArrayTexture||Ye.isCompressedArrayTexture)&&(Re=!0);const De=qt.get(X).__webglFramebuffer;X.isWebGLCubeRenderTarget?(Ft=De[At],fe=!0):ft.isWebGL2&&X.samples>0&&ot.useMultisampledRTT(X)===!1?Ft=qt.get(X).__webglMultisampledFramebuffer:Ft=De,V.copy(X.viewport),K.copy(X.scissor),W=X.scissorTest}else V.copy(dt).multiplyScalar(Q).floor(),K.copy(Rt).multiplyScalar(Q).floor(),W=Jt;if(kt.bindFramebuffer(J.FRAMEBUFFER,Ft)&&ft.drawBuffers&&wt&&kt.drawBuffers(X,Ft),kt.viewport(V),kt.scissor(K),kt.setScissorTest(W),fe){const ze=qt.get(X.texture);J.framebufferTexture2D(J.FRAMEBUFFER,J.COLOR_ATTACHMENT0,J.TEXTURE_CUBE_MAP_POSITIVE_X+At,ze.__webglTexture,Nt)}else if(Re){const ze=qt.get(X.texture),Ye=At||0;J.framebufferTextureLayer(J.FRAMEBUFFER,J.COLOR_ATTACHMENT0,ze.__webglTexture,Nt||0,Ye)}P=-1},this.readRenderTargetPixels=function(X,At,Nt,wt,Ft,fe,Re){if(!(X&&X.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Me=qt.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&Re!==void 0&&(Me=Me[Re]),Me){kt.bindFramebuffer(J.FRAMEBUFFER,Me);try{const ze=X.texture,Ye=ze.format,De=ze.type;if(Ye!==Es&&ae.convert(Ye)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Ue=De===gf&&(et.has("EXT_color_buffer_half_float")||ft.isWebGL2&&et.has("EXT_color_buffer_float"));if(De!==lo&&ae.convert(De)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_TYPE)&&!(De===Hr&&(ft.isWebGL2||et.has("OES_texture_float")||et.has("WEBGL_color_buffer_float")))&&!Ue){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}At>=0&&At<=X.width-wt&&Nt>=0&&Nt<=X.height-Ft&&J.readPixels(At,Nt,wt,Ft,ae.convert(Ye),ae.convert(De),fe)}finally{const ze=L!==null?qt.get(L).__webglFramebuffer:null;kt.bindFramebuffer(J.FRAMEBUFFER,ze)}}},this.copyFramebufferToTexture=function(X,At,Nt=0){const wt=Math.pow(2,-Nt),Ft=Math.floor(At.image.width*wt),fe=Math.floor(At.image.height*wt);ot.setTexture2D(At,0),J.copyTexSubImage2D(J.TEXTURE_2D,Nt,0,0,X.x,X.y,Ft,fe),kt.unbindTexture()},this.copyTextureToTexture=function(X,At,Nt,wt=0){const Ft=At.image.width,fe=At.image.height,Re=ae.convert(Nt.format),Me=ae.convert(Nt.type);ot.setTexture2D(Nt,0),J.pixelStorei(J.UNPACK_FLIP_Y_WEBGL,Nt.flipY),J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Nt.premultiplyAlpha),J.pixelStorei(J.UNPACK_ALIGNMENT,Nt.unpackAlignment),At.isDataTexture?J.texSubImage2D(J.TEXTURE_2D,wt,X.x,X.y,Ft,fe,Re,Me,At.image.data):At.isCompressedTexture?J.compressedTexSubImage2D(J.TEXTURE_2D,wt,X.x,X.y,At.mipmaps[0].width,At.mipmaps[0].height,Re,At.mipmaps[0].data):J.texSubImage2D(J.TEXTURE_2D,wt,X.x,X.y,Re,Me,At.image),wt===0&&Nt.generateMipmaps&&J.generateMipmap(J.TEXTURE_2D),kt.unbindTexture()},this.copyTextureToTexture3D=function(X,At,Nt,wt,Ft=0){if(E.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const fe=X.max.x-X.min.x+1,Re=X.max.y-X.min.y+1,Me=X.max.z-X.min.z+1,ze=ae.convert(wt.format),Ye=ae.convert(wt.type);let De;if(wt.isData3DTexture)ot.setTexture3D(wt,0),De=J.TEXTURE_3D;else if(wt.isDataArrayTexture)ot.setTexture2DArray(wt,0),De=J.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}J.pixelStorei(J.UNPACK_FLIP_Y_WEBGL,wt.flipY),J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,wt.premultiplyAlpha),J.pixelStorei(J.UNPACK_ALIGNMENT,wt.unpackAlignment);const Ue=J.getParameter(J.UNPACK_ROW_LENGTH),Qn=J.getParameter(J.UNPACK_IMAGE_HEIGHT),kn=J.getParameter(J.UNPACK_SKIP_PIXELS),qi=J.getParameter(J.UNPACK_SKIP_ROWS),Rr=J.getParameter(J.UNPACK_SKIP_IMAGES),Qe=Nt.isCompressedTexture?Nt.mipmaps[0]:Nt.image;J.pixelStorei(J.UNPACK_ROW_LENGTH,Qe.width),J.pixelStorei(J.UNPACK_IMAGE_HEIGHT,Qe.height),J.pixelStorei(J.UNPACK_SKIP_PIXELS,X.min.x),J.pixelStorei(J.UNPACK_SKIP_ROWS,X.min.y),J.pixelStorei(J.UNPACK_SKIP_IMAGES,X.min.z),Nt.isDataTexture||Nt.isData3DTexture?J.texSubImage3D(De,Ft,At.x,At.y,At.z,fe,Re,Me,ze,Ye,Qe.data):Nt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),J.compressedTexSubImage3D(De,Ft,At.x,At.y,At.z,fe,Re,Me,ze,Qe.data)):J.texSubImage3D(De,Ft,At.x,At.y,At.z,fe,Re,Me,ze,Ye,Qe),J.pixelStorei(J.UNPACK_ROW_LENGTH,Ue),J.pixelStorei(J.UNPACK_IMAGE_HEIGHT,Qn),J.pixelStorei(J.UNPACK_SKIP_PIXELS,kn),J.pixelStorei(J.UNPACK_SKIP_ROWS,qi),J.pixelStorei(J.UNPACK_SKIP_IMAGES,Rr),Ft===0&&wt.generateMipmaps&&J.generateMipmap(De),kt.unbindTexture()},this.initTexture=function(X){X.isCubeTexture?ot.setTextureCube(X,0):X.isData3DTexture?ot.setTexture3D(X,0):X.isDataArrayTexture||X.isCompressedArrayTexture?ot.setTexture2DArray(X,0):ot.setTexture2D(X,0),kt.unbindTexture()},this.resetState=function(){R=0,O=0,L=null,kt.reset(),xe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return $l}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(t){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!t}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===cn?Xc:Fg}set outputEncoding(t){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=t===Xc?cn:bl}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(t){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=t}}class kE extends RE{}kE.prototype.isWebGL1Renderer=!0;class By{constructor(t,e=25e-5){this.isFogExp2=!0,this.name="",this.color=new me(t),this.density=e}clone(){return new By(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Hy{constructor(t,e=1,n=1e3){this.isFog=!0,this.name="",this.color=new me(t),this.near=e,this.far=n}clone(){return new Hy(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}let Hf=class extends qn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e}};class $y{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=Vg,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ga()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,s=this.stride;r<s;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ga()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ga()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const no=new Y;class Ad{constructor(t,e,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)no.fromBufferAttribute(this,e),no.applyMatrix4(t),this.setXYZ(e,no.x,no.y,no.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)no.fromBufferAttribute(this,e),no.applyNormalMatrix(t),this.setXYZ(e,no.x,no.y,no.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)no.fromBufferAttribute(this,e),no.transformDirection(t),this.setXYZ(e,no.x,no.y,no.z);return this}setX(t,e){return this.normalized&&(e=bn(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=bn(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=bn(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=bn(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=fa(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=fa(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=fa(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=fa(e,this.array)),e}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array),r=bn(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,s){return t=t*this.data.stride+this.offset,this.normalized&&(e=bn(e,this.array),n=bn(n,this.array),r=bn(r,this.array),s=bn(s,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=s,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)e.push(this.data.array[r+s])}return new tn(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Ad(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)e.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class LE extends Hs{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new me(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let zp;const Bm=new Y,Up=new Y,Fp=new Y,Vp=new Vt,Hm=new Vt,uI=new rn,L0=new Y,$m=new Y,O0=new Y,M2=new Vt,rS=new Vt,C2=new Vt;let hI=class extends qn{constructor(t){if(super(),this.isSprite=!0,this.type="Sprite",zp===void 0){zp=new fn;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new $y(e,5);zp.setIndex([0,1,2,0,2,3]),zp.setAttribute("position",new Ad(n,3,0,!1)),zp.setAttribute("uv",new Ad(n,2,3,!1))}this.geometry=zp,this.material=t!==void 0?t:new LE,this.center=new Vt(.5,.5)}raycast(t,e){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Up.setFromMatrixScale(this.matrixWorld),uI.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Fp.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Up.multiplyScalar(-Fp.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;D0(L0.set(-.5,-.5,0),Fp,o,Up,r,s),D0($m.set(.5,-.5,0),Fp,o,Up,r,s),D0(O0.set(.5,.5,0),Fp,o,Up,r,s),M2.set(0,0),rS.set(1,0),C2.set(1,1);let a=t.ray.intersectTriangle(L0,$m,O0,!1,Bm);if(a===null&&(D0($m.set(-.5,.5,0),Fp,o,Up,r,s),rS.set(0,1),a=t.ray.intersectTriangle(L0,O0,$m,!1,Bm),a===null))return;const l=t.ray.origin.distanceTo(Bm);l<t.near||l>t.far||e.push({distance:l,point:Bm.clone(),uv:Po.getInterpolation(Bm,L0,$m,O0,M2,rS,C2,new Vt),face:null,object:this})}copy(t,e){return super.copy(t,e),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}};function D0(i,t,e,n,r,s){Vp.subVectors(i,e).addScalar(.5).multiply(n),r!==void 0?(Hm.x=s*Vp.x-r*Vp.y,Hm.y=r*Vp.x+s*Vp.y):Hm.copy(Vp),i.copy(t),i.x+=Hm.x,i.y+=Hm.y,i.applyMatrix4(uI)}const I0=new Y,E2=new Y;class dI extends qn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let n=0,r=e.length;n<r;n++){const s=e[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,e=0,n=0){e=Math.abs(e);const r=this.levels;let s;for(s=0;s<r.length&&!(e<r[s].distance);s++);return r.splice(s,0,{distance:e,hysteresis:n,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r;n++){let s=e[n].distance;if(e[n].object.visible&&(s-=s*e[n].hysteresis),t<s)break}return e[n-1].object}return null}raycast(t,e){if(this.levels.length>0){I0.setFromMatrixPosition(this.matrixWorld);const r=t.ray.origin.distanceTo(I0);this.getObjectForDistance(r).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){I0.setFromMatrixPosition(t.matrixWorld),E2.setFromMatrixPosition(this.matrixWorld);const n=I0.distanceTo(E2)/t.zoom;e[0].object.visible=!0;let r,s;for(r=1,s=e.length;r<s;r++){let o=e[r].distance;if(e[r].object.visible&&(o-=o*e[r].hysteresis),n>=o)e[r-1].object.visible=!1,e[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)e[r].object.visible=!1}}toJSON(t){const e=super.toJSON(t);this.autoUpdate===!1&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return e}}const T2=new Y,A2=new Vn,P2=new Vn,tX=new Y,R2=new rn,Bp=new Y,sS=new wl,k2=new rn,oS=new Fd;class pI extends fi{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new rn,this.bindMatrixInverse=new rn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;this.boundingBox===null&&(this.boundingBox=new sc),this.boundingBox.makeEmpty();const e=t.getAttribute("position");for(let n=0;n<e.count;n++)Bp.fromBufferAttribute(e,n),this.applyBoneTransform(n,Bp),this.boundingBox.expandByPoint(Bp)}computeBoundingSphere(){const t=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new wl),this.boundingSphere.makeEmpty();const e=t.getAttribute("position");for(let n=0;n<e.count;n++)Bp.fromBufferAttribute(e,n),this.applyBoneTransform(n,Bp),this.boundingSphere.expandByPoint(Bp)}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}raycast(t,e){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),sS.copy(this.boundingSphere),sS.applyMatrix4(r),t.ray.intersectsSphere(sS)!==!1&&(k2.copy(r).invert(),oS.copy(t.ray).applyMatrix4(k2),!(this.boundingBox!==null&&oS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(t,e,oS)))}getVertexPosition(t,e){return super.getVertexPosition(t,e),this.applyBoneTransform(t,e),e}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Vn,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.fromBufferAttribute(e,n);const s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(t,e){const n=this.skeleton,r=this.geometry;A2.fromBufferAttribute(r.attributes.skinIndex,t),P2.fromBufferAttribute(r.attributes.skinWeight,t),T2.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let s=0;s<4;s++){const o=P2.getComponent(s);if(o!==0){const a=A2.getComponent(s);R2.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(tX.copy(T2).applyMatrix4(R2),o)}}return e.applyMatrix4(this.bindMatrixInverse)}boneTransform(t,e){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(t,e)}}class OE extends qn{constructor(){super(),this.isBone=!0,this.type="Bone"}}let lf=class extends mr{constructor(t=null,e=1,n=1,r,s,o,a,l,c=si,u=si,h,p){super(null,o,a,l,c,u,r,s,h,p),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const L2=new rn,eX=new rn;class Gy{constructor(t=[],e=[]){this.uuid=ga(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),e.length===0)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new rn)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const n=new rn;this.bones[t]&&n.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const n=this.bones[t];n&&n.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const n=this.bones[t];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=t.length;s<o;s++){const a=t[s]?t[s].matrixWorld:eX;L2.multiplyMatrices(a,e[s]),L2.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Gy(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=GD(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new lf(e,t,t,Es,Hr);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];if(r.name===t)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){const s=t.bones[n];let o=e[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new OE),this.bones.push(o),this.boneInverses.push(new rn().fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,s=e.length;r<s;r++){const o=e[r];t.bones.push(o.uuid);const a=n[r];t.boneInverses.push(a.toArray())}return t}}class bf extends tn{constructor(t,e,n,r=1){super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const Hp=new rn,O2=new rn,N0=[],D2=new sc,nX=new rn,Gm=new fi,qm=new wl;class fI extends fi{constructor(t,e,n){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new bf(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,nX)}computeBoundingBox(){const t=this.geometry,e=this.count;this.boundingBox===null&&(this.boundingBox=new sc),t.boundingBox===null&&t.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<e;n++)this.getMatrixAt(n,Hp),D2.copy(t.boundingBox).applyMatrix4(Hp),this.boundingBox.union(D2)}computeBoundingSphere(){const t=this.geometry,e=this.count;this.boundingSphere===null&&(this.boundingSphere=new wl),t.boundingSphere===null&&t.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<e;n++)this.getMatrixAt(n,Hp),qm.copy(t.boundingSphere).applyMatrix4(Hp),this.boundingSphere.union(qm)}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}getColorAt(t,e){e.fromArray(this.instanceColor.array,t*3)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,t*16)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(Gm.geometry=this.geometry,Gm.material=this.material,Gm.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),qm.copy(this.boundingSphere),qm.applyMatrix4(n),t.ray.intersectsSphere(qm)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Hp),O2.multiplyMatrices(n,Hp),Gm.matrixWorld=O2,Gm.raycast(t,N0);for(let o=0,a=N0.length;o<a;o++){const l=N0[o];l.instanceId=s,l.object=this,e.push(l)}N0.length=0}}setColorAt(t,e){this.instanceColor===null&&(this.instanceColor=new bf(new Float32Array(this.instanceMatrix.count*3),3)),e.toArray(this.instanceColor.array,t*3)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,t*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class po extends Hs{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new me(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const I2=new Y,N2=new Y,z2=new rn,aS=new Fd,z0=new wl;let nh=class extends qn{constructor(t=new fn,e=new po){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const e=t.attributes.position,n=[0];for(let r=1,s=e.count;r<s;r++)I2.fromBufferAttribute(e,r-1),N2.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=I2.distanceTo(N2);t.setAttribute("lineDistance",new Se(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,s=t.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),z0.copy(n.boundingSphere),z0.applyMatrix4(r),z0.radius+=s,t.ray.intersectsSphere(z0)===!1)return;z2.copy(r).invert(),aS.copy(t.ray).applyMatrix4(z2);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new Y,u=new Y,h=new Y,p=new Y,m=this.isLineSegments?2:1,v=n.index,b=n.attributes.position;if(v!==null){const y=Math.max(0,o.start),M=Math.min(v.count,o.start+o.count);for(let S=y,E=M-1;S<E;S+=m){const A=v.getX(S),R=v.getX(S+1);if(c.fromBufferAttribute(b,A),u.fromBufferAttribute(b,R),aS.distanceSqToSegment(c,u,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const L=t.ray.origin.distanceTo(p);L<t.near||L>t.far||e.push({distance:L,point:h.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,o.start),M=Math.min(b.count,o.start+o.count);for(let S=y,E=M-1;S<E;S+=m){if(c.fromBufferAttribute(b,S),u.fromBufferAttribute(b,S+1),aS.distanceSqToSegment(c,u,p,h)>l)continue;p.applyMatrix4(this.matrixWorld);const R=t.ray.origin.distanceTo(p);R<t.near||R>t.far||e.push({distance:R,point:h.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};const U2=new Y,F2=new Y;class oc extends nh{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const e=t.attributes.position,n=[];for(let r=0,s=e.count;r<s;r+=2)U2.fromBufferAttribute(e,r),F2.fromBufferAttribute(e,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+U2.distanceTo(F2);t.setAttribute("lineDistance",new Se(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class mI extends nh{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class DE extends Hs{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new me(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const V2=new rn,YM=new Fd,U0=new wl,F0=new Y;class gI extends qn{constructor(t=new fn,e=new DE){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,s=t.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),U0.copy(n.boundingSphere),U0.applyMatrix4(r),U0.radius+=s,t.ray.intersectsSphere(U0)===!1)return;V2.copy(r).invert(),YM.copy(t.ray).applyMatrix4(V2);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,h=n.attributes.position;if(c!==null){const p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);for(let v=p,_=m;v<_;v++){const b=c.getX(v);F0.fromBufferAttribute(h,b),B2(F0,b,l,r,t,e,this)}}else{const p=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);for(let v=p,_=m;v<_;v++)F0.fromBufferAttribute(h,v),B2(F0,v,l,r,t,e,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function B2(i,t,e,n,r,s,o){const a=YM.distanceSqToPoint(i);if(a<e){const l=new Y;YM.closestPointToPoint(i,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:t,face:null,object:o})}}class iX extends mr{constructor(t,e,n,r,s,o,a,l,c){super(t,e,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Ji,this.magFilter=s!==void 0?s:Ji,this.generateMipmaps=!1;const u=this;function h(){u.needsUpdate=!0,t.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class rX extends mr{constructor(t,e){super({width:t,height:e}),this.isFramebufferTexture=!0,this.magFilter=si,this.minFilter=si,this.generateMipmaps=!1,this.needsUpdate=!0}}class qy extends mr{constructor(t,e,n,r,s,o,a,l,c,u,h,p){super(null,o,a,l,c,u,r,s,h,p),this.isCompressedTexture=!0,this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class sX extends qy{constructor(t,e,n,r,s,o){super(t,e,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=es}}class oX extends qy{constructor(t,e,n){super(void 0,t[0].width,t[0].height,e,n,Zc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=t}}class aX extends mr{constructor(t,e,n,r,s,o,a,l,c){super(t,e,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Sl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),s=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),s+=n.distanceTo(r),e.push(s),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const s=n.length;let o;e?o=e:o=t*n[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);const u=n[r],p=n[r+1]-u,m=(o-u)/p;return(r+m)/(s-1)}getTangent(t,e){let r=t-1e-4,s=t+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=e||(o.isVector2?new Vt:new Y);return l.copy(a).sub(o).normalize(),l}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new Y,r=[],s=[],o=[],a=new Y,l=new rn;for(let m=0;m<=t;m++){const v=m/t;r[m]=this.getTangentAt(v,new Y)}s[0]=new Y,o[0]=new Y;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),p=Math.abs(r[0].z);u<=c&&(c=u,n.set(1,0,0)),h<=c&&(c=h,n.set(0,1,0)),p<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let m=1;m<=t;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();const v=Math.acos(hr(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,v))}o[m].crossVectors(r[m],s[m])}if(e===!0){let m=Math.acos(hr(s[0].dot(s[t]),-1,1));m/=t,r[0].dot(a.crossVectors(s[0],s[t]))>0&&(m=-m);for(let v=1;v<=t;v++)s[v].applyMatrix4(l.makeRotationAxis(r[v],m*v)),o[v].crossVectors(r[v],s[v])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Wy extends Sl{constructor(t=0,e=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(t,e){const n=e||new Vt,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+t*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*u-m*h+this.aX,c=p*h+m*u+this.aY}return n.set(l,c)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class vI extends Wy{constructor(t,e,n,r,s,o){super(t,e,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function IE(){let i=0,t=0,e=0,n=0;function r(s,o,a,l){i=s,t=a,e=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,h){let p=(o-s)/c-(a-s)/(c+u)+(a-o)/u,m=(a-o)/u-(l-o)/(u+h)+(l-a)/h;p*=u,m*=u,r(o,a,p,m)},calc:function(s){const o=s*s,a=o*s;return i+t*s+e*o+n*a}}}const V0=new Y,lS=new IE,cS=new IE,uS=new IE;class _I extends Sl{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new Y){const n=e,r=this.points,s=r.length,o=(s-(this.closed?0:1))*t;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%s]:(V0.subVectors(r[0],r[1]).add(r[0]),c=V0);const h=r[a%s],p=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(V0.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=V0),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let v=Math.pow(c.distanceToSquared(h),m),_=Math.pow(h.distanceToSquared(p),m),b=Math.pow(p.distanceToSquared(u),m);_<1e-4&&(_=1),v<1e-4&&(v=_),b<1e-4&&(b=_),lS.initNonuniformCatmullRom(c.x,h.x,p.x,u.x,v,_,b),cS.initNonuniformCatmullRom(c.y,h.y,p.y,u.y,v,_,b),uS.initNonuniformCatmullRom(c.z,h.z,p.z,u.z,v,_,b)}else this.curveType==="catmullrom"&&(lS.initCatmullRom(c.x,h.x,p.x,u.x,this.tension),cS.initCatmullRom(c.y,h.y,p.y,u.y,this.tension),uS.initCatmullRom(c.z,h.z,p.z,u.z,this.tension));return n.set(lS.calc(l),cS.calc(l),uS.calc(l)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new Y().fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function H2(i,t,e,n,r){const s=(n-t)*.5,o=(r-e)*.5,a=i*i,l=i*a;return(2*e-2*n+s+o)*l+(-3*e+3*n-2*s-o)*a+s*i+e}function lX(i,t){const e=1-i;return e*e*t}function cX(i,t){return 2*(1-i)*i*t}function uX(i,t){return i*i*t}function Eg(i,t,e,n){return lX(i,t)+cX(i,e)+uX(i,n)}function hX(i,t){const e=1-i;return e*e*e*t}function dX(i,t){const e=1-i;return 3*e*e*i*t}function pX(i,t){return 3*(1-i)*i*i*t}function fX(i,t){return i*i*i*t}function Tg(i,t,e,n,r){return hX(i,t)+dX(i,e)+pX(i,n)+fX(i,r)}class NE extends Sl{constructor(t=new Vt,e=new Vt,n=new Vt,r=new Vt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new Vt){const n=e,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Tg(t,r.x,s.x,o.x,a.x),Tg(t,r.y,s.y,o.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class bI extends Sl{constructor(t=new Y,e=new Y,n=new Y,r=new Y){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new Y){const n=e,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Tg(t,r.x,s.x,o.x,a.x),Tg(t,r.y,s.y,o.y,a.y),Tg(t,r.z,s.z,o.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class jy extends Sl{constructor(t=new Vt,e=new Vt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Vt){const n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Vt){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class yI extends Sl{constructor(t=new Y,e=new Y){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new Y){const n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Y){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class zE extends Sl{constructor(t=new Vt,e=new Vt,n=new Vt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Vt){const n=e,r=this.v0,s=this.v1,o=this.v2;return n.set(Eg(t,r.x,s.x,o.x),Eg(t,r.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class UE extends Sl{constructor(t=new Y,e=new Y,n=new Y){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Y){const n=e,r=this.v0,s=this.v1,o=this.v2;return n.set(Eg(t,r.x,s.x,o.x),Eg(t,r.y,s.y,o.y),Eg(t,r.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class FE extends Sl{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new Vt){const n=e,r=this.points,s=(r.length-1)*t,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return n.set(H2(a,l.x,c.x,u.x,h.x),H2(a,l.y,c.y,u.y,h.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new Vt().fromArray(r))}return this}}var VE=Object.freeze({__proto__:null,ArcCurve:vI,CatmullRomCurve3:_I,CubicBezierCurve:NE,CubicBezierCurve3:bI,EllipseCurve:Wy,LineCurve:jy,LineCurve3:yI,QuadraticBezierCurve:zE,QuadraticBezierCurve3:UE,SplineCurve:FE});class xI extends Sl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new jy(e,t))}getPoint(t,e){const n=t*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,e)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?t*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];n&&n.equals(u)||(e.push(u),n=u)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const r=this.curves[e];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(new VE[r.type]().fromJSON(r))}return this}}class $g extends xI{constructor(t){super(),this.type="Path",this.currentPoint=new Vt,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new jy(this.currentPoint.clone(),new Vt(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const s=new zE(this.currentPoint.clone(),new Vt(t,e),new Vt(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,s,o){const a=new NE(this.currentPoint.clone(),new Vt(t,e),new Vt(n,r),new Vt(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new FE(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+a,e+l,n,r,s,o),this}absarc(t,e,n,r,s,o){return this.absellipse(t,e,n,n,r,s,o),this}ellipse(t,e,n,r,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+c,e+u,n,r,s,o,a,l),this}absellipse(t,e,n,r,s,o,a,l){const c=new Wy(t,e,n,r,s,o,a,l);if(this.curves.length>0){const h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Sv extends fn{constructor(t=[new Vt(0,-.5),new Vt(.5,0),new Vt(0,.5)],e=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e),r=hr(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/e,h=new Y,p=new Vt,m=new Y,v=new Y,_=new Y;let b=0,y=0;for(let M=0;M<=t.length-1;M++)switch(M){case 0:b=t[M+1].x-t[M].x,y=t[M+1].y-t[M].y,m.x=y*1,m.y=-b,m.z=y*0,_.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case t.length-1:l.push(_.x,_.y,_.z);break;default:b=t[M+1].x-t[M].x,y=t[M+1].y-t[M].y,m.x=y*1,m.y=-b,m.z=y*0,v.copy(m),m.x+=_.x,m.y+=_.y,m.z+=_.z,m.normalize(),l.push(m.x,m.y,m.z),_.copy(v)}for(let M=0;M<=e;M++){const S=n+M*u*r,E=Math.sin(S),A=Math.cos(S);for(let R=0;R<=t.length-1;R++){h.x=t[R].x*E,h.y=t[R].y,h.z=t[R].x*A,o.push(h.x,h.y,h.z),p.x=M/e,p.y=R/(t.length-1),a.push(p.x,p.y);const O=l[3*R+0]*E,L=l[3*R+1],P=l[3*R+0]*A;c.push(O,L,P)}}for(let M=0;M<e;M++)for(let S=0;S<t.length-1;S++){const E=S+M*t.length,A=E,R=E+t.length,O=E+t.length+1,L=E+1;s.push(A,R,L),s.push(O,L,R)}this.setIndex(s),this.setAttribute("position",new Se(o,3)),this.setAttribute("uv",new Se(a,2)),this.setAttribute("normal",new Se(c,3))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Sv(t.points,t.segments,t.phiStart,t.phiLength)}}class Xy extends Sv{constructor(t=1,e=1,n=4,r=8){const s=new $g;s.absarc(0,-e/2,t,Math.PI*1.5,0),s.absarc(0,e/2,t,0,Math.PI*.5),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:t,length:e,capSegments:n,radialSegments:r}}static fromJSON(t){return new Xy(t.radius,t.length,t.capSegments,t.radialSegments)}}class Yy extends fn{constructor(t=1,e=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},e=Math.max(3,e);const s=[],o=[],a=[],l=[],c=new Y,u=new Vt;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,p=3;h<=e;h++,p+=3){const m=n+h/e*r;c.x=t*Math.cos(m),c.y=t*Math.sin(m),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[p]/t+1)/2,u.y=(o[p+1]/t+1)/2,l.push(u.x,u.y)}for(let h=1;h<=e;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new Se(o,3)),this.setAttribute("normal",new Se(a,3)),this.setAttribute("uv",new Se(l,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Yy(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class $f extends fn{constructor(t=1,e=1,n=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],p=[],m=[];let v=0;const _=[],b=n/2;let y=0;M(),o===!1&&(t>0&&S(!0),e>0&&S(!1)),this.setIndex(u),this.setAttribute("position",new Se(h,3)),this.setAttribute("normal",new Se(p,3)),this.setAttribute("uv",new Se(m,2));function M(){const E=new Y,A=new Y;let R=0;const O=(e-t)/n;for(let L=0;L<=s;L++){const P=[],D=L/s,V=D*(e-t)+t;for(let K=0;K<=r;K++){const W=K/r,Z=W*l+a,z=Math.sin(Z),ut=Math.cos(Z);A.x=V*z,A.y=-D*n+b,A.z=V*ut,h.push(A.x,A.y,A.z),E.set(z,O,ut).normalize(),p.push(E.x,E.y,E.z),m.push(W,1-D),P.push(v++)}_.push(P)}for(let L=0;L<r;L++)for(let P=0;P<s;P++){const D=_[P][L],V=_[P+1][L],K=_[P+1][L+1],W=_[P][L+1];u.push(D,V,W),u.push(V,K,W),R+=6}c.addGroup(y,R,0),y+=R}function S(E){const A=v,R=new Vt,O=new Y;let L=0;const P=E===!0?t:e,D=E===!0?1:-1;for(let K=1;K<=r;K++)h.push(0,b*D,0),p.push(0,D,0),m.push(.5,.5),v++;const V=v;for(let K=0;K<=r;K++){const Z=K/r*l+a,z=Math.cos(Z),ut=Math.sin(Z);O.x=P*ut,O.y=b*D,O.z=P*z,h.push(O.x,O.y,O.z),p.push(0,D,0),R.x=z*.5+.5,R.y=ut*.5*D+.5,m.push(R.x,R.y),v++}for(let K=0;K<r;K++){const W=A+K,Z=V+K;E===!0?u.push(Z,Z+1,W):u.push(Z+1,Z,W),L+=3}c.addGroup(y,L,E===!0?1:2),y+=L}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new $f(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class Ky extends $f{constructor(t=1,e=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,t,e,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(t){return new Ky(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class gh extends fn{constructor(t=[],e=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r};const s=[],o=[];a(r),c(n),u(),this.setAttribute("position",new Se(s,3)),this.setAttribute("normal",new Se(s.slice(),3)),this.setAttribute("uv",new Se(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(M){const S=new Y,E=new Y,A=new Y;for(let R=0;R<e.length;R+=3)m(e[R+0],S),m(e[R+1],E),m(e[R+2],A),l(S,E,A,M)}function l(M,S,E,A){const R=A+1,O=[];for(let L=0;L<=R;L++){O[L]=[];const P=M.clone().lerp(E,L/R),D=S.clone().lerp(E,L/R),V=R-L;for(let K=0;K<=V;K++)K===0&&L===R?O[L][K]=P:O[L][K]=P.clone().lerp(D,K/V)}for(let L=0;L<R;L++)for(let P=0;P<2*(R-L)-1;P++){const D=Math.floor(P/2);P%2===0?(p(O[L][D+1]),p(O[L+1][D]),p(O[L][D])):(p(O[L][D+1]),p(O[L+1][D+1]),p(O[L+1][D]))}}function c(M){const S=new Y;for(let E=0;E<s.length;E+=3)S.x=s[E+0],S.y=s[E+1],S.z=s[E+2],S.normalize().multiplyScalar(M),s[E+0]=S.x,s[E+1]=S.y,s[E+2]=S.z}function u(){const M=new Y;for(let S=0;S<s.length;S+=3){M.x=s[S+0],M.y=s[S+1],M.z=s[S+2];const E=b(M)/2/Math.PI+.5,A=y(M)/Math.PI+.5;o.push(E,1-A)}v(),h()}function h(){for(let M=0;M<o.length;M+=6){const S=o[M+0],E=o[M+2],A=o[M+4],R=Math.max(S,E,A),O=Math.min(S,E,A);R>.9&&O<.1&&(S<.2&&(o[M+0]+=1),E<.2&&(o[M+2]+=1),A<.2&&(o[M+4]+=1))}}function p(M){s.push(M.x,M.y,M.z)}function m(M,S){const E=M*3;S.x=t[E+0],S.y=t[E+1],S.z=t[E+2]}function v(){const M=new Y,S=new Y,E=new Y,A=new Y,R=new Vt,O=new Vt,L=new Vt;for(let P=0,D=0;P<s.length;P+=9,D+=6){M.set(s[P+0],s[P+1],s[P+2]),S.set(s[P+3],s[P+4],s[P+5]),E.set(s[P+6],s[P+7],s[P+8]),R.set(o[D+0],o[D+1]),O.set(o[D+2],o[D+3]),L.set(o[D+4],o[D+5]),A.copy(M).add(S).add(E).divideScalar(3);const V=b(A);_(R,D+0,M,V),_(O,D+2,S,V),_(L,D+4,E,V)}}function _(M,S,E,A){A<0&&M.x===1&&(o[S]=M.x-1),E.x===0&&E.z===0&&(o[S]=A/2/Math.PI+.5)}function b(M){return Math.atan2(M.z,-M.x)}function y(M){return Math.atan2(-M.y,Math.sqrt(M.x*M.x+M.z*M.z))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new gh(t.vertices,t.indices,t.radius,t.details)}}class Zy extends gh{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Zy(t.radius,t.detail)}}const B0=new Y,H0=new Y,hS=new Y,$0=new Po;class wI extends fn{constructor(t=null,e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},t!==null){const r=Math.pow(10,4),s=Math.cos(bd*e),o=t.getIndex(),a=t.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],h=new Array(3),p={},m=[];for(let v=0;v<l;v+=3){o?(c[0]=o.getX(v),c[1]=o.getX(v+1),c[2]=o.getX(v+2)):(c[0]=v,c[1]=v+1,c[2]=v+2);const{a:_,b,c:y}=$0;if(_.fromBufferAttribute(a,c[0]),b.fromBufferAttribute(a,c[1]),y.fromBufferAttribute(a,c[2]),$0.getNormal(hS),h[0]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[1]=`${Math.round(b.x*r)},${Math.round(b.y*r)},${Math.round(b.z*r)}`,h[2]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let M=0;M<3;M++){const S=(M+1)%3,E=h[M],A=h[S],R=$0[u[M]],O=$0[u[S]],L=`${E}_${A}`,P=`${A}_${E}`;P in p&&p[P]?(hS.dot(p[P].normal)<=s&&(m.push(R.x,R.y,R.z),m.push(O.x,O.y,O.z)),p[P]=null):L in p||(p[L]={index0:c[M],index1:c[S],normal:hS.clone()})}}for(const v in p)if(p[v]){const{index0:_,index1:b}=p[v];B0.fromBufferAttribute(a,_),H0.fromBufferAttribute(a,b),m.push(B0.x,B0.y,B0.z),m.push(H0.x,H0.y,H0.z)}this.setAttribute("position",new Se(m,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}class yd extends $g{constructor(t){super(t),this.uuid=ga(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const r=this.holes[e];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(new $g().fromJSON(r))}return this}}const mX={triangulate:function(i,t,e=2){const n=t&&t.length,r=n?t[0]*e:i.length;let s=SI(i,0,r,e,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,p,m;if(n&&(s=yX(i,t,s,e)),i.length>80*e){a=c=i[0],l=u=i[1];for(let v=e;v<r;v+=e)h=i[v],p=i[v+1],h<a&&(a=h),p<l&&(l=p),h>c&&(c=h),p>u&&(u=p);m=Math.max(c-a,u-l),m=m!==0?32767/m:0}return Gg(s,o,e,a,l,m,0),o}};function SI(i,t,e,n,r){let s,o;if(r===kX(i,t,e,n)>0)for(s=t;s<e;s+=n)o=$2(s,i[s],i[s+1],o);else for(s=e-n;s>=t;s-=n)o=$2(s,i[s],i[s+1],o);return o&&Jy(o,o.next)&&(Wg(o),o=o.next),o}function Pd(i,t){if(!i)return i;t||(t=i);let e=i,n;do if(n=!1,!e.steiner&&(Jy(e,e.next)||Qi(e.prev,e,e.next)===0)){if(Wg(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function Gg(i,t,e,n,r,s,o){if(!i)return;!o&&s&&CX(i,n,r,s);let a=i,l,c;for(;i.prev!==i.next;){if(l=i.prev,c=i.next,s?vX(i,n,r,s):gX(i)){t.push(l.i/e|0),t.push(i.i/e|0),t.push(c.i/e|0),Wg(i),i=c.next,a=c.next;continue}if(i=c,i===a){o?o===1?(i=_X(Pd(i),t,e),Gg(i,t,e,n,r,s,2)):o===2&&bX(i,t,e,n,r,s):Gg(Pd(i),t,e,n,r,s,1);break}}}function gX(i){const t=i.prev,e=i,n=i.next;if(Qi(t,e,n)>=0)return!1;const r=t.x,s=e.x,o=n.x,a=t.y,l=e.y,c=n.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,p=r>s?r>o?r:o:s>o?s:o,m=a>l?a>c?a:c:l>c?l:c;let v=n.next;for(;v!==t;){if(v.x>=u&&v.x<=p&&v.y>=h&&v.y<=m&&Jp(r,a,s,l,o,c,v.x,v.y)&&Qi(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vX(i,t,e,n){const r=i.prev,s=i,o=i.next;if(Qi(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,p=o.y,m=a<l?a<c?a:c:l<c?l:c,v=u<h?u<p?u:p:h<p?h:p,_=a>l?a>c?a:c:l>c?l:c,b=u>h?u>p?u:p:h>p?h:p,y=KM(m,v,t,e,n),M=KM(_,b,t,e,n);let S=i.prevZ,E=i.nextZ;for(;S&&S.z>=y&&E&&E.z<=M;){if(S.x>=m&&S.x<=_&&S.y>=v&&S.y<=b&&S!==r&&S!==o&&Jp(a,u,l,h,c,p,S.x,S.y)&&Qi(S.prev,S,S.next)>=0||(S=S.prevZ,E.x>=m&&E.x<=_&&E.y>=v&&E.y<=b&&E!==r&&E!==o&&Jp(a,u,l,h,c,p,E.x,E.y)&&Qi(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;S&&S.z>=y;){if(S.x>=m&&S.x<=_&&S.y>=v&&S.y<=b&&S!==r&&S!==o&&Jp(a,u,l,h,c,p,S.x,S.y)&&Qi(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;E&&E.z<=M;){if(E.x>=m&&E.x<=_&&E.y>=v&&E.y<=b&&E!==r&&E!==o&&Jp(a,u,l,h,c,p,E.x,E.y)&&Qi(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function _X(i,t,e){let n=i;do{const r=n.prev,s=n.next.next;!Jy(r,s)&&MI(r,n,n.next,s)&&qg(r,s)&&qg(s,r)&&(t.push(r.i/e|0),t.push(n.i/e|0),t.push(s.i/e|0),Wg(n),Wg(n.next),n=i=s),n=n.next}while(n!==i);return Pd(n)}function bX(i,t,e,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&AX(o,a)){let l=CI(o,a);o=Pd(o,o.next),l=Pd(l,l.next),Gg(o,t,e,n,r,s,0),Gg(l,t,e,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function yX(i,t,e,n){const r=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*n,l=s<o-1?t[s+1]*n:i.length,c=SI(i,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(TX(c));for(r.sort(xX),s=0;s<r.length;s++)e=wX(r[s],e);return e}function xX(i,t){return i.x-t.x}function wX(i,t){const e=SX(i,t);if(!e)return t;const n=CI(e,i);return Pd(n,n.next),Pd(e,e.next)}function SX(i,t){let e=t,n=-1/0,r;const s=i.x,o=i.y;do{if(o<=e.y&&o>=e.next.y&&e.next.y!==e.y){const p=e.x+(o-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(p<=s&&p>n&&(n=p,r=e.x<e.next.x?e:e.next,p===s))return r}e=e.next}while(e!==t);if(!r)return null;const a=r,l=r.x,c=r.y;let u=1/0,h;e=r;do s>=e.x&&e.x>=l&&s!==e.x&&Jp(o<c?s:n,o,l,c,o<c?n:s,o,e.x,e.y)&&(h=Math.abs(o-e.y)/(s-e.x),qg(e,i)&&(h<u||h===u&&(e.x>r.x||e.x===r.x&&MX(r,e)))&&(r=e,u=h)),e=e.next;while(e!==a);return r}function MX(i,t){return Qi(i.prev,i,t.prev)<0&&Qi(t.next,i,i.next)<0}function CX(i,t,e,n){let r=i;do r.z===0&&(r.z=KM(r.x,r.y,t,e,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,EX(r)}function EX(i){let t,e,n,r,s,o,a,l,c=1;do{for(e=i,i=null,s=null,o=0;e;){for(o++,n=e,a=0,t=0;t<c&&(a++,n=n.nextZ,!!n);t++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||e.z<=n.z)?(r=e,e=e.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;e=n}s.nextZ=null,c*=2}while(o>1);return i}function KM(i,t,e,n,r){return i=(i-e)*r|0,t=(t-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function TX(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Jp(i,t,e,n,r,s,o,a){return(r-o)*(t-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(e-o)*(t-a)&&(e-o)*(s-a)>=(r-o)*(n-a)}function AX(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!PX(i,t)&&(qg(i,t)&&qg(t,i)&&RX(i,t)&&(Qi(i.prev,i,t.prev)||Qi(i,t.prev,t))||Jy(i,t)&&Qi(i.prev,i,i.next)>0&&Qi(t.prev,t,t.next)>0)}function Qi(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Jy(i,t){return i.x===t.x&&i.y===t.y}function MI(i,t,e,n){const r=q0(Qi(i,t,e)),s=q0(Qi(i,t,n)),o=q0(Qi(e,n,i)),a=q0(Qi(e,n,t));return!!(r!==s&&o!==a||r===0&&G0(i,e,t)||s===0&&G0(i,n,t)||o===0&&G0(e,i,n)||a===0&&G0(e,t,n))}function G0(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function q0(i){return i>0?1:i<0?-1:0}function PX(i,t){let e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&MI(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function qg(i,t){return Qi(i.prev,i,i.next)<0?Qi(i,t,i.next)>=0&&Qi(i,i.prev,t)>=0:Qi(i,t,i.prev)<0||Qi(i,i.next,t)<0}function RX(i,t){let e=i,n=!1;const r=(i.x+t.x)/2,s=(i.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&r<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==i);return n}function CI(i,t){const e=new ZM(i.i,i.x,i.y),n=new ZM(t.i,t.x,t.y),r=i.next,s=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,s.next=n,n.prev=s,n}function $2(i,t,e,n){const r=new ZM(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Wg(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ZM(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function kX(i,t,e,n){let r=0;for(let s=t,o=e-n;s<e;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}class Yl{static area(t){const e=t.length;let n=0;for(let r=e-1,s=0;s<e;r=s++)n+=t[r].x*t[s].y-t[s].x*t[r].y;return n*.5}static isClockWise(t){return Yl.area(t)<0}static triangulateShape(t,e){const n=[],r=[],s=[];G2(t),q2(n,t);let o=t.length;e.forEach(G2);for(let l=0;l<e.length;l++)r.push(o),o+=e[l].length,q2(n,e[l]);const a=mX.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function G2(i){const t=i.length;t>2&&i[t-1].equals(i[0])&&i.pop()}function q2(i,t){for(let e=0;e<t.length;e++)i.push(t[e].x),i.push(t[e].y)}class Qy extends fn{constructor(t=new yd([new Vt(.5,.5),new Vt(-.5,.5),new Vt(-.5,-.5),new Vt(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],s=[];for(let a=0,l=t.length;a<l;a++){const c=t[a];o(c)}this.setAttribute("position",new Se(r,3)),this.setAttribute("uv",new Se(s,2)),this.computeVertexNormals();function o(a){const l=[],c=e.curveSegments!==void 0?e.curveSegments:12,u=e.steps!==void 0?e.steps:1,h=e.depth!==void 0?e.depth:1;let p=e.bevelEnabled!==void 0?e.bevelEnabled:!0,m=e.bevelThickness!==void 0?e.bevelThickness:.2,v=e.bevelSize!==void 0?e.bevelSize:m-.1,_=e.bevelOffset!==void 0?e.bevelOffset:0,b=e.bevelSegments!==void 0?e.bevelSegments:3;const y=e.extrudePath,M=e.UVGenerator!==void 0?e.UVGenerator:LX;let S,E=!1,A,R,O,L;y&&(S=y.getSpacedPoints(u),E=!0,p=!1,A=y.computeFrenetFrames(u,!1),R=new Y,O=new Y,L=new Y),p||(b=0,m=0,v=0,_=0);const P=a.extractPoints(c);let D=P.shape;const V=P.holes;if(!Yl.isClockWise(D)){D=D.reverse();for(let Gt=0,J=V.length;Gt<J;Gt++){const $t=V[Gt];Yl.isClockWise($t)&&(V[Gt]=$t.reverse())}}const W=Yl.triangulateShape(D,V),Z=D;for(let Gt=0,J=V.length;Gt<J;Gt++){const $t=V[Gt];D=D.concat($t)}function z(Gt,J,$t){return J||console.error("THREE.ExtrudeGeometry: vec does not exist"),Gt.clone().addScaledVector(J,$t)}const ut=D.length,nt=W.length;function Q(Gt,J,$t){let et,ft,kt;const Qt=Gt.x-J.x,qt=Gt.y-J.y,ot=$t.x-Gt.x,st=$t.y-Gt.y,_t=Qt*Qt+qt*qt,$=Qt*st-qt*ot;if(Math.abs($)>Number.EPSILON){const B=Math.sqrt(_t),Lt=Math.sqrt(ot*ot+st*st),jt=J.x-qt/B,Kt=J.y+Qt/B,se=$t.x-st/Lt,we=$t.y+ot/Lt,ht=((se-jt)*st-(we-Kt)*ot)/(Qt*st-qt*ot);et=jt+Qt*ht-Gt.x,ft=Kt+qt*ht-Gt.y;const mt=et*et+ft*ft;if(mt<=2)return new Vt(et,ft);kt=Math.sqrt(mt/2)}else{let B=!1;Qt>Number.EPSILON?ot>Number.EPSILON&&(B=!0):Qt<-Number.EPSILON?ot<-Number.EPSILON&&(B=!0):Math.sign(qt)===Math.sign(st)&&(B=!0),B?(et=-qt,ft=Qt,kt=Math.sqrt(_t)):(et=Qt,ft=qt,kt=Math.sqrt(_t/2))}return new Vt(et/kt,ft/kt)}const St=[];for(let Gt=0,J=Z.length,$t=J-1,et=Gt+1;Gt<J;Gt++,$t++,et++)$t===J&&($t=0),et===J&&(et=0),St[Gt]=Q(Z[Gt],Z[$t],Z[et]);const Pt=[];let dt,Rt=St.concat();for(let Gt=0,J=V.length;Gt<J;Gt++){const $t=V[Gt];dt=[];for(let et=0,ft=$t.length,kt=ft-1,Qt=et+1;et<ft;et++,kt++,Qt++)kt===ft&&(kt=0),Qt===ft&&(Qt=0),dt[et]=Q($t[et],$t[kt],$t[Qt]);Pt.push(dt),Rt=Rt.concat(dt)}for(let Gt=0;Gt<b;Gt++){const J=Gt/b,$t=m*Math.cos(J*Math.PI/2),et=v*Math.sin(J*Math.PI/2)+_;for(let ft=0,kt=Z.length;ft<kt;ft++){const Qt=z(Z[ft],St[ft],et);re(Qt.x,Qt.y,-$t)}for(let ft=0,kt=V.length;ft<kt;ft++){const Qt=V[ft];dt=Pt[ft];for(let qt=0,ot=Qt.length;qt<ot;qt++){const st=z(Qt[qt],dt[qt],et);re(st.x,st.y,-$t)}}}const Jt=v+_;for(let Gt=0;Gt<ut;Gt++){const J=p?z(D[Gt],Rt[Gt],Jt):D[Gt];E?(O.copy(A.normals[0]).multiplyScalar(J.x),R.copy(A.binormals[0]).multiplyScalar(J.y),L.copy(S[0]).add(O).add(R),re(L.x,L.y,L.z)):re(J.x,J.y,0)}for(let Gt=1;Gt<=u;Gt++)for(let J=0;J<ut;J++){const $t=p?z(D[J],Rt[J],Jt):D[J];E?(O.copy(A.normals[Gt]).multiplyScalar($t.x),R.copy(A.binormals[Gt]).multiplyScalar($t.y),L.copy(S[Gt]).add(O).add(R),re(L.x,L.y,L.z)):re($t.x,$t.y,h/u*Gt)}for(let Gt=b-1;Gt>=0;Gt--){const J=Gt/b,$t=m*Math.cos(J*Math.PI/2),et=v*Math.sin(J*Math.PI/2)+_;for(let ft=0,kt=Z.length;ft<kt;ft++){const Qt=z(Z[ft],St[ft],et);re(Qt.x,Qt.y,h+$t)}for(let ft=0,kt=V.length;ft<kt;ft++){const Qt=V[ft];dt=Pt[ft];for(let qt=0,ot=Qt.length;qt<ot;qt++){const st=z(Qt[qt],dt[qt],et);E?re(st.x,st.y+S[u-1].y,S[u-1].x+$t):re(st.x,st.y,h+$t)}}}Bt(),Wt();function Bt(){const Gt=r.length/3;if(p){let J=0,$t=ut*J;for(let et=0;et<nt;et++){const ft=W[et];It(ft[2]+$t,ft[1]+$t,ft[0]+$t)}J=u+b*2,$t=ut*J;for(let et=0;et<nt;et++){const ft=W[et];It(ft[0]+$t,ft[1]+$t,ft[2]+$t)}}else{for(let J=0;J<nt;J++){const $t=W[J];It($t[2],$t[1],$t[0])}for(let J=0;J<nt;J++){const $t=W[J];It($t[0]+ut*u,$t[1]+ut*u,$t[2]+ut*u)}}n.addGroup(Gt,r.length/3-Gt,0)}function Wt(){const Gt=r.length/3;let J=0;be(Z,J),J+=Z.length;for(let $t=0,et=V.length;$t<et;$t++){const ft=V[$t];be(ft,J),J+=ft.length}n.addGroup(Gt,r.length/3-Gt,1)}function be(Gt,J){let $t=Gt.length;for(;--$t>=0;){const et=$t;let ft=$t-1;ft<0&&(ft=Gt.length-1);for(let kt=0,Qt=u+b*2;kt<Qt;kt++){const qt=ut*kt,ot=ut*(kt+1),st=J+et+qt,_t=J+ft+qt,$=J+ft+ot,B=J+et+ot;ye(st,_t,$,B)}}}function re(Gt,J,$t){l.push(Gt),l.push(J),l.push($t)}function It(Gt,J,$t){ce(Gt),ce(J),ce($t);const et=r.length/3,ft=M.generateTopUV(n,r,et-3,et-2,et-1);ne(ft[0]),ne(ft[1]),ne(ft[2])}function ye(Gt,J,$t,et){ce(Gt),ce(J),ce(et),ce(J),ce($t),ce(et);const ft=r.length/3,kt=M.generateSideWallUV(n,r,ft-6,ft-3,ft-2,ft-1);ne(kt[0]),ne(kt[1]),ne(kt[3]),ne(kt[1]),ne(kt[2]),ne(kt[3])}function ce(Gt){r.push(l[Gt*3+0]),r.push(l[Gt*3+1]),r.push(l[Gt*3+2])}function ne(Gt){s.push(Gt.x),s.push(Gt.y)}}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,n=this.parameters.options;return OX(e,n,t)}static fromJSON(t,e){const n=[];for(let s=0,o=t.shapes.length;s<o;s++){const a=e[t.shapes[s]];n.push(a)}const r=t.options.extrudePath;return r!==void 0&&(t.options.extrudePath=new VE[r.type]().fromJSON(r)),new Qy(n,t.options)}}const LX={generateTopUV:function(i,t,e,n,r){const s=t[e*3],o=t[e*3+1],a=t[n*3],l=t[n*3+1],c=t[r*3],u=t[r*3+1];return[new Vt(s,o),new Vt(a,l),new Vt(c,u)]},generateSideWallUV:function(i,t,e,n,r,s){const o=t[e*3],a=t[e*3+1],l=t[e*3+2],c=t[n*3],u=t[n*3+1],h=t[n*3+2],p=t[r*3],m=t[r*3+1],v=t[r*3+2],_=t[s*3],b=t[s*3+1],y=t[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new Vt(o,1-l),new Vt(c,1-h),new Vt(p,1-v),new Vt(_,1-y)]:[new Vt(a,1-l),new Vt(u,1-h),new Vt(m,1-v),new Vt(b,1-y)]}};function OX(i,t,e){if(e.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e.options=Object.assign({},t),t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}class tx extends gh{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new tx(t.radius,t.detail)}}class Mv extends gh{constructor(t=1,e=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Mv(t.radius,t.detail)}}class ex extends fn{constructor(t=.5,e=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const a=[],l=[],c=[],u=[];let h=t;const p=(e-t)/r,m=new Y,v=new Vt;for(let _=0;_<=r;_++){for(let b=0;b<=n;b++){const y=s+b/n*o;m.x=h*Math.cos(y),m.y=h*Math.sin(y),l.push(m.x,m.y,m.z),c.push(0,0,1),v.x=(m.x/e+1)/2,v.y=(m.y/e+1)/2,u.push(v.x,v.y)}h+=p}for(let _=0;_<r;_++){const b=_*(n+1);for(let y=0;y<n;y++){const M=y+b,S=M,E=M+n+1,A=M+n+2,R=M+1;a.push(S,E,R),a.push(E,A,R)}}this.setIndex(a),this.setAttribute("position",new Se(l,3)),this.setAttribute("normal",new Se(c,3)),this.setAttribute("uv",new Se(u,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new ex(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class nx extends fn{constructor(t=new yd([new Vt(0,.5),new Vt(-.5,-.5),new Vt(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(t)===!1)c(t);else for(let u=0;u<t.length;u++)c(t[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new Se(r,3)),this.setAttribute("normal",new Se(s,3)),this.setAttribute("uv",new Se(o,2));function c(u){const h=r.length/3,p=u.extractPoints(e);let m=p.shape;const v=p.holes;Yl.isClockWise(m)===!1&&(m=m.reverse());for(let b=0,y=v.length;b<y;b++){const M=v[b];Yl.isClockWise(M)===!0&&(v[b]=M.reverse())}const _=Yl.triangulateShape(m,v);for(let b=0,y=v.length;b<y;b++){const M=v[b];m=m.concat(M)}for(let b=0,y=m.length;b<y;b++){const M=m[b];r.push(M.x,M.y,0),s.push(0,0,1),o.push(M.x,M.y)}for(let b=0,y=_.length;b<y;b++){const M=_[b],S=M[0]+h,E=M[1]+h,A=M[2]+h;n.push(S,E,A),l+=3}}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON(),e=this.parameters.shapes;return DX(e,t)}static fromJSON(t,e){const n=[];for(let r=0,s=t.shapes.length;r<s;r++){const o=e[t.shapes[r]];n.push(o)}return new nx(n,t.curveSegments)}}function DX(i,t){if(t.shapes=[],Array.isArray(i))for(let e=0,n=i.length;e<n;e++){const r=i[e];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t}class Cv extends fn{constructor(t=1,e=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const u=[],h=new Y,p=new Y,m=[],v=[],_=[],b=[];for(let y=0;y<=n;y++){const M=[],S=y/n;let E=0;y===0&&o===0?E=.5/e:y===n&&l===Math.PI&&(E=-.5/e);for(let A=0;A<=e;A++){const R=A/e;h.x=-t*Math.cos(r+R*s)*Math.sin(o+S*a),h.y=t*Math.cos(o+S*a),h.z=t*Math.sin(r+R*s)*Math.sin(o+S*a),v.push(h.x,h.y,h.z),p.copy(h).normalize(),_.push(p.x,p.y,p.z),b.push(R+E,1-S),M.push(c++)}u.push(M)}for(let y=0;y<n;y++)for(let M=0;M<e;M++){const S=u[y][M+1],E=u[y][M],A=u[y+1][M],R=u[y+1][M+1];(y!==0||o>0)&&m.push(S,E,R),(y!==n-1||l<Math.PI)&&m.push(E,A,R)}this.setIndex(m),this.setAttribute("position",new Se(v,3)),this.setAttribute("normal",new Se(_,3)),this.setAttribute("uv",new Se(b,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Cv(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class ix extends gh{constructor(t=1,e=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new ix(t.radius,t.detail)}}class rx extends fn{constructor(t=1,e=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new Y,h=new Y,p=new Y;for(let m=0;m<=n;m++)for(let v=0;v<=r;v++){const _=v/r*s,b=m/n*Math.PI*2;h.x=(t+e*Math.cos(b))*Math.cos(_),h.y=(t+e*Math.cos(b))*Math.sin(_),h.z=e*Math.sin(b),a.push(h.x,h.y,h.z),u.x=t*Math.cos(_),u.y=t*Math.sin(_),p.subVectors(h,u).normalize(),l.push(p.x,p.y,p.z),c.push(v/r),c.push(m/n)}for(let m=1;m<=n;m++)for(let v=1;v<=r;v++){const _=(r+1)*m+v-1,b=(r+1)*(m-1)+v-1,y=(r+1)*(m-1)+v,M=(r+1)*m+v;o.push(_,b,M),o.push(b,y,M)}this.setIndex(o),this.setAttribute("position",new Se(a,3)),this.setAttribute("normal",new Se(l,3)),this.setAttribute("uv",new Se(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new rx(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class sx extends fn{constructor(t=1,e=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],u=[],h=new Y,p=new Y,m=new Y,v=new Y,_=new Y,b=new Y,y=new Y;for(let S=0;S<=n;++S){const E=S/n*s*Math.PI*2;M(E,s,o,t,m),M(E+.01,s,o,t,v),b.subVectors(v,m),y.addVectors(v,m),_.crossVectors(b,y),y.crossVectors(_,b),_.normalize(),y.normalize();for(let A=0;A<=r;++A){const R=A/r*Math.PI*2,O=-e*Math.cos(R),L=e*Math.sin(R);h.x=m.x+(O*y.x+L*_.x),h.y=m.y+(O*y.y+L*_.y),h.z=m.z+(O*y.z+L*_.z),l.push(h.x,h.y,h.z),p.subVectors(h,m).normalize(),c.push(p.x,p.y,p.z),u.push(S/n),u.push(A/r)}}for(let S=1;S<=n;S++)for(let E=1;E<=r;E++){const A=(r+1)*(S-1)+(E-1),R=(r+1)*S+(E-1),O=(r+1)*S+E,L=(r+1)*(S-1)+E;a.push(A,R,L),a.push(R,O,L)}this.setIndex(a),this.setAttribute("position",new Se(l,3)),this.setAttribute("normal",new Se(c,3)),this.setAttribute("uv",new Se(u,2));function M(S,E,A,R,O){const L=Math.cos(S),P=Math.sin(S),D=A/E*S,V=Math.cos(D);O.x=R*(2+V)*.5*L,O.y=R*(2+V)*P*.5,O.z=R*Math.sin(D)*.5}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new sx(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class ox extends fn{constructor(t=new UE(new Y(-1,-1,0),new Y(-1,1,0),new Y(1,1,0)),e=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:s};const o=t.computeFrenetFrames(e,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new Y,l=new Y,c=new Vt;let u=new Y;const h=[],p=[],m=[],v=[];_(),this.setIndex(v),this.setAttribute("position",new Se(h,3)),this.setAttribute("normal",new Se(p,3)),this.setAttribute("uv",new Se(m,2));function _(){for(let S=0;S<e;S++)b(S);b(s===!1?e:0),M(),y()}function b(S){u=t.getPointAt(S/e,u);const E=o.normals[S],A=o.binormals[S];for(let R=0;R<=r;R++){const O=R/r*Math.PI*2,L=Math.sin(O),P=-Math.cos(O);l.x=P*E.x+L*A.x,l.y=P*E.y+L*A.y,l.z=P*E.z+L*A.z,l.normalize(),p.push(l.x,l.y,l.z),a.x=u.x+n*l.x,a.y=u.y+n*l.y,a.z=u.z+n*l.z,h.push(a.x,a.y,a.z)}}function y(){for(let S=1;S<=e;S++)for(let E=1;E<=r;E++){const A=(r+1)*(S-1)+(E-1),R=(r+1)*S+(E-1),O=(r+1)*S+E,L=(r+1)*(S-1)+E;v.push(A,R,L),v.push(R,O,L)}}function M(){for(let S=0;S<=e;S++)for(let E=0;E<=r;E++)c.x=S/e,c.y=E/r,m.push(c.x,c.y)}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new ox(new VE[t.path.type]().fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class EI extends fn{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},t!==null){const e=[],n=new Set,r=new Y,s=new Y;if(t.index!==null){const o=t.attributes.position,a=t.index;let l=t.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const h=l[c],p=h.start,m=h.count;for(let v=p,_=p+m;v<_;v+=3)for(let b=0;b<3;b++){const y=a.getX(v+b),M=a.getX(v+(b+1)%3);r.fromBufferAttribute(o,y),s.fromBufferAttribute(o,M),W2(r,s,n)===!0&&(e.push(r.x,r.y,r.z),e.push(s.x,s.y,s.z))}}}else{const o=t.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,h=3*a+(c+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,h),W2(r,s,n)===!0&&(e.push(r.x,r.y,r.z),e.push(s.x,s.y,s.z))}}this.setAttribute("position",new Se(e,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}function W2(i,t,e){const n=`${i.x},${i.y},${i.z}-${t.x},${t.y},${t.z}`,r=`${t.x},${t.y},${t.z}-${i.x},${i.y},${i.z}`;return e.has(n)===!0||e.has(r)===!0?!1:(e.add(n),e.add(r),!0)}var j2=Object.freeze({__proto__:null,BoxGeometry:Bd,CapsuleGeometry:Xy,CircleGeometry:Yy,ConeGeometry:Ky,CylinderGeometry:$f,DodecahedronGeometry:Zy,EdgesGeometry:wI,ExtrudeGeometry:Qy,IcosahedronGeometry:tx,LatheGeometry:Sv,OctahedronGeometry:Mv,PlaneGeometry:Vf,PolyhedronGeometry:gh,RingGeometry:ex,ShapeGeometry:nx,SphereGeometry:Cv,TetrahedronGeometry:ix,TorusGeometry:rx,TorusKnotGeometry:sx,TubeGeometry:ox,WireframeGeometry:EI});class TI extends Hs{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new me(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class BE extends yl{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class HE extends Hs{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new me(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mh,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class AI extends HE{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return hr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new me(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new me(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new me(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(t)}get anisotropy(){return this._anisotropy}set anisotropy(t){this._anisotropy>0!=t>0&&this.version++,this._anisotropy=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=t.anisotropy,this.anisotropyRotation=t.anisotropyRotation,this.anisotropyMap=t.anisotropyMap,this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class PI extends Hs{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new me(16777215),this.specular=new me(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mh,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class RI extends Hs{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new me(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mh,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class kI extends Hs{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mh,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class LI extends Hs{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new me(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mh,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class OI extends Hs{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new me(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mh,this.normalScale=new Vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class DI extends po{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}function Ua(i,t,e){return $E(i)?new i.constructor(i.subarray(t,e!==void 0?e:i.length)):i.slice(t,e)}function gd(i,t,e){return!i||!e&&i.constructor===t?i:typeof t.BYTES_PER_ELEMENT=="number"?new t(i):Array.prototype.slice.call(i)}function $E(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function II(i){function t(r,s){return i[r]-i[s]}const e=i.length,n=new Array(e);for(let r=0;r!==e;++r)n[r]=r;return n.sort(t),n}function JM(i,t,e){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=e[s]*t;for(let l=0;l!==t;++l)r[o++]=i[a+l]}return r}function GE(i,t,e,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(t.push(s.time),e.push.apply(e,o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(t.push(s.time),o.toArray(e,e.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(t.push(s.time),e.push(o)),s=i[r++];while(s!==void 0)}function IX(i,t,e,n,r=30){const s=i.clone();s.name=t;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),h=[],p=[];for(let m=0;m<c.times.length;++m){const v=c.times[m]*r;if(!(v<e||v>=n)){h.push(c.times[m]);for(let _=0;_<u;++_)p.push(c.values[m*u+_])}}h.length!==0&&(c.times=gd(h,c.times.constructor),c.values=gd(p,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function NX(i,t=0,e=i,n=30){n<=0&&(n=30);const r=e.tracks.length,s=t/n;for(let o=0;o<r;++o){const a=e.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=i.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(c===void 0)continue;let u=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let p=0;const m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=m/3);const v=a.times.length-1;let _;if(s<=a.times[0]){const y=u,M=h-u;_=Ua(a.values,y,M)}else if(s>=a.times[v]){const y=v*h+u,M=y+h-u;_=Ua(a.values,y,M)}else{const y=a.createInterpolant(),M=u,S=h-u;y.evaluate(s),_=Ua(y.resultBuffer,M,S)}l==="quaternion"&&new $r().fromArray(_).normalize().conjugate().toArray(_);const b=c.times.length;for(let y=0;y<b;++y){const M=y*m+p;if(l==="quaternion")$r.multiplyQuaternionsFlat(c.values,M,_,0,c.values,M);else{const S=m-p*2;for(let E=0;E<S;++E)c.values[M+E]-=_[E]}}}return i.blendMode=yE,i}const zX={arraySlice:Ua,convertArray:gd,isTypedArray:$E,getKeyframeOrder:II,sortedArray:JM,flattenJSON:GE,subclip:IX,makeClipAdditive:NX};class Ev{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],s=e[n-1];t:{e:{let o;n:{i:if(!(t<r)){for(let a=n+2;;){if(r===void 0){if(t<s)break i;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=e[++n],t<r)break e}o=e.length;break n}if(!(t>=s)){const a=e[1];t<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=e[--n-1],t>=s)break e}o=n,n=0;break n}break t}for(;n<o;){const a=n+o>>>1;t<e[a]?o=a:n=a+1}if(r=e[n],s=e[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=t*r;for(let o=0;o!==r;++o)e[o]=n[s+o];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class NI extends Ev{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:pd,endingEnd:pd}}intervalChanged_(t,e,n){const r=this.parameterPositions;let s=t-2,o=t+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case fd:s=t,a=2*e-n;break;case Ug:s=r.length-2,a=e+r[s]-r[s+1];break;default:s=t,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case fd:o=t,l=2*n-e;break;case Ug:o=1,l=n+r[1]-r[0];break;default:o=t-1,l=e}const c=(n-e)*.5,u=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(l-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(t,e,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=t*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,p=this._weightPrev,m=this._weightNext,v=(n-e)/(r-e),_=v*v,b=_*v,y=-p*b+2*p*_-p*v,M=(1+p)*b+(-1.5-2*p)*_+(-.5+p)*v+1,S=(-1-m)*b+(1.5+m)*_+.5*v,E=m*b-m*_;for(let A=0;A!==a;++A)s[A]=y*o[u+A]+M*o[c+A]+S*o[l+A]+E*o[h+A];return s}}class qE extends Ev{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=t*a,c=l-a,u=(n-e)/(r-e),h=1-u;for(let p=0;p!==a;++p)s[p]=o[c+p]*h+o[l+p]*u;return s}}class zI extends Ev{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class Ml{constructor(t,e,n,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=gd(e,this.TimeBufferType),this.values=gd(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:gd(t.times,Array),values:gd(t.values,Array)};const r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new zI(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new qE(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new NI(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Ng:e=this.InterpolantFactoryMethodDiscrete;break;case zg:e=this.InterpolantFactoryMethodLinear;break;case Lb:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ng;case this.InterpolantFactoryMethodLinear:return zg;case this.InterpolantFactoryMethodSmooth:return Lb}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(t!==1){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<t;)++s;for(;o!==-1&&n[o]>e;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Ua(n,s,o),this.values=Ua(this.values,s*a,o*a)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),t=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),t=!1;break}o=l}if(r!==void 0&&$E(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),t=!1;break}}return t}optimize(){const t=Ua(this.times),e=Ua(this.values),n=this.getValueSize(),r=this.getInterpolation()===Lb,s=t.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=t[a],u=t[a+1];if(c!==u&&(a!==1||c!==t[0]))if(r)l=!0;else{const h=a*n,p=h-n,m=h+n;for(let v=0;v!==n;++v){const _=e[h+v];if(_!==e[p+v]||_!==e[m+v]){l=!0;break}}}if(l){if(a!==o){t[o]=t[a];const h=a*n,p=o*n;for(let m=0;m!==n;++m)e[p+m]=e[h+m]}++o}}if(s>0){t[o]=t[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)e[l+c]=e[a+c];++o}return o!==t.length?(this.times=Ua(t,0,o),this.values=Ua(e,0,o*n)):(this.times=t,this.values=e),this}clone(){const t=Ua(this.times,0),e=Ua(this.values,0),n=this.constructor,r=new n(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}}Ml.prototype.TimeBufferType=Float32Array;Ml.prototype.ValueBufferType=Float32Array;Ml.prototype.DefaultInterpolation=zg;class Hd extends Ml{}Hd.prototype.ValueTypeName="bool";Hd.prototype.ValueBufferType=Array;Hd.prototype.DefaultInterpolation=Ng;Hd.prototype.InterpolantFactoryMethodLinear=void 0;Hd.prototype.InterpolantFactoryMethodSmooth=void 0;class WE extends Ml{}WE.prototype.ValueTypeName="color";class jg extends Ml{}jg.prototype.ValueTypeName="number";class UI extends Ev{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-e)/(r-e);let c=t*a;for(let u=c+a;c!==u;c+=4)$r.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Gf extends Ml{InterpolantFactoryMethodLinear(t){return new UI(this.times,this.values,this.getValueSize(),t)}}Gf.prototype.ValueTypeName="quaternion";Gf.prototype.DefaultInterpolation=zg;Gf.prototype.InterpolantFactoryMethodSmooth=void 0;class $d extends Ml{}$d.prototype.ValueTypeName="string";$d.prototype.ValueBufferType=Array;$d.prototype.DefaultInterpolation=Ng;$d.prototype.InterpolantFactoryMethodLinear=void 0;$d.prototype.InterpolantFactoryMethodSmooth=void 0;class Xg extends Ml{}Xg.prototype.ValueTypeName="vector";class Yg{constructor(t,e=-1,n,r=Ny){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=ga(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let o=0,a=n.length;o!==a;++o)e.push(FX(n[o]).scale(r));const s=new this(t.name,t.duration,e,t.blendMode);return s.uuid=t.uuid,s}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let s=0,o=n.length;s!==o;++s)e.push(Ml.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const s=e.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=II(l);l=JM(l,1,u),c=JM(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new jg(".morphTargetInfluences["+e[a].name+"]",l,c).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const r=t;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=t.length;a<l;a++){const c=t[a],u=c.name.match(s);if(u&&u.length>1){const h=u[1];let p=r[h];p||(r[h]=p=[]),p.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],e,n));return o}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(h,p,m,v,_){if(m.length!==0){const b=[],y=[];GE(m,b,y,v),b.length!==0&&_.push(new h(p,b,y))}},r=[],s=t.name||"default",o=t.fps||30,a=t.blendMode;let l=t.length||-1;const c=t.hierarchy||[];for(let h=0;h<c.length;h++){const p=c[h].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const m={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let _=0;_<p[v].morphTargets.length;_++)m[p[v].morphTargets[_]]=-1;for(const _ in m){const b=[],y=[];for(let M=0;M!==p[v].morphTargets.length;++M){const S=p[v];b.push(S.time),y.push(S.morphTarget===_?1:0)}r.push(new jg(".morphTargetInfluence["+_+"]",b,y))}l=m.length*o}else{const m=".bones["+e[h].name+"]";n(Xg,m+".position",p,"pos",r),n(Gf,m+".quaternion",p,"rot",r),n(Xg,m+".scale",p,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const t=this.tracks;let e=0;for(let n=0,r=t.length;n!==r;++n){const s=this.tracks[n];e=Math.max(e,s.times[s.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UX(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return jg;case"vector":case"vector2":case"vector3":case"vector4":return Xg;case"color":return WE;case"quaternion":return Gf;case"bool":case"boolean":return Hd;case"string":return $d}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function FX(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=UX(i.type);if(i.times===void 0){const e=[],n=[];GE(i.keys,e,n,"value"),i.times=e,i.values=n}return t.parse!==void 0?t.parse(i):new t(i.name,i.times,i.values,i.interpolation)}const Rd={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class jE{constructor(t,e,n){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return h!==-1&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,p=c.length;h<p;h+=2){const m=c[h],v=c[h+1];if(m.global&&(m.lastIndex=0),m.test(u))return v}return null}}}const FI=new jE;class Ho{constructor(t){this.manager=t!==void 0?t:FI,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(r,s){n.load(t,r,e,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}Ho.DEFAULT_MATERIAL_NAME="__DEFAULT";const Nc={};class VX extends Error{constructor(t,e){super(t),this.response=e}}class Jc extends Ho{constructor(t){super(t)}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=Rd.get(t);if(s!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(s),this.manager.itemEnd(t)},0),s;if(Nc[t]!==void 0){Nc[t].push({onLoad:e,onProgress:n,onError:r});return}Nc[t]=[],Nc[t].push({onLoad:e,onProgress:n,onError:r});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=Nc[t],h=c.body.getReader(),p=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),m=p?parseInt(p):0,v=m!==0;let _=0;const b=new ReadableStream({start(y){M();function M(){h.read().then(({done:S,value:E})=>{if(S)y.close();else{_+=E.byteLength;const A=new ProgressEvent("progress",{lengthComputable:v,loaded:_,total:m});for(let R=0,O=u.length;R<O;R++){const L=u[R];L.onProgress&&L.onProgress(A)}y.enqueue(E),M()}})}}});return new Response(b)}else throw new VX(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),p=h&&h[1]?h[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(v=>m.decode(v))}}}).then(c=>{Rd.add(t,c);const u=Nc[t];delete Nc[t];for(let h=0,p=u.length;h<p;h++){const m=u[h];m.onLoad&&m.onLoad(c)}}).catch(c=>{const u=Nc[t];if(u===void 0)throw this.manager.itemError(t),c;delete Nc[t];for(let h=0,p=u.length;h<p;h++){const m=u[h];m.onError&&m.onError(c)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class BX extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=this,o=new Jc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(a){try{e(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(t)}},n,r)}parse(t){const e=[];for(let n=0;n<t.length;n++){const r=Yg.parse(t[n]);e.push(r)}return e}}class HX extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=this,o=[],a=new qy,l=new Jc(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(h){l.load(t[h],function(p){const m=s.parse(p,!0);o[h]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},c+=1,c===6&&(m.mipmapCount===1&&(a.minFilter=Ji),a.image=o,a.format=m.format,a.needsUpdate=!0,e&&e(a))},n,r)}if(Array.isArray(t))for(let h=0,p=t.length;h<p;++h)u(h);else l.load(t,function(h){const p=s.parse(h,!0);if(p.isCubemap){const m=p.mipmaps.length/p.mipmapCount;for(let v=0;v<m;v++){o[v]={mipmaps:[]};for(let _=0;_<p.mipmapCount;_++)o[v].mipmaps.push(p.mipmaps[v*p.mipmapCount+_]),o[v].format=p.format,o[v].width=p.width,o[v].height=p.height}a.image=o}else a.image.width=p.width,a.image.height=p.height,a.mipmaps=p.mipmaps;p.mipmapCount===1&&(a.minFilter=Ji),a.format=p.format,a.needsUpdate=!0,e&&e(a)},n,r);return a}}class Kg extends Ho{constructor(t){super(t)}load(t,e,n,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,o=Rd.get(t);if(o!==void 0)return s.manager.itemStart(t),setTimeout(function(){e&&e(o),s.manager.itemEnd(t)},0),o;const a=Hg("img");function l(){u(),Rd.add(t,this),e&&e(this),s.manager.itemEnd(t)}function c(h){u(),r&&r(h),s.manager.itemError(t),s.manager.itemEnd(t)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(t),a.src=t,a}}class $X extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=new xv;s.colorSpace=cn;const o=new Kg(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(t[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,e&&e(s))},void 0,r)}for(let c=0;c<t.length;++c)l(c);return s}}class GX extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=this,o=new lf,a=new Jc(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(t,function(l){const c=s.parse(l);c&&(c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:es,o.wrapT=c.wrapT!==void 0?c.wrapT:es,o.magFilter=c.magFilter!==void 0?c.magFilter:Ji,o.minFilter=c.minFilter!==void 0?c.minFilter:Ji,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=eh),c.mipmapCount===1&&(o.minFilter=Ji),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,e&&e(o,c))},n,r),o}}class qX extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=new mr,o=new Kg(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(a){s.image=a,s.needsUpdate=!0,e!==void 0&&e(s)},n,r),s}}class vh extends qn{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new me(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}class VI extends vh{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(qn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new me(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const dS=new rn,X2=new Y,Y2=new Y;class XE{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vt(512,512),this.map=null,this.mapPass=null,this.matrix=new rn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Fy,this._frameExtents=new Vt(1,1),this._viewportCount=1,this._viewports=[new Vn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;X2.setFromMatrixPosition(t.matrixWorld),e.position.copy(X2),Y2.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Y2),e.updateMatrixWorld(),dS.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dS),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(dS)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class WX extends XE{constructor(){super(new Di(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,n=vf*2*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=t.distance||e.far;(n!==e.fov||r!==e.aspect||s!==e.far)&&(e.fov=n,e.aspect=r,e.far=s,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class BI extends vh{constructor(t,e,n=0,r=Math.PI/3,s=0,o=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(qn.DEFAULT_UP),this.updateMatrix(),this.target=new qn,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new WX}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const K2=new rn,Wm=new Y,pS=new Y;class jX extends XE{constructor(){super(new Di(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vt(4,2),this._viewportCount=6,this._viewports=[new Vn(2,1,1,1),new Vn(0,1,1,1),new Vn(3,1,1,1),new Vn(1,1,1,1),new Vn(3,0,1,1),new Vn(1,0,1,1)],this._cubeDirections=[new Y(1,0,0),new Y(-1,0,0),new Y(0,0,1),new Y(0,0,-1),new Y(0,1,0),new Y(0,-1,0)],this._cubeUps=[new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,0,1),new Y(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,s=t.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Wm.setFromMatrixPosition(t.matrixWorld),n.position.copy(Wm),pS.copy(n.position),pS.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(pS),n.updateMatrixWorld(),r.makeTranslation(-Wm.x,-Wm.y,-Wm.z),K2.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(K2)}}class HI extends vh{constructor(t,e,n=0,r=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new jX}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class XX extends XE{constructor(){super(new wv(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class $I extends vh{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(qn.DEFAULT_UP),this.updateMatrix(),this.target=new qn,this.shadow=new XX}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class GI extends vh{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class qI extends vh{constructor(t,e,n=10,r=10){super(t,e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}class WI{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Y)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,s=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*s),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],1.092548*(n*r)),e.addScaledVector(o[5],1.092548*(r*s)),e.addScaledVector(o[6],.315392*(3*s*s-1)),e.addScaledVector(o[7],1.092548*(n*s)),e.addScaledVector(o[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,s=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],2*.511664*r),e.addScaledVector(o[2],2*.511664*s),e.addScaledVector(o[3],2*.511664*n),e.addScaledVector(o[4],2*.429043*n*r),e.addScaledVector(o[5],2*.429043*r*s),e.addScaledVector(o[6],.743125*s*s-.247708),e.addScaledVector(o[7],2*.429043*n*s),e.addScaledVector(o[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+r*3);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+r*3);return t}static getBasisAt(t,e){const n=t.x,r=t.y,s=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*s,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*s,e[6]=.315392*(3*s*s-1),e[7]=1.092548*n*s,e[8]=.546274*(n*n-r*r)}}class ax extends vh{constructor(t=new WI,e=1){super(void 0,e),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}class lx extends Ho{constructor(t){super(t),this.textures={}}load(t,e,n,r){const s=this,o=new Jc(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(t,function(a){try{e(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(t)}},n,r)}parse(t){const e=this.textures;function n(s){return e[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),e[s]}const r=lx.createMaterialFromType(t.type);if(t.uuid!==void 0&&(r.uuid=t.uuid),t.name!==void 0&&(r.name=t.name),t.color!==void 0&&r.color!==void 0&&r.color.setHex(t.color),t.roughness!==void 0&&(r.roughness=t.roughness),t.metalness!==void 0&&(r.metalness=t.metalness),t.sheen!==void 0&&(r.sheen=t.sheen),t.sheenColor!==void 0&&(r.sheenColor=new me().setHex(t.sheenColor)),t.sheenRoughness!==void 0&&(r.sheenRoughness=t.sheenRoughness),t.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(t.emissive),t.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(t.specular),t.specularIntensity!==void 0&&(r.specularIntensity=t.specularIntensity),t.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(t.specularColor),t.shininess!==void 0&&(r.shininess=t.shininess),t.clearcoat!==void 0&&(r.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=t.clearcoatRoughness),t.iridescence!==void 0&&(r.iridescence=t.iridescence),t.iridescenceIOR!==void 0&&(r.iridescenceIOR=t.iridescenceIOR),t.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=t.iridescenceThicknessRange),t.transmission!==void 0&&(r.transmission=t.transmission),t.thickness!==void 0&&(r.thickness=t.thickness),t.attenuationDistance!==void 0&&(r.attenuationDistance=t.attenuationDistance),t.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(t.attenuationColor),t.anisotropy!==void 0&&(r.anisotropy=t.anisotropy),t.anisotropyRotation!==void 0&&(r.anisotropyRotation=t.anisotropyRotation),t.fog!==void 0&&(r.fog=t.fog),t.flatShading!==void 0&&(r.flatShading=t.flatShading),t.blending!==void 0&&(r.blending=t.blending),t.combine!==void 0&&(r.combine=t.combine),t.side!==void 0&&(r.side=t.side),t.shadowSide!==void 0&&(r.shadowSide=t.shadowSide),t.opacity!==void 0&&(r.opacity=t.opacity),t.transparent!==void 0&&(r.transparent=t.transparent),t.alphaTest!==void 0&&(r.alphaTest=t.alphaTest),t.alphaHash!==void 0&&(r.alphaHash=t.alphaHash),t.depthTest!==void 0&&(r.depthTest=t.depthTest),t.depthWrite!==void 0&&(r.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(r.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(r.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(r.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(r.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(r.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(r.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(r.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(r.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(r.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(r.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(r.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(r.rotation=t.rotation),t.linewidth!==1&&(r.linewidth=t.linewidth),t.dashSize!==void 0&&(r.dashSize=t.dashSize),t.gapSize!==void 0&&(r.gapSize=t.gapSize),t.scale!==void 0&&(r.scale=t.scale),t.polygonOffset!==void 0&&(r.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=t.polygonOffsetUnits),t.dithering!==void 0&&(r.dithering=t.dithering),t.alphaToCoverage!==void 0&&(r.alphaToCoverage=t.alphaToCoverage),t.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=t.premultipliedAlpha),t.forceSinglePass!==void 0&&(r.forceSinglePass=t.forceSinglePass),t.visible!==void 0&&(r.visible=t.visible),t.toneMapped!==void 0&&(r.toneMapped=t.toneMapped),t.userData!==void 0&&(r.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),t.uniforms!==void 0)for(const s in t.uniforms){const o=t.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new me().setHex(o.value);break;case"v2":r.uniforms[s].value=new Vt().fromArray(o.value);break;case"v3":r.uniforms[s].value=new Y().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Vn().fromArray(o.value);break;case"m3":r.uniforms[s].value=new wn().fromArray(o.value);break;case"m4":r.uniforms[s].value=new rn().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(t.defines!==void 0&&(r.defines=t.defines),t.vertexShader!==void 0&&(r.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(r.fragmentShader=t.fragmentShader),t.glslVersion!==void 0&&(r.glslVersion=t.glslVersion),t.extensions!==void 0)for(const s in t.extensions)r.extensions[s]=t.extensions[s];if(t.lights!==void 0&&(r.lights=t.lights),t.clipping!==void 0&&(r.clipping=t.clipping),t.size!==void 0&&(r.size=t.size),t.sizeAttenuation!==void 0&&(r.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(r.map=n(t.map)),t.matcap!==void 0&&(r.matcap=n(t.matcap)),t.alphaMap!==void 0&&(r.alphaMap=n(t.alphaMap)),t.bumpMap!==void 0&&(r.bumpMap=n(t.bumpMap)),t.bumpScale!==void 0&&(r.bumpScale=t.bumpScale),t.normalMap!==void 0&&(r.normalMap=n(t.normalMap)),t.normalMapType!==void 0&&(r.normalMapType=t.normalMapType),t.normalScale!==void 0){let s=t.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Vt().fromArray(s)}return t.displacementMap!==void 0&&(r.displacementMap=n(t.displacementMap)),t.displacementScale!==void 0&&(r.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(r.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(r.roughnessMap=n(t.roughnessMap)),t.metalnessMap!==void 0&&(r.metalnessMap=n(t.metalnessMap)),t.emissiveMap!==void 0&&(r.emissiveMap=n(t.emissiveMap)),t.emissiveIntensity!==void 0&&(r.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(r.specularMap=n(t.specularMap)),t.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(t.specularIntensityMap)),t.specularColorMap!==void 0&&(r.specularColorMap=n(t.specularColorMap)),t.envMap!==void 0&&(r.envMap=n(t.envMap)),t.envMapIntensity!==void 0&&(r.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(r.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(r.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(r.lightMap=n(t.lightMap)),t.lightMapIntensity!==void 0&&(r.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(r.aoMap=n(t.aoMap)),t.aoMapIntensity!==void 0&&(r.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(r.gradientMap=n(t.gradientMap)),t.clearcoatMap!==void 0&&(r.clearcoatMap=n(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Vt().fromArray(t.clearcoatNormalScale)),t.iridescenceMap!==void 0&&(r.iridescenceMap=n(t.iridescenceMap)),t.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(t.iridescenceThicknessMap)),t.transmissionMap!==void 0&&(r.transmissionMap=n(t.transmissionMap)),t.thicknessMap!==void 0&&(r.thicknessMap=n(t.thicknessMap)),t.anisotropyMap!==void 0&&(r.anisotropyMap=n(t.anisotropyMap)),t.sheenColorMap!==void 0&&(r.sheenColorMap=n(t.sheenColorMap)),t.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(t.sheenRoughnessMap)),r}setTextures(t){return this.textures=t,this}static createMaterialFromType(t){const e={ShadowMaterial:TI,SpriteMaterial:LE,RawShaderMaterial:BE,ShaderMaterial:yl,PointsMaterial:DE,MeshPhysicalMaterial:AI,MeshStandardMaterial:HE,MeshPhongMaterial:PI,MeshToonMaterial:RI,MeshNormalMaterial:kI,MeshLambertMaterial:LI,MeshDepthMaterial:AE,MeshDistanceMaterial:PE,MeshBasicMaterial:iu,MeshMatcapMaterial:OI,LineDashedMaterial:DI,LineBasicMaterial:po,Material:Hs};return new e[t]}}class QM{static decodeText(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return e===-1?"./":t.slice(0,e+1)}static resolveURL(t,e){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class jI extends fn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){const t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class XI extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=this,o=new Jc(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(t,function(a){try{e(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(t)}},n,r)}parse(t){const e={},n={};function r(m,v){if(e[v]!==void 0)return e[v];const b=m.interleavedBuffers[v],y=s(m,b.buffer),M=Yp(b.type,y),S=new $y(M,b.stride);return S.uuid=b.uuid,e[v]=S,S}function s(m,v){if(n[v]!==void 0)return n[v];const b=m.arrayBuffers[v],y=new Uint32Array(b).buffer;return n[v]=y,y}const o=t.isInstancedBufferGeometry?new jI:new fn,a=t.data.index;if(a!==void 0){const m=Yp(a.type,a.array);o.setIndex(new tn(m,1))}const l=t.data.attributes;for(const m in l){const v=l[m];let _;if(v.isInterleavedBufferAttribute){const b=r(t.data,v.data);_=new Ad(b,v.itemSize,v.offset,v.normalized)}else{const b=Yp(v.type,v.array),y=v.isInstancedBufferAttribute?bf:tn;_=new y(b,v.itemSize,v.normalized)}v.name!==void 0&&(_.name=v.name),v.usage!==void 0&&_.setUsage(v.usage),v.updateRange!==void 0&&(_.updateRange.offset=v.updateRange.offset,_.updateRange.count=v.updateRange.count),o.setAttribute(m,_)}const c=t.data.morphAttributes;if(c)for(const m in c){const v=c[m],_=[];for(let b=0,y=v.length;b<y;b++){const M=v[b];let S;if(M.isInterleavedBufferAttribute){const E=r(t.data,M.data);S=new Ad(E,M.itemSize,M.offset,M.normalized)}else{const E=Yp(M.type,M.array);S=new tn(E,M.itemSize,M.normalized)}M.name!==void 0&&(S.name=M.name),_.push(S)}o.morphAttributes[m]=_}t.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=t.data.groups||t.data.drawcalls||t.data.offsets;if(h!==void 0)for(let m=0,v=h.length;m!==v;++m){const _=h[m];o.addGroup(_.start,_.count,_.materialIndex)}const p=t.data.boundingSphere;if(p!==void 0){const m=new Y;p.center!==void 0&&m.fromArray(p.center),o.boundingSphere=new wl(m,p.radius)}return t.name&&(o.name=t.name),t.userData&&(o.userData=t.userData),o}}class YX extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=this,o=this.path===""?QM.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const a=new Jc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(l){let c=null;try{c=JSON.parse(l)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+t+".",h.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+t)),console.error("THREE.ObjectLoader: Can't load "+t);return}s.parse(c,e)},n,r)}async loadAsync(t,e){const n=this,r=this.path===""?QM.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||r;const s=new Jc(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(t,e),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+t);return await n.parseAsync(a)}parse(t,e){const n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),s=this.parseGeometries(t.geometries,r),o=this.parseImages(t.images,function(){e!==void 0&&e(c)}),a=this.parseTextures(t.textures,o),l=this.parseMaterials(t.materials,a),c=this.parseObject(t.object,s,l,a,n),u=this.parseSkeletons(t.skeletons,c);if(this.bindSkeletons(c,u),e!==void 0){let h=!1;for(const p in o)if(o[p].data instanceof HTMLImageElement){h=!0;break}h===!1&&e(c)}return c}async parseAsync(t){const e=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,n),s=await this.parseImagesAsync(t.images),o=this.parseTextures(t.textures,s),a=this.parseMaterials(t.materials,o),l=this.parseObject(t.object,r,a,o,e),c=this.parseSkeletons(t.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(t){const e={};if(t!==void 0)for(let n=0,r=t.length;n<r;n++){const s=new yd().fromJSON(t[n]);e[s.uuid]=s}return e}parseSkeletons(t,e){const n={},r={};if(e.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),t!==void 0)for(let s=0,o=t.length;s<o;s++){const a=new Gy().fromJSON(t[s],r);n[a.uuid]=a}return n}parseGeometries(t,e){const n={};if(t!==void 0){const r=new XI;for(let s=0,o=t.length;s<o;s++){let a;const l=t[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in j2?a=j2[l.type].fromJSON(l,e):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(t,e){const n={},r={};if(t!==void 0){const s=new lx;s.setTextures(e);for(let o=0,a=t.length;o<a;o++){const l=t[o];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(t){const e={};if(t!==void 0)for(let n=0;n<t.length;n++){const r=t[n],s=Yg.parse(r);e[s.uuid]=s}return e}parseImages(t,e){const n=this,r={};let s;function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return o(u)}else return l.data?{data:Yp(l.type,l.data),width:l.width,height:l.height}:null}if(t!==void 0&&t.length>0){const l=new jE(e);s=new Kg(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=t.length;c<u;c++){const h=t[c],p=h.url;if(Array.isArray(p)){const m=[];for(let v=0,_=p.length;v<_;v++){const b=p[v],y=a(b);y!==null&&(y instanceof HTMLImageElement?m.push(y):m.push(new lf(y.data,y.width,y.height)))}r[h.uuid]=new md(m)}else{const m=a(h.url);r[h.uuid]=new md(m)}}}return r}async parseImagesAsync(t){const e=this,n={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:e.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Yp(o.type,o.data),width:o.width,height:o.height}:null}if(t!==void 0&&t.length>0){r=new Kg(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=t.length;o<a;o++){const l=t[o],c=l.url;if(Array.isArray(c)){const u=[];for(let h=0,p=c.length;h<p;h++){const m=c[h],v=await s(m);v!==null&&(v instanceof HTMLImageElement?u.push(v):u.push(new lf(v.data,v.width,v.height)))}n[l.uuid]=new md(u)}else{const u=await s(l.url);n[l.uuid]=new md(u)}}}return n}parseTextures(t,e){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(t!==void 0)for(let s=0,o=t.length;s<o;s++){const a=t[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),e[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=e[a.image],c=l.data;let u;Array.isArray(c)?(u=new xv,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new lf:u=new mr,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=n(a.mapping,KX)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=n(a.wrap[0],Z2),u.wrapT=n(a.wrap[1],Z2)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.encoding!==void 0&&(u.encoding=a.encoding),a.minFilter!==void 0&&(u.minFilter=n(a.minFilter,J2)),a.magFilter!==void 0&&(u.magFilter=n(a.magFilter,J2)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(t,e,n,r,s){let o;function a(p){return e[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",p),e[p]}function l(p){if(p!==void 0){if(Array.isArray(p)){const m=[];for(let v=0,_=p.length;v<_;v++){const b=p[v];n[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),m.push(n[b])}return m}return n[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),n[p]}}function c(p){return r[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",p),r[p]}let u,h;switch(t.type){case"Scene":o=new Hf,t.background!==void 0&&(Number.isInteger(t.background)?o.background=new me(t.background):o.background=c(t.background)),t.environment!==void 0&&(o.environment=c(t.environment)),t.fog!==void 0&&(t.fog.type==="Fog"?o.fog=new Hy(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(o.fog=new By(t.fog.color,t.fog.density))),t.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=t.backgroundBlurriness),t.backgroundIntensity!==void 0&&(o.backgroundIntensity=t.backgroundIntensity);break;case"PerspectiveCamera":o=new Di(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(o.focus=t.focus),t.zoom!==void 0&&(o.zoom=t.zoom),t.filmGauge!==void 0&&(o.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(o.filmOffset=t.filmOffset),t.view!==void 0&&(o.view=Object.assign({},t.view));break;case"OrthographicCamera":o=new wv(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(o.zoom=t.zoom),t.view!==void 0&&(o.view=Object.assign({},t.view));break;case"AmbientLight":o=new GI(t.color,t.intensity);break;case"DirectionalLight":o=new $I(t.color,t.intensity);break;case"PointLight":o=new HI(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":o=new qI(t.color,t.intensity,t.width,t.height);break;case"SpotLight":o=new BI(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":o=new VI(t.color,t.groundColor,t.intensity);break;case"LightProbe":o=new ax().fromJSON(t);break;case"SkinnedMesh":u=a(t.geometry),h=l(t.material),o=new pI(u,h),t.bindMode!==void 0&&(o.bindMode=t.bindMode),t.bindMatrix!==void 0&&o.bindMatrix.fromArray(t.bindMatrix),t.skeleton!==void 0&&(o.skeleton=t.skeleton);break;case"Mesh":u=a(t.geometry),h=l(t.material),o=new fi(u,h);break;case"InstancedMesh":u=a(t.geometry),h=l(t.material);const p=t.count,m=t.instanceMatrix,v=t.instanceColor;o=new fI(u,h,p),o.instanceMatrix=new bf(new Float32Array(m.array),16),v!==void 0&&(o.instanceColor=new bf(new Float32Array(v.array),v.itemSize));break;case"LOD":o=new dI;break;case"Line":o=new nh(a(t.geometry),l(t.material));break;case"LineLoop":o=new mI(a(t.geometry),l(t.material));break;case"LineSegments":o=new oc(a(t.geometry),l(t.material));break;case"PointCloud":case"Points":o=new gI(a(t.geometry),l(t.material));break;case"Sprite":o=new hI(l(t.material));break;case"Group":o=new Zp;break;case"Bone":o=new OE;break;default:o=new qn}if(o.uuid=t.uuid,t.name!==void 0&&(o.name=t.name),t.matrix!==void 0?(o.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=t.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(t.position!==void 0&&o.position.fromArray(t.position),t.rotation!==void 0&&o.rotation.fromArray(t.rotation),t.quaternion!==void 0&&o.quaternion.fromArray(t.quaternion),t.scale!==void 0&&o.scale.fromArray(t.scale)),t.up!==void 0&&o.up.fromArray(t.up),t.castShadow!==void 0&&(o.castShadow=t.castShadow),t.receiveShadow!==void 0&&(o.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(o.shadow.bias=t.shadow.bias),t.shadow.normalBias!==void 0&&(o.shadow.normalBias=t.shadow.normalBias),t.shadow.radius!==void 0&&(o.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(o.visible=t.visible),t.frustumCulled!==void 0&&(o.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(o.renderOrder=t.renderOrder),t.userData!==void 0&&(o.userData=t.userData),t.layers!==void 0&&(o.layers.mask=t.layers),t.children!==void 0){const p=t.children;for(let m=0;m<p.length;m++)o.add(this.parseObject(p[m],e,n,r,s))}if(t.animations!==void 0){const p=t.animations;for(let m=0;m<p.length;m++){const v=p[m];o.animations.push(s[v])}}if(t.type==="LOD"){t.autoUpdate!==void 0&&(o.autoUpdate=t.autoUpdate);const p=t.levels;for(let m=0;m<p.length;m++){const v=p[m],_=o.getObjectByProperty("uuid",v.object);_!==void 0&&o.addLevel(_,v.distance,v.hysteresis)}}return o}bindSkeletons(t,e){Object.keys(e).length!==0&&t.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=e[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const KX={UVMapping:_v,CubeReflectionMapping:Zc,CubeRefractionMapping:th,EquirectangularReflectionMapping:Dg,EquirectangularRefractionMapping:Ig,CubeUVReflectionMapping:zf},Z2={RepeatWrapping:ff,ClampToEdgeWrapping:es,MirroredRepeatWrapping:mf},J2={NearestFilter:si,NearestMipmapNearestFilter:Yb,NearestMipmapLinearFilter:Sg,LinearFilter:Ji,LinearMipmapNearestFilter:pE,LinearMipmapLinearFilter:eh};class ZX extends Ho{constructor(t){super(t),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,o=Rd.get(t);if(o!==void 0)return s.manager.itemStart(t),setTimeout(function(){e&&e(o),s.manager.itemEnd(t)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Rd.add(t,l),e&&e(l),s.manager.itemEnd(t)}).catch(function(l){r&&r(l),s.manager.itemError(t),s.manager.itemEnd(t)}),s.manager.itemStart(t)}}let W0;class YE{static getContext(){return W0===void 0&&(W0=new(window.AudioContext||window.webkitAudioContext)),W0}static setContext(t){W0=t}}class JX extends Ho{constructor(t){super(t)}load(t,e,n,r){const s=this,o=new Jc(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(l){try{const c=l.slice(0);YE.getContext().decodeAudioData(c,function(h){e(h)},a)}catch(c){a(c)}},n,r);function a(l){r?r(l):console.error(l),s.manager.itemError(t)}}}class QX extends ax{constructor(t,e,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=new me().set(t),s=new me().set(e),o=new Y(r.r,r.g,r.b),a=new Y(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class t9 extends ax{constructor(t,e=1){super(void 0,e),this.isAmbientLightProbe=!0;const n=new me().set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const Q2=new rn,tR=new rn,Xh=new rn;class e9{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Di,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Di,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,Xh.copy(t.projectionMatrix);const r=e.eyeSep/2,s=r*e.near/e.focus,o=e.near*Math.tan(bd*e.fov*.5)/e.zoom;let a,l;tR.elements[12]=-r,Q2.elements[12]=r,a=-o*e.aspect+s,l=o*e.aspect+s,Xh.elements[0]=2*e.near/(l-a),Xh.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Xh),a=-o*e.aspect-s,l=o*e.aspect-s,Xh.elements[0]=2*e.near/(l-a),Xh.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Xh)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(tR),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Q2)}}let KE=class{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=eR(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=eR();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}};function eR(){return(typeof performance>"u"?Date:performance).now()}const Yh=new Y,nR=new $r,n9=new Y,Kh=new Y;class i9 extends qn{constructor(){super(),this.type="AudioListener",this.context=YE.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new KE}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Yh,nR,n9),Kh.set(0,0,-1).applyQuaternion(nR),e.positionX){const r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Yh.x,r),e.positionY.linearRampToValueAtTime(Yh.y,r),e.positionZ.linearRampToValueAtTime(Yh.z,r),e.forwardX.linearRampToValueAtTime(Kh.x,r),e.forwardY.linearRampToValueAtTime(Kh.y,r),e.forwardZ.linearRampToValueAtTime(Kh.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(Yh.x,Yh.y,Yh.z),e.setOrientation(Kh.x,Kh.y,Kh.z,n.x,n.y,n.z)}}class YI extends qn{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const Zh=new Y,iR=new $r,r9=new Y,Jh=new Y;class s9 extends YI{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Zh,iR,r9),Jh.set(0,0,1).applyQuaternion(iR);const e=this.panner;if(e.positionX){const n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(Zh.x,n),e.positionY.linearRampToValueAtTime(Zh.y,n),e.positionZ.linearRampToValueAtTime(Zh.z,n),e.orientationX.linearRampToValueAtTime(Jh.x,n),e.orientationY.linearRampToValueAtTime(Jh.y,n),e.orientationZ.linearRampToValueAtTime(Jh.z,n)}else e.setPosition(Zh.x,Zh.y,Zh.z),e.setOrientation(Jh.x,Jh.y,Jh.z)}}class o9{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}class KI{constructor(t,e,n){this.binding=t,this.valueSize=n;let r,s,o;switch(e){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,s=t*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)n[s+a]=n[a];o=e}else{o+=e;const a=e/o;this._mixBufferRegion(n,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=e*this._origIndex;this._mixBufferRegion(n,r,l,1-s,e)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let l=e,c=e+e;l!==c;++l)if(n[l]!==n[l+e]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let s=n,o=r;s!==o;++s)e[s]=e[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)t[e+o]=t[n+o]}_slerp(t,e,n,r){$r.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,s){const o=this._workIndex*s;$r.multiplyQuaternionsFlat(t,o,t,e,t,n),$r.slerpFlat(t,e,t,e,t,o,r)}_lerp(t,e,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=e+a;t[l]=t[l]*o+t[n+a]*r}}_lerpAdditive(t,e,n,r,s){for(let o=0;o!==s;++o){const a=e+o;t[a]=t[a]+t[n+o]*r}}}const ZE="\\[\\]\\.:\\/",a9=new RegExp("["+ZE+"]","g"),JE="[^"+ZE+"]",l9="[^"+ZE.replace("\\.","")+"]",c9=/((?:WC+[\/:])*)/.source.replace("WC",JE),u9=/(WCOD+)?/.source.replace("WCOD",l9),h9=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",JE),d9=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",JE),p9=new RegExp("^"+c9+u9+h9+d9+"$"),f9=["material","materials","bones","map"];class m9{constructor(t,e,n){const r=n||Yn.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}class Yn{constructor(t,e,n){this.path=e,this.parsedPath=n||Yn.parseTrackName(e),this.node=Yn.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Yn.Composite(t,e,n):new Yn(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(a9,"")}static parseTrackName(t){const e=p9.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);f9.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(n!==void 0)return n}if(t.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===e||a.uuid===e)return a;const l=n(a.children);if(l)return l}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let s=e.propertyIndex;if(t||(t=Yn.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let c=e.objectIndex;switch(n){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===c){c=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[n]}if(c!==void 0){if(t[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[c]}}const o=t[r];if(o===void 0){const c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t);return}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Yn.Composite=m9;Yn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Yn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Yn.prototype.GetterByBindingType=[Yn.prototype._getValue_direct,Yn.prototype._getValue_array,Yn.prototype._getValue_arrayElement,Yn.prototype._getValue_toArray];Yn.prototype.SetterByBindingTypeAndVersioning=[[Yn.prototype._setValue_direct,Yn.prototype._setValue_direct_setNeedsUpdate,Yn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_array,Yn.prototype._setValue_array_setNeedsUpdate,Yn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_arrayElement,Yn.prototype._setValue_arrayElement_setNeedsUpdate,Yn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Yn.prototype._setValue_fromArray,Yn.prototype._setValue_fromArray_setNeedsUpdate,Yn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class g9{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ga(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=t.length,c=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const p=arguments[u],m=p.uuid;let v=e[m];if(v===void 0){v=l++,e[m]=v,t.push(p);for(let _=0,b=o;_!==b;++_)s[_].push(new Yn(p,n[_],r[_]))}else if(v<c){a=t[v];const _=--c,b=t[_];e[b.uuid]=v,t[v]=b,e[m]=_,t[_]=p;for(let y=0,M=o;y!==M;++y){const S=s[y],E=S[_];let A=S[v];S[v]=E,A===void 0&&(A=new Yn(p,n[y],r[y])),S[_]=A}}else t[v]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=e[c];if(u!==void 0&&u>=s){const h=s++,p=t[h];e[p.uuid]=u,t[u]=p,e[c]=h,t[h]=l;for(let m=0,v=r;m!==v;++m){const _=n[m],b=_[h],y=_[u];_[u]=b,_[h]=y}}}this.nCachedObjects_=s}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=t.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,h=e[u];if(h!==void 0)if(delete e[u],h<s){const p=--s,m=t[p],v=--o,_=t[v];e[m.uuid]=h,t[h]=m,e[_.uuid]=p,t[p]=_,t.pop();for(let b=0,y=r;b!==y;++b){const M=n[b],S=M[p],E=M[v];M[h]=S,M[p]=E,M.pop()}}else{const p=--o,m=t[p];p>0&&(e[m.uuid]=h),t[h]=m,t.pop();for(let v=0,_=r;v!==_;++v){const b=n[v];b[h]=b[p],b.pop()}}}this.nCachedObjects_=s}subscribe_(t,e){const n=this._bindingsIndicesByPath;let r=n[t];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,h=new Array(c);r=s.length,n[t]=r,o.push(t),a.push(e),s.push(h);for(let p=u,m=l.length;p!==m;++p){const v=l[p];h[p]=new Yn(v,t,e)}return h}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=t[a];e[c]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class ZI{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const s=e.tracks,o=s.length,a=new Array(o),l={endingStart:pd,endingEnd:pd};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=RD,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const r=this._clip.duration,s=t._clip.duration,o=s/r,a=r/s;t.warp(1,o,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=t/o,c[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled){this._updateWeight(t);return}const s=this._startTime;if(s!==null){const l=(t-s)*n;l<0||n===0?e=0:(this._startTime=null,e=n*l)}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case yE:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case Ny:default:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,s=this._loopCount;const o=n===kD;if(t===0)return s===-1?r:o&&(s&1)===1?e-r:r;if(n===PD){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else if(r<0)r=0;else{this.time=r;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=e||r<0){const a=Math.floor(r/e);r-=e*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){const c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=fd,r.endingEnd=fd):(t?r.endingStart=this.zeroSlopeAtStart?fd:pd:r.endingStart=Ug,e?r.endingEnd=this.zeroSlopeAtEnd?fd:pd:r.endingEnd=Ug)}_scheduleFading(t,e,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=e,a[1]=s+t,l[1]=n,this}}const v9=new Float32Array(1);class _9 extends ma{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,s=r.length,o=t._propertyBindings,a=t._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let h=0;h!==s;++h){const p=r[h],m=p.name;let v=u[m];if(v!==void 0)++v.referenceCount,o[h]=v;else{if(v=o[h],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,l,m));continue}const _=e&&e._propertyBindings[h].binding.parsedPath;v=new KI(Yn.create(n,m,_),p.ValueTypeName,p.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,l,m),o[h]=v}a[h].resultBuffer=v.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const n=(t._localRoot||this._root).uuid,r=t._clip.uuid,s=this._actionsByClip[r];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,r,n)}const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const s=e[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const s=e[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,s=this._actionsByClip;let o=s[e];if(o===void 0)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[e]=o;else{const a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const s=t._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=t._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),t._byClipCacheIndex=null;const h=a.actionByRoot,p=(t._localRoot||this._root).uuid;delete h[p],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const s=e[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[e];o===void 0&&(o={},r[e]=o),o[n]=t,t._cacheIndex=s.length,s.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=e[e.length-1],c=t._cacheIndex;l._cacheIndex=c,e[c]=l,e.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,s=e[r];t._cacheIndex=r,e[r]=t,s._cacheIndex=n,e[n]=s}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return n===void 0&&(n=new qE(new Float32Array(2),new Float32Array(2),1,v9),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,s=e[r];t.__cacheIndex=r,e[r]=t,s.__cacheIndex=n,e[n]=s}clipAction(t,e,n){const r=e||this._root,s=r.uuid;let o=typeof t=="string"?Yg.findByName(r,t):t;const a=o!==null?o.uuid:t,l=this._actionsByClip[a];let c=null;if(n===void 0&&(o!==null?n=o.blendMode:n=Ny),l!==void 0){const h=l.actionByRoot[s];if(h!==void 0&&h.blendMode===n)return h;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new ZI(this,o,e,n);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(t,e){const n=e||this._root,r=n.uuid,s=typeof t=="string"?Yg.findByName(n,t):t,o=s?s.uuid:t,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const t=this._actions,e=this._nActiveActions;for(let n=e-1;n>=0;--n)t[n].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,r=this.time+=t,s=Math.sign(t),o=this._accuIndex^=1;for(let c=0;c!==n;++c)e[c]._update(r,t,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,h=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,e[u]=h,e.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[e];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[e];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(t,e){const n=this.existingAction(t,e);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class QE{constructor(t){this.value=t}clone(){return new QE(this.value.clone===void 0?this.value:this.value.clone())}}let b9=0;class y9 extends ma{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:b9++}),this.name="",this.usage=Vg,this.uniforms=[]}add(t){return this.uniforms.push(t),this}remove(t){const e=this.uniforms.indexOf(t);return e!==-1&&this.uniforms.splice(e,1),this}setName(t){return this.name=t,this}setUsage(t){return this.usage=t,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(t){this.name=t.name,this.usage=t.usage;const e=t.uniforms;this.uniforms.length=0;for(let n=0,r=e.length;n<r;n++)this.uniforms.push(e[n].clone());return this}clone(){return new this.constructor().copy(this)}}class x9 extends $y{constructor(t,e,n=1){super(t,e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}class w9{constructor(t,e,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(t){t===!0&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}class S9{constructor(t,e,n=0,r=1/0){this.ray=new Fd(t,e),this.near=n,this.far=r,this.camera=null,this.layers=new Uy,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return tC(t,this,n,e),n.sort(rR),n}intersectObjects(t,e=!0,n=[]){for(let r=0,s=t.length;r<s;r++)tC(t[r],this,n,e);return n.sort(rR),n}}function rR(i,t){return i.distance-t.distance}function tC(i,t,e,n){if(i.layers.test(t.layers)&&i.raycast(t,e),n===!0){const r=i.children;for(let s=0,o=r.length;s<o;s++)tC(r[s],t,e,!0)}}let eC=class{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(hr(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};class M9{constructor(t=1,e=0,n=0){return this.radius=t,this.theta=e,this.y=n,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return new this.constructor().copy(this)}}const sR=new Vt;class C9{constructor(t=new Vt(1/0,1/0),e=new Vt(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=sR.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,sR).distanceTo(t)}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const oR=new Y,j0=new Y;class E9{constructor(t=new Y,e=new Y){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){oR.subVectors(t,this.start),j0.subVectors(this.end,this.start);const n=j0.dot(j0);let s=j0.dot(oR)/n;return e&&(s=hr(s,0,1)),s}closestPointToPoint(t,e,n){const r=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const aR=new Y;class T9 extends qn{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";const n=new fn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new Se(r,3));const s=new po({fog:!1,toneMapped:!1});this.cone=new oc(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),aR.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(aR),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ku=new Y,X0=new rn,fS=new rn;class A9 extends oc{constructor(t){const e=JI(t),n=new fn,r=[],s=[],o=new me(0,0,1),a=new me(0,1,0);for(let c=0;c<e.length;c++){const u=e[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new Se(r,3)),n.setAttribute("color",new Se(s,3));const l=new po({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");fS.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<e.length;s++){const a=e[s];a.parent&&a.parent.isBone&&(X0.multiplyMatrices(fS,a.matrixWorld),ku.setFromMatrixPosition(X0),r.setXYZ(o,ku.x,ku.y,ku.z),X0.multiplyMatrices(fS,a.parent.matrixWorld),ku.setFromMatrixPosition(X0),r.setXYZ(o+1,ku.x,ku.y,ku.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose()}}function JI(i){const t=[];i.isBone===!0&&t.push(i);for(let e=0;e<i.children.length;e++)t.push.apply(t,JI(i.children[e]));return t}class P9 extends fi{constructor(t,e,n){const r=new Cv(e,4,2),s=new iu({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=t,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const R9=new Y,lR=new me,cR=new me;class k9 extends qn{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Mv(e);r.rotateY(Math.PI*.5),this.material=new iu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new tn(o,3)),this.add(new fi(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");lR.copy(this.light.color),cR.copy(this.light.groundColor);for(let n=0,r=e.count;n<r;n++){const s=n<r/2?lR:cR;e.setXYZ(n,s.r,s.g,s.b)}e.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),t.lookAt(R9.setFromMatrixPosition(this.light.matrixWorld).negate())}}class L9 extends oc{constructor(t=10,e=10,n=4473924,r=8947848){n=new me(n),r=new me(r);const s=e/2,o=t/e,a=t/2,l=[],c=[];for(let p=0,m=0,v=-a;p<=e;p++,v+=o){l.push(-a,0,v,a,0,v),l.push(v,0,-a,v,0,a);const _=p===s?n:r;_.toArray(c,m),m+=3,_.toArray(c,m),m+=3,_.toArray(c,m),m+=3,_.toArray(c,m),m+=3}const u=new fn;u.setAttribute("position",new Se(l,3)),u.setAttribute("color",new Se(c,3));const h=new po({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class O9 extends oc{constructor(t=10,e=16,n=8,r=64,s=4473924,o=8947848){s=new me(s),o=new me(o);const a=[],l=[];if(e>1)for(let h=0;h<e;h++){const p=h/e*(Math.PI*2),m=Math.sin(p)*t,v=Math.cos(p)*t;a.push(0,0,0),a.push(m,0,v);const _=h&1?s:o;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let h=0;h<n;h++){const p=h&1?s:o,m=t-t/n*h;for(let v=0;v<r;v++){let _=v/r*(Math.PI*2),b=Math.sin(_)*m,y=Math.cos(_)*m;a.push(b,0,y),l.push(p.r,p.g,p.b),_=(v+1)/r*(Math.PI*2),b=Math.sin(_)*m,y=Math.cos(_)*m,a.push(b,0,y),l.push(p.r,p.g,p.b)}}const c=new fn;c.setAttribute("position",new Se(a,3)),c.setAttribute("color",new Se(l,3));const u=new po({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const uR=new Y,Y0=new Y,hR=new Y;class D9 extends qn{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",e===void 0&&(e=1);let r=new fn;r.setAttribute("position",new Se([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const s=new po({fog:!1,toneMapped:!1});this.lightPlane=new nh(r,s),this.add(this.lightPlane),r=new fn,r.setAttribute("position",new Se([0,0,0,0,0,1],3)),this.targetLine=new nh(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),uR.setFromMatrixPosition(this.light.matrixWorld),Y0.setFromMatrixPosition(this.light.target.matrixWorld),hR.subVectors(Y0,uR),this.lightPlane.lookAt(Y0),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Y0),this.targetLine.scale.z=hR.length()}}const K0=new Y,lr=new Ff;class I9 extends oc{constructor(t){const e=new fn,n=new po({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(v,_){l(v),l(_)}function l(v){r.push(0,0,0),s.push(0,0,0),o[v]===void 0&&(o[v]=[]),o[v].push(r.length/3-1)}e.setAttribute("position",new Se(r,3)),e.setAttribute("color",new Se(s,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new me(16755200),u=new me(16711680),h=new me(43775),p=new me(16777215),m=new me(3355443);this.setColors(c,u,h,p,m)}setColors(t,e,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,t.r,t.g,t.b),a.setXYZ(1,t.r,t.g,t.b),a.setXYZ(2,t.r,t.g,t.b),a.setXYZ(3,t.r,t.g,t.b),a.setXYZ(4,t.r,t.g,t.b),a.setXYZ(5,t.r,t.g,t.b),a.setXYZ(6,t.r,t.g,t.b),a.setXYZ(7,t.r,t.g,t.b),a.setXYZ(8,t.r,t.g,t.b),a.setXYZ(9,t.r,t.g,t.b),a.setXYZ(10,t.r,t.g,t.b),a.setXYZ(11,t.r,t.g,t.b),a.setXYZ(12,t.r,t.g,t.b),a.setXYZ(13,t.r,t.g,t.b),a.setXYZ(14,t.r,t.g,t.b),a.setXYZ(15,t.r,t.g,t.b),a.setXYZ(16,t.r,t.g,t.b),a.setXYZ(17,t.r,t.g,t.b),a.setXYZ(18,t.r,t.g,t.b),a.setXYZ(19,t.r,t.g,t.b),a.setXYZ(20,t.r,t.g,t.b),a.setXYZ(21,t.r,t.g,t.b),a.setXYZ(22,t.r,t.g,t.b),a.setXYZ(23,t.r,t.g,t.b),a.setXYZ(24,e.r,e.g,e.b),a.setXYZ(25,e.r,e.g,e.b),a.setXYZ(26,e.r,e.g,e.b),a.setXYZ(27,e.r,e.g,e.b),a.setXYZ(28,e.r,e.g,e.b),a.setXYZ(29,e.r,e.g,e.b),a.setXYZ(30,e.r,e.g,e.b),a.setXYZ(31,e.r,e.g,e.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const t=this.geometry,e=this.pointMap,n=1,r=1;lr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Sr("c",e,t,lr,0,0,-1),Sr("t",e,t,lr,0,0,1),Sr("n1",e,t,lr,-n,-r,-1),Sr("n2",e,t,lr,n,-r,-1),Sr("n3",e,t,lr,-n,r,-1),Sr("n4",e,t,lr,n,r,-1),Sr("f1",e,t,lr,-n,-r,1),Sr("f2",e,t,lr,n,-r,1),Sr("f3",e,t,lr,-n,r,1),Sr("f4",e,t,lr,n,r,1),Sr("u1",e,t,lr,n*.7,r*1.1,-1),Sr("u2",e,t,lr,-n*.7,r*1.1,-1),Sr("u3",e,t,lr,0,r*2,-1),Sr("cf1",e,t,lr,-n,0,1),Sr("cf2",e,t,lr,n,0,1),Sr("cf3",e,t,lr,0,-r,1),Sr("cf4",e,t,lr,0,r,1),Sr("cn1",e,t,lr,-n,0,-1),Sr("cn2",e,t,lr,n,0,-1),Sr("cn3",e,t,lr,0,-r,-1),Sr("cn4",e,t,lr,0,r,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Sr(i,t,e,n,r,s,o){K0.set(r,s,o).unproject(n);const a=t[i];if(a!==void 0){const l=e.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],K0.x,K0.y,K0.z)}}const Z0=new sc;class N9 extends oc{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new fn;s.setIndex(new tn(n,1)),s.setAttribute("position",new tn(r,3)),super(s,new po({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Z0.setFromObject(this.object),Z0.isEmpty())return;const e=Z0.min,n=Z0.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=e.x,s[4]=n.y,s[5]=n.z,s[6]=e.x,s[7]=e.y,s[8]=n.z,s[9]=n.x,s[10]=e.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=e.z,s[15]=e.x,s[16]=n.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=n.x,s[22]=e.y,s[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,e){return super.copy(t,e),this.object=t.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class z9 extends oc{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new fn;s.setIndex(new tn(n,1)),s.setAttribute("position",new Se(r,3)),super(s,new po({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}}class U9 extends nh{constructor(t,e=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new fn;o.setAttribute("position",new Se(s,3)),o.computeBoundingSphere(),super(o,new po({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new fn;l.setAttribute("position",new Se(a,3)),l.computeBoundingSphere(),this.add(new fi(l,new iu({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const dR=new Y;let J0,mS;class F9 extends qn{constructor(t=new Y(0,0,1),e=new Y(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",J0===void 0&&(J0=new fn,J0.setAttribute("position",new Se([0,0,0,0,1,0],3)),mS=new $f(0,.5,1,5,1),mS.translate(0,-.5,0)),this.position.copy(e),this.line=new nh(J0,new po({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new fi(mS,new iu({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,s,o)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{dR.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(dR,e)}}setLength(t,e=t*.2,n=e*.2){this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class V9 extends oc{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new fn;r.setAttribute("position",new Se(e,3)),r.setAttribute("color",new Se(n,3));const s=new po({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(t,e,n){const r=new me,s=this.geometry.attributes.color.array;return r.set(t),r.toArray(s,0),r.toArray(s,3),r.set(e),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class B9{constructor(){this.type="ShapePath",this.color=new me,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new $g,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this}bezierCurveTo(t,e,n,r,s,o){return this.currentPath.bezierCurveTo(t,e,n,r,s,o),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t){function e(y){const M=[];for(let S=0,E=y.length;S<E;S++){const A=y[S],R=new yd;R.curves=A.curves,M.push(R)}return M}function n(y,M){const S=M.length;let E=!1;for(let A=S-1,R=0;R<S;A=R++){let O=M[A],L=M[R],P=L.x-O.x,D=L.y-O.y;if(Math.abs(D)>Number.EPSILON){if(D<0&&(O=M[R],P=-P,L=M[A],D=-D),y.y<O.y||y.y>L.y)continue;if(y.y===O.y){if(y.x===O.x)return!0}else{const V=D*(y.x-O.x)-P*(y.y-O.y);if(V===0)return!0;if(V<0)continue;E=!E}}else{if(y.y!==O.y)continue;if(L.x<=y.x&&y.x<=O.x||O.x<=y.x&&y.x<=L.x)return!0}}return E}const r=Yl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new yd,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=t?!u:u;const h=[],p=[];let m=[],v=0,_;p[v]=void 0,m[v]=[];for(let y=0,M=s.length;y<M;y++)a=s[y],_=a.getPoints(),o=r(_),o=t?!o:o,o?(!u&&p[v]&&v++,p[v]={s:new yd,p:_},p[v].s.curves=a.curves,u&&v++,m[v]=[]):m[v].push({h:a,p:_[0]});if(!p[0])return e(s);if(p.length>1){let y=!1,M=0;for(let S=0,E=p.length;S<E;S++)h[S]=[];for(let S=0,E=p.length;S<E;S++){const A=m[S];for(let R=0;R<A.length;R++){const O=A[R];let L=!0;for(let P=0;P<p.length;P++)n(O.p,p[P].p)&&(S!==P&&M++,L?(L=!1,h[P].push(O)):y=!0);L&&h[S].push(O)}}M>0&&y===!1&&(m=h)}let b;for(let y=0,M=p.length;y<M;y++){l=p[y].s,c.push(l),b=m[y];for(let S=0,E=b.length;S<E;S++)l.holes.push(b[S].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Ay}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Ay);const H9=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:uE,AddEquation:Nu,AddOperation:yD,AdditiveAnimationBlendMode:yE,AdditiveBlending:gM,AlphaFormat:gE,AlwaysCompare:$D,AlwaysDepth:pD,AlwaysStencilFunc:ID,AmbientLight:GI,AmbientLightProbe:t9,AnimationAction:ZI,AnimationClip:Yg,AnimationLoader:BX,AnimationMixer:_9,AnimationObjectGroup:g9,AnimationUtils:zX,ArcCurve:vI,ArrayCamera:lI,ArrowHelper:F9,Audio:YI,AudioAnalyser:o9,AudioContext:YE,AudioListener:i9,AudioLoader:JX,AxesHelper:V9,BackSide:ao,BasicDepthPacking:LD,BasicShadowMap:rG,Bone:OE,BooleanKeyframeTrack:Hd,Box2:C9,Box3:sc,Box3Helper:z9,BoxGeometry:Bd,BoxHelper:N9,BufferAttribute:tn,BufferGeometry:fn,BufferGeometryLoader:XI,ByteType:bv,Cache:Rd,Camera:Ff,CameraHelper:I9,CanvasTexture:aX,CapsuleGeometry:Xy,CatmullRomCurve3:_I,CineonToneMapping:SD,CircleGeometry:Yy,ClampToEdgeWrapping:es,Clock:KE,Color:me,ColorKeyframeTrack:WE,ColorManagement:oa,CompressedArrayTexture:sX,CompressedCubeTexture:oX,CompressedTexture:qy,CompressedTextureLoader:HX,ConeGeometry:Ky,CubeCamera:tI,CubeReflectionMapping:Zc,CubeRefractionMapping:th,CubeTexture:xv,CubeTextureLoader:$X,CubeUVReflectionMapping:zf,CubicBezierCurve:NE,CubicBezierCurve3:bI,CubicInterpolant:NI,CullFaceBack:mM,CullFaceFront:uD,CullFaceFrontBack:iG,CullFaceNone:cD,Curve:Sl,CurvePath:xI,CustomBlending:hD,CustomToneMapping:MD,CylinderGeometry:$f,Cylindrical:M9,Data3DTexture:ME,DataArrayTexture:zy,DataTexture:lf,DataTextureLoader:GX,DataUtils:dq,DecrementStencilOp:dG,DecrementWrapStencilOp:fG,DefaultLoadingManager:FI,DepthFormat:Gu,DepthStencilFormat:Td,DepthTexture:cI,DirectionalLight:$I,DirectionalLightHelper:D9,DiscreteInterpolant:zI,DisplayP3ColorSpace:xE,DodecahedronGeometry:Zy,DoubleSide:pr,DstAlphaFactor:sE,DstColorFactor:aE,DynamicCopyUsage:PG,DynamicDrawUsage:SG,DynamicReadUsage:EG,EdgesGeometry:wI,EllipseCurve:Wy,EqualCompare:UD,EqualDepth:mD,EqualStencilFunc:_G,EquirectangularReflectionMapping:Dg,EquirectangularRefractionMapping:Ig,Euler:Vd,EventDispatcher:ma,ExtrudeGeometry:Qy,FileLoader:Jc,Float16BufferAttribute:_q,Float32BufferAttribute:Se,Float64BufferAttribute:bq,FloatType:Hr,Fog:Hy,FogExp2:By,FramebufferTexture:rX,FrontSide:Kc,Frustum:Fy,GLBufferAttribute:w9,GLSL1:kG,GLSL3:GM,GreaterCompare:VD,GreaterDepth:vD,GreaterEqualCompare:HD,GreaterEqualDepth:gD,GreaterEqualStencilFunc:wG,GreaterStencilFunc:yG,GridHelper:L9,Group:Zp,HalfFloatType:gf,HemisphereLight:VI,HemisphereLightHelper:k9,HemisphereLightProbe:QX,IcosahedronGeometry:tx,ImageBitmapLoader:ZX,ImageLoader:Kg,ImageUtils:SE,IncrementStencilOp:hG,IncrementWrapStencilOp:pG,InstancedBufferAttribute:bf,InstancedBufferGeometry:jI,InstancedInterleavedBuffer:x9,InstancedMesh:fI,Int16BufferAttribute:gq,Int32BufferAttribute:vq,Int8BufferAttribute:pq,IntType:Uf,InterleavedBuffer:$y,InterleavedBufferAttribute:Ad,Interpolant:Ev,InterpolateDiscrete:Ng,InterpolateLinear:zg,InterpolateSmooth:Lb,InvertStencilOp:mG,KeepStencilOp:Ob,KeyframeTrack:Ml,LOD:dI,LatheGeometry:Sv,Layers:Uy,LessCompare:zD,LessDepth:fD,LessEqualCompare:FD,LessEqualDepth:Xb,LessEqualStencilFunc:bG,LessStencilFunc:vG,Light:vh,LightProbe:ax,Line:nh,Line3:E9,LineBasicMaterial:po,LineCurve:jy,LineCurve3:yI,LineDashedMaterial:DI,LineLoop:mI,LineSegments:oc,LinearEncoding:Fg,LinearFilter:Ji,LinearInterpolant:qE,LinearMipMapLinearFilter:mE,LinearMipMapNearestFilter:fE,LinearMipmapLinearFilter:eh,LinearMipmapNearestFilter:pE,LinearSRGBColorSpace:bl,LinearToneMapping:xD,Loader:Ho,LoaderUtils:QM,LoadingManager:jE,LoopOnce:PD,LoopPingPong:kD,LoopRepeat:RD,LuminanceAlphaFormat:Iy,LuminanceFormat:Dy,MOUSE:rd,Material:Hs,MaterialLoader:lx,MathUtils:qD,Matrix3:wn,Matrix4:rn,MaxEquation:yM,Mesh:fi,MeshBasicMaterial:iu,MeshDepthMaterial:AE,MeshDistanceMaterial:PE,MeshLambertMaterial:LI,MeshMatcapMaterial:OI,MeshNormalMaterial:kI,MeshPhongMaterial:PI,MeshPhysicalMaterial:AI,MeshStandardMaterial:HE,MeshToonMaterial:RI,MinEquation:bM,MirroredRepeatWrapping:mf,MixOperation:bD,MultiplyBlending:_M,MultiplyOperation:vv,NearestFilter:si,NearestMipMapLinearFilter:dE,NearestMipMapNearestFilter:hE,NearestMipmapLinearFilter:Sg,NearestMipmapNearestFilter:Yb,NeverCompare:ND,NeverDepth:dD,NeverStencilFunc:gG,NoBlending:Wc,NoColorSpace:qu,NoToneMapping:jc,NormalAnimationBlendMode:Ny,NormalBlending:Hu,NotEqualCompare:BD,NotEqualDepth:_D,NotEqualStencilFunc:xG,NumberKeyframeTrack:jg,Object3D:qn,ObjectLoader:YX,ObjectSpaceNormalMap:DD,OctahedronGeometry:Mv,OneFactor:nE,OneMinusDstAlphaFactor:oE,OneMinusDstColorFactor:lE,OneMinusSrcAlphaFactor:ky,OneMinusSrcColorFactor:rE,OrthographicCamera:wv,PCFShadowMap:JC,PCFSoftShadowMap:Py,PMREMGenerator:jM,Path:$g,PerspectiveCamera:Di,Plane:$c,PlaneGeometry:Vf,PlaneHelper:U9,PointLight:HI,PointLightHelper:P9,Points:gI,PointsMaterial:DE,PolarGridHelper:O9,PolyhedronGeometry:gh,PositionalAudio:s9,PropertyBinding:Yn,PropertyMixer:KI,QuadraticBezierCurve:zE,QuadraticBezierCurve3:UE,Quaternion:$r,QuaternionKeyframeTrack:Gf,QuaternionLinearInterpolant:UI,RED_GREEN_RGTC2_Format:HM,RED_RGTC1_Format:AD,REVISION:Ay,RGBADepthPacking:OD,RGBAFormat:Es,RGBAIntegerFormat:bE,RGBA_ASTC_10x10_Format:UM,RGBA_ASTC_10x5_Format:IM,RGBA_ASTC_10x6_Format:NM,RGBA_ASTC_10x8_Format:zM,RGBA_ASTC_12x10_Format:FM,RGBA_ASTC_12x12_Format:VM,RGBA_ASTC_4x4_Format:TM,RGBA_ASTC_5x4_Format:AM,RGBA_ASTC_5x5_Format:PM,RGBA_ASTC_6x5_Format:RM,RGBA_ASTC_6x6_Format:kM,RGBA_ASTC_8x5_Format:LM,RGBA_ASTC_8x6_Format:OM,RGBA_ASTC_8x8_Format:DM,RGBA_BPTC_Format:kb,RGBA_ETC2_EAC_Format:EM,RGBA_PVRTC_2BPPV1_Format:MM,RGBA_PVRTC_4BPPV1_Format:SM,RGBA_S3TC_DXT1_Format:Ab,RGBA_S3TC_DXT3_Format:Pb,RGBA_S3TC_DXT5_Format:Rb,RGB_ETC1_Format:TD,RGB_ETC2_Format:CM,RGB_PVRTC_2BPPV1_Format:wM,RGB_PVRTC_4BPPV1_Format:xM,RGB_S3TC_DXT1_Format:Tb,RGFormat:ED,RGIntegerFormat:_E,RawShaderMaterial:BE,Ray:Fd,Raycaster:S9,RectAreaLight:qI,RedFormat:CD,RedIntegerFormat:vE,ReinhardToneMapping:wD,RepeatWrapping:ff,ReplaceStencilOp:uG,ReverseSubtractEquation:tE,RingGeometry:ex,SIGNED_RED_GREEN_RGTC2_Format:$M,SIGNED_RED_RGTC1_Format:BM,SRGBColorSpace:cn,Scene:Hf,ShaderChunk:dn,ShaderLib:pl,ShaderMaterial:yl,ShadowMaterial:TI,Shape:yd,ShapeGeometry:nx,ShapePath:B9,ShapeUtils:Yl,ShortType:yv,Skeleton:Gy,SkeletonHelper:A9,SkinnedMesh:pI,Source:md,Sphere:wl,SphereGeometry:Cv,Spherical:eC,SphericalHarmonics3:WI,SplineCurve:FE,SpotLight:BI,SpotLightHelper:T9,Sprite:hI,SpriteMaterial:LE,SrcAlphaFactor:Ry,SrcAlphaSaturateFactor:cE,SrcColorFactor:iE,StaticCopyUsage:AG,StaticDrawUsage:Vg,StaticReadUsage:CG,StereoCamera:e9,StreamCopyUsage:RG,StreamDrawUsage:MG,StreamReadUsage:TG,StringKeyframeTrack:$d,SubtractEquation:QC,SubtractiveBlending:vM,TOUCH:sd,TangentSpaceNormalMap:mh,TetrahedronGeometry:ix,Texture:mr,TextureLoader:qX,TorusGeometry:rx,TorusKnotGeometry:sx,Triangle:Po,TriangleFanDrawMode:lG,TriangleStripDrawMode:aG,TrianglesDrawMode:oG,TubeGeometry:ox,TwoPassDoubleSide:sG,UVMapping:_v,Uint16BufferAttribute:CE,Uint32BufferAttribute:EE,Uint8BufferAttribute:fq,Uint8ClampedBufferAttribute:mq,Uniform:QE,UniformsGroup:y9,UniformsLib:pe,UniformsUtils:QD,UnsignedByteType:lo,UnsignedInt248Type:$u,UnsignedIntType:Fa,UnsignedShort4444Type:Ly,UnsignedShort5551Type:Oy,UnsignedShortType:Ud,VSMShadowMap:Bl,Vector2:Vt,Vector3:Y,Vector4:Vn,VectorKeyframeTrack:Xg,VideoTexture:iX,WebGL1Renderer:kE,WebGL3DRenderTarget:eq,WebGLArrayRenderTarget:tq,WebGLCoordinateSystem:$l,WebGLCubeRenderTarget:eI,WebGLMultipleRenderTargets:nq,WebGLRenderTarget:ba,WebGLRenderer:RE,WebGLUtils:aI,WebGPUCoordinateSystem:Bg,WireframeGeometry:EI,WrapAroundEnding:Ug,ZeroCurvatureEnding:pd,ZeroFactor:eE,ZeroSlopeEnding:fd,ZeroStencilOp:cG,_SRGBAFormat:Kb,sRGBEncoding:Xc},Symbol.toStringTag,{value:"Module"})),$9=()=>Ql("threlte-internal-context");function G9(i){let t;const e=i[9].default,n=hh(e,i,i[8],null);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),t=!0},p(r,[s]){n&&n.p&&(!t||s&256)&&dh(n,e,r,r[8],t?fh(e,r[8],s,null):ph(r[8]),null)},i(r){t||(Pn(n,r),t=!0)},o(r){Bn(n,r),t=!1},d(r){n&&n.d(r)}}}const pR="threlte-disposable-object-context";function q9(i,t,e){let n,r,{$$slots:s={},$$scope:o}=t;const{collectDisposableObjects:a,addDisposableObjects:l,removeDisposableObjects:c}=$9();let{object:u=void 0}=t,h=u,{dispose:p=void 0}=t;const m=Ql(pR);pa(i,m,b=>e(7,r=b));const v=_a(p??r??!0);pa(i,v,b=>e(6,n=b)),gl(pR,v);let _=n?a(u):[];return l(_),ys(()=>{c(_)}),i.$$set=b=>{"object"in b&&e(2,u=b.object),"dispose"in b&&e(3,p=b.dispose),"$$scope"in b&&e(8,o=b.$$scope)},i.$$.update=()=>{i.$$.dirty&136&&v.set(p??r??!0),i.$$.dirty&116&&u!==h&&(c(_),e(5,_=n?a(u):[]),l(_),e(4,h=u))},[m,v,u,p,h,_,n,r,o,s]}class W9 extends uo{constructor(t){super(),ho(this,t,q9,G9,co,{object:2,dispose:3})}}function j9(i,t){const e=_a(i);let n=i;const r=e.subscribe(a=>n=a);return ys(r),{...e,set:a=>{if((a==null?void 0:a.uuid)===(n==null?void 0:n.uuid))return;const l=n;e.set(a),t==null||t(a,l)},update:a=>{const l=a(n);if((l==null?void 0:l.uuid)===(n==null?void 0:n.uuid))return;const c=n;e.set(l),t==null||t(l,c)}}}const Gd=()=>Ql("threlte"),QI=()=>Ql("threlte-hierarchical-parent-context");function X9(i){let t;const e=i[8].default,n=hh(e,i,i[7],null);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),t=!0},p(r,[s]){n&&n.p&&(!t||s&128)&&dh(n,e,r,r[7],t?fh(e,r[7],s,null):ph(r[7]),null)},i(r){t||(Pn(n,r),t=!0)},o(r){Bn(n,r),t=!1},d(r){n&&n.d(r)}}}const Y9=()=>({onChildMount:Ql("threlte-hierarchical-object-on-mount"),onChildDestroy:Ql("threlte-hierarchical-object-on-destroy")});function K9(i,t,e){var y;let n,{$$slots:r={},$$scope:s}=t,{object:o=void 0}=t,{children:a=[]}=t,{onChildMount:l=void 0}=t;const c=M=>{a.push(M),e(1,a),l==null||l(M)};let{onChildDestroy:u=void 0}=t;const h=M=>{const S=a.findIndex(E=>E.uuid===M.uuid);S!==-1&&a.splice(S,1),e(1,a),u==null||u(M)},{invalidate:p}=Gd(),m=QI();pa(i,m,M=>e(6,n=M));let{parent:v=n}=t;const _=Y9();o&&((y=_.onChildMount)==null||y.call(_,o),p("HierarchicalObject: object added"));const b=j9(o,(M,S)=>{var E,A;S&&((E=_.onChildDestroy)==null||E.call(_,S),p("HierarchicalObject: object added")),M&&((A=_.onChildMount)==null||A.call(_,M),p("HierarchicalObject: object removed"))});return ys(()=>{var M;o&&((M=_.onChildDestroy)==null||M.call(_,o),p("HierarchicalObject: object removed"))}),gl("threlte-hierarchical-object-on-mount",c),gl("threlte-hierarchical-object-on-destroy",h),gl("threlte-hierarchical-parent-context",b),i.$$set=M=>{"object"in M&&e(3,o=M.object),"children"in M&&e(1,a=M.children),"onChildMount"in M&&e(4,l=M.onChildMount),"onChildDestroy"in M&&e(5,u=M.onChildDestroy),"parent"in M&&e(2,v=M.parent),"$$scope"in M&&e(7,s=M.$$scope)},i.$$.update=()=>{i.$$.dirty&64&&e(2,v=n),i.$$.dirty&8&&b.set(o)},[m,a,v,o,l,u,n,s,r]}class Z9 extends uo{constructor(t){super(),ho(this,t,K9,X9,co,{object:3,children:1,onChildMount:4,onChildDestroy:5,parent:2})}}function J9(i){let t;const e=i[1].default,n=hh(e,i,i[4],null);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),t=!0},p(r,s){n&&n.p&&(!t||s&16)&&dh(n,e,r,r[4],t?fh(e,r[4],s,null):ph(r[4]),null)},i(r){t||(Pn(n,r),t=!0)},o(r){Bn(n,r),t=!1},d(r){n&&n.d(r)}}}function Q9(i){let t,e;return t=new Z9({props:{object:i[0],onChildMount:i[2],onChildDestroy:i[3],$$slots:{default:[J9]},$$scope:{ctx:i}}}),{c(){Cr(t.$$.fragment)},l(n){Er(t.$$.fragment,n)},m(n,r){Tr(t,n,r),e=!0},p(n,[r]){const s={};r&1&&(s.object=n[0]),r&1&&(s.onChildMount=n[2]),r&1&&(s.onChildDestroy=n[3]),r&16&&(s.$$scope={dirty:r,ctx:n}),t.$set(s)},i(n){e||(Pn(t.$$.fragment,n),e=!0)},o(n){Bn(t.$$.fragment,n),e=!1},d(n){Ar(t,n)}}}function tY(i,t,e){let{$$slots:n={},$$scope:r}=t,{object:s}=t;const o=l=>s.add(l),a=l=>s.remove(l);return i.$$set=l=>{"object"in l&&e(0,s=l.object),"$$scope"in l&&e(4,r=l.$$scope)},[s,n,o,a,r]}class eY extends uo{constructor(t){super(),ho(this,t,tY,Q9,co,{object:0})}}const tN=(i,t)=>{if(t.includes(".")){const e=t.split("."),n=e.pop();for(let r=0;r<e.length;r+=1)i=i[e[r]];return{target:i,key:n}}else return{target:i,key:t}},gS=Symbol("initialValueBeforeAttach"),nY=()=>{const{invalidate:i}=Gd();let t=!1,e=gS,n,r,s;const o=(l,c,u)=>{if(a(),!u){const h=l;((h==null?void 0:h.isMaterial)||!1)&&(u="material"),((h==null?void 0:h.isBufferGeometry)||(h==null?void 0:h.isGeometry)||!1)&&(u="geometry")}if(u){if(typeof u=="function")n=u(c,l);else{const{target:h,key:p}=tN(c,u);e=h[p],h[p]=l,r=h,s=p}t=!0,i()}},a=()=>{t&&(n?(n(),n=void 0):r&&s&&e!==gS&&(r[s]=e,e=gS,r=void 0,s=void 0),t=!1,i())};return ys(()=>{a()}),{update:o}},iY=i=>i&&i.isCamera,eN=i=>i&&i.isOrthographicCamera,nN=i=>i&&i.isPerspectiveCamera,rY=i=>nN(i)||eN(i),sY=()=>{const{invalidate:i,size:t,camera:e}=Gd();let n,r;ys(()=>{r==null||r()});const s=l=>{n&&(eN(n)?(n.left=l.width/-2,n.right=l.width/2,n.top=l.height/2,n.bottom=l.height/-2,n.updateProjectionMatrix(),n.updateMatrixWorld(),i()):nN(n)&&(n.aspect=l.width/l.height,n.updateProjectionMatrix(),n.updateMatrixWorld(),i()))};return{update:(l,c)=>{if(r==null||r(),c||!rY(l)){n=void 0;return}n=l,r=t.subscribe(s)},makeDefaultCamera:(l,c)=>{!iY(l)||!c||(e.set(l),i())}}},iN=()=>{const i=YC(),t=(n,r)=>{const s=i.$$.callbacks[n];s&&s.forEach(o=>{o(r)})};return Object.defineProperty(t,"hasEventListener",{value:n=>!!i.$$.callbacks[n],enumerable:!0}),t},oY=()=>{const i=iN(),t=[];let e,n=!1;const r=()=>{t.forEach(a=>a()),t.length=0,i("create",{ref:e,cleanup:a=>{t.push(a)}})},s=o=>{e=o,n&&r()};return Ey(()=>{r(),n=!0}),ys(()=>{t.forEach(o=>o())}),{updateRef:s}},fR=i=>!!(i!=null&&i.addEventListener),aY=()=>{const i=iN(),t=YC(),e=p=>{p!=null&&p.type&&i(p.type,p)},n=(p,m)=>{fR(p)&&m.forEach(v=>{p.removeEventListener(v,e)})},r=(p,m)=>{fR(p)&&m.forEach(v=>{p.addEventListener(v,e)})};let s=[],o;const a=_a([]),l=a.subscribe(p=>{n(o,s),r(o,p),s=p});ys(l);const c=_a(),u=c.subscribe(p=>{n(o,s),r(p,s),o=p});return ys(u),ys(()=>{n(o,s)}),Ey(()=>{a.set(Object.keys(t.$$.callbacks))}),{updateRef:p=>{c.set(p)}}},lY=i=>{const e=Ql("threlte-plugin-context");if(!e)return;const n=Object.values(e).map(c=>c(i)).filter(Boolean),r=n.flatMap(c=>c.pluginProps??[]);let s=[];return ys(()=>{s.forEach(c=>c())}),{updateRef:c=>{s.forEach(u=>u()),s=[],n.forEach(u=>{var p;const h=(p=u.onRefChange)==null?void 0:p.call(u,c);h&&s.push(h)})},updateProps:c=>{n.forEach(u=>{var h;(h=u.onPropsChange)==null||h.call(u,c)})},updateRestProps:c=>{n.forEach(u=>{var h;(h=u.onRestPropsChange)==null||h.call(u,c)})},pluginsProps:r}},cY=new Set(["$$scope","$$slots","type","args","attach","instance"]),uY=new Set(["fov","aspect","near","far","left","right","top","bottom","zoom"]),hY=i=>typeof i=="string"||typeof i=="number"||typeof i=="boolean"||typeof i>"u"||i===null,dY=()=>{const{invalidate:i}=Gd(),t=new Map,e=(r,s,o,a)=>{var u,h;if(hY(o)){const p=t.get(s);if(p&&p.instance===r&&p.value===o)return;t.set(s,{instance:r,value:o})}const{key:l,target:c}=tN(r,s);if(!Array.isArray(o)&&typeof o=="number"&&typeof((u=c[l])==null?void 0:u.setScalar)=="function")c[l].setScalar(o);else if(typeof((h=c[l])==null?void 0:h.set)=="function")Array.isArray(o)?c[l].set(...o):c[l].set(o);else{if(c[l]=o,a.manualCamera)return;uY.has(l)&&(c.isPerspectiveCamera||c.isOrthographicCamera)&&c.updateProjectionMatrix()}};return{updateProps:(r,s,o)=>{var a;for(const l in s)!cY.has(l)&&!((a=o.pluginsProps)!=null&&a.includes(l))&&e(r,l,s[l],o),i()}}},pY=i=>({ref:i&2}),mR=i=>({ref:i[1]}),fY=i=>({ref:i&2}),gR=i=>({ref:i[1]});function vR(i){let t,e;return t=new W9({props:{object:i[1],dispose:i[0]}}),{c(){Cr(t.$$.fragment)},l(n){Er(t.$$.fragment,n)},m(n,r){Tr(t,n,r),e=!0},p(n,r){const s={};r&2&&(s.object=n[1]),r&1&&(s.dispose=n[0]),t.$set(s)},i(n){e||(Pn(t.$$.fragment,n),e=!0)},o(n){Bn(t.$$.fragment,n),e=!1},d(n){Ar(t,n)}}}function mY(i){let t;const e=i[12].default,n=hh(e,i,i[13],mR);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),t=!0},p(r,s){n&&n.p&&(!t||s&8194)&&dh(n,e,r,r[13],t?fh(e,r[13],s,pY):ph(r[13]),mR)},i(r){t||(Pn(n,r),t=!0)},o(r){Bn(n,r),t=!1},d(r){n&&n.d(r)}}}function gY(i){let t,e;return t=new eY({props:{object:i[1],$$slots:{default:[vY]},$$scope:{ctx:i}}}),{c(){Cr(t.$$.fragment)},l(n){Er(t.$$.fragment,n)},m(n,r){Tr(t,n,r),e=!0},p(n,r){const s={};r&2&&(s.object=n[1]),r&8194&&(s.$$scope={dirty:r,ctx:n}),t.$set(s)},i(n){e||(Pn(t.$$.fragment,n),e=!0)},o(n){Bn(t.$$.fragment,n),e=!1},d(n){Ar(t,n)}}}function vY(i){let t;const e=i[12].default,n=hh(e,i,i[13],gR);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),t=!0},p(r,s){n&&n.p&&(!t||s&8194)&&dh(n,e,r,r[13],t?fh(e,r[13],s,fY):ph(r[13]),gR)},i(r){t||(Pn(n,r),t=!0)},o(r){Bn(n,r),t=!1},d(r){n&&n.d(r)}}}function _Y(i){let t=i[4](i[1]),e,n,r,s,o,a,l=t&&vR(i);const c=[gY,mY],u=[];function h(p,m){return m&2&&(n=null),n==null&&(n=!!p[3](p[1])),n?0:1}return r=h(i,-1),s=u[r]=c[r](i),{c(){l&&l.c(),e=Ju(),s.c(),o=jb()},l(p){l&&l.l(p),e=Qu(p),s.l(p),o=jb()},m(p,m){l&&l.m(p,m),qa(p,e,m),u[r].m(p,m),qa(p,o,m),a=!0},p(p,[m]){m&2&&(t=p[4](p[1])),t?l?(l.p(p,m),m&2&&Pn(l,1)):(l=vR(p),l.c(),Pn(l,1),l.m(e.parentNode,e)):l&&(fM(),Bn(l,1,1,()=>{l=null}),pM());let v=r;r=h(p,m),r===v?u[r].p(p,m):(fM(),Bn(u[v],1,1,()=>{u[v]=null}),pM(),s=u[r],s?s.p(p,m):(s=u[r]=c[r](p),s.c()),Pn(s,1),s.m(o.parentNode,o))},i(p){a||(Pn(l),Pn(s),a=!0)},o(p){Bn(l),Bn(s),a=!1},d(p){p&&(An(e),An(o)),l&&l.d(p),u[r].d(p)}}}function bY(i,t,e){const n=["is","args","attach","manual","makeDefault","dispose","ref"];let r=pf(t,n),s,{$$slots:o={},$$scope:a}=t,{is:l}=t,{args:c=void 0}=t,{attach:u=void 0}=t,{manual:h=void 0}=t,{makeDefault:p=void 0}=t,{dispose:m=void 0}=t;const v=Ql("threlte-hierarchical-parent-context");pa(i,v,z=>e(11,s=z));const _=z=>typeof z=="function"&&/^\s*class\s+/.test(z.toString()),b=z=>Array.isArray(z),y=oY();let M=_(l)&&b(c)?new l(...c):_(l)?new l:l;y.updateRef(M);let S=!1;const E=()=>{if(!S){S=!0;return}e(1,M=_(l)&&b(c)?new l(...c):_(l)?new l:l),y.updateRef(M)};let{ref:A=M}=t;const R=_a(M);gl("threlte-hierarchical-parent-context",R);const O=lY({ref:M,props:t}),L=(O==null?void 0:O.pluginsProps)??[],P=dY(),D=sY(),V=nY(),K=aY(),W=z=>!!z.isObject3D,Z=z=>z.dispose!==void 0;return i.$$set=z=>{e(27,t=vl(vl({},t),Wb(z))),e(26,r=pf(t,n)),"is"in z&&e(6,l=z.is),"args"in z&&e(7,c=z.args),"attach"in z&&e(8,u=z.attach),"manual"in z&&e(9,h=z.manual),"makeDefault"in z&&e(10,p=z.makeDefault),"dispose"in z&&e(0,m=z.dispose),"ref"in z&&e(5,A=z.ref),"$$scope"in z&&e(13,a=z.$$scope)},i.$$.update=()=>{i.$$.dirty&192&&E(),i.$$.dirty&2&&e(5,A=M),i.$$.dirty&2&&R.set(M),P.updateProps(M,r,{manualCamera:h,pluginsProps:L}),i.$$.dirty&514&&D.update(M,h),i.$$.dirty&1026&&D.makeDefaultCamera(M,p),i.$$.dirty&2306&&V.update(M,s,u),i.$$.dirty&2&&K.updateRef(M),i.$$.dirty&2&&(O==null||O.updateRef(M)),O==null||O.updateProps(t),O==null||O.updateRestProps(r)},t=Wb(t),[m,M,v,W,Z,A,l,c,u,h,p,s,o,a]}let tT=class extends uo{constructor(t){super(),ho(this,t,bY,_Y,co,{is:6,args:7,attach:8,manual:9,makeDefault:10,dispose:0,ref:5})}};const eT=typeof window<"u",yY=()=>{const i=_a({width:0,height:0});let t={width:0,height:0};const e=i.subscribe(o=>t=o);ys(e);let n;const r=()=>{const o=t;if(!n||!n.parentElement)return;const{clientWidth:a,clientHeight:l}=n.parentElement;(a!==o.width||l!==o.height)&&i.set({width:a,height:l})},s=o=>{n=o,r(),window.addEventListener("resize",r)};return eT?(ys(()=>{window.removeEventListener("resize",r)}),{parentSizeAction:s,parentSize:i}):{parentSize:i,parentSizeAction:s}},xY=()=>{gl("threlte-cache",[])},rN=i=>i.userData,wY=()=>{const i=new Di(75,0,.1,1e3);return rN(i).threlteDefaultCamera=!0,i.position.z=5,i.lookAt(0,0,0),i},SY=i=>{nT(i.size,t=>{rN(aD(i.camera)).threlteDefaultCamera&&i.camera.update(e=>{const n=e;return n.aspect=t.width/t.height,n.updateProjectionMatrix(),i.invalidate("Default camera: aspect ratio changed"),n})})},nT=(i,t)=>{const e=KC(i,s=>s);let n;const r=e.subscribe(async s=>{n&&n();const o=await t(s);o&&(n=o)});ys(()=>{r(),n&&n()})},zc=i=>{const t=_a(i),e={set:n=>{e.current=n,t.set(n)},subscribe:t.subscribe,update:n=>{const r=n(e.current);e.current=r,t.set(r)},current:i};return e},MY=i=>{const t={debugFrameloop:i.debugFrameloop,frame:0,frameInvalidated:!0,invalidations:{},manualFrameHandlers:new Set,autoFrameHandlers:new Set,allFrameHandlers:new Set,allFrameHandlersNeedSortCheck:!1,renderHandlers:new Set,renderHandlersNeedSortCheck:!1,advance:!1,dispose:async(o=!1)=>{await $$(),!(!t.shouldDispose&&!o)&&(t.disposableObjects.forEach((a,l)=>{var c;(a===0||o)&&((c=l==null?void 0:l.dispose)==null||c.call(l),t.disposableObjects.delete(l))}),t.shouldDispose=!1)},collectDisposableObjects:(o,a)=>{const l=a??[];return o&&(o!=null&&o.dispose&&typeof o.dispose=="function"&&o.type!=="Scene"&&l.push(o),Object.entries(o).forEach(([c,u])=>{if(c==="parent"||c==="children"||typeof u!="object")return;const h=u;h!=null&&h.dispose&&t.collectDisposableObjects(h,l)})),l},addDisposableObjects:o=>{o.forEach(a=>{const l=t.disposableObjects.get(a);l?t.disposableObjects.set(a,l+1):t.disposableObjects.set(a,1)})},removeDisposableObjects:o=>{o.length!==0&&(o.forEach(a=>{const l=t.disposableObjects.get(a);l&&l>0&&t.disposableObjects.set(a,l-1)}),t.shouldDispose=!0)},disposableObjects:new Map,shouldDispose:!1},e={size:KC([i.userSize,i.parentSize],([o,a])=>o||a),clock:new KE,camera:zc(wY()),scene:new Hf,renderer:void 0,invalidate:o=>{t.frameInvalidated=!0,t.debugFrameloop&&o&&(t.invalidations[o]=t.invalidations[o]?t.invalidations[o]+1:1)},advance:()=>{t.advance=!0},colorSpace:zc(i.colorSpace),toneMapping:zc(i.toneMapping),dpr:zc(i.dpr),useLegacyLights:zc(i.useLegacyLights),shadows:zc(i.shadows),colorManagementEnabled:zc(i.colorManagementEnabled),frameloop:zc(i.frameloop)},n=zc({});return gl("threlte",e),gl("threlte-internal-context",t),gl("threlte-user-context",n),{ctx:e,internalCtx:t,getCtx:()=>e,getInternalCtx:()=>t}},CY=(i,t,e)=>{if(t.allFrameHandlers.size!==0){if(t.allFrameHandlersNeedSortCheck){const n=Array.from(t.allFrameHandlers);if(n.some(s=>s.order)){const s=n.sort((o,a)=>(o.order??0)>(a.order??0)?1:-1);t.allFrameHandlers.clear(),s.forEach(o=>t.allFrameHandlers.add(o))}t.allFrameHandlersNeedSortCheck=!1}if(t.debugFrameloop){let n=0;t.autoFrameHandlers.forEach(r=>{r.debugFrameloopMessage?t.invalidations[r.debugFrameloopMessage]=r.debugFrameloopMessage in t.invalidations?t.invalidations[r.debugFrameloopMessage]+1:1:++n}),n>0&&(t.invalidations.useFrame=t.autoFrameHandlers.size)}t.allFrameHandlers.forEach(n=>n.fn(i,e))}},EY=(i,t,e)=>{if(t.renderHandlers.size!==0){if(t.renderHandlersNeedSortCheck){const n=Array.from(t.renderHandlers);if(n.some(s=>s.order)){const s=n.sort((o,a)=>(o.order??0)>(a.order??0)?1:-1);t.renderHandlers.clear(),s.forEach(o=>t.renderHandlers.add(o))}t.renderHandlersNeedSortCheck=!1}t.renderHandlers.forEach(n=>n.fn(i,e))}},TY=i=>{i.debugFrameloop&&(i.frame+=1,console.log(`frame: ${i.frame}${Object.keys(i.invalidations).length>0?", requested by ":""}`),Object.keys(i.invalidations).length>0&&console.table(i.invalidations),i.invalidations={})},AY=(i,t)=>i.frameloop.current==="always"||i.frameloop.current==="demand"&&(t.frameInvalidated||t.autoFrameHandlers.size>0)||i.frameloop.current==="never"&&t.advance,PY=(i,t)=>{var e;(e=i.renderer)==null||e.setAnimationLoop(()=>{t.dispose();const n=i.clock.getDelta();CY(i,t,n),AY(i,t)&&(t.renderHandlers.size>0?EY(i,t,n):i.renderer&&i.camera.current&&i.renderer.render(i.scene,i.camera.current),TY(t),t.frameInvalidated=!1,t.advance=!1)})},RY={srgb:Xc,"srgb-linear":Fg,"":Fg},kY=i=>i.outputColorSpace!==void 0,LY=i=>{const t=_a(void 0),e=(n,r)=>{i.renderer=new RE({powerPreference:"high-performance",canvas:n,antialias:!0,alpha:!0,...r}),t.set(i.renderer)};return nT([t,i.size,i.toneMapping,i.colorSpace,i.dpr,i.shadows,i.colorManagementEnabled,i.useLegacyLights],([n,r,s,o,a,l,c,u])=>{if(!n)return;if(n.setSize(r.width,r.height),n.setPixelRatio(a),kY(n))n.outputColorSpace=o;else{const m=RY[o];m?n.outputEncoding=m:console.warn("No encoding found for colorSpace",o)}n.toneMapping=s,n.shadowMap.enabled=!!l,l&&l!==!0?n.shadowMap.type=l:l===!0&&(n.shadowMap.type=Py);const h=oa;h.enabled!==void 0?h.enabled=c:h.legacyMode!==void 0&&(h.legacyMode=!c);const p=n;u&&p.useLegacyLights!==void 0?p.useLegacyLights=u:p.physicallyCorrectLights!==void 0&&(p.physicallyCorrectLights=!u)}),ys(()=>{var n;(n=i.renderer)==null||n.dispose()}),{createRenderer:e}};function _R(i){let t,e;return t=new tT({props:{is:i[3].ctx.scene,$$slots:{default:[OY]},$$scope:{ctx:i}}}),{c(){Cr(t.$$.fragment)},l(n){Er(t.$$.fragment,n)},m(n,r){Tr(t,n,r),e=!0},p(n,r){const s={};r&131072&&(s.$$scope={dirty:r,ctx:n}),t.$set(s)},i(n){e||(Pn(t.$$.fragment,n),e=!0)},o(n){Bn(t.$$.fragment,n),e=!1},d(n){Ar(t,n)}}}function OY(i){let t;const e=i[15].default,n=hh(e,i,i[17],null);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),t=!0},p(r,s){n&&n.p&&(!t||s&131072)&&dh(n,e,r,r[17],t?fh(e,r[17],s,null):ph(r[17]),null)},i(r){t||(Pn(n,r),t=!0)},o(r){Bn(n,r),t=!1},d(r){n&&n.d(r)}}}function DY(i){let t,e,n,r,s=i[1]&&_R(i);return{c(){t=Hi("canvas"),s&&s.c(),this.h()},l(o){t=$i(o,"CANVAS",{class:!0});var a=lD(t);s&&s.l(a),a.forEach(An),this.h()},h(){Pe(t,"class","svelte-15bl8wt")},m(o,a){qa(o,t,a),s&&s.m(t,null),i[16](t),e=!0,n||(r=G$(i[2].call(null,t)),n=!0)},p(o,[a]){o[1]?s?(s.p(o,a),a&2&&Pn(s,1)):(s=_R(o),s.c(),Pn(s,1),s.m(t,null)):s&&(fM(),Bn(s,1,1,()=>{s=null}),pM())},i(o){e||(Pn(s),e=!0)},o(o){Bn(s),e=!1},d(o){o&&An(t),s&&s.d(),i[16](null),n=!1,r()}}}const bR=new Set;function IY(i,t,e){let{$$slots:n={},$$scope:r}=t,{dpr:s=eT?window.devicePixelRatio:1}=t,{toneMapping:o=uE}=t,{colorSpace:a="srgb"}=t,{frameloop:l="demand"}=t,{debugFrameloop:c=!1}=t,{shadows:u=Py}=t,{size:h=void 0}=t,{rendererParameters:p=void 0}=t,{colorManagementEnabled:m=!0}=t,{useLegacyLights:v=!0}=t,_,b=!1;const y=_a(h),{parentSize:M,parentSizeAction:S}=yY(),E=MY({colorSpace:a,toneMapping:o,dpr:s,userSize:y,parentSize:M,debugFrameloop:c,frameloop:l,shadows:u,colorManagementEnabled:m,useLegacyLights:v});xY();const A=E.ctx;SY(A),bR.add(A.invalidate),ys(()=>{bR.delete(A.invalidate)});const{createRenderer:R}=LY(A);Ey(()=>{_&&(R(_,p),PY(E.ctx,E.internalCtx),e(1,b=!0))}),ys(()=>{var L;E.internalCtx.dispose(!0),(L=E.ctx.renderer)==null||L.setAnimationLoop(null)});function O(L){Ty[L?"unshift":"push"](()=>{_=L,e(0,_)})}return i.$$set=L=>{"dpr"in L&&e(4,s=L.dpr),"toneMapping"in L&&e(5,o=L.toneMapping),"colorSpace"in L&&e(6,a=L.colorSpace),"frameloop"in L&&e(7,l=L.frameloop),"debugFrameloop"in L&&e(8,c=L.debugFrameloop),"shadows"in L&&e(9,u=L.shadows),"size"in L&&e(10,h=L.size),"rendererParameters"in L&&e(11,p=L.rendererParameters),"colorManagementEnabled"in L&&e(12,m=L.colorManagementEnabled),"useLegacyLights"in L&&e(13,v=L.useLegacyLights),"$$scope"in L&&e(17,r=L.$$scope)},i.$$.update=()=>{i.$$.dirty&1024&&y.set(h)},[_,b,S,E,s,o,a,l,c,u,h,p,m,v,A,n,O,r]}class NY extends uo{constructor(t){super(),ho(this,t,IY,DY,co,{dpr:4,toneMapping:5,colorSpace:6,frameloop:7,debugFrameloop:8,shadows:9,size:10,rendererParameters:11,colorManagementEnabled:12,useLegacyLights:13,ctx:14})}get ctx(){return this.$$.ctx[14]}}const zY={},UY=(i,t)=>{const e=zY[t]||H9[t];if(!e)throw new Error(`No Three.js module found for ${t}. Did you forget to extend the catalogue?`);return{...i,props:{...i.props,is:e}}},FY=i=>new Proxy(class{},{construct(t,[e]){const n=e;return new tT(UY(n,i))}}),Tv=new Proxy(class{},{construct(i,[t]){const e=t;return new tT(e)},get(i,t){return FY(t)}}),sN=(i,t)=>{if(!eT)return{start:()=>{},stop:()=>{},started:K$(!1)};const e=(t==null?void 0:t.invalidate)??!0,n=Ql("threlte-internal-context"),r={fn:i,order:t==null?void 0:t.order,debugFrameloopMessage:t==null?void 0:t.debugFrameloopMessage,invalidate:e},s=_a(!1),o=()=>{e?n.autoFrameHandlers.delete(r):n.manualFrameHandlers.delete(r),n.allFrameHandlers.delete(r),s.set(!1)},a=()=>{e?n.autoFrameHandlers.add(r):n.manualFrameHandlers.add(r),n.allFrameHandlers.add(r),n.allFrameHandlersNeedSortCheck=!0,s.set(!0)};return((t==null?void 0:t.autostart)??!0)&&a(),ys(()=>{o()}),{start:a,stop:o,started:{subscribe:s.subscribe}}};function VY(i,t,e){const n=Ql("threlte-user-context");if(!n)throw new Error("No user context store found, did you invoke this function outside of your main <Canvas> component?");return i?i&&!t?KC(n,r=>r[i]):(n.update(r=>{if(i in r){if(!e||e.existing==="skip")return r;if(e.existing==="merge")return Object.assign(r[i],t),r}return r[i]=t,r}),n.current[i]):{subscribe:n.subscribe}}const oN=()=>{const i=YC(),t=_a(void 0);return nT(t,e=>{e&&Object.entries(i.$$.callbacks).forEach(n=>{const[r,s]=n;r in e.$$.callbacks&&Array.isArray(e.$$.callbacks[r])?e.$$.callbacks[r].push(...s):e.$$.callbacks[r]=s})}),t};new Y;new Y;new Y;const BY=i=>({ref:i&1}),yR=i=>({ref:i[0]});function HY(i){let t,e,n;t=new Tv.PlaneGeometry({props:{args:typeof i[1]=="number"?[i[1],i[1]]:i[1]}});const r=i[17].default,s=hh(r,i,i[20],yR);return{c(){Cr(t.$$.fragment),e=Ju(),s&&s.c()},l(o){Er(t.$$.fragment,o),e=Qu(o),s&&s.l(o)},m(o,a){Tr(t,o,a),qa(o,e,a),s&&s.m(o,a),n=!0},p(o,a){const l={};a&2&&(l.args=typeof o[1]=="number"?[o[1],o[1]]:o[1]),t.$set(l),s&&s.p&&(!n||a&1048577)&&dh(s,r,o,o[20],n?fh(r,o[20],a,BY):ph(o[20]),yR)},i(o){n||(Pn(t.$$.fragment,o),Pn(s,o),n=!0)},o(o){Bn(t.$$.fragment,o),Bn(s,o),n=!1},d(o){o&&An(e),Ar(t,o),s&&s.d(o)}}}function $Y(i){let t,e,n;const r=[{material:i[2]},{frustumCulled:!1},i[5]];function s(a){i[19](a)}let o={$$slots:{default:[HY,({ref:a})=>({0:a}),({ref:a})=>a?1:0]},$$scope:{ctx:i}};for(let a=0;a<r.length;a+=1)o=vl(o,r[a]);return i[0]!==void 0&&(o.ref=i[0]),t=new Tv.Mesh({props:o}),i[18](t),Ty.push(()=>Y$(t,"ref",s)),{c(){Cr(t.$$.fragment)},l(a){Er(t.$$.fragment,a)},m(a,l){Tr(t,a,l),n=!0},p(a,[l]){const c=l&36?xg(r,[l&4&&{material:a[2]},r[1],l&32&&wg(a[5])]):{};l&1048579&&(c.$$scope={dirty:l,ctx:a}),!e&&l&1&&(e=!0,c.ref=a[0],q$(()=>e=!1)),t.$set(c)},i(a){n||(Pn(t.$$.fragment,a),n=!0)},o(a){Bn(t.$$.fragment,a),n=!1},d(a){i[18](null),Ar(t,a)}}}function GY(i,t,e){let n;const r=["cellColor","sectionColor","cellSize","sectionSize","axes","gridSize","followCamera","infiniteGrid","fadeDistance","fadeStrength","cellThickness","sectionThickness","ref"];let s=pf(t,r),o,{$$slots:a={},$$scope:l}=t,{cellColor:c="#000000"}=t,{sectionColor:u="#0000ee"}=t,{cellSize:h=1}=t,{sectionSize:p=10}=t,{axes:m="xzy"}=t,{gridSize:v=[20,20]}=t,{followCamera:_=!1}=t,{infiniteGrid:b=!1}=t,{fadeDistance:y=100}=t,{fadeStrength:M=1}=t,{cellThickness:S=1}=t,{sectionThickness:E=2}=t,{ref:A}=t;const{invalidate:R}=Gd(),O=V=>new yl({side:pr,uniforms:{uSize1:{value:h},uSize2:{value:p},uColor1:{value:new me(c)},uColor2:{value:new me(u)},uFadeDistance:{value:y},uFadeStrength:{value:M},uThickness1:{value:1},uThickness2:{value:1},uInfiniteGrid:{value:b?1:0},uFollowCamera:{value:0}},transparent:!0,vertexShader:`
      varying vec3 worldPosition;
      uniform float uFadeDistance;
      uniform float uInfiniteGrid;
      uniform float uFollowCamera;

      void main() {

        vec3 pos = position.${V} * (1. + uFadeDistance * uInfiniteGrid);
        pos.${V.slice(0,2)} += (cameraPosition.${V.slice(0,2)} * uFollowCamera);

        worldPosition = pos;

        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);

      }`,fragmentShader:`
      varying vec3 worldPosition;
      uniform float uSize1;
      uniform float uSize2;
      uniform vec3 uColor1;
      uniform vec3 uColor2;
      uniform float uFadeDistance;
      uniform float uFadeStrength;
      uniform float uThickness1;
      uniform float uThickness2;
      uniform float uInfiniteGrid;

      float getGrid(float size, float thickness) {

        vec2 r = worldPosition.${V.slice(0,2)} / size;

        vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
        float line = min(grid.x, grid.y) + 1. - thickness;

        return 1.0 - min(line, 1.);
      }

      void main() {

        float g1 = getGrid(uSize1, uThickness1);
        float g2 = getGrid(uSize2, uThickness2);

        float d = 1.0 - min(distance(cameraPosition.${V.slice(0,2)}, worldPosition.${V.slice(0,2)}) / uFadeDistance, 1.);
        vec3 color = mix(uColor1, uColor2, min(1.,uThickness2*g2));

        gl_FragColor = vec4(color, (g1 + g2) * pow(d,uFadeStrength));
        gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);

        if(gl_FragColor.a <= 0.0)
          discard;
        #include <tonemapping_fragment>
        #include <encodings_fragment>
      }
       `,extensions:{derivatives:!0}}),L=oN();pa(i,L,V=>e(3,o=V));function P(V){Ty[V?"unshift":"push"](()=>{o=V,L.set(o)})}function D(V){A=V,e(0,A)}return i.$$set=V=>{t=vl(vl({},t),Wb(V)),e(5,s=pf(t,r)),"cellColor"in V&&e(6,c=V.cellColor),"sectionColor"in V&&e(7,u=V.sectionColor),"cellSize"in V&&e(8,h=V.cellSize),"sectionSize"in V&&e(9,p=V.sectionSize),"axes"in V&&e(10,m=V.axes),"gridSize"in V&&e(1,v=V.gridSize),"followCamera"in V&&e(11,_=V.followCamera),"infiniteGrid"in V&&e(12,b=V.infiniteGrid),"fadeDistance"in V&&e(13,y=V.fadeDistance),"fadeStrength"in V&&e(14,M=V.fadeStrength),"cellThickness"in V&&e(15,S=V.cellThickness),"sectionThickness"in V&&e(16,E=V.sectionThickness),"ref"in V&&e(0,A=V.ref),"$$scope"in V&&e(20,l=V.$$scope)},i.$$.update=()=>{i.$$.dirty&1024&&e(2,n=O(m)),i.$$.dirty&131008&&(e(2,n.uniforms.uSize1={value:h},n),e(2,n.uniforms.uSize2={value:p},n),e(2,n.uniforms.uColor1={value:new me(c)},n),e(2,n.uniforms.uColor2={value:new me(u)},n),e(2,n.uniforms.uFadeDistance={value:y},n),e(2,n.uniforms.uFadeStrength={value:M},n),e(2,n.uniforms.uThickness1={value:S},n),e(2,n.uniforms.uThickness2={value:E},n),e(2,n.uniforms.uFollowCamera={value:_?1:0},n),e(2,n.uniforms.uInfiniteGrid={value:b?1:0},n),R("Grid uniforms changed")),i.$$.dirty&4&&n&&R("Grid axes changed")},[A,v,n,o,L,s,c,u,h,p,m,_,b,y,M,S,E,a,P,D,l]}let vS=class extends uo{constructor(t){super(),ho(this,t,GY,$Y,co,{cellColor:6,sectionColor:7,cellSize:8,sectionSize:9,axes:10,gridSize:1,followCamera:11,infiniteGrid:12,fadeDistance:13,fadeStrength:14,cellThickness:15,sectionThickness:16,ref:0})}};var Jb={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Jb.exports;(function(i,t){(function(){var e,n="4.17.21",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",c=500,u="__lodash_placeholder__",h=1,p=2,m=4,v=1,_=2,b=1,y=2,M=4,S=8,E=16,A=32,R=64,O=128,L=256,P=512,D=30,V="...",K=800,W=16,Z=1,z=2,ut=3,nt=1/0,Q=9007199254740991,St=17976931348623157e292,Pt=0/0,dt=4294967295,Rt=dt-1,Jt=dt>>>1,Bt=[["ary",O],["bind",b],["bindKey",y],["curry",S],["curryRight",E],["flip",P],["partial",A],["partialRight",R],["rearg",L]],Wt="[object Arguments]",be="[object Array]",re="[object AsyncFunction]",It="[object Boolean]",ye="[object Date]",ce="[object DOMException]",ne="[object Error]",Gt="[object Function]",J="[object GeneratorFunction]",$t="[object Map]",et="[object Number]",ft="[object Null]",kt="[object Object]",Qt="[object Promise]",qt="[object Proxy]",ot="[object RegExp]",st="[object Set]",_t="[object String]",$="[object Symbol]",B="[object Undefined]",Lt="[object WeakMap]",jt="[object WeakSet]",Kt="[object ArrayBuffer]",se="[object DataView]",we="[object Float32Array]",ht="[object Float64Array]",mt="[object Int8Array]",tt="[object Int16Array]",Ut="[object Int32Array]",oe="[object Uint8Array]",ue="[object Uint8ClampedArray]",ae="[object Uint16Array]",xe="[object Uint32Array]",Ze=/\b__p \+= '';/g,pt=/\b(__p \+=) '' \+/g,ee=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Mt=/&(?:amp|lt|gt|quot|#39);/g,ie=/[&<>"']/g,le=RegExp(Mt.source),Xe=RegExp(ie.source),Rn=/<%-([\s\S]+?)%>/g,Zn=/<%([\s\S]+?)%>/g,Wr=/<%=([\s\S]+?)%>/g,mn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jr=/^\w*$/,Jn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xr=/[\\^$.*+?()[\]{}|]/g,qo=RegExp(Xr.source),xa=/^\s+/,As=/\s/,Wo=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ja=/\{\n\/\* \[wrapped with (.+)\] \*/,Tl=/,? & /,uu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ws=/[()=,{}\[\]\/\s]/,Al=/\\(\\)?/g,vr=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,X=/\w*$/,At=/^[-+]0x[0-9a-f]+$/i,Nt=/^0b[01]+$/i,wt=/^\[object .+?Constructor\]$/,Ft=/^0o[0-7]+$/i,fe=/^(?:0|[1-9]\d*)$/,Re=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Me=/($^)/,ze=/['\n\r\u2028\u2029\\]/g,Ye="\\ud800-\\udfff",De="\\u0300-\\u036f",Ue="\\ufe20-\\ufe2f",Qn="\\u20d0-\\u20ff",kn=De+Ue+Qn,qi="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Qe="\\xac\\xb1\\xd7\\xf7",Ve="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",js="\\u2000-\\u206f",yi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",oi="A-Z\\xc0-\\xd6\\xd8-\\xde",Ni="\\ufe0e\\ufe0f",wa=Qe+Ve+js+yi,jo="[']",ai="["+Ye+"]",Ps="["+wa+"]",Xo="["+kn+"]",kr="\\d+",Xa="["+qi+"]",uc="["+Rr+"]",Sa="[^"+Ye+wa+kr+qi+Rr+oi+"]",zi="\\ud83c[\\udffb-\\udfff]",er="(?:"+Xo+"|"+zi+")",hc="[^"+Ye+"]",Ma="(?:\\ud83c[\\udde6-\\uddff]){2}",os="[\\ud800-\\udbff][\\udc00-\\udfff]",as="["+oi+"]",Yo="\\u200d",Pl="(?:"+uc+"|"+Sa+")",Ya="(?:"+as+"|"+Sa+")",en="(?:"+jo+"(?:d|ll|m|re|s|t|ve))?",hu="(?:"+jo+"(?:D|LL|M|RE|S|T|VE))?",mo=er+"?",du="["+Ni+"]?",Rl="(?:"+Yo+"(?:"+[hc,Ma,os].join("|")+")"+du+mo+")*",pu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",kl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ca=du+mo+Rl,fu="(?:"+[Xa,Ma,os].join("|")+")"+Ca,op="(?:"+[hc+Xo+"?",Xo,Ma,os,ai].join("|")+")",Ea=RegExp(jo,"g"),ls=RegExp(Xo,"g"),mu=RegExp(zi+"(?="+zi+")|"+op+Ca,"g"),Th=RegExp([as+"?"+uc+"+"+en+"(?="+[Ps,as,"$"].join("|")+")",Ya+"+"+hu+"(?="+[Ps,as+Pl,"$"].join("|")+")",as+"?"+Pl+"+"+en,as+"+"+hu,kl,pu,kr,fu].join("|"),"g"),ap=RegExp("["+Yo+Ye+kn+Ni+"]"),Yr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ka=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gu=-1,jn={};jn[we]=jn[ht]=jn[mt]=jn[tt]=jn[Ut]=jn[oe]=jn[ue]=jn[ae]=jn[xe]=!0,jn[Wt]=jn[be]=jn[Kt]=jn[It]=jn[se]=jn[ye]=jn[ne]=jn[Gt]=jn[$t]=jn[et]=jn[kt]=jn[ot]=jn[st]=jn[_t]=jn[Lt]=!1;var ei={};ei[Wt]=ei[be]=ei[Kt]=ei[se]=ei[It]=ei[ye]=ei[we]=ei[ht]=ei[mt]=ei[tt]=ei[Ut]=ei[$t]=ei[et]=ei[kt]=ei[ot]=ei[st]=ei[_t]=ei[$]=ei[oe]=ei[ue]=ei[ae]=ei[xe]=!0,ei[ne]=ei[Gt]=ei[Lt]=!1;var Xs={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Ah={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ll={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ol={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ko=parseFloat,Ph=parseInt,dc=typeof zt=="object"&&zt&&zt.Object===Object&&zt,um=typeof self=="object"&&self&&self.Object===Object&&self,Wi=dc||um||Function("return this")(),Rh=t&&!t.nodeType&&t,Rs=Rh&&!0&&i&&!i.nodeType&&i,pc=Rs&&Rs.exports===Rh,kh=pc&&dc.process,Kr=function(){try{var lt=Rs&&Rs.require&&Rs.require("util").types;return lt||kh&&kh.binding&&kh.binding("util")}catch{}}(),Lh=Kr&&Kr.isArrayBuffer,lp=Kr&&Kr.isDate,Oh=Kr&&Kr.isMap,Dh=Kr&&Kr.isRegExp,fc=Kr&&Kr.isSet,vu=Kr&&Kr.isTypedArray;function Fe(lt,Ot,Tt){switch(Tt.length){case 0:return lt.call(Ot);case 1:return lt.call(Ot,Tt[0]);case 2:return lt.call(Ot,Tt[0],Tt[1]);case 3:return lt.call(Ot,Tt[0],Tt[1],Tt[2])}return lt.apply(Ot,Tt)}function cp(lt,Ot,Tt,he){for(var bt=-1,Je=lt==null?0:lt.length;++bt<Je;){var $n=lt[bt];Ot(he,$n,Tt($n),lt)}return he}function cs(lt,Ot){for(var Tt=-1,he=lt==null?0:lt.length;++Tt<he&&Ot(lt[Tt],Tt,lt)!==!1;);return lt}function mc(lt,Ot){for(var Tt=lt==null?0:lt.length;Tt--&&Ot(lt[Tt],Tt,lt)!==!1;);return lt}function up(lt,Ot){for(var Tt=-1,he=lt==null?0:lt.length;++Tt<he;)if(!Ot(lt[Tt],Tt,lt))return!1;return!0}function _r(lt,Ot){for(var Tt=-1,he=lt==null?0:lt.length,bt=0,Je=[];++Tt<he;){var $n=lt[Tt];Ot($n,Tt,lt)&&(Je[bt++]=$n)}return Je}function gc(lt,Ot){var Tt=lt==null?0:lt.length;return!!Tt&&de(lt,Ot,0)>-1}function _u(lt,Ot,Tt){for(var he=-1,bt=lt==null?0:lt.length;++he<bt;)if(Tt(Ot,lt[he]))return!0;return!1}function nn(lt,Ot){for(var Tt=-1,he=lt==null?0:lt.length,bt=Array(he);++Tt<he;)bt[Tt]=Ot(lt[Tt],Tt,lt);return bt}function Ta(lt,Ot){for(var Tt=-1,he=Ot.length,bt=lt.length;++Tt<he;)lt[bt+Tt]=Ot[Tt];return lt}function yt(lt,Ot,Tt,he){var bt=-1,Je=lt==null?0:lt.length;for(he&&Je&&(Tt=lt[++bt]);++bt<Je;)Tt=Ot(Tt,lt[bt],bt,lt);return Tt}function F(lt,Ot,Tt,he){var bt=lt==null?0:lt.length;for(he&&bt&&(Tt=lt[--bt]);bt--;)Tt=Ot(Tt,lt[bt],bt,lt);return Tt}function at(lt,Ot){for(var Tt=-1,he=lt==null?0:lt.length;++Tt<he;)if(Ot(lt[Tt],Tt,lt))return!0;return!1}var q=Ee("length");function j(lt){return lt.split("")}function gt(lt){return lt.match(uu)||[]}function Dt(lt,Ot,Tt){var he;return Tt(lt,function(bt,Je,$n){if(Ot(bt,Je,$n))return he=Je,!1}),he}function Et(lt,Ot,Tt,he){for(var bt=lt.length,Je=Tt+(he?1:-1);he?Je--:++Je<bt;)if(Ot(lt[Je],Je,lt))return Je;return-1}function de(lt,Ot,Tt){return Ot===Ot?Za(lt,Ot,Tt):Et(lt,sn,Tt)}function $e(lt,Ot,Tt,he){for(var bt=Tt-1,Je=lt.length;++bt<Je;)if(he(lt[bt],Ot))return bt;return-1}function sn(lt){return lt!==lt}function Ce(lt,Ot){var Tt=lt==null?0:lt.length;return Tt?ni(lt,Ot)/Tt:Pt}function Ee(lt){return function(Ot){return Ot==null?e:Ot[lt]}}function Ht(lt){return function(Ot){return lt==null?e:lt[Ot]}}function ke(lt,Ot,Tt,he,bt){return bt(lt,function(Je,$n,ve){Tt=he?(he=!1,Je):Ot(Tt,Je,$n,ve)}),Tt}function Ln(lt,Ot){var Tt=lt.length;for(lt.sort(Ot);Tt--;)lt[Tt]=lt[Tt].value;return lt}function ni(lt,Ot){for(var Tt,he=-1,bt=lt.length;++he<bt;){var Je=Ot(lt[he]);Je!==e&&(Tt=Tt===e?Je:Tt+Je)}return Tt}function ui(lt,Ot){for(var Tt=-1,he=Array(lt);++Tt<lt;)he[Tt]=Ot(Tt);return he}function hi(lt,Ot){return nn(Ot,function(Tt){return[Tt,lt[Tt]]})}function nr(lt){return lt&&lt.slice(0,Or(lt)+1).replace(xa,"")}function Le(lt){return function(Ot){return lt(Ot)}}function Lr(lt,Ot){return nn(Ot,function(Tt){return lt[Tt]})}function ti(lt,Ot){return lt.has(Ot)}function Be(lt,Ot){for(var Tt=-1,he=lt.length;++Tt<he&&de(Ot,lt[Tt],0)>-1;);return Tt}function Ui(lt,Ot){for(var Tt=lt.length;Tt--&&de(Ot,lt[Tt],0)>-1;);return Tt}function br(lt,Ot){for(var Tt=lt.length,he=0;Tt--;)lt[Tt]===Ot&&++he;return he}var Oe=Ht(Xs),mi=Ht(Ah);function qe(lt){return"\\"+Ol[lt]}function Ys(lt,Ot){return lt==null?e:lt[Ot]}function gi(lt){return ap.test(lt)}function ir(lt){return Yr.test(lt)}function Fi(lt){for(var Ot,Tt=[];!(Ot=lt.next()).done;)Tt.push(Ot.value);return Tt}function Sn(lt){var Ot=-1,Tt=Array(lt.size);return lt.forEach(function(he,bt){Tt[++Ot]=[bt,he]}),Tt}function vi(lt,Ot){return function(Tt){return lt(Ot(Tt))}}function ii(lt,Ot){for(var Tt=-1,he=lt.length,bt=0,Je=[];++Tt<he;){var $n=lt[Tt];($n===Ot||$n===u)&&(lt[Tt]=u,Je[bt++]=Tt)}return Je}function Ct(lt){var Ot=-1,Tt=Array(lt.size);return lt.forEach(function(he){Tt[++Ot]=he}),Tt}function ji(lt){var Ot=-1,Tt=Array(lt.size);return lt.forEach(function(he){Tt[++Ot]=[he,he]}),Tt}function Za(lt,Ot,Tt){for(var he=Tt-1,bt=lt.length;++he<bt;)if(lt[he]===Ot)return he;return-1}function us(lt,Ot,Tt){for(var he=Tt+1;he--;)if(lt[he]===Ot)return he;return he}function yr(lt){return gi(lt)?Dr(lt):q(lt)}function Xi(lt){return gi(lt)?Ir(lt):j(lt)}function Or(lt){for(var Ot=lt.length;Ot--&&As.test(lt.charAt(Ot)););return Ot}var Vi=Ht(Ll);function Dr(lt){for(var Ot=mu.lastIndex=0;mu.test(lt);)++Ot;return Ot}function Ir(lt){return lt.match(mu)||[]}function Aa(lt){return lt.match(Th)||[]}var Bi=function lt(Ot){Ot=Ot==null?Wi:Nr.defaults(Wi.Object(),Ot,Nr.pick(Wi,Ka));var Tt=Ot.Array,he=Ot.Date,bt=Ot.Error,Je=Ot.Function,$n=Ot.Math,ve=Ot.Object,Xn=Ot.RegExp,Ja=Ot.String,rr=Ot.TypeError,go=Tt.prototype,xi=Je.prototype,On=ve.prototype,hs=Ot["__core-js_shared__"],di=xi.toString,yn=On.hasOwnProperty,vo=0,ks=function(){var d=/[^.]+$/.exec(hs&&hs.keys&&hs.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),sr=On.toString,Pa=di.call(ve),Qa=Wi._,tl=Xn("^"+di.call(yn).replace(Xr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ks=pc?Ot.Buffer:e,zr=Ot.Symbol,Ls=Ot.Uint8Array,xn=Ks?Ks.allocUnsafe:e,_o=vi(ve.getPrototypeOf,ve),ws=ve.create,Os=On.propertyIsEnumerable,Zr=go.splice,Zo=zr?zr.isConcatSpreadable:e,Zs=zr?zr.iterator:e,Ur=zr?zr.toStringTag:e,Ke=function(){try{var d=Bh(ve,"defineProperty");return d({},"",{}),d}catch{}}(),Ie=Ot.clearTimeout!==Wi.clearTimeout&&Ot.clearTimeout,En=he&&he.now!==Wi.Date.now&&he.now,wi=Ot.setTimeout!==Wi.setTimeout&&Ot.setTimeout,_e=$n.ceil,on=$n.floor,Ne=ve.getOwnPropertySymbols,ln=Ks?Ks.isBuffer:e,Ri=Ot.isFinite,Mn=go.join,ki=vi(ve.keys,ve),gn=$n.max,Dn=$n.min,Si=he.now,ri=Ot.parseInt,Ss=$n.random,Mi=go.reverse,Fr=Bh(Ot,"DataView"),ds=Bh(Ot,"Map"),Jr=Bh(Ot,"Promise"),_i=Bh(Ot,"Set"),bi=Bh(Ot,"WeakMap"),Js=Bh(ve,"create"),el=bi&&new bi,li={},Yi=Hh(Fr),bo=Hh(ds),Ih=Hh(Jr),hp=Hh(_i),nl=Hh(bi),Ms=zr?zr.prototype:e,Qs=Ms?Ms.valueOf:e,vc=Ms?Ms.toString:e;function H(d){if(or(d)&&!an(d)&&!(d instanceof Cn)){if(d instanceof yo)return d;if(yn.call(d,"__wrapped__"))return iP(d)}return new yo(d)}var Dl=function(){function d(){}return function(g){if(!Ki(g))return{};if(ws)return ws(g);d.prototype=g;var C=new d;return d.prototype=e,C}}();function Nh(){}function yo(d,g){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=e}H.templateSettings={escape:Rn,evaluate:Zn,interpolate:Wr,variable:"",imports:{_:H}},H.prototype=Nh.prototype,H.prototype.constructor=H,yo.prototype=Dl(Nh.prototype),yo.prototype.constructor=yo;function Cn(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=dt,this.__views__=[]}function Aw(){var d=new Cn(this.__wrapped__);return d.__actions__=So(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=So(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=So(this.__views__),d}function hm(){if(this.__filtered__){var d=new Cn(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function Pw(){var d=this.__wrapped__.value(),g=this.__dir__,C=an(d),k=g<0,N=C?d.length:0,G=gB(0,N,this.__views__),rt=G.start,ct=G.end,vt=ct-rt,Xt=k?ct:rt-1,Yt=this.__iteratees__,te=Yt.length,ge=0,Ae=Dn(vt,this.__takeCount__);if(!C||!k&&N==vt&&Ae==vt)return Ul(d,this.__actions__);var We=[];t:for(;vt--&&ge<Ae;){Xt+=g;for(var vn=-1,je=d[Xt];++vn<te;){var Tn=Yt[vn],zn=Tn.iteratee,ea=Tn.type,eo=zn(je);if(ea==z)je=eo;else if(!eo){if(ea==Z)continue t;break t}}We[ge++]=je}return We}Cn.prototype=Dl(Nh.prototype),Cn.prototype.constructor=Cn;function _c(d){var g=-1,C=d==null?0:d.length;for(this.clear();++g<C;){var k=d[g];this.set(k[0],k[1])}}function dm(){this.__data__=Js?Js(null):{},this.size=0}function Rw(d){var g=this.has(d)&&delete this.__data__[d];return this.size-=g?1:0,g}function kw(d){var g=this.__data__;if(Js){var C=g[d];return C===l?e:C}return yn.call(g,d)?g[d]:e}function Lw(d){var g=this.__data__;return Js?g[d]!==e:yn.call(g,d)}function Ow(d,g){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Js&&g===e?l:g,this}_c.prototype.clear=dm,_c.prototype.delete=Rw,_c.prototype.get=kw,_c.prototype.has=Lw,_c.prototype.set=Ow;function il(d){var g=-1,C=d==null?0:d.length;for(this.clear();++g<C;){var k=d[g];this.set(k[0],k[1])}}function Dw(){this.__data__=[],this.size=0}function Iw(d){var g=this.__data__,C=Qo(g,d);if(C<0)return!1;var k=g.length-1;return C==k?g.pop():Zr.call(g,C,1),--this.size,!0}function Nw(d){var g=this.__data__,C=Qo(g,d);return C<0?e:g[C][1]}function zw(d){return Qo(this.__data__,d)>-1}function Uw(d,g){var C=this.__data__,k=Qo(C,d);return k<0?(++this.size,C.push([d,g])):C[k][1]=g,this}il.prototype.clear=Dw,il.prototype.delete=Iw,il.prototype.get=Nw,il.prototype.has=zw,il.prototype.set=Uw;function rl(d){var g=-1,C=d==null?0:d.length;for(this.clear();++g<C;){var k=d[g];this.set(k[0],k[1])}}function Fw(){this.size=0,this.__data__={hash:new _c,map:new(ds||il),string:new _c}}function pm(d){var g=n0(this,d).delete(d);return this.size-=g?1:0,g}function Vw(d){return n0(this,d).get(d)}function Bw(d){return n0(this,d).has(d)}function Hw(d,g){var C=n0(this,d),k=C.size;return C.set(d,g),this.size+=C.size==k?0:1,this}rl.prototype.clear=Fw,rl.prototype.delete=pm,rl.prototype.get=Vw,rl.prototype.has=Bw,rl.prototype.set=Hw;function bc(d){var g=-1,C=d==null?0:d.length;for(this.__data__=new rl;++g<C;)this.add(d[g])}function $w(d){return this.__data__.set(d,l),this}function Gw(d){return this.__data__.has(d)}bc.prototype.add=bc.prototype.push=$w,bc.prototype.has=Gw;function Jo(d){var g=this.__data__=new il(d);this.size=g.size}function qw(){this.__data__=new il,this.size=0}function Il(d){var g=this.__data__,C=g.delete(d);return this.size=g.size,C}function L_(d){return this.__data__.get(d)}function Ww(d){return this.__data__.has(d)}function jw(d,g){var C=this.__data__;if(C instanceof il){var k=C.__data__;if(!ds||k.length<r-1)return k.push([d,g]),this.size=++C.size,this;C=this.__data__=new rl(k)}return C.set(d,g),this.size=C.size,this}Jo.prototype.clear=qw,Jo.prototype.delete=Il,Jo.prototype.get=L_,Jo.prototype.has=Ww,Jo.prototype.set=jw;function dp(d,g){var C=an(d),k=!C&&$h(d),N=!C&&!k&&Eu(d),G=!C&&!k&&!N&&bp(d),rt=C||k||N||G,ct=rt?ui(d.length,Ja):[],vt=ct.length;for(var Xt in d)(g||yn.call(d,Xt))&&!(rt&&(Xt=="length"||N&&(Xt=="offset"||Xt=="parent")||G&&(Xt=="buffer"||Xt=="byteLength"||Xt=="byteOffset")||Ec(Xt,vt)))&&ct.push(Xt);return ct}function fm(d){var g=d.length;return g?d[km(0,g-1)]:e}function O_(d,g){return i0(So(d),Nl(g,0,d.length))}function Xw(d){return i0(So(d))}function mm(d,g,C){(C!==e&&!sl(d[g],C)||C===e&&!(g in d))&&ps(d,g,C)}function zh(d,g,C){var k=d[g];(!(yn.call(d,g)&&sl(k,C))||C===e&&!(g in d))&&ps(d,g,C)}function Qo(d,g){for(var C=d.length;C--;)if(sl(d[C][0],g))return C;return-1}function D_(d,g,C,k){return zl(d,function(N,G,rt){g(k,N,C(N),rt)}),k}function yc(d,g){return d&&Fl(g,ms(g),d)}function Yw(d,g){return d&&Fl(g,Co(g),d)}function ps(d,g,C){g=="__proto__"&&Ke?Ke(d,g,{configurable:!0,enumerable:!0,value:C,writable:!0}):d[g]=C}function gm(d,g){for(var C=-1,k=g.length,N=Tt(k),G=d==null;++C<k;)N[C]=G?e:A1(d,g[C]);return N}function Nl(d,g,C){return d===d&&(C!==e&&(d=d<=C?d:C),g!==e&&(d=d>=g?d:g)),d}function xo(d,g,C,k,N,G){var rt,ct=g&h,vt=g&p,Xt=g&m;if(C&&(rt=N?C(d,k,N,G):C(d)),rt!==e)return rt;if(!Ki(d))return d;var Yt=an(d);if(Yt){if(rt=_B(d),!ct)return So(d,rt)}else{var te=Ds(d),ge=te==Gt||te==J;if(Eu(d))return PA(d,ct);if(te==kt||te==Wt||ge&&!N){if(rt=vt||ge?{}:XA(d),!ct)return vt?aB(d,Yw(rt,d)):oB(d,yc(rt,d))}else{if(!ei[te])return N?d:{};rt=bB(d,te,ct)}}G||(G=new Jo);var Ae=G.get(d);if(Ae)return Ae;G.set(d,rt),SP(d)?d.forEach(function(je){rt.add(xo(je,g,C,je,d,G))}):xP(d)&&d.forEach(function(je,Tn){rt.set(Tn,xo(je,g,C,Tn,d,G))});var We=Xt?vt?f1:p1:vt?Co:ms,vn=Yt?e:We(d);return cs(vn||d,function(je,Tn){vn&&(Tn=je,je=d[Tn]),zh(rt,Tn,xo(je,g,C,Tn,d,G))}),rt}function Kw(d){var g=ms(d);return function(C){return xc(C,d,g)}}function xc(d,g,C){var k=C.length;if(d==null)return!k;for(d=ve(d);k--;){var N=C[k],G=g[N],rt=d[N];if(rt===e&&!(N in d)||!G(rt))return!1}return!0}function vm(d,g,C){if(typeof d!="function")throw new rr(o);return Im(function(){d.apply(e,C)},g)}function Uh(d,g,C,k){var N=-1,G=gc,rt=!0,ct=d.length,vt=[],Xt=g.length;if(!ct)return vt;C&&(g=nn(g,Le(C))),k?(G=_u,rt=!1):g.length>=r&&(G=ti,rt=!1,g=new bc(g));t:for(;++N<ct;){var Yt=d[N],te=C==null?Yt:C(Yt);if(Yt=k||Yt!==0?Yt:0,rt&&te===te){for(var ge=Xt;ge--;)if(g[ge]===te)continue t;vt.push(Yt)}else G(g,te,k)||vt.push(Yt)}return vt}var zl=DA(Ra),I_=DA(xm,!0);function _m(d,g){var C=!0;return zl(d,function(k,N,G){return C=!!g(k,N,G),C}),C}function pp(d,g,C){for(var k=-1,N=d.length;++k<N;){var G=d[k],rt=g(G);if(rt!=null&&(ct===e?rt===rt&&!ta(rt):C(rt,ct)))var ct=rt,vt=G}return vt}function bu(d,g,C,k){var N=d.length;for(C=hn(C),C<0&&(C=-C>N?0:N+C),k=k===e||k>N?N:hn(k),k<0&&(k+=N),k=C>k?0:CP(k);C<k;)d[C++]=g;return d}function bm(d,g){var C=[];return zl(d,function(k,N,G){g(k,N,G)&&C.push(k)}),C}function Qr(d,g,C,k,N){var G=-1,rt=d.length;for(C||(C=xB),N||(N=[]);++G<rt;){var ct=d[G];g>0&&C(ct)?g>1?Qr(ct,g-1,C,k,N):Ta(N,ct):k||(N[N.length]=ct)}return N}var ym=IA(),N_=IA(!0);function Ra(d,g){return d&&ym(d,g,ms)}function xm(d,g){return d&&N_(d,g,ms)}function fp(d,g){return _r(g,function(C){return Tc(d[C])})}function wc(d,g){g=Mu(g,d);for(var C=0,k=g.length;d!=null&&C<k;)d=d[Vl(g[C++])];return C&&C==k?d:e}function yu(d,g,C){var k=g(d);return an(d)?k:Ta(k,C(d))}function fs(d){return d==null?d===e?B:ft:Ur&&Ur in ve(d)?mB(d):AB(d)}function wm(d,g){return d>g}function Sm(d,g){return d!=null&&yn.call(d,g)}function z_(d,g){return d!=null&&g in ve(d)}function Zw(d,g,C){return d>=Dn(g,C)&&d<gn(g,C)}function Fh(d,g,C){for(var k=C?_u:gc,N=d[0].length,G=d.length,rt=G,ct=Tt(G),vt=1/0,Xt=[];rt--;){var Yt=d[rt];rt&&g&&(Yt=nn(Yt,Le(g))),vt=Dn(Yt.length,vt),ct[rt]=!C&&(g||N>=120&&Yt.length>=120)?new bc(rt&&Yt):e}Yt=d[0];var te=-1,ge=ct[0];t:for(;++te<N&&Xt.length<vt;){var Ae=Yt[te],We=g?g(Ae):Ae;if(Ae=C||Ae!==0?Ae:0,!(ge?ti(ge,We):k(Xt,We,C))){for(rt=G;--rt;){var vn=ct[rt];if(!(vn?ti(vn,We):k(d[rt],We,C)))continue t}ge&&ge.push(We),Xt.push(Ae)}}return Xt}function Jw(d,g,C,k){return Ra(d,function(N,G,rt){g(k,C(N),G,rt)}),k}function wo(d,g,C){g=Mu(g,d),d=JA(d,g);var k=d==null?d:d[Vl(La(g))];return k==null?e:Fe(k,d,C)}function U_(d){return or(d)&&fs(d)==Wt}function Qw(d){return or(d)&&fs(d)==Kt}function Mm(d){return or(d)&&fs(d)==ye}function Vh(d,g,C,k,N){return d===g?!0:d==null||g==null||!or(d)&&!or(g)?d!==d&&g!==g:t1(d,g,C,k,Vh,N)}function t1(d,g,C,k,N,G){var rt=an(d),ct=an(g),vt=rt?be:Ds(d),Xt=ct?be:Ds(g);vt=vt==Wt?kt:vt,Xt=Xt==Wt?kt:Xt;var Yt=vt==kt,te=Xt==kt,ge=vt==Xt;if(ge&&Eu(d)){if(!Eu(g))return!1;rt=!0,Yt=!1}if(ge&&!Yt)return G||(G=new Jo),rt||bp(d)?qA(d,g,C,k,N,G):pB(d,g,vt,C,k,N,G);if(!(C&v)){var Ae=Yt&&yn.call(d,"__wrapped__"),We=te&&yn.call(g,"__wrapped__");if(Ae||We){var vn=Ae?d.value():d,je=We?g.value():g;return G||(G=new Jo),N(vn,je,C,k,G)}}return ge?(G||(G=new Jo),fB(d,g,C,k,N,G)):!1}function F_(d){return or(d)&&Ds(d)==$t}function Cm(d,g,C,k){var N=C.length,G=N,rt=!k;if(d==null)return!G;for(d=ve(d);N--;){var ct=C[N];if(rt&&ct[2]?ct[1]!==d[ct[0]]:!(ct[0]in d))return!1}for(;++N<G;){ct=C[N];var vt=ct[0],Xt=d[vt],Yt=ct[1];if(rt&&ct[2]){if(Xt===e&&!(vt in d))return!1}else{var te=new Jo;if(k)var ge=k(Xt,Yt,vt,d,g,te);if(!(ge===e?Vh(Yt,Xt,v|_,k,te):ge))return!1}}return!0}function V_(d){if(!Ki(d)||SB(d))return!1;var g=Tc(d)?tl:wt;return g.test(Hh(d))}function e1(d){return or(d)&&fs(d)==ot}function n1(d){return or(d)&&Ds(d)==st}function i1(d){return or(d)&&c0(d.length)&&!!jn[fs(d)]}function B_(d){return typeof d=="function"?d:d==null?Eo:typeof d=="object"?an(d)?Am(d[0],d[1]):H_(d):NP(d)}function Em(d){if(!Dm(d))return ki(d);var g=[];for(var C in ve(d))yn.call(d,C)&&C!="constructor"&&g.push(C);return g}function r1(d){if(!Ki(d))return TB(d);var g=Dm(d),C=[];for(var k in d)k=="constructor"&&(g||!yn.call(d,k))||C.push(k);return C}function Tm(d,g){return d<g}function ka(d,g){var C=-1,k=Mo(d)?Tt(d.length):[];return zl(d,function(N,G,rt){k[++C]=g(N,G,rt)}),k}function H_(d){var g=g1(d);return g.length==1&&g[0][2]?KA(g[0][0],g[0][1]):function(C){return C===d||Cm(C,d,g)}}function Am(d,g){return _1(d)&&YA(g)?KA(Vl(d),g):function(C){var k=A1(C,d);return k===e&&k===g?P1(C,d):Vh(g,k,v|_)}}function mp(d,g,C,k,N){d!==g&&ym(g,function(G,rt){if(N||(N=new Jo),Ki(G))$_(d,g,rt,C,mp,k,N);else{var ct=k?k(y1(d,rt),G,rt+"",d,g,N):e;ct===e&&(ct=G),mm(d,rt,ct)}},Co)}function $_(d,g,C,k,N,G,rt){var ct=y1(d,C),vt=y1(g,C),Xt=rt.get(vt);if(Xt){mm(d,C,Xt);return}var Yt=G?G(ct,vt,C+"",d,g,rt):e,te=Yt===e;if(te){var ge=an(vt),Ae=!ge&&Eu(vt),We=!ge&&!Ae&&bp(vt);Yt=vt,ge||Ae||We?an(ct)?Yt=ct:xr(ct)?Yt=So(ct):Ae?(te=!1,Yt=PA(vt,!0)):We?(te=!1,Yt=RA(vt,!0)):Yt=[]:Nm(vt)||$h(vt)?(Yt=ct,$h(ct)?Yt=EP(ct):(!Ki(ct)||Tc(ct))&&(Yt=XA(vt))):te=!1}te&&(rt.set(vt,Yt),N(Yt,vt,k,G,rt),rt.delete(vt)),mm(d,C,Yt)}function G_(d,g){var C=d.length;if(C)return g+=g<0?C:0,Ec(g,C)?d[g]:e}function q_(d,g,C){g.length?g=nn(g,function(G){return an(G)?function(rt){return wc(rt,G.length===1?G[0]:G)}:G}):g=[Eo];var k=-1;g=nn(g,Le(Ge()));var N=ka(d,function(G,rt,ct){var vt=nn(g,function(Xt){return Xt(G)});return{criteria:vt,index:++k,value:G}});return Ln(N,function(G,rt){return sB(G,rt,C)})}function W_(d,g){return Pm(d,g,function(C,k){return P1(d,k)})}function Pm(d,g,C){for(var k=-1,N=g.length,G={};++k<N;){var rt=g[k],ct=wc(d,rt);C(ct,rt)&&xu(G,Mu(rt,d),ct)}return G}function j_(d){return function(g){return wc(g,d)}}function Rm(d,g,C,k){var N=k?$e:de,G=-1,rt=g.length,ct=d;for(d===g&&(g=So(g)),C&&(ct=nn(d,Le(C)));++G<rt;)for(var vt=0,Xt=g[G],Yt=C?C(Xt):Xt;(vt=N(ct,Yt,vt,k))>-1;)ct!==d&&Zr.call(ct,vt,1),Zr.call(d,vt,1);return d}function X_(d,g){for(var C=d?g.length:0,k=C-1;C--;){var N=g[C];if(C==k||N!==G){var G=N;Ec(N)?Zr.call(d,N,1):He(d,N)}}return d}function km(d,g){return d+on(Ss()*(g-d+1))}function s1(d,g,C,k){for(var N=-1,G=gn(_e((g-d)/(C||1)),0),rt=Tt(G);G--;)rt[k?G:++N]=d,d+=C;return rt}function Lm(d,g){var C="";if(!d||g<1||g>Q)return C;do g%2&&(C+=d),g=on(g/2),g&&(d+=d);while(g);return C}function un(d,g){return x1(ZA(d,g,Eo),d+"")}function o1(d){return fm(yp(d))}function a1(d,g){var C=yp(d);return i0(C,Nl(g,0,C.length))}function xu(d,g,C,k){if(!Ki(d))return d;g=Mu(g,d);for(var N=-1,G=g.length,rt=G-1,ct=d;ct!=null&&++N<G;){var vt=Vl(g[N]),Xt=C;if(vt==="__proto__"||vt==="constructor"||vt==="prototype")return d;if(N!=rt){var Yt=ct[vt];Xt=k?k(Yt,vt,ct):e,Xt===e&&(Xt=Ki(Yt)?Yt:Ec(g[N+1])?[]:{})}zh(ct,vt,Xt),ct=ct[vt]}return d}var Y_=el?function(d,g){return el.set(d,g),d}:Eo,l1=Ke?function(d,g){return Ke(d,"toString",{configurable:!0,enumerable:!1,value:k1(g),writable:!0})}:Eo;function w(d){return i0(yp(d))}function f(d,g,C){var k=-1,N=d.length;g<0&&(g=-g>N?0:N+g),C=C>N?N:C,C<0&&(C+=N),N=g>C?0:C-g>>>0,g>>>=0;for(var G=Tt(N);++k<N;)G[k]=d[k+g];return G}function x(d,g){var C;return zl(d,function(k,N,G){return C=g(k,N,G),!C}),!!C}function T(d,g,C){var k=0,N=d==null?k:d.length;if(typeof g=="number"&&g===g&&N<=Jt){for(;k<N;){var G=k+N>>>1,rt=d[G];rt!==null&&!ta(rt)&&(C?rt<=g:rt<g)?k=G+1:N=G}return N}return I(d,g,Eo,C)}function I(d,g,C,k){var N=0,G=d==null?0:d.length;if(G===0)return 0;g=C(g);for(var rt=g!==g,ct=g===null,vt=ta(g),Xt=g===e;N<G;){var Yt=on((N+G)/2),te=C(d[Yt]),ge=te!==e,Ae=te===null,We=te===te,vn=ta(te);if(rt)var je=k||We;else Xt?je=We&&(k||ge):ct?je=We&&ge&&(k||!Ae):vt?je=We&&ge&&!Ae&&(k||!vn):Ae||vn?je=!1:je=k?te<=g:te<g;je?N=Yt+1:G=Yt}return Dn(G,Rt)}function it(d,g){for(var C=-1,k=d.length,N=0,G=[];++C<k;){var rt=d[C],ct=g?g(rt):rt;if(!C||!sl(ct,vt)){var vt=ct;G[N++]=rt===0?0:rt}}return G}function xt(d){return typeof d=="number"?d:ta(d)?Pt:+d}function Zt(d){if(typeof d=="string")return d;if(an(d))return nn(d,Zt)+"";if(ta(d))return vc?vc.call(d):"";var g=d+"";return g=="0"&&1/d==-nt?"-0":g}function Te(d,g,C){var k=-1,N=gc,G=d.length,rt=!0,ct=[],vt=ct;if(C)rt=!1,N=_u;else if(G>=r){var Xt=g?null:hB(d);if(Xt)return Ct(Xt);rt=!1,N=ti,vt=new bc}else vt=g?[]:ct;t:for(;++k<G;){var Yt=d[k],te=g?g(Yt):Yt;if(Yt=C||Yt!==0?Yt:0,rt&&te===te){for(var ge=vt.length;ge--;)if(vt[ge]===te)continue t;g&&vt.push(te),ct.push(Yt)}else N(vt,te,C)||(vt!==ct&&vt.push(te),ct.push(Yt))}return ct}function He(d,g){return g=Mu(g,d),d=JA(d,g),d==null||delete d[Vl(La(g))]}function Nn(d,g,C,k){return xu(d,g,C(wc(d,g)),k)}function In(d,g,C,k){for(var N=d.length,G=k?N:-1;(k?G--:++G<N)&&g(d[G],G,d););return C?f(d,k?0:G,k?G+1:N):f(d,k?G+1:0,k?N:G)}function Ul(d,g){var C=d;return C instanceof Cn&&(C=C.value()),yt(g,function(k,N){return N.func.apply(N.thisArg,Ta([k],N.args))},C)}function Sc(d,g,C){var k=d.length;if(k<2)return k?Te(d[0]):[];for(var N=-1,G=Tt(k);++N<k;)for(var rt=d[N],ct=-1;++ct<k;)ct!=N&&(G[N]=Uh(G[N]||rt,d[ct],g,C));return Te(Qr(G,1),g,C)}function wu(d,g,C){for(var k=-1,N=d.length,G=g.length,rt={};++k<N;){var ct=k<G?g[k]:e;C(rt,d[k],ct)}return rt}function Su(d){return xr(d)?d:[]}function c1(d){return typeof d=="function"?d:Eo}function Mu(d,g){return an(d)?d:_1(d,g)?[d]:nP(ci(d))}var eB=un;function Cu(d,g,C){var k=d.length;return C=C===e?k:C,!g&&C>=k?d:f(d,g,C)}var AA=Ie||function(d){return Wi.clearTimeout(d)};function PA(d,g){if(g)return d.slice();var C=d.length,k=xn?xn(C):new d.constructor(C);return d.copy(k),k}function u1(d){var g=new d.constructor(d.byteLength);return new Ls(g).set(new Ls(d)),g}function nB(d,g){var C=g?u1(d.buffer):d.buffer;return new d.constructor(C,d.byteOffset,d.byteLength)}function iB(d){var g=new d.constructor(d.source,X.exec(d));return g.lastIndex=d.lastIndex,g}function rB(d){return Qs?ve(Qs.call(d)):{}}function RA(d,g){var C=g?u1(d.buffer):d.buffer;return new d.constructor(C,d.byteOffset,d.length)}function kA(d,g){if(d!==g){var C=d!==e,k=d===null,N=d===d,G=ta(d),rt=g!==e,ct=g===null,vt=g===g,Xt=ta(g);if(!ct&&!Xt&&!G&&d>g||G&&rt&&vt&&!ct&&!Xt||k&&rt&&vt||!C&&vt||!N)return 1;if(!k&&!G&&!Xt&&d<g||Xt&&C&&N&&!k&&!G||ct&&C&&N||!rt&&N||!vt)return-1}return 0}function sB(d,g,C){for(var k=-1,N=d.criteria,G=g.criteria,rt=N.length,ct=C.length;++k<rt;){var vt=kA(N[k],G[k]);if(vt){if(k>=ct)return vt;var Xt=C[k];return vt*(Xt=="desc"?-1:1)}}return d.index-g.index}function LA(d,g,C,k){for(var N=-1,G=d.length,rt=C.length,ct=-1,vt=g.length,Xt=gn(G-rt,0),Yt=Tt(vt+Xt),te=!k;++ct<vt;)Yt[ct]=g[ct];for(;++N<rt;)(te||N<G)&&(Yt[C[N]]=d[N]);for(;Xt--;)Yt[ct++]=d[N++];return Yt}function OA(d,g,C,k){for(var N=-1,G=d.length,rt=-1,ct=C.length,vt=-1,Xt=g.length,Yt=gn(G-ct,0),te=Tt(Yt+Xt),ge=!k;++N<Yt;)te[N]=d[N];for(var Ae=N;++vt<Xt;)te[Ae+vt]=g[vt];for(;++rt<ct;)(ge||N<G)&&(te[Ae+C[rt]]=d[N++]);return te}function So(d,g){var C=-1,k=d.length;for(g||(g=Tt(k));++C<k;)g[C]=d[C];return g}function Fl(d,g,C,k){var N=!C;C||(C={});for(var G=-1,rt=g.length;++G<rt;){var ct=g[G],vt=k?k(C[ct],d[ct],ct,C,d):e;vt===e&&(vt=d[ct]),N?ps(C,ct,vt):zh(C,ct,vt)}return C}function oB(d,g){return Fl(d,v1(d),g)}function aB(d,g){return Fl(d,WA(d),g)}function K_(d,g){return function(C,k){var N=an(C)?cp:D_,G=g?g():{};return N(C,d,Ge(k,2),G)}}function gp(d){return un(function(g,C){var k=-1,N=C.length,G=N>1?C[N-1]:e,rt=N>2?C[2]:e;for(G=d.length>3&&typeof G=="function"?(N--,G):e,rt&&to(C[0],C[1],rt)&&(G=N<3?e:G,N=1),g=ve(g);++k<N;){var ct=C[k];ct&&d(g,ct,k,G)}return g})}function DA(d,g){return function(C,k){if(C==null)return C;if(!Mo(C))return d(C,k);for(var N=C.length,G=g?N:-1,rt=ve(C);(g?G--:++G<N)&&k(rt[G],G,rt)!==!1;);return C}}function IA(d){return function(g,C,k){for(var N=-1,G=ve(g),rt=k(g),ct=rt.length;ct--;){var vt=rt[d?ct:++N];if(C(G[vt],vt,G)===!1)break}return g}}function lB(d,g,C){var k=g&b,N=Om(d);function G(){var rt=this&&this!==Wi&&this instanceof G?N:d;return rt.apply(k?C:this,arguments)}return G}function NA(d){return function(g){g=ci(g);var C=gi(g)?Xi(g):e,k=C?C[0]:g.charAt(0),N=C?Cu(C,1).join(""):g.slice(1);return k[d]()+N}}function vp(d){return function(g){return yt(DP(OP(g).replace(Ea,"")),d,"")}}function Om(d){return function(){var g=arguments;switch(g.length){case 0:return new d;case 1:return new d(g[0]);case 2:return new d(g[0],g[1]);case 3:return new d(g[0],g[1],g[2]);case 4:return new d(g[0],g[1],g[2],g[3]);case 5:return new d(g[0],g[1],g[2],g[3],g[4]);case 6:return new d(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new d(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var C=Dl(d.prototype),k=d.apply(C,g);return Ki(k)?k:C}}function cB(d,g,C){var k=Om(d);function N(){for(var G=arguments.length,rt=Tt(G),ct=G,vt=_p(N);ct--;)rt[ct]=arguments[ct];var Xt=G<3&&rt[0]!==vt&&rt[G-1]!==vt?[]:ii(rt,vt);if(G-=Xt.length,G<C)return BA(d,g,Z_,N.placeholder,e,rt,Xt,e,e,C-G);var Yt=this&&this!==Wi&&this instanceof N?k:d;return Fe(Yt,this,rt)}return N}function zA(d){return function(g,C,k){var N=ve(g);if(!Mo(g)){var G=Ge(C,3);g=ms(g),C=function(ct){return G(N[ct],ct,N)}}var rt=d(g,C,k);return rt>-1?N[G?g[rt]:rt]:e}}function UA(d){return Cc(function(g){var C=g.length,k=C,N=yo.prototype.thru;for(d&&g.reverse();k--;){var G=g[k];if(typeof G!="function")throw new rr(o);if(N&&!rt&&e0(G)=="wrapper")var rt=new yo([],!0)}for(k=rt?k:C;++k<C;){G=g[k];var ct=e0(G),vt=ct=="wrapper"?m1(G):e;vt&&b1(vt[0])&&vt[1]==(O|S|A|L)&&!vt[4].length&&vt[9]==1?rt=rt[e0(vt[0])].apply(rt,vt[3]):rt=G.length==1&&b1(G)?rt[ct]():rt.thru(G)}return function(){var Xt=arguments,Yt=Xt[0];if(rt&&Xt.length==1&&an(Yt))return rt.plant(Yt).value();for(var te=0,ge=C?g[te].apply(this,Xt):Yt;++te<C;)ge=g[te].call(this,ge);return ge}})}function Z_(d,g,C,k,N,G,rt,ct,vt,Xt){var Yt=g&O,te=g&b,ge=g&y,Ae=g&(S|E),We=g&P,vn=ge?e:Om(d);function je(){for(var Tn=arguments.length,zn=Tt(Tn),ea=Tn;ea--;)zn[ea]=arguments[ea];if(Ae)var eo=_p(je),na=br(zn,eo);if(k&&(zn=LA(zn,k,N,Ae)),G&&(zn=OA(zn,G,rt,Ae)),Tn-=na,Ae&&Tn<Xt){var wr=ii(zn,eo);return BA(d,g,Z_,je.placeholder,C,zn,wr,ct,vt,Xt-Tn)}var ol=te?C:this,Pc=ge?ol[d]:d;return Tn=zn.length,ct?zn=PB(zn,ct):We&&Tn>1&&zn.reverse(),Yt&&vt<Tn&&(zn.length=vt),this&&this!==Wi&&this instanceof je&&(Pc=vn||Om(Pc)),Pc.apply(ol,zn)}return je}function FA(d,g){return function(C,k){return Jw(C,d,g(k),{})}}function J_(d,g){return function(C,k){var N;if(C===e&&k===e)return g;if(C!==e&&(N=C),k!==e){if(N===e)return k;typeof C=="string"||typeof k=="string"?(C=Zt(C),k=Zt(k)):(C=xt(C),k=xt(k)),N=d(C,k)}return N}}function h1(d){return Cc(function(g){return g=nn(g,Le(Ge())),un(function(C){var k=this;return d(g,function(N){return Fe(N,k,C)})})})}function Q_(d,g){g=g===e?" ":Zt(g);var C=g.length;if(C<2)return C?Lm(g,d):g;var k=Lm(g,_e(d/yr(g)));return gi(g)?Cu(Xi(k),0,d).join(""):k.slice(0,d)}function uB(d,g,C,k){var N=g&b,G=Om(d);function rt(){for(var ct=-1,vt=arguments.length,Xt=-1,Yt=k.length,te=Tt(Yt+vt),ge=this&&this!==Wi&&this instanceof rt?G:d;++Xt<Yt;)te[Xt]=k[Xt];for(;vt--;)te[Xt++]=arguments[++ct];return Fe(ge,N?C:this,te)}return rt}function VA(d){return function(g,C,k){return k&&typeof k!="number"&&to(g,C,k)&&(C=k=e),g=Ac(g),C===e?(C=g,g=0):C=Ac(C),k=k===e?g<C?1:-1:Ac(k),s1(g,C,k,d)}}function t0(d){return function(g,C){return typeof g=="string"&&typeof C=="string"||(g=Oa(g),C=Oa(C)),d(g,C)}}function BA(d,g,C,k,N,G,rt,ct,vt,Xt){var Yt=g&S,te=Yt?rt:e,ge=Yt?e:rt,Ae=Yt?G:e,We=Yt?e:G;g|=Yt?A:R,g&=~(Yt?R:A),g&M||(g&=~(b|y));var vn=[d,g,N,Ae,te,We,ge,ct,vt,Xt],je=C.apply(e,vn);return b1(d)&&QA(je,vn),je.placeholder=k,tP(je,d,g)}function d1(d){var g=$n[d];return function(C,k){if(C=Oa(C),k=k==null?0:Dn(hn(k),292),k&&Ri(C)){var N=(ci(C)+"e").split("e"),G=g(N[0]+"e"+(+N[1]+k));return N=(ci(G)+"e").split("e"),+(N[0]+"e"+(+N[1]-k))}return g(C)}}var hB=_i&&1/Ct(new _i([,-0]))[1]==nt?function(d){return new _i(d)}:D1;function HA(d){return function(g){var C=Ds(g);return C==$t?Sn(g):C==st?ji(g):hi(g,d(g))}}function Mc(d,g,C,k,N,G,rt,ct){var vt=g&y;if(!vt&&typeof d!="function")throw new rr(o);var Xt=k?k.length:0;if(Xt||(g&=~(A|R),k=N=e),rt=rt===e?rt:gn(hn(rt),0),ct=ct===e?ct:hn(ct),Xt-=N?N.length:0,g&R){var Yt=k,te=N;k=N=e}var ge=vt?e:m1(d),Ae=[d,g,C,k,N,Yt,te,G,rt,ct];if(ge&&EB(Ae,ge),d=Ae[0],g=Ae[1],C=Ae[2],k=Ae[3],N=Ae[4],ct=Ae[9]=Ae[9]===e?vt?0:d.length:gn(Ae[9]-Xt,0),!ct&&g&(S|E)&&(g&=~(S|E)),!g||g==b)var We=lB(d,g,C);else g==S||g==E?We=cB(d,g,ct):(g==A||g==(b|A))&&!N.length?We=uB(d,g,C,k):We=Z_.apply(e,Ae);var vn=ge?Y_:QA;return tP(vn(We,Ae),d,g)}function $A(d,g,C,k){return d===e||sl(d,On[C])&&!yn.call(k,C)?g:d}function GA(d,g,C,k,N,G){return Ki(d)&&Ki(g)&&(G.set(g,d),mp(d,g,e,GA,G),G.delete(g)),d}function dB(d){return Nm(d)?e:d}function qA(d,g,C,k,N,G){var rt=C&v,ct=d.length,vt=g.length;if(ct!=vt&&!(rt&&vt>ct))return!1;var Xt=G.get(d),Yt=G.get(g);if(Xt&&Yt)return Xt==g&&Yt==d;var te=-1,ge=!0,Ae=C&_?new bc:e;for(G.set(d,g),G.set(g,d);++te<ct;){var We=d[te],vn=g[te];if(k)var je=rt?k(vn,We,te,g,d,G):k(We,vn,te,d,g,G);if(je!==e){if(je)continue;ge=!1;break}if(Ae){if(!at(g,function(Tn,zn){if(!ti(Ae,zn)&&(We===Tn||N(We,Tn,C,k,G)))return Ae.push(zn)})){ge=!1;break}}else if(!(We===vn||N(We,vn,C,k,G))){ge=!1;break}}return G.delete(d),G.delete(g),ge}function pB(d,g,C,k,N,G,rt){switch(C){case se:if(d.byteLength!=g.byteLength||d.byteOffset!=g.byteOffset)return!1;d=d.buffer,g=g.buffer;case Kt:return!(d.byteLength!=g.byteLength||!G(new Ls(d),new Ls(g)));case It:case ye:case et:return sl(+d,+g);case ne:return d.name==g.name&&d.message==g.message;case ot:case _t:return d==g+"";case $t:var ct=Sn;case st:var vt=k&v;if(ct||(ct=Ct),d.size!=g.size&&!vt)return!1;var Xt=rt.get(d);if(Xt)return Xt==g;k|=_,rt.set(d,g);var Yt=qA(ct(d),ct(g),k,N,G,rt);return rt.delete(d),Yt;case $:if(Qs)return Qs.call(d)==Qs.call(g)}return!1}function fB(d,g,C,k,N,G){var rt=C&v,ct=p1(d),vt=ct.length,Xt=p1(g),Yt=Xt.length;if(vt!=Yt&&!rt)return!1;for(var te=vt;te--;){var ge=ct[te];if(!(rt?ge in g:yn.call(g,ge)))return!1}var Ae=G.get(d),We=G.get(g);if(Ae&&We)return Ae==g&&We==d;var vn=!0;G.set(d,g),G.set(g,d);for(var je=rt;++te<vt;){ge=ct[te];var Tn=d[ge],zn=g[ge];if(k)var ea=rt?k(zn,Tn,ge,g,d,G):k(Tn,zn,ge,d,g,G);if(!(ea===e?Tn===zn||N(Tn,zn,C,k,G):ea)){vn=!1;break}je||(je=ge=="constructor")}if(vn&&!je){var eo=d.constructor,na=g.constructor;eo!=na&&"constructor"in d&&"constructor"in g&&!(typeof eo=="function"&&eo instanceof eo&&typeof na=="function"&&na instanceof na)&&(vn=!1)}return G.delete(d),G.delete(g),vn}function Cc(d){return x1(ZA(d,e,oP),d+"")}function p1(d){return yu(d,ms,v1)}function f1(d){return yu(d,Co,WA)}var m1=el?function(d){return el.get(d)}:D1;function e0(d){for(var g=d.name+"",C=li[g],k=yn.call(li,g)?C.length:0;k--;){var N=C[k],G=N.func;if(G==null||G==d)return N.name}return g}function _p(d){var g=yn.call(H,"placeholder")?H:d;return g.placeholder}function Ge(){var d=H.iteratee||L1;return d=d===L1?B_:d,arguments.length?d(arguments[0],arguments[1]):d}function n0(d,g){var C=d.__data__;return wB(g)?C[typeof g=="string"?"string":"hash"]:C.map}function g1(d){for(var g=ms(d),C=g.length;C--;){var k=g[C],N=d[k];g[C]=[k,N,YA(N)]}return g}function Bh(d,g){var C=Ys(d,g);return V_(C)?C:e}function mB(d){var g=yn.call(d,Ur),C=d[Ur];try{d[Ur]=e;var k=!0}catch{}var N=sr.call(d);return k&&(g?d[Ur]=C:delete d[Ur]),N}var v1=Ne?function(d){return d==null?[]:(d=ve(d),_r(Ne(d),function(g){return Os.call(d,g)}))}:I1,WA=Ne?function(d){for(var g=[];d;)Ta(g,v1(d)),d=_o(d);return g}:I1,Ds=fs;(Fr&&Ds(new Fr(new ArrayBuffer(1)))!=se||ds&&Ds(new ds)!=$t||Jr&&Ds(Jr.resolve())!=Qt||_i&&Ds(new _i)!=st||bi&&Ds(new bi)!=Lt)&&(Ds=function(d){var g=fs(d),C=g==kt?d.constructor:e,k=C?Hh(C):"";if(k)switch(k){case Yi:return se;case bo:return $t;case Ih:return Qt;case hp:return st;case nl:return Lt}return g});function gB(d,g,C){for(var k=-1,N=C.length;++k<N;){var G=C[k],rt=G.size;switch(G.type){case"drop":d+=rt;break;case"dropRight":g-=rt;break;case"take":g=Dn(g,d+rt);break;case"takeRight":d=gn(d,g-rt);break}}return{start:d,end:g}}function vB(d){var g=d.match(ja);return g?g[1].split(Tl):[]}function jA(d,g,C){g=Mu(g,d);for(var k=-1,N=g.length,G=!1;++k<N;){var rt=Vl(g[k]);if(!(G=d!=null&&C(d,rt)))break;d=d[rt]}return G||++k!=N?G:(N=d==null?0:d.length,!!N&&c0(N)&&Ec(rt,N)&&(an(d)||$h(d)))}function _B(d){var g=d.length,C=new d.constructor(g);return g&&typeof d[0]=="string"&&yn.call(d,"index")&&(C.index=d.index,C.input=d.input),C}function XA(d){return typeof d.constructor=="function"&&!Dm(d)?Dl(_o(d)):{}}function bB(d,g,C){var k=d.constructor;switch(g){case Kt:return u1(d);case It:case ye:return new k(+d);case se:return nB(d,C);case we:case ht:case mt:case tt:case Ut:case oe:case ue:case ae:case xe:return RA(d,C);case $t:return new k;case et:case _t:return new k(d);case ot:return iB(d);case st:return new k;case $:return rB(d)}}function yB(d,g){var C=g.length;if(!C)return d;var k=C-1;return g[k]=(C>1?"& ":"")+g[k],g=g.join(C>2?", ":" "),d.replace(Wo,`{
/* [wrapped with `+g+`] */
`)}function xB(d){return an(d)||$h(d)||!!(Zo&&d&&d[Zo])}function Ec(d,g){var C=typeof d;return g=g??Q,!!g&&(C=="number"||C!="symbol"&&fe.test(d))&&d>-1&&d%1==0&&d<g}function to(d,g,C){if(!Ki(C))return!1;var k=typeof g;return(k=="number"?Mo(C)&&Ec(g,C.length):k=="string"&&g in C)?sl(C[g],d):!1}function _1(d,g){if(an(d))return!1;var C=typeof d;return C=="number"||C=="symbol"||C=="boolean"||d==null||ta(d)?!0:jr.test(d)||!mn.test(d)||g!=null&&d in ve(g)}function wB(d){var g=typeof d;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?d!=="__proto__":d===null}function b1(d){var g=e0(d),C=H[g];if(typeof C!="function"||!(g in Cn.prototype))return!1;if(d===C)return!0;var k=m1(C);return!!k&&d===k[0]}function SB(d){return!!ks&&ks in d}var MB=hs?Tc:N1;function Dm(d){var g=d&&d.constructor,C=typeof g=="function"&&g.prototype||On;return d===C}function YA(d){return d===d&&!Ki(d)}function KA(d,g){return function(C){return C==null?!1:C[d]===g&&(g!==e||d in ve(C))}}function CB(d){var g=a0(d,function(k){return C.size===c&&C.clear(),k}),C=g.cache;return g}function EB(d,g){var C=d[1],k=g[1],N=C|k,G=N<(b|y|O),rt=k==O&&C==S||k==O&&C==L&&d[7].length<=g[8]||k==(O|L)&&g[7].length<=g[8]&&C==S;if(!(G||rt))return d;k&b&&(d[2]=g[2],N|=C&b?0:M);var ct=g[3];if(ct){var vt=d[3];d[3]=vt?LA(vt,ct,g[4]):ct,d[4]=vt?ii(d[3],u):g[4]}return ct=g[5],ct&&(vt=d[5],d[5]=vt?OA(vt,ct,g[6]):ct,d[6]=vt?ii(d[5],u):g[6]),ct=g[7],ct&&(d[7]=ct),k&O&&(d[8]=d[8]==null?g[8]:Dn(d[8],g[8])),d[9]==null&&(d[9]=g[9]),d[0]=g[0],d[1]=N,d}function TB(d){var g=[];if(d!=null)for(var C in ve(d))g.push(C);return g}function AB(d){return sr.call(d)}function ZA(d,g,C){return g=gn(g===e?d.length-1:g,0),function(){for(var k=arguments,N=-1,G=gn(k.length-g,0),rt=Tt(G);++N<G;)rt[N]=k[g+N];N=-1;for(var ct=Tt(g+1);++N<g;)ct[N]=k[N];return ct[g]=C(rt),Fe(d,this,ct)}}function JA(d,g){return g.length<2?d:wc(d,f(g,0,-1))}function PB(d,g){for(var C=d.length,k=Dn(g.length,C),N=So(d);k--;){var G=g[k];d[k]=Ec(G,C)?N[G]:e}return d}function y1(d,g){if(!(g==="constructor"&&typeof d[g]=="function")&&g!="__proto__")return d[g]}var QA=eP(Y_),Im=wi||function(d,g){return Wi.setTimeout(d,g)},x1=eP(l1);function tP(d,g,C){var k=g+"";return x1(d,yB(k,RB(vB(k),C)))}function eP(d){var g=0,C=0;return function(){var k=Si(),N=W-(k-C);if(C=k,N>0){if(++g>=K)return arguments[0]}else g=0;return d.apply(e,arguments)}}function i0(d,g){var C=-1,k=d.length,N=k-1;for(g=g===e?k:g;++C<g;){var G=km(C,N),rt=d[G];d[G]=d[C],d[C]=rt}return d.length=g,d}var nP=CB(function(d){var g=[];return d.charCodeAt(0)===46&&g.push(""),d.replace(Jn,function(C,k,N,G){g.push(N?G.replace(Al,"$1"):k||C)}),g});function Vl(d){if(typeof d=="string"||ta(d))return d;var g=d+"";return g=="0"&&1/d==-nt?"-0":g}function Hh(d){if(d!=null){try{return di.call(d)}catch{}try{return d+""}catch{}}return""}function RB(d,g){return cs(Bt,function(C){var k="_."+C[0];g&C[1]&&!gc(d,k)&&d.push(k)}),d.sort()}function iP(d){if(d instanceof Cn)return d.clone();var g=new yo(d.__wrapped__,d.__chain__);return g.__actions__=So(d.__actions__),g.__index__=d.__index__,g.__values__=d.__values__,g}function kB(d,g,C){(C?to(d,g,C):g===e)?g=1:g=gn(hn(g),0);var k=d==null?0:d.length;if(!k||g<1)return[];for(var N=0,G=0,rt=Tt(_e(k/g));N<k;)rt[G++]=f(d,N,N+=g);return rt}function LB(d){for(var g=-1,C=d==null?0:d.length,k=0,N=[];++g<C;){var G=d[g];G&&(N[k++]=G)}return N}function OB(){var d=arguments.length;if(!d)return[];for(var g=Tt(d-1),C=arguments[0],k=d;k--;)g[k-1]=arguments[k];return Ta(an(C)?So(C):[C],Qr(g,1))}var DB=un(function(d,g){return xr(d)?Uh(d,Qr(g,1,xr,!0)):[]}),IB=un(function(d,g){var C=La(g);return xr(C)&&(C=e),xr(d)?Uh(d,Qr(g,1,xr,!0),Ge(C,2)):[]}),NB=un(function(d,g){var C=La(g);return xr(C)&&(C=e),xr(d)?Uh(d,Qr(g,1,xr,!0),e,C):[]});function zB(d,g,C){var k=d==null?0:d.length;return k?(g=C||g===e?1:hn(g),f(d,g<0?0:g,k)):[]}function UB(d,g,C){var k=d==null?0:d.length;return k?(g=C||g===e?1:hn(g),g=k-g,f(d,0,g<0?0:g)):[]}function FB(d,g){return d&&d.length?In(d,Ge(g,3),!0,!0):[]}function VB(d,g){return d&&d.length?In(d,Ge(g,3),!0):[]}function BB(d,g,C,k){var N=d==null?0:d.length;return N?(C&&typeof C!="number"&&to(d,g,C)&&(C=0,k=N),bu(d,g,C,k)):[]}function rP(d,g,C){var k=d==null?0:d.length;if(!k)return-1;var N=C==null?0:hn(C);return N<0&&(N=gn(k+N,0)),Et(d,Ge(g,3),N)}function sP(d,g,C){var k=d==null?0:d.length;if(!k)return-1;var N=k-1;return C!==e&&(N=hn(C),N=C<0?gn(k+N,0):Dn(N,k-1)),Et(d,Ge(g,3),N,!0)}function oP(d){var g=d==null?0:d.length;return g?Qr(d,1):[]}function HB(d){var g=d==null?0:d.length;return g?Qr(d,nt):[]}function $B(d,g){var C=d==null?0:d.length;return C?(g=g===e?1:hn(g),Qr(d,g)):[]}function GB(d){for(var g=-1,C=d==null?0:d.length,k={};++g<C;){var N=d[g];k[N[0]]=N[1]}return k}function aP(d){return d&&d.length?d[0]:e}function qB(d,g,C){var k=d==null?0:d.length;if(!k)return-1;var N=C==null?0:hn(C);return N<0&&(N=gn(k+N,0)),de(d,g,N)}function WB(d){var g=d==null?0:d.length;return g?f(d,0,-1):[]}var jB=un(function(d){var g=nn(d,Su);return g.length&&g[0]===d[0]?Fh(g):[]}),XB=un(function(d){var g=La(d),C=nn(d,Su);return g===La(C)?g=e:C.pop(),C.length&&C[0]===d[0]?Fh(C,Ge(g,2)):[]}),YB=un(function(d){var g=La(d),C=nn(d,Su);return g=typeof g=="function"?g:e,g&&C.pop(),C.length&&C[0]===d[0]?Fh(C,e,g):[]});function KB(d,g){return d==null?"":Mn.call(d,g)}function La(d){var g=d==null?0:d.length;return g?d[g-1]:e}function ZB(d,g,C){var k=d==null?0:d.length;if(!k)return-1;var N=k;return C!==e&&(N=hn(C),N=N<0?gn(k+N,0):Dn(N,k-1)),g===g?us(d,g,N):Et(d,sn,N,!0)}function JB(d,g){return d&&d.length?G_(d,hn(g)):e}var QB=un(lP);function lP(d,g){return d&&d.length&&g&&g.length?Rm(d,g):d}function t4(d,g,C){return d&&d.length&&g&&g.length?Rm(d,g,Ge(C,2)):d}function e4(d,g,C){return d&&d.length&&g&&g.length?Rm(d,g,e,C):d}var n4=Cc(function(d,g){var C=d==null?0:d.length,k=gm(d,g);return X_(d,nn(g,function(N){return Ec(N,C)?+N:N}).sort(kA)),k});function i4(d,g){var C=[];if(!(d&&d.length))return C;var k=-1,N=[],G=d.length;for(g=Ge(g,3);++k<G;){var rt=d[k];g(rt,k,d)&&(C.push(rt),N.push(k))}return X_(d,N),C}function w1(d){return d==null?d:Mi.call(d)}function r4(d,g,C){var k=d==null?0:d.length;return k?(C&&typeof C!="number"&&to(d,g,C)?(g=0,C=k):(g=g==null?0:hn(g),C=C===e?k:hn(C)),f(d,g,C)):[]}function s4(d,g){return T(d,g)}function o4(d,g,C){return I(d,g,Ge(C,2))}function a4(d,g){var C=d==null?0:d.length;if(C){var k=T(d,g);if(k<C&&sl(d[k],g))return k}return-1}function l4(d,g){return T(d,g,!0)}function c4(d,g,C){return I(d,g,Ge(C,2),!0)}function u4(d,g){var C=d==null?0:d.length;if(C){var k=T(d,g,!0)-1;if(sl(d[k],g))return k}return-1}function h4(d){return d&&d.length?it(d):[]}function d4(d,g){return d&&d.length?it(d,Ge(g,2)):[]}function p4(d){var g=d==null?0:d.length;return g?f(d,1,g):[]}function f4(d,g,C){return d&&d.length?(g=C||g===e?1:hn(g),f(d,0,g<0?0:g)):[]}function m4(d,g,C){var k=d==null?0:d.length;return k?(g=C||g===e?1:hn(g),g=k-g,f(d,g<0?0:g,k)):[]}function g4(d,g){return d&&d.length?In(d,Ge(g,3),!1,!0):[]}function v4(d,g){return d&&d.length?In(d,Ge(g,3)):[]}var _4=un(function(d){return Te(Qr(d,1,xr,!0))}),b4=un(function(d){var g=La(d);return xr(g)&&(g=e),Te(Qr(d,1,xr,!0),Ge(g,2))}),y4=un(function(d){var g=La(d);return g=typeof g=="function"?g:e,Te(Qr(d,1,xr,!0),e,g)});function x4(d){return d&&d.length?Te(d):[]}function w4(d,g){return d&&d.length?Te(d,Ge(g,2)):[]}function S4(d,g){return g=typeof g=="function"?g:e,d&&d.length?Te(d,e,g):[]}function S1(d){if(!(d&&d.length))return[];var g=0;return d=_r(d,function(C){if(xr(C))return g=gn(C.length,g),!0}),ui(g,function(C){return nn(d,Ee(C))})}function cP(d,g){if(!(d&&d.length))return[];var C=S1(d);return g==null?C:nn(C,function(k){return Fe(g,e,k)})}var M4=un(function(d,g){return xr(d)?Uh(d,g):[]}),C4=un(function(d){return Sc(_r(d,xr))}),E4=un(function(d){var g=La(d);return xr(g)&&(g=e),Sc(_r(d,xr),Ge(g,2))}),T4=un(function(d){var g=La(d);return g=typeof g=="function"?g:e,Sc(_r(d,xr),e,g)}),A4=un(S1);function P4(d,g){return wu(d||[],g||[],zh)}function R4(d,g){return wu(d||[],g||[],xu)}var k4=un(function(d){var g=d.length,C=g>1?d[g-1]:e;return C=typeof C=="function"?(d.pop(),C):e,cP(d,C)});function uP(d){var g=H(d);return g.__chain__=!0,g}function L4(d,g){return g(d),d}function r0(d,g){return g(d)}var O4=Cc(function(d){var g=d.length,C=g?d[0]:0,k=this.__wrapped__,N=function(G){return gm(G,d)};return g>1||this.__actions__.length||!(k instanceof Cn)||!Ec(C)?this.thru(N):(k=k.slice(C,+C+(g?1:0)),k.__actions__.push({func:r0,args:[N],thisArg:e}),new yo(k,this.__chain__).thru(function(G){return g&&!G.length&&G.push(e),G}))});function D4(){return uP(this)}function I4(){return new yo(this.value(),this.__chain__)}function N4(){this.__values__===e&&(this.__values__=MP(this.value()));var d=this.__index__>=this.__values__.length,g=d?e:this.__values__[this.__index__++];return{done:d,value:g}}function z4(){return this}function U4(d){for(var g,C=this;C instanceof Nh;){var k=iP(C);k.__index__=0,k.__values__=e,g?N.__wrapped__=k:g=k;var N=k;C=C.__wrapped__}return N.__wrapped__=d,g}function F4(){var d=this.__wrapped__;if(d instanceof Cn){var g=d;return this.__actions__.length&&(g=new Cn(this)),g=g.reverse(),g.__actions__.push({func:r0,args:[w1],thisArg:e}),new yo(g,this.__chain__)}return this.thru(w1)}function V4(){return Ul(this.__wrapped__,this.__actions__)}var B4=K_(function(d,g,C){yn.call(d,C)?++d[C]:ps(d,C,1)});function H4(d,g,C){var k=an(d)?up:_m;return C&&to(d,g,C)&&(g=e),k(d,Ge(g,3))}function $4(d,g){var C=an(d)?_r:bm;return C(d,Ge(g,3))}var G4=zA(rP),q4=zA(sP);function W4(d,g){return Qr(s0(d,g),1)}function j4(d,g){return Qr(s0(d,g),nt)}function X4(d,g,C){return C=C===e?1:hn(C),Qr(s0(d,g),C)}function hP(d,g){var C=an(d)?cs:zl;return C(d,Ge(g,3))}function dP(d,g){var C=an(d)?mc:I_;return C(d,Ge(g,3))}var Y4=K_(function(d,g,C){yn.call(d,C)?d[C].push(g):ps(d,C,[g])});function K4(d,g,C,k){d=Mo(d)?d:yp(d),C=C&&!k?hn(C):0;var N=d.length;return C<0&&(C=gn(N+C,0)),u0(d)?C<=N&&d.indexOf(g,C)>-1:!!N&&de(d,g,C)>-1}var Z4=un(function(d,g,C){var k=-1,N=typeof g=="function",G=Mo(d)?Tt(d.length):[];return zl(d,function(rt){G[++k]=N?Fe(g,rt,C):wo(rt,g,C)}),G}),J4=K_(function(d,g,C){ps(d,C,g)});function s0(d,g){var C=an(d)?nn:ka;return C(d,Ge(g,3))}function Q4(d,g,C,k){return d==null?[]:(an(g)||(g=g==null?[]:[g]),C=k?e:C,an(C)||(C=C==null?[]:[C]),q_(d,g,C))}var tH=K_(function(d,g,C){d[C?0:1].push(g)},function(){return[[],[]]});function eH(d,g,C){var k=an(d)?yt:ke,N=arguments.length<3;return k(d,Ge(g,4),C,N,zl)}function nH(d,g,C){var k=an(d)?F:ke,N=arguments.length<3;return k(d,Ge(g,4),C,N,I_)}function iH(d,g){var C=an(d)?_r:bm;return C(d,l0(Ge(g,3)))}function rH(d){var g=an(d)?fm:o1;return g(d)}function sH(d,g,C){(C?to(d,g,C):g===e)?g=1:g=hn(g);var k=an(d)?O_:a1;return k(d,g)}function oH(d){var g=an(d)?Xw:w;return g(d)}function aH(d){if(d==null)return 0;if(Mo(d))return u0(d)?yr(d):d.length;var g=Ds(d);return g==$t||g==st?d.size:Em(d).length}function lH(d,g,C){var k=an(d)?at:x;return C&&to(d,g,C)&&(g=e),k(d,Ge(g,3))}var cH=un(function(d,g){if(d==null)return[];var C=g.length;return C>1&&to(d,g[0],g[1])?g=[]:C>2&&to(g[0],g[1],g[2])&&(g=[g[0]]),q_(d,Qr(g,1),[])}),o0=En||function(){return Wi.Date.now()};function uH(d,g){if(typeof g!="function")throw new rr(o);return d=hn(d),function(){if(--d<1)return g.apply(this,arguments)}}function pP(d,g,C){return g=C?e:g,g=d&&g==null?d.length:g,Mc(d,O,e,e,e,e,g)}function fP(d,g){var C;if(typeof g!="function")throw new rr(o);return d=hn(d),function(){return--d>0&&(C=g.apply(this,arguments)),d<=1&&(g=e),C}}var M1=un(function(d,g,C){var k=b;if(C.length){var N=ii(C,_p(M1));k|=A}return Mc(d,k,g,C,N)}),mP=un(function(d,g,C){var k=b|y;if(C.length){var N=ii(C,_p(mP));k|=A}return Mc(g,k,d,C,N)});function gP(d,g,C){g=C?e:g;var k=Mc(d,S,e,e,e,e,e,g);return k.placeholder=gP.placeholder,k}function vP(d,g,C){g=C?e:g;var k=Mc(d,E,e,e,e,e,e,g);return k.placeholder=vP.placeholder,k}function _P(d,g,C){var k,N,G,rt,ct,vt,Xt=0,Yt=!1,te=!1,ge=!0;if(typeof d!="function")throw new rr(o);g=Oa(g)||0,Ki(C)&&(Yt=!!C.leading,te="maxWait"in C,G=te?gn(Oa(C.maxWait)||0,g):G,ge="trailing"in C?!!C.trailing:ge);function Ae(wr){var ol=k,Pc=N;return k=N=e,Xt=wr,rt=d.apply(Pc,ol),rt}function We(wr){return Xt=wr,ct=Im(Tn,g),Yt?Ae(wr):rt}function vn(wr){var ol=wr-vt,Pc=wr-Xt,zP=g-ol;return te?Dn(zP,G-Pc):zP}function je(wr){var ol=wr-vt,Pc=wr-Xt;return vt===e||ol>=g||ol<0||te&&Pc>=G}function Tn(){var wr=o0();if(je(wr))return zn(wr);ct=Im(Tn,vn(wr))}function zn(wr){return ct=e,ge&&k?Ae(wr):(k=N=e,rt)}function ea(){ct!==e&&AA(ct),Xt=0,k=vt=N=ct=e}function eo(){return ct===e?rt:zn(o0())}function na(){var wr=o0(),ol=je(wr);if(k=arguments,N=this,vt=wr,ol){if(ct===e)return We(vt);if(te)return AA(ct),ct=Im(Tn,g),Ae(vt)}return ct===e&&(ct=Im(Tn,g)),rt}return na.cancel=ea,na.flush=eo,na}var hH=un(function(d,g){return vm(d,1,g)}),dH=un(function(d,g,C){return vm(d,Oa(g)||0,C)});function pH(d){return Mc(d,P)}function a0(d,g){if(typeof d!="function"||g!=null&&typeof g!="function")throw new rr(o);var C=function(){var k=arguments,N=g?g.apply(this,k):k[0],G=C.cache;if(G.has(N))return G.get(N);var rt=d.apply(this,k);return C.cache=G.set(N,rt)||G,rt};return C.cache=new(a0.Cache||rl),C}a0.Cache=rl;function l0(d){if(typeof d!="function")throw new rr(o);return function(){var g=arguments;switch(g.length){case 0:return!d.call(this);case 1:return!d.call(this,g[0]);case 2:return!d.call(this,g[0],g[1]);case 3:return!d.call(this,g[0],g[1],g[2])}return!d.apply(this,g)}}function fH(d){return fP(2,d)}var mH=eB(function(d,g){g=g.length==1&&an(g[0])?nn(g[0],Le(Ge())):nn(Qr(g,1),Le(Ge()));var C=g.length;return un(function(k){for(var N=-1,G=Dn(k.length,C);++N<G;)k[N]=g[N].call(this,k[N]);return Fe(d,this,k)})}),C1=un(function(d,g){var C=ii(g,_p(C1));return Mc(d,A,e,g,C)}),bP=un(function(d,g){var C=ii(g,_p(bP));return Mc(d,R,e,g,C)}),gH=Cc(function(d,g){return Mc(d,L,e,e,e,g)});function vH(d,g){if(typeof d!="function")throw new rr(o);return g=g===e?g:hn(g),un(d,g)}function _H(d,g){if(typeof d!="function")throw new rr(o);return g=g==null?0:gn(hn(g),0),un(function(C){var k=C[g],N=Cu(C,0,g);return k&&Ta(N,k),Fe(d,this,N)})}function bH(d,g,C){var k=!0,N=!0;if(typeof d!="function")throw new rr(o);return Ki(C)&&(k="leading"in C?!!C.leading:k,N="trailing"in C?!!C.trailing:N),_P(d,g,{leading:k,maxWait:g,trailing:N})}function yH(d){return pP(d,1)}function xH(d,g){return C1(c1(g),d)}function wH(){if(!arguments.length)return[];var d=arguments[0];return an(d)?d:[d]}function SH(d){return xo(d,m)}function MH(d,g){return g=typeof g=="function"?g:e,xo(d,m,g)}function CH(d){return xo(d,h|m)}function EH(d,g){return g=typeof g=="function"?g:e,xo(d,h|m,g)}function TH(d,g){return g==null||xc(d,g,ms(g))}function sl(d,g){return d===g||d!==d&&g!==g}var AH=t0(wm),PH=t0(function(d,g){return d>=g}),$h=U_(function(){return arguments}())?U_:function(d){return or(d)&&yn.call(d,"callee")&&!Os.call(d,"callee")},an=Tt.isArray,RH=Lh?Le(Lh):Qw;function Mo(d){return d!=null&&c0(d.length)&&!Tc(d)}function xr(d){return or(d)&&Mo(d)}function kH(d){return d===!0||d===!1||or(d)&&fs(d)==It}var Eu=ln||N1,LH=lp?Le(lp):Mm;function OH(d){return or(d)&&d.nodeType===1&&!Nm(d)}function DH(d){if(d==null)return!0;if(Mo(d)&&(an(d)||typeof d=="string"||typeof d.splice=="function"||Eu(d)||bp(d)||$h(d)))return!d.length;var g=Ds(d);if(g==$t||g==st)return!d.size;if(Dm(d))return!Em(d).length;for(var C in d)if(yn.call(d,C))return!1;return!0}function IH(d,g){return Vh(d,g)}function NH(d,g,C){C=typeof C=="function"?C:e;var k=C?C(d,g):e;return k===e?Vh(d,g,e,C):!!k}function E1(d){if(!or(d))return!1;var g=fs(d);return g==ne||g==ce||typeof d.message=="string"&&typeof d.name=="string"&&!Nm(d)}function zH(d){return typeof d=="number"&&Ri(d)}function Tc(d){if(!Ki(d))return!1;var g=fs(d);return g==Gt||g==J||g==re||g==qt}function yP(d){return typeof d=="number"&&d==hn(d)}function c0(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=Q}function Ki(d){var g=typeof d;return d!=null&&(g=="object"||g=="function")}function or(d){return d!=null&&typeof d=="object"}var xP=Oh?Le(Oh):F_;function UH(d,g){return d===g||Cm(d,g,g1(g))}function FH(d,g,C){return C=typeof C=="function"?C:e,Cm(d,g,g1(g),C)}function VH(d){return wP(d)&&d!=+d}function BH(d){if(MB(d))throw new bt(s);return V_(d)}function HH(d){return d===null}function $H(d){return d==null}function wP(d){return typeof d=="number"||or(d)&&fs(d)==et}function Nm(d){if(!or(d)||fs(d)!=kt)return!1;var g=_o(d);if(g===null)return!0;var C=yn.call(g,"constructor")&&g.constructor;return typeof C=="function"&&C instanceof C&&di.call(C)==Pa}var T1=Dh?Le(Dh):e1;function GH(d){return yP(d)&&d>=-Q&&d<=Q}var SP=fc?Le(fc):n1;function u0(d){return typeof d=="string"||!an(d)&&or(d)&&fs(d)==_t}function ta(d){return typeof d=="symbol"||or(d)&&fs(d)==$}var bp=vu?Le(vu):i1;function qH(d){return d===e}function WH(d){return or(d)&&Ds(d)==Lt}function jH(d){return or(d)&&fs(d)==jt}var XH=t0(Tm),YH=t0(function(d,g){return d<=g});function MP(d){if(!d)return[];if(Mo(d))return u0(d)?Xi(d):So(d);if(Zs&&d[Zs])return Fi(d[Zs]());var g=Ds(d),C=g==$t?Sn:g==st?Ct:yp;return C(d)}function Ac(d){if(!d)return d===0?d:0;if(d=Oa(d),d===nt||d===-nt){var g=d<0?-1:1;return g*St}return d===d?d:0}function hn(d){var g=Ac(d),C=g%1;return g===g?C?g-C:g:0}function CP(d){return d?Nl(hn(d),0,dt):0}function Oa(d){if(typeof d=="number")return d;if(ta(d))return Pt;if(Ki(d)){var g=typeof d.valueOf=="function"?d.valueOf():d;d=Ki(g)?g+"":g}if(typeof d!="string")return d===0?d:+d;d=nr(d);var C=Nt.test(d);return C||Ft.test(d)?Ph(d.slice(2),C?2:8):At.test(d)?Pt:+d}function EP(d){return Fl(d,Co(d))}function KH(d){return d?Nl(hn(d),-Q,Q):d===0?d:0}function ci(d){return d==null?"":Zt(d)}var ZH=gp(function(d,g){if(Dm(g)||Mo(g)){Fl(g,ms(g),d);return}for(var C in g)yn.call(g,C)&&zh(d,C,g[C])}),TP=gp(function(d,g){Fl(g,Co(g),d)}),h0=gp(function(d,g,C,k){Fl(g,Co(g),d,k)}),JH=gp(function(d,g,C,k){Fl(g,ms(g),d,k)}),QH=Cc(gm);function t5(d,g){var C=Dl(d);return g==null?C:yc(C,g)}var e5=un(function(d,g){d=ve(d);var C=-1,k=g.length,N=k>2?g[2]:e;for(N&&to(g[0],g[1],N)&&(k=1);++C<k;)for(var G=g[C],rt=Co(G),ct=-1,vt=rt.length;++ct<vt;){var Xt=rt[ct],Yt=d[Xt];(Yt===e||sl(Yt,On[Xt])&&!yn.call(d,Xt))&&(d[Xt]=G[Xt])}return d}),n5=un(function(d){return d.push(e,GA),Fe(AP,e,d)});function i5(d,g){return Dt(d,Ge(g,3),Ra)}function r5(d,g){return Dt(d,Ge(g,3),xm)}function s5(d,g){return d==null?d:ym(d,Ge(g,3),Co)}function o5(d,g){return d==null?d:N_(d,Ge(g,3),Co)}function a5(d,g){return d&&Ra(d,Ge(g,3))}function l5(d,g){return d&&xm(d,Ge(g,3))}function c5(d){return d==null?[]:fp(d,ms(d))}function u5(d){return d==null?[]:fp(d,Co(d))}function A1(d,g,C){var k=d==null?e:wc(d,g);return k===e?C:k}function h5(d,g){return d!=null&&jA(d,g,Sm)}function P1(d,g){return d!=null&&jA(d,g,z_)}var d5=FA(function(d,g,C){g!=null&&typeof g.toString!="function"&&(g=sr.call(g)),d[g]=C},k1(Eo)),p5=FA(function(d,g,C){g!=null&&typeof g.toString!="function"&&(g=sr.call(g)),yn.call(d,g)?d[g].push(C):d[g]=[C]},Ge),f5=un(wo);function ms(d){return Mo(d)?dp(d):Em(d)}function Co(d){return Mo(d)?dp(d,!0):r1(d)}function m5(d,g){var C={};return g=Ge(g,3),Ra(d,function(k,N,G){ps(C,g(k,N,G),k)}),C}function g5(d,g){var C={};return g=Ge(g,3),Ra(d,function(k,N,G){ps(C,N,g(k,N,G))}),C}var v5=gp(function(d,g,C){mp(d,g,C)}),AP=gp(function(d,g,C,k){mp(d,g,C,k)}),_5=Cc(function(d,g){var C={};if(d==null)return C;var k=!1;g=nn(g,function(G){return G=Mu(G,d),k||(k=G.length>1),G}),Fl(d,f1(d),C),k&&(C=xo(C,h|p|m,dB));for(var N=g.length;N--;)He(C,g[N]);return C});function b5(d,g){return PP(d,l0(Ge(g)))}var y5=Cc(function(d,g){return d==null?{}:W_(d,g)});function PP(d,g){if(d==null)return{};var C=nn(f1(d),function(k){return[k]});return g=Ge(g),Pm(d,C,function(k,N){return g(k,N[0])})}function x5(d,g,C){g=Mu(g,d);var k=-1,N=g.length;for(N||(N=1,d=e);++k<N;){var G=d==null?e:d[Vl(g[k])];G===e&&(k=N,G=C),d=Tc(G)?G.call(d):G}return d}function w5(d,g,C){return d==null?d:xu(d,g,C)}function S5(d,g,C,k){return k=typeof k=="function"?k:e,d==null?d:xu(d,g,C,k)}var RP=HA(ms),kP=HA(Co);function M5(d,g,C){var k=an(d),N=k||Eu(d)||bp(d);if(g=Ge(g,4),C==null){var G=d&&d.constructor;N?C=k?new G:[]:Ki(d)?C=Tc(G)?Dl(_o(d)):{}:C={}}return(N?cs:Ra)(d,function(rt,ct,vt){return g(C,rt,ct,vt)}),C}function C5(d,g){return d==null?!0:He(d,g)}function E5(d,g,C){return d==null?d:Nn(d,g,c1(C))}function T5(d,g,C,k){return k=typeof k=="function"?k:e,d==null?d:Nn(d,g,c1(C),k)}function yp(d){return d==null?[]:Lr(d,ms(d))}function A5(d){return d==null?[]:Lr(d,Co(d))}function P5(d,g,C){return C===e&&(C=g,g=e),C!==e&&(C=Oa(C),C=C===C?C:0),g!==e&&(g=Oa(g),g=g===g?g:0),Nl(Oa(d),g,C)}function R5(d,g,C){return g=Ac(g),C===e?(C=g,g=0):C=Ac(C),d=Oa(d),Zw(d,g,C)}function k5(d,g,C){if(C&&typeof C!="boolean"&&to(d,g,C)&&(g=C=e),C===e&&(typeof g=="boolean"?(C=g,g=e):typeof d=="boolean"&&(C=d,d=e)),d===e&&g===e?(d=0,g=1):(d=Ac(d),g===e?(g=d,d=0):g=Ac(g)),d>g){var k=d;d=g,g=k}if(C||d%1||g%1){var N=Ss();return Dn(d+N*(g-d+Ko("1e-"+((N+"").length-1))),g)}return km(d,g)}var L5=vp(function(d,g,C){return g=g.toLowerCase(),d+(C?LP(g):g)});function LP(d){return R1(ci(d).toLowerCase())}function OP(d){return d=ci(d),d&&d.replace(Re,Oe).replace(ls,"")}function O5(d,g,C){d=ci(d),g=Zt(g);var k=d.length;C=C===e?k:Nl(hn(C),0,k);var N=C;return C-=g.length,C>=0&&d.slice(C,N)==g}function D5(d){return d=ci(d),d&&Xe.test(d)?d.replace(ie,mi):d}function I5(d){return d=ci(d),d&&qo.test(d)?d.replace(Xr,"\\$&"):d}var N5=vp(function(d,g,C){return d+(C?"-":"")+g.toLowerCase()}),z5=vp(function(d,g,C){return d+(C?" ":"")+g.toLowerCase()}),U5=NA("toLowerCase");function F5(d,g,C){d=ci(d),g=hn(g);var k=g?yr(d):0;if(!g||k>=g)return d;var N=(g-k)/2;return Q_(on(N),C)+d+Q_(_e(N),C)}function V5(d,g,C){d=ci(d),g=hn(g);var k=g?yr(d):0;return g&&k<g?d+Q_(g-k,C):d}function B5(d,g,C){d=ci(d),g=hn(g);var k=g?yr(d):0;return g&&k<g?Q_(g-k,C)+d:d}function H5(d,g,C){return C||g==null?g=0:g&&(g=+g),ri(ci(d).replace(xa,""),g||0)}function $5(d,g,C){return(C?to(d,g,C):g===e)?g=1:g=hn(g),Lm(ci(d),g)}function G5(){var d=arguments,g=ci(d[0]);return d.length<3?g:g.replace(d[1],d[2])}var q5=vp(function(d,g,C){return d+(C?"_":"")+g.toLowerCase()});function W5(d,g,C){return C&&typeof C!="number"&&to(d,g,C)&&(g=C=e),C=C===e?dt:C>>>0,C?(d=ci(d),d&&(typeof g=="string"||g!=null&&!T1(g))&&(g=Zt(g),!g&&gi(d))?Cu(Xi(d),0,C):d.split(g,C)):[]}var j5=vp(function(d,g,C){return d+(C?" ":"")+R1(g)});function X5(d,g,C){return d=ci(d),C=C==null?0:Nl(hn(C),0,d.length),g=Zt(g),d.slice(C,C+g.length)==g}function Y5(d,g,C){var k=H.templateSettings;C&&to(d,g,C)&&(g=e),d=ci(d),g=h0({},g,k,$A);var N=h0({},g.imports,k.imports,$A),G=ms(N),rt=Lr(N,G),ct,vt,Xt=0,Yt=g.interpolate||Me,te="__p += '",ge=Xn((g.escape||Me).source+"|"+Yt.source+"|"+(Yt===Wr?vr:Me).source+"|"+(g.evaluate||Me).source+"|$","g"),Ae="//# sourceURL="+(yn.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gu+"]")+`
`;d.replace(ge,function(je,Tn,zn,ea,eo,na){return zn||(zn=ea),te+=d.slice(Xt,na).replace(ze,qe),Tn&&(ct=!0,te+=`' +
__e(`+Tn+`) +
'`),eo&&(vt=!0,te+=`';
`+eo+`;
__p += '`),zn&&(te+=`' +
((__t = (`+zn+`)) == null ? '' : __t) +
'`),Xt=na+je.length,je}),te+=`';
`;var We=yn.call(g,"variable")&&g.variable;if(!We)te=`with (obj) {
`+te+`
}
`;else if(Ws.test(We))throw new bt(a);te=(vt?te.replace(Ze,""):te).replace(pt,"$1").replace(ee,"$1;"),te="function("+(We||"obj")+`) {
`+(We?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ct?", __e = _.escape":"")+(vt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+te+`return __p
}`;var vn=IP(function(){return Je(G,Ae+"return "+te).apply(e,rt)});if(vn.source=te,E1(vn))throw vn;return vn}function K5(d){return ci(d).toLowerCase()}function Z5(d){return ci(d).toUpperCase()}function J5(d,g,C){if(d=ci(d),d&&(C||g===e))return nr(d);if(!d||!(g=Zt(g)))return d;var k=Xi(d),N=Xi(g),G=Be(k,N),rt=Ui(k,N)+1;return Cu(k,G,rt).join("")}function Q5(d,g,C){if(d=ci(d),d&&(C||g===e))return d.slice(0,Or(d)+1);if(!d||!(g=Zt(g)))return d;var k=Xi(d),N=Ui(k,Xi(g))+1;return Cu(k,0,N).join("")}function t$(d,g,C){if(d=ci(d),d&&(C||g===e))return d.replace(xa,"");if(!d||!(g=Zt(g)))return d;var k=Xi(d),N=Be(k,Xi(g));return Cu(k,N).join("")}function e$(d,g){var C=D,k=V;if(Ki(g)){var N="separator"in g?g.separator:N;C="length"in g?hn(g.length):C,k="omission"in g?Zt(g.omission):k}d=ci(d);var G=d.length;if(gi(d)){var rt=Xi(d);G=rt.length}if(C>=G)return d;var ct=C-yr(k);if(ct<1)return k;var vt=rt?Cu(rt,0,ct).join(""):d.slice(0,ct);if(N===e)return vt+k;if(rt&&(ct+=vt.length-ct),T1(N)){if(d.slice(ct).search(N)){var Xt,Yt=vt;for(N.global||(N=Xn(N.source,ci(X.exec(N))+"g")),N.lastIndex=0;Xt=N.exec(Yt);)var te=Xt.index;vt=vt.slice(0,te===e?ct:te)}}else if(d.indexOf(Zt(N),ct)!=ct){var ge=vt.lastIndexOf(N);ge>-1&&(vt=vt.slice(0,ge))}return vt+k}function n$(d){return d=ci(d),d&&le.test(d)?d.replace(Mt,Vi):d}var i$=vp(function(d,g,C){return d+(C?" ":"")+g.toUpperCase()}),R1=NA("toUpperCase");function DP(d,g,C){return d=ci(d),g=C?e:g,g===e?ir(d)?Aa(d):gt(d):d.match(g)||[]}var IP=un(function(d,g){try{return Fe(d,e,g)}catch(C){return E1(C)?C:new bt(C)}}),r$=Cc(function(d,g){return cs(g,function(C){C=Vl(C),ps(d,C,M1(d[C],d))}),d});function s$(d){var g=d==null?0:d.length,C=Ge();return d=g?nn(d,function(k){if(typeof k[1]!="function")throw new rr(o);return[C(k[0]),k[1]]}):[],un(function(k){for(var N=-1;++N<g;){var G=d[N];if(Fe(G[0],this,k))return Fe(G[1],this,k)}})}function o$(d){return Kw(xo(d,h))}function k1(d){return function(){return d}}function a$(d,g){return d==null||d!==d?g:d}var l$=UA(),c$=UA(!0);function Eo(d){return d}function L1(d){return B_(typeof d=="function"?d:xo(d,h))}function u$(d){return H_(xo(d,h))}function h$(d,g){return Am(d,xo(g,h))}var d$=un(function(d,g){return function(C){return wo(C,d,g)}}),p$=un(function(d,g){return function(C){return wo(d,C,g)}});function O1(d,g,C){var k=ms(g),N=fp(g,k);C==null&&!(Ki(g)&&(N.length||!k.length))&&(C=g,g=d,d=this,N=fp(g,ms(g)));var G=!(Ki(C)&&"chain"in C)||!!C.chain,rt=Tc(d);return cs(N,function(ct){var vt=g[ct];d[ct]=vt,rt&&(d.prototype[ct]=function(){var Xt=this.__chain__;if(G||Xt){var Yt=d(this.__wrapped__),te=Yt.__actions__=So(this.__actions__);return te.push({func:vt,args:arguments,thisArg:d}),Yt.__chain__=Xt,Yt}return vt.apply(d,Ta([this.value()],arguments))})}),d}function f$(){return Wi._===this&&(Wi._=Qa),this}function D1(){}function m$(d){return d=hn(d),un(function(g){return G_(g,d)})}var g$=h1(nn),v$=h1(up),_$=h1(at);function NP(d){return _1(d)?Ee(Vl(d)):j_(d)}function b$(d){return function(g){return d==null?e:wc(d,g)}}var y$=VA(),x$=VA(!0);function I1(){return[]}function N1(){return!1}function w$(){return{}}function S$(){return""}function M$(){return!0}function C$(d,g){if(d=hn(d),d<1||d>Q)return[];var C=dt,k=Dn(d,dt);g=Ge(g),d-=dt;for(var N=ui(k,g);++C<d;)g(C);return N}function E$(d){return an(d)?nn(d,Vl):ta(d)?[d]:So(nP(ci(d)))}function T$(d){var g=++vo;return ci(d)+g}var A$=J_(function(d,g){return d+g},0),P$=d1("ceil"),R$=J_(function(d,g){return d/g},1),k$=d1("floor");function L$(d){return d&&d.length?pp(d,Eo,wm):e}function O$(d,g){return d&&d.length?pp(d,Ge(g,2),wm):e}function D$(d){return Ce(d,Eo)}function I$(d,g){return Ce(d,Ge(g,2))}function N$(d){return d&&d.length?pp(d,Eo,Tm):e}function z$(d,g){return d&&d.length?pp(d,Ge(g,2),Tm):e}var U$=J_(function(d,g){return d*g},1),F$=d1("round"),V$=J_(function(d,g){return d-g},0);function B$(d){return d&&d.length?ni(d,Eo):0}function H$(d,g){return d&&d.length?ni(d,Ge(g,2)):0}return H.after=uH,H.ary=pP,H.assign=ZH,H.assignIn=TP,H.assignInWith=h0,H.assignWith=JH,H.at=QH,H.before=fP,H.bind=M1,H.bindAll=r$,H.bindKey=mP,H.castArray=wH,H.chain=uP,H.chunk=kB,H.compact=LB,H.concat=OB,H.cond=s$,H.conforms=o$,H.constant=k1,H.countBy=B4,H.create=t5,H.curry=gP,H.curryRight=vP,H.debounce=_P,H.defaults=e5,H.defaultsDeep=n5,H.defer=hH,H.delay=dH,H.difference=DB,H.differenceBy=IB,H.differenceWith=NB,H.drop=zB,H.dropRight=UB,H.dropRightWhile=FB,H.dropWhile=VB,H.fill=BB,H.filter=$4,H.flatMap=W4,H.flatMapDeep=j4,H.flatMapDepth=X4,H.flatten=oP,H.flattenDeep=HB,H.flattenDepth=$B,H.flip=pH,H.flow=l$,H.flowRight=c$,H.fromPairs=GB,H.functions=c5,H.functionsIn=u5,H.groupBy=Y4,H.initial=WB,H.intersection=jB,H.intersectionBy=XB,H.intersectionWith=YB,H.invert=d5,H.invertBy=p5,H.invokeMap=Z4,H.iteratee=L1,H.keyBy=J4,H.keys=ms,H.keysIn=Co,H.map=s0,H.mapKeys=m5,H.mapValues=g5,H.matches=u$,H.matchesProperty=h$,H.memoize=a0,H.merge=v5,H.mergeWith=AP,H.method=d$,H.methodOf=p$,H.mixin=O1,H.negate=l0,H.nthArg=m$,H.omit=_5,H.omitBy=b5,H.once=fH,H.orderBy=Q4,H.over=g$,H.overArgs=mH,H.overEvery=v$,H.overSome=_$,H.partial=C1,H.partialRight=bP,H.partition=tH,H.pick=y5,H.pickBy=PP,H.property=NP,H.propertyOf=b$,H.pull=QB,H.pullAll=lP,H.pullAllBy=t4,H.pullAllWith=e4,H.pullAt=n4,H.range=y$,H.rangeRight=x$,H.rearg=gH,H.reject=iH,H.remove=i4,H.rest=vH,H.reverse=w1,H.sampleSize=sH,H.set=w5,H.setWith=S5,H.shuffle=oH,H.slice=r4,H.sortBy=cH,H.sortedUniq=h4,H.sortedUniqBy=d4,H.split=W5,H.spread=_H,H.tail=p4,H.take=f4,H.takeRight=m4,H.takeRightWhile=g4,H.takeWhile=v4,H.tap=L4,H.throttle=bH,H.thru=r0,H.toArray=MP,H.toPairs=RP,H.toPairsIn=kP,H.toPath=E$,H.toPlainObject=EP,H.transform=M5,H.unary=yH,H.union=_4,H.unionBy=b4,H.unionWith=y4,H.uniq=x4,H.uniqBy=w4,H.uniqWith=S4,H.unset=C5,H.unzip=S1,H.unzipWith=cP,H.update=E5,H.updateWith=T5,H.values=yp,H.valuesIn=A5,H.without=M4,H.words=DP,H.wrap=xH,H.xor=C4,H.xorBy=E4,H.xorWith=T4,H.zip=A4,H.zipObject=P4,H.zipObjectDeep=R4,H.zipWith=k4,H.entries=RP,H.entriesIn=kP,H.extend=TP,H.extendWith=h0,O1(H,H),H.add=A$,H.attempt=IP,H.camelCase=L5,H.capitalize=LP,H.ceil=P$,H.clamp=P5,H.clone=SH,H.cloneDeep=CH,H.cloneDeepWith=EH,H.cloneWith=MH,H.conformsTo=TH,H.deburr=OP,H.defaultTo=a$,H.divide=R$,H.endsWith=O5,H.eq=sl,H.escape=D5,H.escapeRegExp=I5,H.every=H4,H.find=G4,H.findIndex=rP,H.findKey=i5,H.findLast=q4,H.findLastIndex=sP,H.findLastKey=r5,H.floor=k$,H.forEach=hP,H.forEachRight=dP,H.forIn=s5,H.forInRight=o5,H.forOwn=a5,H.forOwnRight=l5,H.get=A1,H.gt=AH,H.gte=PH,H.has=h5,H.hasIn=P1,H.head=aP,H.identity=Eo,H.includes=K4,H.indexOf=qB,H.inRange=R5,H.invoke=f5,H.isArguments=$h,H.isArray=an,H.isArrayBuffer=RH,H.isArrayLike=Mo,H.isArrayLikeObject=xr,H.isBoolean=kH,H.isBuffer=Eu,H.isDate=LH,H.isElement=OH,H.isEmpty=DH,H.isEqual=IH,H.isEqualWith=NH,H.isError=E1,H.isFinite=zH,H.isFunction=Tc,H.isInteger=yP,H.isLength=c0,H.isMap=xP,H.isMatch=UH,H.isMatchWith=FH,H.isNaN=VH,H.isNative=BH,H.isNil=$H,H.isNull=HH,H.isNumber=wP,H.isObject=Ki,H.isObjectLike=or,H.isPlainObject=Nm,H.isRegExp=T1,H.isSafeInteger=GH,H.isSet=SP,H.isString=u0,H.isSymbol=ta,H.isTypedArray=bp,H.isUndefined=qH,H.isWeakMap=WH,H.isWeakSet=jH,H.join=KB,H.kebabCase=N5,H.last=La,H.lastIndexOf=ZB,H.lowerCase=z5,H.lowerFirst=U5,H.lt=XH,H.lte=YH,H.max=L$,H.maxBy=O$,H.mean=D$,H.meanBy=I$,H.min=N$,H.minBy=z$,H.stubArray=I1,H.stubFalse=N1,H.stubObject=w$,H.stubString=S$,H.stubTrue=M$,H.multiply=U$,H.nth=JB,H.noConflict=f$,H.noop=D1,H.now=o0,H.pad=F5,H.padEnd=V5,H.padStart=B5,H.parseInt=H5,H.random=k5,H.reduce=eH,H.reduceRight=nH,H.repeat=$5,H.replace=G5,H.result=x5,H.round=F$,H.runInContext=lt,H.sample=rH,H.size=aH,H.snakeCase=q5,H.some=lH,H.sortedIndex=s4,H.sortedIndexBy=o4,H.sortedIndexOf=a4,H.sortedLastIndex=l4,H.sortedLastIndexBy=c4,H.sortedLastIndexOf=u4,H.startCase=j5,H.startsWith=X5,H.subtract=V$,H.sum=B$,H.sumBy=H$,H.template=Y5,H.times=C$,H.toFinite=Ac,H.toInteger=hn,H.toLength=CP,H.toLower=K5,H.toNumber=Oa,H.toSafeInteger=KH,H.toString=ci,H.toUpper=Z5,H.trim=J5,H.trimEnd=Q5,H.trimStart=t$,H.truncate=e$,H.unescape=n$,H.uniqueId=T$,H.upperCase=i$,H.upperFirst=R1,H.each=hP,H.eachRight=dP,H.first=aP,O1(H,function(){var d={};return Ra(H,function(g,C){yn.call(H.prototype,C)||(d[C]=g)}),d}(),{chain:!1}),H.VERSION=n,cs(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){H[d].placeholder=H}),cs(["drop","take"],function(d,g){Cn.prototype[d]=function(C){C=C===e?1:gn(hn(C),0);var k=this.__filtered__&&!g?new Cn(this):this.clone();return k.__filtered__?k.__takeCount__=Dn(C,k.__takeCount__):k.__views__.push({size:Dn(C,dt),type:d+(k.__dir__<0?"Right":"")}),k},Cn.prototype[d+"Right"]=function(C){return this.reverse()[d](C).reverse()}}),cs(["filter","map","takeWhile"],function(d,g){var C=g+1,k=C==Z||C==ut;Cn.prototype[d]=function(N){var G=this.clone();return G.__iteratees__.push({iteratee:Ge(N,3),type:C}),G.__filtered__=G.__filtered__||k,G}}),cs(["head","last"],function(d,g){var C="take"+(g?"Right":"");Cn.prototype[d]=function(){return this[C](1).value()[0]}}),cs(["initial","tail"],function(d,g){var C="drop"+(g?"":"Right");Cn.prototype[d]=function(){return this.__filtered__?new Cn(this):this[C](1)}}),Cn.prototype.compact=function(){return this.filter(Eo)},Cn.prototype.find=function(d){return this.filter(d).head()},Cn.prototype.findLast=function(d){return this.reverse().find(d)},Cn.prototype.invokeMap=un(function(d,g){return typeof d=="function"?new Cn(this):this.map(function(C){return wo(C,d,g)})}),Cn.prototype.reject=function(d){return this.filter(l0(Ge(d)))},Cn.prototype.slice=function(d,g){d=hn(d);var C=this;return C.__filtered__&&(d>0||g<0)?new Cn(C):(d<0?C=C.takeRight(-d):d&&(C=C.drop(d)),g!==e&&(g=hn(g),C=g<0?C.dropRight(-g):C.take(g-d)),C)},Cn.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},Cn.prototype.toArray=function(){return this.take(dt)},Ra(Cn.prototype,function(d,g){var C=/^(?:filter|find|map|reject)|While$/.test(g),k=/^(?:head|last)$/.test(g),N=H[k?"take"+(g=="last"?"Right":""):g],G=k||/^find/.test(g);N&&(H.prototype[g]=function(){var rt=this.__wrapped__,ct=k?[1]:arguments,vt=rt instanceof Cn,Xt=ct[0],Yt=vt||an(rt),te=function(Tn){var zn=N.apply(H,Ta([Tn],ct));return k&&ge?zn[0]:zn};Yt&&C&&typeof Xt=="function"&&Xt.length!=1&&(vt=Yt=!1);var ge=this.__chain__,Ae=!!this.__actions__.length,We=G&&!ge,vn=vt&&!Ae;if(!G&&Yt){rt=vn?rt:new Cn(this);var je=d.apply(rt,ct);return je.__actions__.push({func:r0,args:[te],thisArg:e}),new yo(je,ge)}return We&&vn?d.apply(this,ct):(je=this.thru(te),We?k?je.value()[0]:je.value():je)})}),cs(["pop","push","shift","sort","splice","unshift"],function(d){var g=go[d],C=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",k=/^(?:pop|shift)$/.test(d);H.prototype[d]=function(){var N=arguments;if(k&&!this.__chain__){var G=this.value();return g.apply(an(G)?G:[],N)}return this[C](function(rt){return g.apply(an(rt)?rt:[],N)})}}),Ra(Cn.prototype,function(d,g){var C=H[g];if(C){var k=C.name+"";yn.call(li,k)||(li[k]=[]),li[k].push({name:g,func:C})}}),li[Z_(e,y).name]=[{name:"wrapper",func:e}],Cn.prototype.clone=Aw,Cn.prototype.reverse=hm,Cn.prototype.value=Pw,H.prototype.at=O4,H.prototype.chain=D4,H.prototype.commit=I4,H.prototype.next=N4,H.prototype.plant=U4,H.prototype.reverse=F4,H.prototype.toJSON=H.prototype.valueOf=H.prototype.value=V4,H.prototype.first=H.prototype.head,Zs&&(H.prototype[Zs]=z4),H},Nr=Bi();Rs?((Rs.exports=Nr)._=Nr,Rh._=Nr):Wi._=Nr}).call(zt)})(Jb,Jb.exports);Jb.exports;const qY=()=>VY("threlte-controls",{orbitControls:_a(void 0)}),xR={type:"change"},_S={type:"start"},wR={type:"end"},Q0=new Fd,SR=new $c,WY=Math.cos(70*qD.DEG2RAD);let jY=class extends ma{constructor(t,e){super(),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Y,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:rd.ROTATE,MIDDLE:rd.DOLLY,RIGHT:rd.PAN},this.touches={ONE:sd.ROTATE,TWO:sd.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(tt){tt.addEventListener("keydown",B),this._domElementKeyEvents=tt},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",B),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(xR),n.update(),s=r.NONE},this.update=function(){const tt=new Y,Ut=new $r().setFromUnitVectors(t.up,new Y(0,1,0)),oe=Ut.clone().invert(),ue=new Y,ae=new $r,xe=new Y,Ze=2*Math.PI;return function(){const ee=n.object.position;tt.copy(ee).sub(n.target),tt.applyQuaternion(Ut),a.setFromVector3(tt),n.autoRotate&&s===r.NONE&&V(P()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Mt=n.minAzimuthAngle,ie=n.maxAzimuthAngle;isFinite(Mt)&&isFinite(ie)&&(Mt<-Math.PI?Mt+=Ze:Mt>Math.PI&&(Mt-=Ze),ie<-Math.PI?ie+=Ze:ie>Math.PI&&(ie-=Ze),Mt<=ie?a.theta=Math.max(Mt,Math.min(ie,a.theta)):a.theta=a.theta>(Mt+ie)/2?Math.max(Mt,a.theta):Math.min(ie,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(u,n.dampingFactor):n.target.add(u),n.zoomToCursor&&R||n.object.isOrthographicCamera?a.radius=St(a.radius):a.radius=St(a.radius*c),tt.setFromSpherical(a),tt.applyQuaternion(oe),ee.copy(n.target).add(tt),n.object.lookAt(n.target),n.enableDamping===!0?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,u.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),u.set(0,0,0));let le=!1;if(n.zoomToCursor&&R){let Xe=null;if(n.object.isPerspectiveCamera){const Rn=tt.length();Xe=St(Rn*c);const Zn=Rn-Xe;n.object.position.addScaledVector(E,Zn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Rn=new Y(A.x,A.y,0);Rn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/c)),n.object.updateProjectionMatrix(),le=!0;const Zn=new Y(A.x,A.y,0);Zn.unproject(n.object),n.object.position.sub(Zn).add(Rn),n.object.updateMatrixWorld(),Xe=tt.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Xe!==null&&(this.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Xe).add(n.object.position):(Q0.origin.copy(n.object.position),Q0.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Q0.direction))<WY?t.lookAt(n.target):(SR.setFromNormalAndCoplanarPoint(n.object.up,n.target),Q0.intersectPlane(SR,n.target))))}else n.object.isOrthographicCamera&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/c)),n.object.updateProjectionMatrix(),le=!0);return c=1,R=!1,le||ue.distanceToSquared(n.object.position)>o||8*(1-ae.dot(n.object.quaternion))>o||xe.distanceToSquared(n.target)>0?(n.dispatchEvent(xR),ue.copy(n.object.position),ae.copy(n.object.quaternion),xe.copy(n.target),le=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Kt),n.domElement.removeEventListener("pointerdown",Qt),n.domElement.removeEventListener("pointercancel",ot),n.domElement.removeEventListener("wheel",$),n.domElement.removeEventListener("pointermove",qt),n.domElement.removeEventListener("pointerup",ot),n._domElementKeyEvents!==null&&(n._domElementKeyEvents.removeEventListener("keydown",B),n._domElementKeyEvents=null)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new eC,l=new eC;let c=1;const u=new Y,h=new Vt,p=new Vt,m=new Vt,v=new Vt,_=new Vt,b=new Vt,y=new Vt,M=new Vt,S=new Vt,E=new Y,A=new Vt;let R=!1;const O=[],L={};function P(){return 2*Math.PI/60/60*n.autoRotateSpeed}function D(){return Math.pow(.95,n.zoomSpeed)}function V(tt){l.theta-=tt}function K(tt){l.phi-=tt}const W=function(){const tt=new Y;return function(oe,ue){tt.setFromMatrixColumn(ue,0),tt.multiplyScalar(-oe),u.add(tt)}}(),Z=function(){const tt=new Y;return function(oe,ue){n.screenSpacePanning===!0?tt.setFromMatrixColumn(ue,1):(tt.setFromMatrixColumn(ue,0),tt.crossVectors(n.object.up,tt)),tt.multiplyScalar(oe),u.add(tt)}}(),z=function(){const tt=new Y;return function(oe,ue){const ae=n.domElement;if(n.object.isPerspectiveCamera){const xe=n.object.position;tt.copy(xe).sub(n.target);let Ze=tt.length();Ze*=Math.tan(n.object.fov/2*Math.PI/180),W(2*oe*Ze/ae.clientHeight,n.object.matrix),Z(2*ue*Ze/ae.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(W(oe*(n.object.right-n.object.left)/n.object.zoom/ae.clientWidth,n.object.matrix),Z(ue*(n.object.top-n.object.bottom)/n.object.zoom/ae.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function ut(tt){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?c/=tt:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function nt(tt){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?c*=tt:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Q(tt){if(!n.zoomToCursor)return;R=!0;const Ut=n.domElement.getBoundingClientRect(),oe=tt.clientX-Ut.left,ue=tt.clientY-Ut.top,ae=Ut.width,xe=Ut.height;A.x=oe/ae*2-1,A.y=-(ue/xe)*2+1,E.set(A.x,A.y,1).unproject(t).sub(t.position).normalize()}function St(tt){return Math.max(n.minDistance,Math.min(n.maxDistance,tt))}function Pt(tt){h.set(tt.clientX,tt.clientY)}function dt(tt){Q(tt),y.set(tt.clientX,tt.clientY)}function Rt(tt){v.set(tt.clientX,tt.clientY)}function Jt(tt){p.set(tt.clientX,tt.clientY),m.subVectors(p,h).multiplyScalar(n.rotateSpeed);const Ut=n.domElement;V(2*Math.PI*m.x/Ut.clientHeight),K(2*Math.PI*m.y/Ut.clientHeight),h.copy(p),n.update()}function Bt(tt){M.set(tt.clientX,tt.clientY),S.subVectors(M,y),S.y>0?ut(D()):S.y<0&&nt(D()),y.copy(M),n.update()}function Wt(tt){_.set(tt.clientX,tt.clientY),b.subVectors(_,v).multiplyScalar(n.panSpeed),z(b.x,b.y),v.copy(_),n.update()}function be(tt){Q(tt),tt.deltaY<0?nt(D()):tt.deltaY>0&&ut(D()),n.update()}function re(tt){let Ut=!1;switch(tt.code){case n.keys.UP:tt.ctrlKey||tt.metaKey||tt.shiftKey?K(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):z(0,n.keyPanSpeed),Ut=!0;break;case n.keys.BOTTOM:tt.ctrlKey||tt.metaKey||tt.shiftKey?K(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):z(0,-n.keyPanSpeed),Ut=!0;break;case n.keys.LEFT:tt.ctrlKey||tt.metaKey||tt.shiftKey?V(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):z(n.keyPanSpeed,0),Ut=!0;break;case n.keys.RIGHT:tt.ctrlKey||tt.metaKey||tt.shiftKey?V(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):z(-n.keyPanSpeed,0),Ut=!0;break}Ut&&(tt.preventDefault(),n.update())}function It(){if(O.length===1)h.set(O[0].pageX,O[0].pageY);else{const tt=.5*(O[0].pageX+O[1].pageX),Ut=.5*(O[0].pageY+O[1].pageY);h.set(tt,Ut)}}function ye(){if(O.length===1)v.set(O[0].pageX,O[0].pageY);else{const tt=.5*(O[0].pageX+O[1].pageX),Ut=.5*(O[0].pageY+O[1].pageY);v.set(tt,Ut)}}function ce(){const tt=O[0].pageX-O[1].pageX,Ut=O[0].pageY-O[1].pageY,oe=Math.sqrt(tt*tt+Ut*Ut);y.set(0,oe)}function ne(){n.enableZoom&&ce(),n.enablePan&&ye()}function Gt(){n.enableZoom&&ce(),n.enableRotate&&It()}function J(tt){if(O.length==1)p.set(tt.pageX,tt.pageY);else{const oe=mt(tt),ue=.5*(tt.pageX+oe.x),ae=.5*(tt.pageY+oe.y);p.set(ue,ae)}m.subVectors(p,h).multiplyScalar(n.rotateSpeed);const Ut=n.domElement;V(2*Math.PI*m.x/Ut.clientHeight),K(2*Math.PI*m.y/Ut.clientHeight),h.copy(p)}function $t(tt){if(O.length===1)_.set(tt.pageX,tt.pageY);else{const Ut=mt(tt),oe=.5*(tt.pageX+Ut.x),ue=.5*(tt.pageY+Ut.y);_.set(oe,ue)}b.subVectors(_,v).multiplyScalar(n.panSpeed),z(b.x,b.y),v.copy(_)}function et(tt){const Ut=mt(tt),oe=tt.pageX-Ut.x,ue=tt.pageY-Ut.y,ae=Math.sqrt(oe*oe+ue*ue);M.set(0,ae),S.set(0,Math.pow(M.y/y.y,n.zoomSpeed)),ut(S.y),y.copy(M)}function ft(tt){n.enableZoom&&et(tt),n.enablePan&&$t(tt)}function kt(tt){n.enableZoom&&et(tt),n.enableRotate&&J(tt)}function Qt(tt){n.enabled!==!1&&(O.length===0&&(n.domElement.setPointerCapture(tt.pointerId),n.domElement.addEventListener("pointermove",qt),n.domElement.addEventListener("pointerup",ot)),se(tt),tt.pointerType==="touch"?Lt(tt):st(tt))}function qt(tt){n.enabled!==!1&&(tt.pointerType==="touch"?jt(tt):_t(tt))}function ot(tt){we(tt),O.length===0&&(n.domElement.releasePointerCapture(tt.pointerId),n.domElement.removeEventListener("pointermove",qt),n.domElement.removeEventListener("pointerup",ot)),n.dispatchEvent(wR),s=r.NONE}function st(tt){let Ut;switch(tt.button){case 0:Ut=n.mouseButtons.LEFT;break;case 1:Ut=n.mouseButtons.MIDDLE;break;case 2:Ut=n.mouseButtons.RIGHT;break;default:Ut=-1}switch(Ut){case rd.DOLLY:if(n.enableZoom===!1)return;dt(tt),s=r.DOLLY;break;case rd.ROTATE:if(tt.ctrlKey||tt.metaKey||tt.shiftKey){if(n.enablePan===!1)return;Rt(tt),s=r.PAN}else{if(n.enableRotate===!1)return;Pt(tt),s=r.ROTATE}break;case rd.PAN:if(tt.ctrlKey||tt.metaKey||tt.shiftKey){if(n.enableRotate===!1)return;Pt(tt),s=r.ROTATE}else{if(n.enablePan===!1)return;Rt(tt),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(_S)}function _t(tt){switch(s){case r.ROTATE:if(n.enableRotate===!1)return;Jt(tt);break;case r.DOLLY:if(n.enableZoom===!1)return;Bt(tt);break;case r.PAN:if(n.enablePan===!1)return;Wt(tt);break}}function $(tt){n.enabled===!1||n.enableZoom===!1||s!==r.NONE||(tt.preventDefault(),n.dispatchEvent(_S),be(tt),n.dispatchEvent(wR))}function B(tt){n.enabled===!1||n.enablePan===!1||re(tt)}function Lt(tt){switch(ht(tt),O.length){case 1:switch(n.touches.ONE){case sd.ROTATE:if(n.enableRotate===!1)return;It(),s=r.TOUCH_ROTATE;break;case sd.PAN:if(n.enablePan===!1)return;ye(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case sd.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ne(),s=r.TOUCH_DOLLY_PAN;break;case sd.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Gt(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(_S)}function jt(tt){switch(ht(tt),s){case r.TOUCH_ROTATE:if(n.enableRotate===!1)return;J(tt),n.update();break;case r.TOUCH_PAN:if(n.enablePan===!1)return;$t(tt),n.update();break;case r.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ft(tt),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;kt(tt),n.update();break;default:s=r.NONE}}function Kt(tt){n.enabled!==!1&&tt.preventDefault()}function se(tt){O.push(tt)}function we(tt){delete L[tt.pointerId];for(let Ut=0;Ut<O.length;Ut++)if(O[Ut].pointerId==tt.pointerId){O.splice(Ut,1);return}}function ht(tt){let Ut=L[tt.pointerId];Ut===void 0&&(Ut=new Vt,L[tt.pointerId]=Ut),Ut.set(tt.pageX,tt.pageY)}function mt(tt){const Ut=tt.pointerId===O[0].pointerId?O[1]:O[0];return L[Ut.pointerId]}n.domElement.addEventListener("contextmenu",Kt),n.domElement.addEventListener("pointerdown",Qt),n.domElement.addEventListener("pointercancel",ot),n.domElement.addEventListener("wheel",$,{passive:!1}),this.update()}};const XY=i=>({ref:i&1}),MR=i=>({ref:i[0]});function YY(i){let t;const e=i[7].default,n=hh(e,i,i[10],MR);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),t=!0},p(r,s){n&&n.p&&(!t||s&1025)&&dh(n,e,r,r[10],t?fh(e,r[10],s,XY):ph(r[10]),MR)},i(r){t||(Pn(n,r),t=!0)},o(r){Bn(n,r),t=!1},d(r){n&&n.d(r)}}}function KY(i){let t,e;const n=[{is:i[0]},i[6]];let r={$$slots:{default:[YY,({ref:s})=>({0:s}),({ref:s})=>s?1:0]},$$scope:{ctx:i}};for(let s=0;s<n.length;s+=1)r=vl(r,n[s]);return t=new Tv({props:r}),i[8](t),t.$on("change",i[3]),t.$on("create",i[9]),{c(){Cr(t.$$.fragment)},l(s){Er(t.$$.fragment,s)},m(s,o){Tr(t,s,o),e=!0},p(s,[o]){const a=o&65?xg(n,[o&1&&{is:s[0]},o&64&&wg(s[6])]):{};o&1025&&(a.$$scope={dirty:o,ctx:s}),t.$set(a)},i(s){e||(Pn(t.$$.fragment,s),e=!0)},o(s){Bn(t.$$.fragment,s),e=!1},d(s){i[8](null),Ar(t,s)}}}function ZY(i,t,e){const n=["ref"];let r=pf(t,n),s,o,{$$slots:a={},$$scope:l}=t;const c=QI();pa(i,c,S=>e(11,s=S));const{renderer:u,invalidate:h}=Gd();if(!u)throw new Error("Threlte Context missing: Is <OrbitControls> a child of <Canvas>?");if(!(s instanceof Ff))throw new Error("Parent missing: <OrbitControls> need to be a child of a <Camera>");const p=new jY(s,u.domElement),{start:m,stop:v}=sN(()=>p.update(),{autostart:!1,debugFrameloopMessage:"OrbitControls: updating controls"}),_=oN();pa(i,_,S=>e(1,o=S));const{orbitControls:b}=qY();function y(S){Ty[S?"unshift":"push"](()=>{o=S,_.set(o)})}const M=({ref:S,cleanup:E})=>{b.set(S),E(()=>{b.set(void 0)})};return i.$$set=S=>{t=vl(vl({},t),Wb(S)),e(6,r=pf(t,n)),"$$scope"in S&&e(10,l=S.$$scope)},i.$$.update=()=>{r.autoRotate||r.enableDamping?m():v()},[p,o,c,h,_,b,r,a,y,M,l]}class JY extends uo{constructor(t){super(),ho(this,t,ZY,KY,co,{ref:0})}get ref(){return this.$$.ctx[0]}}new rn;new rn;new fi;class QY{static apply(t){t.set=function(e){const n=this.options||{},r=Object.entries(e).reduce(function(s,[o,a]){return n[o]!==a&&(s[o]=a),s},{});this.options=Object.assign(n,r),this.trigger({type:"change",options:e,changes:r})},t.get=function(){return this.options},t.api=function(e,n){return e||(e={}),n&&Object.entries(e).forEach(function([r,s]){typeof s=="function"&&(e[r]=(...o)=>s(...o,n))}),e.set=this.set.bind(this),e.get=this.get.bind(this),e}}}class ml{static bind(t,e){return function(n,r){r.__binds||(r.__binds=[]);let s=t;Array.isArray(n)&&(s=n[0],n=n[1]);const o=/^([^.:]*(?:\.[^.:]+)*)?(?::(.*))?$/.exec(n),a=o[1].split(/\./g),l=a.pop(),c=o[2]||l,u=a.shift();let h={this:r}[u]||e[u]||t[u]||s;for(;h&&(n=a.shift());)h=h[n];if(h&&(h.on||h.addEventListener)){const p=function(v){r[c]&&r[c](v,t)};ml._polyfill(h,["addEventListener","on"],function(v){h[v](l,p)});const m={target:h,name:l,callback:p};return r.__binds.push(m),p}else throw"Cannot bind '"+n+"' in "+this.__name}}static unbind(){return function(t){t.__binds&&(t.__binds.forEach((function(e){ml._polyfill(e.target,["removeEventListener","off"],function(n){e.target[n](e.name,e.callback)})}).bind(this)),t.__binds=[])}}static apply(t){t.trigger=ml._trigger,t.triggerOnce=ml._triggerOnce,t.hasEventListener=ma.prototype.hasEventListener,t.addEventListener=ma.prototype.addEventListener,t.removeEventListener=ma.prototype.removeEventListener,t.on=t.addEventListener,t.off=t.removeEventListener,t.dispatchEvent=t.trigger}static _triggerOnce(t){this.trigger(t),this._listeners&&delete this._listeners[t.type]}static _trigger(t){if(this._listeners===void 0)return;const e=t.type;let n=this._listeners[e];if(n!==void 0){n=n.slice();const r=n.length;t.target=this;for(let s=0;s<r;s++)n[s].call(this,t,this)}}static _polyfill(t,e,n){e.map(function(r){return t.method}),e.length&&n(e[0])}}function CR(i){return i&&typeof i.valueOf()=="string"}const t7=(i,t)=>{let e=0;for(const n of i){if(t(n,e,i)===!1)break;e++}};class Kn{static initClass(){this.Plugins={},this.Aliases={}}static registerPlugin(t,e){const n=function(r){Kn.Plugin.call(this,r),this.__name=t};n.prototype=Object.assign(new Kn.Plugin,e),this.Plugins[t]=n}static unregisterPlugin(t){delete this.Plugins[t]}static registerAlias(t,e){this.Aliases[t]=e}static unregisterAlias(t){delete this.Aliases[t]}constructor(t){if(t){let r=[].slice.apply(arguments);if(t={},r[0]instanceof Node){const s=r[0];r=r.slice(1),t.element=s}CR(r[0])?t.plugins=r:Array.isArray(r[0])?t.plugins=r[0]:r[0]&&(t=Object.assign({},r[0],t))}const e={init:!0,element:document.body,plugins:["core"],aliases:{},plugindb:Kn.Plugins||{},aliasdb:Kn.Aliases||{}};this.__options=Object.assign({},e,t||{}),this.__inited=!1,this.__destroyed=!1,this.__installed=[];let n=this.__options.element;n===""+n&&(n=document.querySelector(n)),this.plugins={},this.element=n,this.trigger=this.trigger.bind(this),this.frame=this.frame.bind(this),this.events=["pre","update","render","post"].map(function(r){return{type:r}}),this.__options.init&&this.init()}init(){this.__inited||(this.__inited=!0,this.install(this.__options.plugins))}destroy(){this.__inited&&(this.__destroyed||(this.__destroyed=!0,this.trigger({type:"destroy"}),this.uninstall()))}frame(){this.events.map(this.trigger)}resolve(t){t=Array.isArray(t)?t:[t];const e=this.__options,n=Object.assign({},e.aliasdb,e.aliases),r=function(o){const a=o.split(":");return a[1]?(n[a[0]]=[a[1]],!1):!0};t=t.filter(r),Object.entries(n).forEach(function([o,a]){n[o]=Array.isArray(a)?a:[a]});function s(o,a,l){if(l>=256)throw"Plug-in alias recursion detected.";return o=o.filter(r),o.forEach(function(c){const u=n[c];u?a=a.concat(s(u,[],l+1)):a.push(c)}),a}return s(t,[],0)}install(t){t=Array.isArray(t)?t:[t],t=this.resolve(t),t7(t,e=>this.__install(e)),this.__ready()}uninstall(t){t&&(t=Array.isArray(t)?t:[t],t=this.resolve(t)),(t||this.__installed).reverse().forEach(e=>this.__uninstall(e))}__install(t){const e=this.__options.plugindb[t];if(!e)throw"[three.install] Cannot install. '"+t+"' is not registered.";if(this.plugins[t])return console.warn("[three.install] "+t+" is already installed.");const n=e,r=new n(this.__options[t]||{},t);this.plugins[t]=r;const s=r.install(this);return this.__installed.push(r),this.trigger({type:"install",plugin:r}),s}__uninstall(t){const e=CR(t)?this.plugins[t]:t;if(!e){console.warn("[three.uninstall] "+t+"' is not installed.");return}t=e.__name,e.uninstall(this),this.__installed=this.__installed.filter(n=>n!==e),delete this.plugins[t],this.trigger({type:"uninstall",plugin:e})}__ready(){this.triggerOnce({type:"ready"})}}Kn.initClass();Kn.Plugin=function(i){this.options=Object.assign({},this.defaults,i||{})};Kn.Plugin.prototype={listen:[],defaults:{},install:function(i){},uninstall:function(i){}};ml.apply(Kn.prototype);ml.apply(Kn.Plugin.prototype);QY.apply(Kn.Plugin.prototype);Kn.registerPlugin("splash",{defaults:{color:"mono",fancy:!0},listen:["ready","mathbox/init:init","mathbox/progress:progress","mathbox/destroy:destroy"],uninstall(){return this.destroy()},ready(i,t){if(t.MathBox&&!this.div)return this.init(i,t)},init(i,t){let e;this.destroy();const{color:n}=this.options,r=`<div class="mathbox-loader mathbox-splash-${n}">
  <div class="mathbox-logo">
    <div> <div></div><div></div><div></div> </div>
    <div> <div></div><div></div><div></div> </div>
  </div>
  <div class="mathbox-progress"><div></div></div>
</div>`;this.div=e=document.createElement("div"),e.innerHTML=r,t.element.appendChild(e);const s=Math.random()*2-1,o=Math.random()*2-1,a=Math.random()*2-1,l=1/Math.sqrt(s*s+o*o+a*a);return this.loader=e.querySelector(".mathbox-loader"),this.bar=e.querySelector(".mathbox-progress > div"),this.gyro=e.querySelectorAll(".mathbox-logo > div"),this.transforms=["rotateZ(22deg) rotateX(24deg) rotateY(30deg)","rotateZ(11deg) rotateX(12deg) rotateY(15deg) scale3d(.6, .6, .6)"],this.random=[s*l,o*l,a*l],this.start=t.Time.now,this.timer=null},progress(i,t){if(!this.div)return;const{current:e,total:n}=i,r=e<n;clearTimeout(this.timer),r?(this.loader.classList.remove("mathbox-exit"),this.loader.style.display="block"):(this.loader.classList.add("mathbox-exit"),this.timer=setTimeout(()=>this.loader.style.display="none",150));const s=e<n?Math.round(1e3*e/n)*.1+"%":"100%";if(this.bar.style.width=s,this.options.fancy){const o=this.random,a=Math.max(0,Math.min(1,t.Time.now-this.start)),l=function(c,u){return u==null&&(u=0),c.replace(/(-?[0-9.e]+)deg/g,(h,p)=>+p+o[u++]*a*t.Time.step*60+"deg")};return(()=>{const c=[];for(let u=0;u<this.gyro.length;u++){let h;const p=this.gyro[u];this.transforms[u]=h=l(this.transforms[u]),c.push(p.style.transform=p.style.WebkitTransform=h)}return c})()}},destroy(){return this.div!=null&&this.div.remove(),this.div=null}});Kn.registerAlias("empty",["fallback","bind","renderer","size","fill","loop","time"]);Kn.registerAlias("core",["empty","scene","camera","render","warmup"]);Kn.registerAlias("VR",["core","cursor","fullscreen","render:vr"]);Kn.registerPlugin("bind",{install:function(i){const t={three:i,window};i.bind=ml.bind(i,t),i.unbind=ml.unbind(i),i.bind("install:bind",this),i.bind("uninstall:unbind",this)},uninstall:function(i){i.unbind(this),delete i.bind,delete i.unbind},bind:function(i,t){const e=i.plugin,n=e.listen;n&&n.forEach(function(r){t.bind(r,e)})},unbind:function(i,t){t.unbind(i.plugin)}});Kn.registerPlugin("camera",{defaults:{near:.01,far:1e4,type:"perspective",fov:60,aspect:null,left:-1,right:1,bottom:-1,top:1,klass:null,parameters:null},listen:["resize","this.change"],install:function(i){i.Camera=this.api(),i.camera=null,this.aspect=1,this.change({},i)},uninstall:function(i){delete i.Camera,delete i.camera},change:function(i,t){const e=this.options,n=t.camera;if(!t.camera||i.changes.type||i.changes.klass){const r=e.klass||{perspective:Di,orthographic:wv}[e.type]||Ff;t.camera=e.parameters?new r(e.parameters):new r}Object.entries(e).forEach((function([r]){Object.prototype.hasOwnProperty.call(t.camera,r)&&(t.camera[r]=e[r])}).bind(this)),this.update(t),n===t.camera||t.trigger({type:"camera",camera:t.camera})},resize:function(i,t){this.aspect=i.viewWidth/Math.max(1,i.viewHeight),this.update(t)},update:function(i){i.camera.aspect=this.options.aspect||this.aspect,i.camera.updateProjectionMatrix()}});Kn.registerPlugin("fallback",{defaults:{force:!1,fill:!0,begin:'<div class="threestrap-fallback" style="display: table; width: 100%; height: 100%;box-sizing: border-box; border: 1px dashed rgba(0, 0, 0, .25);"><div style="display: table-cell; padding: 10px; vertical-align: middle; text-align: center;">',end:"</div></div>",message:'<big><strong>This example requires WebGL</strong></big><br>Visit <a target="_blank" href="http://get.webgl.org/">get.webgl.org</a> for more info</a>'},install:function(i){let t,e;try{if(t=document.createElement("canvas"),e=t.getContext("webgl")||t.getContext("experimental-webgl"),!e||this.options.force)throw"WebGL unavailable.";i.fallback=!1}catch{const r=this.options.message,s=this.options.begin,o=this.options.end,a=this.options.fill,l=document.createElement("div");for(l.innerHTML=s+r+o,this.children=[];l.childNodes.length>0;)this.children.push(l.firstChild),i.element.appendChild(l.firstChild);return a&&i.install("fill"),this.div=l,i.fallback=!0,!1}},uninstall:function(i){this.children&&(this.children.forEach(function(t){t.parentNode.removeChild(t)}),this.children=null),delete i.fallback}});Kn.registerPlugin("fill",{defaults:{block:!0,body:!0,layout:!0},install:function(i){function t(n){const r=n.style.height;return r=="auto"||r==""}function e(n){return n.style.height="100%",n.style.margin=0,n.style.padding=0,n}this.options.body&&i.element==document.body&&(this.applied=[i.element,document.documentElement].filter(t).map(e)),this.options.block&&i.canvas&&(i.canvas.style.display="block",this.block=!0),this.options.layout&&i.element&&window.getComputedStyle(i.element).position=="static"&&(i.element.style.position="relative",this.layout=!0)},uninstall:function(i){if(this.applied){const t=function(e){return e.style.height="",e.style.margin="",e.style.padding="",e};this.applied.map(t),delete this.applied}this.block&&i.canvas&&(i.canvas.style.display="",delete this.block),this.layout&&i.element&&(i.element.style.position="",delete this.layout)},change:function(i){this.uninstall(i),this.install(i)}});Kn.registerPlugin("loop",{defaults:{start:!0,each:1},listen:["ready"],install:function(i){this.running=!1,this.lastRequestId=null,i.Loop=this.api({start:this.start.bind(this),stop:this.stop.bind(this),running:!1,window},i),this.events=["pre","update","render","post"].map(function(t){return{type:t}})},uninstall:function(i){this.stop(i)},ready:function(i,t){this.options.start&&this.start(t)},start:function(i){if(this.running)return;i.Loop.running=this.running=!0;const t=i.trigger.bind(i),e=(function(){this.running&&(this.lastRequestId=i.Loop.window.requestAnimationFrame(e),this.events.map(t))}).bind(this);this.lastRequestId=i.Loop.window.requestAnimationFrame(e),i.trigger({type:"start"})},stop:function(i){this.running&&(i.Loop.running=this.running=!1,i.Loop.window.cancelAnimationFrame(this.lastRequestId),this.lastRequestId=null,i.trigger({type:"stop"}))}});Kn.registerPlugin("render",{listen:["render"],render:function(i,t){t.scene&&t.camera&&t.renderer.render(t.scene,t.camera)}});Kn.registerPlugin("renderer",{defaults:{klass:kE,parameters:{depth:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!0}},listen:["resize"],install:function(i){const t=i.renderer=new this.options.klass(this.options.parameters);i.canvas=t.domElement,i.element.appendChild(t.domElement)},uninstall:function(i){i.element.removeChild(i.renderer.domElement),delete i.renderer,delete i.canvas},resize:function(i,t){const e=t.renderer,n=e.domElement;n&&n.tagName=="CANVAS"?e.setSize(i.renderWidth,i.renderHeight,!1):(e.setRenderSize&&e.setRenderSize(i.renderWidth,i.renderHeight),e.setSize(i.viewWidth,i.viewHeight,!1))}});Kn.registerPlugin("scene",{install:function(i){i.scene=new Hf},uninstall:function(i){delete i.scene}});Kn.registerPlugin("size",{defaults:{width:null,height:null,aspect:null,scale:1,maxRenderWidth:1/0,maxRenderHeight:1/0,devicePixelRatio:!0},listen:["window.resize:queue","element.resize:queue","this.change:queue","ready:resize","pre:pre"],install:function(i){i.Size=this.api({renderWidth:0,renderHeight:0,viewWidth:0,viewHeight:0}),this.resized=!1},uninstall:function(i){delete i.Size},queue:function(i,t){this.resized=!0},pre:function(i,t){this.resized&&(this.resized=!1,this.resize(i,t))},resize:function(i,t){const e=this.options,n=t.element,r=t.renderer;let s,o,a,l,c,u,h,p,m=0,v=0;s=a=e.width===void 0||e.width==null?n.offsetWidth||n.innerWidth||0:e.width,o=l=e.height===void 0||e.height==null?n.offsetHeight||n.innerHeight||0:e.height,h=s/o,e.aspect&&(e.aspect>h?(o=Math.round(s/e.aspect),v=Math.floor((l-o)/2)):(s=Math.round(o*e.aspect),m=Math.floor((a-s)/2)),h=s/o),p=1,e.devicePixelRatio&&typeof window<"u"&&(p=window.devicePixelRatio||1),c=Math.round(Math.min(s*p*e.scale,e.maxRenderWidth)),u=Math.round(Math.min(o*p*e.scale,e.maxRenderHeight)),c/u>h?c=Math.round(u*h):u=Math.round(c/h),p=u/o;const b=r.domElement.style;b.width=s+"px",b.height=o+"px",b.marginLeft=m+"px",b.marginTop=v+"px",Object.assign(t.Size,{renderWidth:c,renderHeight:u,viewWidth:s,viewHeight:o,aspect:h,pixelRatio:p}),t.trigger({type:"resize",renderWidth:c,renderHeight:u,viewWidth:s,viewHeight:o,aspect:h,pixelRatio:p})}});Kn.registerPlugin("time",{defaults:{speed:1,warmup:0,timeout:1},listen:["pre:tick","this.change"],now:function(){return+new Date/1e3},install:function(i){i.Time=this.api({now:this.now(),clock:0,step:1/60,frames:0,time:0,delta:1/60,average:0,fps:0}),this.last=0,this.time=0,this.clock=0,this.wait=this.options.warmup,this.clockStart=0,this.timeStart=0},tick:function(i,t){const e=this.options.speed,n=this.options.timeout,r=t.Time,s=r.now=this.now(),o=this.last;let a=this.time,l=this.clock;if(o){let c=r.delta=s-o;const u=r.average||c;c>n&&(c=0);const h=c*e;a+=c,l+=h,r.frames>0&&(r.average=u+(c-u)*.1,r.fps=1/u),r.step=h,r.clock=l-this.clockStart,r.time=a-this.timeStart,r.frames++,this.wait-- >0&&(this.clockStart=l,this.timeStart=a,r.clock=0,r.step=1e-100)}this.last=s,this.clock=l,this.time=a},uninstall:function(i){delete i.Time}});Kn.registerPlugin("warmup",{defaults:{delay:2},listen:["ready","post"],ready:function(i,t){t.renderer.domElement.style.visibility="hidden",this.frame=0,this.hidden=!0},post:function(i,t){this.hidden&&this.frame>=this.options.delay&&(t.renderer.domElement.style.visibility="visible",this.hidden=!1),this.frame++}});Kn.registerPlugin("controls",{listen:["update","resize","camera","this.change"],defaults:{klass:null,parameters:{}},install:function(i){if(!this.options.klass)throw"Must provide class for `controls.klass`";i.controls=null,this._camera=i.camera||new Di,this.change(null,i)},uninstall:function(i){delete i.controls},change:function(i,t){this.options.klass?((!i||i.changes.klass)&&(t.controls=new this.options.klass(this._camera,t.renderer.domElement)),Object.assign(t.controls,this.options.parameters)):t.controls=null},update:function(i,t){const e=t.Time&&t.Time.delta||.016666666666666666,n=t.VR&&t.VR.state;t.controls.vr&&t.controls.vr(n),t.controls.update(e)},camera:function(i,t){t.controls.object=this._camera=i.camera},resize:function(i,t){t.controls.handleResize&&t.controls.handleResize()}});Kn.registerPlugin("cursor",{listen:["update","this.change","install:change","uninstall:change","element.mousemove","vr"],defaults:{cursor:null,hide:!1,timeout:3},install:function(i){this.timeout=this.options.timeout,this.element=i.element,this.change(null,i)},uninstall:function(i){delete i.controls},change:function(i,t){this.applyCursor(t)},mousemove:function(i,t){this.options.hide&&(this.applyCursor(t),this.timeout=+this.options.timeout||0)},update:function(i,t){const e=t.Time&&t.Time.delta||.016666666666666666;this.options.hide&&(this.timeout-=e,this.timeout<0&&this.applyCursor(t,"none"))},vr:function(i,t){this.hide=i.active&&!i.hmd.fake,this.applyCursor(t)},applyCursor:function(i,t){const e=i.controls?"move":"";t=t||this.options.cursor||e,this.hide&&(t="none"),this.cursor!=t&&(this.element.style.cursor=t)}});Kn.registerPlugin("fullscreen",{defaults:{key:"f"},listen:["ready","update"],install:function(i){i.Fullscreen=this.api({active:!1,toggle:this.toggle.bind(this)},i)},uninstall:function(i){delete i.Fullscreen},ready:function(i,t){document.body.addEventListener("keypress",(function(n){this.options.key&&n.charCode==this.options.key.charCodeAt(0)&&this.toggle(t)}).bind(this));const e=(function(){const n=!!document.fullscreenElement||!!document.mozFullScreenElement||!!document.webkitFullscreenElement||!!document.msFullscreenElement;t.Fullscreen.active=this.active=n,t.trigger({type:"fullscreen",active:n})}).bind(this);document.addEventListener("fullscreenchange",e,!1),document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1)},toggle:function(i){const t=i.canvas,e=i.VR&&i.VR.active?{vrDisplay:i.VR.hmd}:{};this.active?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():t.requestFullScreen?t.requestFullScreen(e):t.msRequestFullScreen?t.msRequestFullscreen(e):t.webkitRequestFullscreen?t.webkitRequestFullscreen(e):t.mozRequestFullScreen&&t.mozRequestFullScreen(e)}});var aN={exports:{}};(function(i,t){(function(e,n){i.exports=n()})(zt,function(){var e=function(){function n(m){return o.appendChild(m.dom),m}function r(m){for(var v=0;v<o.children.length;v++)o.children[v].style.display=v===m?"block":"none";s=m}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(m){m.preventDefault(),r(++s%o.children.length)},!1);var a=(performance||Date).now(),l=a,c=0,u=n(new e.Panel("FPS","#0ff","#002")),h=n(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=n(new e.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:n,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){c++;var m=(performance||Date).now();if(h.update(m-a,200),m>l+1e3&&(u.update(1e3*c/(m-l),100),l=m,c=0,p)){var v=performance.memory;p.update(v.usedJSHeapSize/1048576,v.jsHeapSizeLimit/1048576)}return m},update:function(){a=this.end()},domElement:o,setMode:r}};return e.Panel=function(n,r,s){var o=1/0,a=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,h=48*c,p=3*c,m=2*c,v=3*c,_=15*c,b=74*c,y=30*c,M=document.createElement("canvas");M.width=u,M.height=h,M.style.cssText="width:80px;height:48px";var S=M.getContext("2d");return S.font="bold "+9*c+"px Helvetica,Arial,sans-serif",S.textBaseline="top",S.fillStyle=s,S.fillRect(0,0,u,h),S.fillStyle=r,S.fillText(n,p,m),S.fillRect(v,_,b,y),S.fillStyle=s,S.globalAlpha=.9,S.fillRect(v,_,b,y),{dom:M,update:function(E,A){o=Math.min(o,E),a=Math.max(a,E),S.fillStyle=s,S.globalAlpha=1,S.fillRect(0,0,u,_),S.fillStyle=r,S.fillText(l(E)+" "+n+" ("+l(o)+"-"+l(a)+")",p,m),S.drawImage(M,v+c,_,b-c,y,v,_,b-c,y),S.fillRect(v+b-c,_,c,y),S.fillStyle=s,S.globalAlpha=.9,S.fillRect(v+b-c,_,c,l((1-E/A)*y))}}},e})})(aN);var e7=aN.exports;const n7=zd(e7);Kn.registerPlugin("stats",{listen:["pre","post"],install:function(i){const t=this.stats=new n7,e=t.domElement.style;e.position="absolute",e.top=e.left=0,i.element.appendChild(t.domElement),i.stats=t},uninstall:function(i){this.stats.domElement.remove(),delete i.stats},pre:function(i,t){this.stats.begin()},post:function(i,t){this.stats.end()}});Kn.registerPlugin("ui",{defaults:{theme:"white",style:".threestrap-ui { position: absolute; bottom: 5px; right: 5px; float: left; }.threestrap-ui button { border: 0; background: none;  vertical-align: middle; font-weight: bold; } .threestrap-ui .glyphicon { top: 2px; font-weight: bold; } @media (max-width: 640px) { .threestrap-ui button { font-size: 120% } }.threestrap-white button { color: #fff; text-shadow: 0 1px 1px rgba(0, 0, 0, 1), 0 1px 3px rgba(0, 0, 0, 1); }.threestrap-black button { color: #000; text-shadow: 0 0px 1px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1) }"},listen:["fullscreen"],markup:function(i,t,e){let n="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css";location.href.match(/^file:\/\//)&&(n="http://"+n);const r=[];return i.Fullscreen&&r.push('<button class="fullscreen" title="Full Screen"><span class="glyphicon glyphicon-fullscreen"></span></button>'),i.VR&&r.push('<button class="vr" title="VR Headset">VR</button>'),'<style type="text/css">@import url("'+n+'"); '+e+'</style><div class="threestrap-ui threestrap-'+t+'">'+r.join(`
`)+"</div>"},install:function(i){const t=this.ui=document.createElement("div");t.innerHTML=this.markup(i,this.options.theme,this.options.style),document.body.appendChild(t);const e=this.ui.fullscreen=t.querySelector("button.fullscreen");e&&i.bind([e,"click:goFullscreen"],this);const n=this.ui.vr=t.querySelector("button.vr");n&&i.VR&&(i.VR.set({mode:"2d"}),i.bind([n,"click:goVR"],this))},fullscreen:function(i,t){this.ui.style.display=i.active?"none":"block",i.active||t.VR&&t.VR.set({mode:"2d"})},goFullscreen:function(i,t){t.Fullscreen&&t.Fullscreen.toggle()},goVR:function(i,t){t.VR&&(t.VR.set({mode:"auto"}),t.Fullscreen.toggle())},uninstall:function(i){document.body.removeChild(this.ui)}});class ER{constructor(t,e){this.renderer=t,this.right=new Y,this.cameraLeft=new Di,this.cameraRight=new Di;const n=e.getEyeTranslation("left");this.halfIPD=new Y(n.x,n.y,n.z).length(),this.fovLeft=e.getRecommendedEyeFieldOfView("left"),this.fovRight=e.getRecommendedEyeFieldOfView("right")}FovToNDCScaleOffset(t){const e=2/(t.leftTan+t.rightTan),n=(t.leftTan-t.rightTan)*e*.5,r=2/(t.upTan+t.downTan),s=(t.upTan-t.downTan)*r*.5;return{scale:[e,r],offset:[n,s]}}FovPortToProjection(t,e,n,r,s){n=n===void 0?!0:n,r=r===void 0?.01:r,s=s===void 0?1e4:s;const o=n?-1:1,a=t.elements,l=this.FovToNDCScaleOffset(e);a[0*4+0]=l.scale[0],a[0*4+1]=0,a[0*4+2]=l.offset[0]*o,a[0*4+3]=0,a[1*4+0]=0,a[1*4+1]=l.scale[1],a[1*4+2]=-l.offset[1]*o,a[1*4+3]=0,a[2*4+0]=0,a[2*4+1]=0,a[2*4+2]=s/(r-s)*-o,a[2*4+3]=s*r/(r-s),a[3*4+0]=0,a[3*4+1]=0,a[3*4+2]=o,a[3*4+3]=0,t.transpose()}FovToProjection(t,e,n,r,s){const o={upTan:Math.tan(e.upDegrees*Math.PI/180),downTan:Math.tan(e.downDegrees*Math.PI/180),leftTan:Math.tan(e.leftDegrees*Math.PI/180),rightTan:Math.tan(e.rightDegrees*Math.PI/180)};return this.FovPortToProjection(t,o,n,r,s)}render(t,e){this.FovToProjection(this.cameraLeft.projectionMatrix,this.fovLeft,!0,e.near,e.far),this.FovToProjection(this.cameraRight.projectionMatrix,this.fovRight,!0,e.near,e.far),this.right.set(this.halfIPD,0,0),this.right.applyQuaternion(e.quaternion),this.cameraLeft.position.copy(e.position).sub(this.right),this.cameraRight.position.copy(e.position).add(this.right),this.cameraLeft.quaternion.copy(e.quaternion),this.cameraRight.quaternion.copy(e.quaternion);const n=this.renderer.devicePixelRatio||1,r=this.renderer.domElement.width/2/n,s=this.renderer.domElement.height/n;this.renderer.enableScissorTest(!0),this.renderer.setViewport(0,0,r,s),this.renderer.setScissor(0,0,r,s),this.renderer.render(t,this.cameraLeft),this.renderer.setViewport(r,0,r,s),this.renderer.setScissor(r,0,r,s),this.renderer.render(t,this.cameraRight)}}Kn.registerPlugin("vr",{defaults:{mode:"auto",device:null,fov:80},listen:["window.load","pre","render","resize","this.change"],install:function(i){i.VR=this.api({active:!1,devices:[],hmd:null,sensor:null,renderer:null,state:null},i)},uninstall:function(i){delete i.VR},mocks:function(i,t,e){return[{fake:!0,force:1,deviceId:"emu",deviceName:"Emulated",getEyeTranslation:function(a){return{left:{x:-.03,y:0,z:0},right:{x:.03,y:0,z:0}}[a]},getRecommendedEyeFieldOfView:function(a){const l=i.camera,c=l&&l.aspect||16/9,u=(t||l&&l.fov||e)/2,h=Math.atan(Math.tan(u*Math.PI/180)*c/2)*180/Math.PI,p=u;return{left:{rightDegrees:h,leftDegrees:h,downDegrees:p,upDegrees:p},right:{rightDegrees:h,leftDegrees:h,downDegrees:p,upDegrees:p}}[a]}},{force:2,getState:function(){return{}}}]},load:function(i,t){const e=(function(n){this.callback(n,t)}).bind(this);navigator.getVRDevices?navigator.getVRDevices().then(e):navigator.mozGetVRDevices?navigator.mozGetVRDevices(e):(console.warn("No native VR support detected."),e(this.mocks(t,this.options.fov,this.defaults.fov),t))},callback:function(i,t){let e,n;const r=window.HMDVRDevice||function(){},s=window.PositionSensorVRDevice||function(){};i=t.VR.devices=i||t.VR.devices;const o=this.options.device;let a;for(let l=0;l<i.length;++l)if(a=i[l],a.force==1||a instanceof r){if(o&&o!=a.deviceId)continue;e=a;break}if(e){let l;for(let c=0;c<i.length;++c)if(l=i[c],l.force==2||l instanceof s&&l.hardwareUnitId==e.hardwareUnitId){n=l;break}this.hookup(e,n,t)}},hookup:function(i,t,e){ER||console.log("VRRenderer not found");const n=ER||function(){};this.renderer=new n(e.renderer,i),this.hmd=i,this.sensor=t,e.VR.renderer=this.renderer,e.VR.hmd=i,e.VR.sensor=t,console.log("VRRenderer",i.deviceName)},change:function(i,t){i.changes.device&&this.callback(null,t),this.pre(i,t)},pre:function(i,t){const e=this.active,n=this.active=this.renderer&&this.options.mode!="2d";if(t.VR.active=n,n&&this.sensor){const r=this.sensor.getState();t.VR.state=r}else t.VR.state=null;e!=this.active&&t.trigger({type:"vr",active:n,hmd:this.hmd,sensor:this.sensor})},resize:function(i,t){this.active&&this.renderer.initialize()},render:function(i,t){if(t.scene&&t.camera){const e=this.active?this.renderer:t.renderer;if(this.last!=e&&e==t.renderer){const n=e.getPixelRatio(),r=e.domElement.width/n,s=e.domElement.height/n;e.setScissorTest(!1),e.setViewport(0,0,r,s)}this.last=e,e.render(t.scene,t.camera)}}});class lN{constructor(t,e){this.context=e,this.traits=t.Traits,this.types=t.Types,this.pending=[],this.bound=[],this.last=null}make(t){return{enum:typeof t.enum=="function"?t.enum():void 0,type:typeof t.uniform=="function"?t.uniform():void 0,value:t.make()}}apply(t,e){return new i7(t,e,this)}bind(t){return this.bound.push(t)}unbind(t){return this.bound=Array.from(this.bound).filter(e=>e!==t)}queue(t,e,n,r){return this.lastObject=e,this.lastKey=n,this.lastValue=r,this.pending.push(t)}invoke(t){return t(this.context.time.clock,this.context.time.step)}compute(){if(this.bound.length)for(const t of Array.from(this.bound))this.invoke(t)}digest(){let t;if(!this.pending.length)return!1;[t,this.pending]=Array.from([this.pending,[]]);for(const e of Array.from(t))e();return!0}getTrait(t){return this.traits[t]}getLastTrigger(){return`${this.lastObject.toString()} - ${this.lastKey}=\`${this.lastValue}\``}}const tb=function(i){const t={};for(const e in i){const n=i[e];t[e]=n}return t};let i7=class{constructor(t,e,n){let r,s,o,a,l,c,u,{props:h}=e;const{traits:p,finals:m,freeform:v}=e,_=this;t.props!=null&&t.expr!=null&&t.orig!=null&&t.computed!=null&&t.attributes!=null&&(c=tb(t.props),a=tb(t.expr),l=t.orig(),o=t.computed(),t.attributes!=null&&t.attributes.dispose());const b={},y={},M={},S=et=>M[et]!=null?M[et]:et,E=function(et,ft){if(M[ft])throw new Error(`${t.toString()} - Duplicate property \`${ft}\``);return M[ft]=et},A=et=>(_[et]!=null?_[et].value:void 0)!=null?_[et]!=null?_[et].value:void 0:r7(_[S(et)],ft=>ft.value),R=function(et,ft,kt,Qt){let qt;if(et=S(et),(qt=_[et])==null){if(!v)throw new Error(`${t.toString()} - Setting unknown property \`${et}={${ft}}\``);qt=_[et]={short:et,type:null,last:null,value:null},Q[et]=_t=>_t}if(!kt){if(V[et])throw new Error(`${t.toString()} - Can't set bound property \`${et}={${ft}}\``);if(K[et])throw new Error(`${t.toString()} - Can't set computed property \`${et}={${ft}}\``);if(W[et])throw new Error(`${t.toString()} - Can't set final property \`${et}={${ft}}\``)}let ot=!0;const st=dt(et,ft,qt.last,function(){return ot=!1,null});if(ot){[qt.value,qt.last]=Array.from([st,qt.value]);const{short:_t}=qt;b[_t]=st,kt||(y[_t]=ft),!Qt&&!Pt(et,qt.value,qt.last)&&It(et,ft)}return ot},O=function(et,ft,kt){return et=S(et),R(et,ft,!0,kt),W[et]=!0},L={},P={},D={},V={},K={},W={},Z=function(et,ft,kt){if(kt==null&&(kt=!1),et=S(et),typeof ft!="function")throw new Error(`${t.toString()} - Expression \`${et}=>{${L}}\` is not a function`);if(V[et])throw new Error(`${t.toString()} - Property \`${et}=>{${L}}\` is already bound`);if(K[et])throw new Error(`${t.toString()} - Property \`${et}\` is computed`);if(W[et])throw new Error(`${t.toString()} - Property \`${et}\` is final`);const Qt=kt?K:V;Qt[et]=ft;const qt=_[et]!=null?_[et].short:et;return kt||(L[qt]=ft),D[et]=ft,ft=ft.bind(t),P[et]=function(ot,st){let _t;return(_t=t.clock!=null?t.clock.getTime():void 0)&&(ot=_t.clock,st=_t.step),t.set(et,ft(ot,st),!0)},n.bind(P[et])},z=function(et,ft){ft==null&&(ft=!1),et=S(et);const kt=ft?K:V;if(kt[et])return n.unbind(P[et]),delete P[et],delete kt[et],_[et]!=null&&(et=_[et].short),delete L[et]},ut=function(et,ft){let kt;return et=S(et),(kt=typeof D[et]=="function"?D[et](ft,0):void 0)!=null?kt:_[et].value};t.expr=L,t.props=b,t.evaluate=function(et,ft){if(et!=null)return ut(et,ft);{const kt={};for(et in h)kt[et]=ut(et,ft);return kt}},t.get=function(et){return et!=null?A(et):b},t.set=function(et,ft,kt,Qt){if(typeof et=="string")R(et,ft,kt,Qt);else{Qt=kt,kt=ft;const qt=et;for(et in qt)ft=qt[et],R(et,ft,kt,Qt)}},t.bind=function(et,ft,kt){if(typeof et=="string")Z(et,ft,kt);else{kt=ft;const Qt=et;for(et in Qt)ft=Qt[et],Z(et,ft,kt)}},t.unbind=function(et,ft){if(typeof et=="string")z(et,ft);else{ft=L;const kt=et;for(et in kt)z(et,ft)}},t.attribute=function(et){return et!=null?_[S(et)]:_},t.orig=function(et){return et!=null?y[S(et)]:tb(y)},t.computed=function(et){return et!=null?K[S(et)]:tb(K)};const nt={},Q={},St={},Pt=(et,ft,kt)=>St[et](ft,kt),dt=(et,ft,kt,Qt)=>Q[et](ft,kt,Qt);t.validate=function(et,ft){let kt;et=S(et);const Qt=nt[et];return Qt!=null&&(kt=Qt()),kt=dt(et,ft,kt,function(){throw new Error(`${t.toString()} - Invalid value \`${et}={${ft}}\``)})};let Rt=!1,Jt={},Bt={},Wt={},be={};const re=et=>et.split(".")[0],It=function(et,ft){Rt||(Rt=!0,n.queue(ce,t,et,ft));const kt=re(et);return Jt[et]=!0,Bt[kt]=!0},ye={type:"change",changed:null,touched:null},ce=function(){let et;ye.changed=Jt,ye.touched=Bt,Jt=Wt,Bt=be,{changed:Wt}=ye,{touched:be}=ye,Rt=!1;for(et in Jt)Jt[et]=!1;for(et in Bt)Bt[et]=!1;return ye.type="change",t.trigger(ye),(()=>{const ft=[];for(const kt in ye.touched)ye.type=`change:${kt}`,ft.push(t.trigger(ye));return ft})()},ne=function(et){const ft=et.split(/\./g),kt=ft.pop();return ft.pop(),ft.unshift(kt),ft.reduce((Qt,qt)=>Qt+qt.charAt(0).toUpperCase()+qt.substring(1))},Gt=(et,ft)=>(()=>{const kt=[];for(let Qt in ft){let qt;const ot=ft[Qt];Qt=[et,Qt].join(".");const st=ne(Qt);_[Qt]={T:ot,ns:et,short:st,enum:typeof ot.enum=="function"?ot.enum():void 0,type:typeof ot.uniform=="function"?ot.uniform():void 0,last:ot.make(),value:qt=ot.make()},E(Qt,st),b[st]=qt,nt[Qt]=ot.make,Q[Qt]=ot.validate!=null?ot.validate:_t=>_t,kt.push(St[Qt]=ot.equals!=null?ot.equals:(_t,$)=>_t===$)}return kt})(),J=[];for(let et of Array.from(p)){[et,s]=Array.from(et.split(":"));const ft=s?[s,et].join("."):et;u=n.getTrait(et),J.push(et),u!=null&&Gt(ft,u)}if(h!=null)for(s in h)u=h[s],Gt(s,u);const $t=J.filter((et,ft)=>J.indexOf(et)===ft);if(t.traits=$t,c!=null&&t.set(c,!0,!0),m!=null)for(r in m){const et=m[r];O(r,et,!0)}l!=null&&t.set(l,!1,!0),o!=null&&t.bind(o,!0),a!=null&&t.bind(a,!1),this.dispose=function(){for(r in K)z(r,!0);for(r in V)z(r,!1);return h={},delete t.attributes,delete t.get,delete t.set}}};function r7(i,t){return typeof i<"u"&&i!==null?t(i):void 0}const TR=5,s7=1e-4,o7=(i,t)=>Math.abs(i/t-Math.round(i/t))<s7,eb=i=>o7(i,1),a7=function(i,t,e,n){const r=Math.round(i/t);return r===1?`${e}`:r===-1?`-${e}`:e==="1"?`${r}`:n?`${r}${e}`:`${r}*${e}`},l7=function(i,t,e,n){let r=Math.round(i*t);return Math.abs(r)===1?(r=r<0?"-":"",r+=e):e!=="1"&&(r+=n?`${e}`:`*${e}`),`${r}/${t}`},AR=[{1:1},{1:1,:Math.PI*2},{1:1,:Math.PI},{1:1,:Math.PI*2,:Math.PI},{1:1,e:Math.E},{1:1,:Math.PI*2,e:Math.E},{1:1,:Math.PI,e:Math.E},{1:1,:Math.PI*2,:Math.PI,e:Math.E}],c7=[[2*2*3*5*7,[2,3,5,7]],[2*2*2*3*3*5*5*7*7,[2,3,5,7]],[2*2*3*5*7*11*13,[2,3,5,7,11,13]],[2*2*17*19*23*29,[2,17,19,23,29]],[256*256,[2]],[1e6,[2,5]]],cN=function(i){let t,e,n,r,s;i&&({cache:t,compact:e,tau:s,pi:r,e:n}=i),e=+!!(e??!0),s=+!!(s??!0),r=+!!(r??!0),n=+!!(n??!0),t=+!!(t??!0);const o=s+r*2+n*4,a=t?{}:null;return function(l){if(a!=null){let p;if((p=a[l])!=null)return p;if(l===Math.round(l))return a[l]=`${l}`}let c=`${l}`,u=c.length+c.indexOf(".")+2;const h=function(p){const m=p.length;if(m<=u)return c=`${p}`,u=m};for(const p in AR[o]){const m=AR[o][p];if(eb(l/m))h(`${a7(l/m,1,p,e)}`);else for(let[v,_]of Array.from(c7)){let b=l/m*v;if(eb(b)){for(const y of Array.from(_)){let M,S;for(;eb(S=b/y)&&eb(M=v/y);)b=S,v=M}h(`${l7(l/m,v,p,e)}`);break}}}return`${l}`.length>TR&&h(`${l.toPrecision(TR)}`),a!=null&&(a[l]=c),c}},iT=function(i,t){return t==null&&(t="info"),i=uN(i),console[t].apply(console,i)},uN=function(i){const t="color:rgb(128,0,128)",e="color:rgb(144,64,0)",n="color:rgb(0,0,192)",r="color:rgb(0,70,156)",s="color:inherit";let o=!1,a=0;const l=[];return i=i.replace(/(\\[<={}> "'])|(=>|[<={}> "'])/g,function(c,u,h){return u!=null&&u.length?u:o&&!['"',"'"].includes(h)||a&&!['"',"'","{","}"].includes(h)?h:(()=>{switch(h){case"<":return l.push(t),"%c<";case">":return l.push(t),l.push(s),"%c>%c";case" ":return l.push(e)," %c";case"=":case"=>":return l.push(t),`%c${h}`;case'"':case"'":return o=!o,o?(l.push(a?e:n),`${h}%c`):(l.push(a?r:t),`%c${h}`);case"{":return a++===0?(l.push(r),`%c${h}`):h;case"}":return--a===0?(l.push(t),`${h}%c`):h;default:return h}})()}),[i].concat(l)},u7=(i,t)=>hN(i,t,"="),h7=(i,t)=>hN(i,t,"=>"),hN=function(){const i=cN({compact:!1});return function(t,e,n){const r=function(a){return a===""+ +a||a.match(/^[A-Za-z_][A-Za-z0-9]*$/)?a:JSON.stringify(a)},s=function(a){return a.match(`
*"`)?a:`{${a}}`},o=function(a){if(a instanceof Array)return`[${a.map(o).join(", ")}]`;switch(typeof a){case"string":return a.match(`
`)?`"
${a}"
`:`"${a}"`;case"function":return a=`${a}`,a.match(`
`),a=a.replace(/^function (\([^)]*\))/,"$1 =>"),a=a.replace(/^(\([^)]*\)) =>\s*{\s*return\s*([^}]+)\s*;\s*}/,"$1 => $2");case"number":return i(a);default:return a!=null&&a!==!!a?a._up!=null?o(a.map(l=>l)):a.toMarkup?a.toString():"{"+(()=>{const l=[];for(const c in a){const u=a[c];Object.prototype.hasOwnProperty.call(a,c)&&l.push(`${r(c)}: ${o(u)}`)}return l})().join(", ")+"}":`${JSON.stringify(a)}`}};return[t,n,s(o(e))].join("")}}(),bS=function(i){return i=i.replace(/&/g,"&amp;"),i=i.replace(/</g,"&lt;"),i=i.replace(/"/g,"&quot;")},d7=function(i){const t=[].slice.call(arguments);t.shift();let e="<span>";i=bS(i);for(const n of Array.from(t))i=i.replace(/%([a-z])/,function(r,s){const o=t.shift();switch(s){case"c":return`</span><span style="${bS(o)}">`;default:return bS(o)}});return e+=i,e+="</span>"},nC={prop:u7,bind:h7},p7=Object.freeze(Object.defineProperty({__proto__:null,JSX:nC,format:d7,markup:uN,number:cN,print:iT},Symbol.toStringTag,{value:"Module"}));let f7=0,Zg=class{constructor(t,e,n,r,s,o){this.type=t,this._id=(++f7).toString(),this.configure(s,o),this.parent=this.root=this.path=this.index=null,this.set(e,!0,!0),this.set(n,!1,!0),this.bind(r,!1)}configure(t,e){let{traits:n,props:r,finals:s,freeform:o}=t;return n==null&&(n=(this._config!=null?this._config.traits:void 0)!=null?this._config!=null?this._config.traits:void 0:[]),r==null&&(r=(this._config!=null?this._config.props:void 0)!=null?this._config!=null?this._config.props:void 0:{}),s==null&&(s=(this._config!=null?this._config.finals:void 0)!=null?this._config!=null?this._config.finals:void 0:{}),o==null&&(o=(this._config!=null?this._config.freeform:void 0)!=null?this._config!=null?this._config.freeform:void 0:!1),this._config={traits:n,props:r,finals:s,freeform:o},this.attributes=e.apply(this,this._config)}dispose(){return this.attributes.dispose(),this.attributes=null}_added(t){this.parent=t,this.root=t.root;const e={type:"add",node:this,parent:this.parent};return this.root&&this.root.trigger(e),e.type="added",this.trigger(e)}_removed(){const t={type:"remove",node:this};return this.root&&this.root.trigger(t),t.type="removed",this.trigger(t),this.root=this.parent=null}_index(t,e){let n;if(e==null&&({parent:e}=this),this.index=t,this.path=n=t!=null?((e!=null?e.path:void 0)!=null?e!=null?e.path:void 0:[]).concat([t]):null,this.order=n!=null?this._encode(n):1/0,this.root!=null)return this.trigger({type:"reindex"})}_encode(t){const n=a=>3/(a+3),r=a=>o+(s-o)*a;let s=1.3333333333333333,o=0;for(const a of Array.from(t)){const l=n(a+1),c=n(a+2);[s,o]=Array.from([r(l),r(c)])}return s}toString(){const t=this.id!=null?this.id:this._id,e=this.type!=null?this.type:"node";let n=e;if(n+=`#${t}`,this.classes!=null&&this.classes.length&&(n+=`.${this.classes.join(".")}`),this.children!=null){let r;return(r=this.children.length)?`<${n}>(${r})</${e}>`:`<${n}></${e}>`}else return`<${n} />`}toMarkup(t=null,e){let n,r;if(e==null&&(e=""),t&&typeof t!="function"){let m;t=(m=this.root!=null?this.root.model._matcher(t):void 0)!=null?m:()=>!0}const s=this.type!=null?this.type:"node";let{expr:o}=this;const a={id:this._id},l=typeof this.orig=="function"?this.orig():void 0;for(n in l)r=l[n],a[n]=r;const c=(()=>{const m=[];for(n in a)r=a[n],this.expr[n]||m.push(nC.prop(n,r));return m})();o=(()=>{const m=[];for(n in o)r=o[n],m.push(nC.bind(n,r));return m})();let u=[""];c.length&&(u=u.concat(c)),o.length&&(u=u.concat(o)),u=u.join(" ");let h=e;const p=()=>this.children!=null&&this.children.length?this.children.map(m=>m.toMarkup(t,h)).filter(m=>m!=null&&m.length).join(`
`):"";if(t&&!t(this))return p();if(this.children!=null){const m=`<${s}${u}>`,v=`</${s}>`;h=e+"  ";let _=p();return _.length&&(_=`
`+_+`
`+e),_==null&&(_=""),e+m+_+v}else return`${e}<${s}${u} />`}print(t,e){return iT(this.toMarkup(t),e)}};ml.apply(Zg.prototype);let dN=class extends Zg{constructor(t,e,n,r,s,o){super(t,e,n,r,s,o),this.children=[],this.on("reindex",a=>Array.from(this.children).map(l=>l.trigger(a)))}add(t){return t.parent!=null&&t.parent.remove(t),t._index(this.children.length,this),this.children.push(t),t._added(this)}remove(t){t.children!=null&&t.children.length&&t.empty();const e=this.children.indexOf(t);if(e!==-1){this.children.splice(e,1),t._index(null),t._removed(this);for(let n=0;n<this.children.length;n++)t=this.children[n],n>=e&&t._index(n)}}empty(){const t=this.children.slice().reverse();for(const e of Array.from(t))this.remove(e)}};class pN{constructor(t){t==null&&(t=10),this.limit=t}iterate(t){const{step:e,last:n}=t;let{limit:r}=this;for(;e();)if(!--r)throw console.warn("Last iteration",typeof n=="function"?n():void 0),new Error("Exceeded iteration limit.");return null}}var Qb={},fN={},la={},qd={},Av={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Doctype=i.CDATA=i.Tag=i.Style=i.Script=i.Comment=i.Directive=i.Text=i.Root=i.isTag=i.ElementType=void 0;var t;(function(n){n.Root="root",n.Text="text",n.Directive="directive",n.Comment="comment",n.Script="script",n.Style="style",n.Tag="tag",n.CDATA="cdata",n.Doctype="doctype"})(t=i.ElementType||(i.ElementType={}));function e(n){return n.type===t.Tag||n.type===t.Script||n.type===t.Style}i.isTag=e,i.Root=t.Root,i.Text=t.Text,i.Directive=t.Directive,i.Comment=t.Comment,i.Script=t.Script,i.Style=t.Style,i.Tag=t.Tag,i.CDATA=t.CDATA,i.Doctype=t.Doctype})(Av);var Un={},Wd=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ag=zt&&zt.__assign||function(){return Ag=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Ag.apply(this,arguments)};Object.defineProperty(Un,"__esModule",{value:!0});Un.cloneNode=Un.hasChildren=Un.isDocument=Un.isDirective=Un.isComment=Un.isText=Un.isCDATA=Un.isTag=Un.Element=Un.Document=Un.NodeWithChildren=Un.ProcessingInstruction=Un.Comment=Un.Text=Un.DataNode=Un.Node=void 0;var cr=Av,m7=new Map([[cr.ElementType.Tag,1],[cr.ElementType.Script,1],[cr.ElementType.Style,1],[cr.ElementType.Directive,1],[cr.ElementType.Text,3],[cr.ElementType.CDATA,4],[cr.ElementType.Comment,8],[cr.ElementType.Root,9]]),rT=function(){function i(t){this.type=t,this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(i.prototype,"nodeType",{get:function(){var t;return(t=m7.get(this.type))!==null&&t!==void 0?t:1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"parentNode",{get:function(){return this.parent},set:function(t){this.parent=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"previousSibling",{get:function(){return this.prev},set:function(t){this.prev=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"nextSibling",{get:function(){return this.next},set:function(t){this.next=t},enumerable:!1,configurable:!0}),i.prototype.cloneNode=function(t){return t===void 0&&(t=!1),sT(this,t)},i}();Un.Node=rT;var cx=function(i){Wd(t,i);function t(e,n){var r=i.call(this,e)||this;return r.data=n,r}return Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.data},set:function(e){this.data=e},enumerable:!1,configurable:!0}),t}(rT);Un.DataNode=cx;var mN=function(i){Wd(t,i);function t(e){return i.call(this,cr.ElementType.Text,e)||this}return t}(cx);Un.Text=mN;var gN=function(i){Wd(t,i);function t(e){return i.call(this,cr.ElementType.Comment,e)||this}return t}(cx);Un.Comment=gN;var vN=function(i){Wd(t,i);function t(e,n){var r=i.call(this,cr.ElementType.Directive,n)||this;return r.name=e,r}return t}(cx);Un.ProcessingInstruction=vN;var ux=function(i){Wd(t,i);function t(e,n){var r=i.call(this,e)||this;return r.children=n,r}return Object.defineProperty(t.prototype,"firstChild",{get:function(){var e;return(e=this.children[0])!==null&&e!==void 0?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.children},set:function(e){this.children=e},enumerable:!1,configurable:!0}),t}(rT);Un.NodeWithChildren=ux;var _N=function(i){Wd(t,i);function t(e){return i.call(this,cr.ElementType.Root,e)||this}return t}(ux);Un.Document=_N;var bN=function(i){Wd(t,i);function t(e,n,r,s){r===void 0&&(r=[]),s===void 0&&(s=e==="script"?cr.ElementType.Script:e==="style"?cr.ElementType.Style:cr.ElementType.Tag);var o=i.call(this,s,r)||this;return o.name=e,o.attribs=n,o}return Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){var e=this;return Object.keys(this.attribs).map(function(n){var r,s;return{name:n,value:e.attribs[n],namespace:(r=e["x-attribsNamespace"])===null||r===void 0?void 0:r[n],prefix:(s=e["x-attribsPrefix"])===null||s===void 0?void 0:s[n]}})},enumerable:!1,configurable:!0}),t}(ux);Un.Element=bN;function yN(i){return(0,cr.isTag)(i)}Un.isTag=yN;function xN(i){return i.type===cr.ElementType.CDATA}Un.isCDATA=xN;function wN(i){return i.type===cr.ElementType.Text}Un.isText=wN;function SN(i){return i.type===cr.ElementType.Comment}Un.isComment=SN;function MN(i){return i.type===cr.ElementType.Directive}Un.isDirective=MN;function CN(i){return i.type===cr.ElementType.Root}Un.isDocument=CN;function g7(i){return Object.prototype.hasOwnProperty.call(i,"children")}Un.hasChildren=g7;function sT(i,t){t===void 0&&(t=!1);var e;if(wN(i))e=new mN(i.data);else if(SN(i))e=new gN(i.data);else if(yN(i)){var n=t?yS(i.children):[],r=new bN(i.name,Ag({},i.attribs),n);n.forEach(function(l){return l.parent=r}),i.namespace!=null&&(r.namespace=i.namespace),i["x-attribsNamespace"]&&(r["x-attribsNamespace"]=Ag({},i["x-attribsNamespace"])),i["x-attribsPrefix"]&&(r["x-attribsPrefix"]=Ag({},i["x-attribsPrefix"])),e=r}else if(xN(i)){var n=t?yS(i.children):[],s=new ux(cr.ElementType.CDATA,n);n.forEach(function(c){return c.parent=s}),e=s}else if(CN(i)){var n=t?yS(i.children):[],o=new _N(n);n.forEach(function(c){return c.parent=o}),i["x-mode"]&&(o["x-mode"]=i["x-mode"]),e=o}else if(MN(i)){var a=new vN(i.name,i.data);i["x-name"]!=null&&(a["x-name"]=i["x-name"],a["x-publicId"]=i["x-publicId"],a["x-systemId"]=i["x-systemId"]),e=a}else throw new Error("Not implemented yet: ".concat(i.type));return e.startIndex=i.startIndex,e.endIndex=i.endIndex,i.sourceCodeLocation!=null&&(e.sourceCodeLocation=i.sourceCodeLocation),e}Un.cloneNode=sT;function yS(i){for(var t=i.map(function(n){return sT(n,!0)}),e=1;e<t.length;e++)t[e].prev=t[e-1],t[e-1].next=t[e];return t}(function(i){var t=zt&&zt.__createBinding||(Object.create?function(l,c,u,h){h===void 0&&(h=u);var p=Object.getOwnPropertyDescriptor(c,u);(!p||("get"in p?!c.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(l,h,p)}:function(l,c,u,h){h===void 0&&(h=u),l[h]=c[u]}),e=zt&&zt.__exportStar||function(l,c){for(var u in l)u!=="default"&&!Object.prototype.hasOwnProperty.call(c,u)&&t(c,l,u)};Object.defineProperty(i,"__esModule",{value:!0}),i.DomHandler=void 0;var n=Av,r=Un;e(Un,i);var s=/\s+/g,o={normalizeWhitespace:!1,withStartIndices:!1,withEndIndices:!1,xmlMode:!1},a=function(){function l(c,u,h){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof u=="function"&&(h=u,u=o),typeof c=="object"&&(u=c,c=void 0),this.callback=c??null,this.options=u??o,this.elementCB=h??null}return l.prototype.onparserinit=function(c){this.parser=c},l.prototype.onreset=function(){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},l.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},l.prototype.onerror=function(c){this.handleCallback(c)},l.prototype.onclosetag=function(){this.lastNode=null;var c=this.tagStack.pop();this.options.withEndIndices&&(c.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(c)},l.prototype.onopentag=function(c,u){var h=this.options.xmlMode?n.ElementType.Tag:void 0,p=new r.Element(c,u,void 0,h);this.addNode(p),this.tagStack.push(p)},l.prototype.ontext=function(c){var u=this.options.normalizeWhitespace,h=this.lastNode;if(h&&h.type===n.ElementType.Text)u?h.data=(h.data+c).replace(s," "):h.data+=c,this.options.withEndIndices&&(h.endIndex=this.parser.endIndex);else{u&&(c=c.replace(s," "));var p=new r.Text(c);this.addNode(p),this.lastNode=p}},l.prototype.oncomment=function(c){if(this.lastNode&&this.lastNode.type===n.ElementType.Comment){this.lastNode.data+=c;return}var u=new r.Comment(c);this.addNode(u),this.lastNode=u},l.prototype.oncommentend=function(){this.lastNode=null},l.prototype.oncdatastart=function(){var c=new r.Text(""),u=new r.NodeWithChildren(n.ElementType.CDATA,[c]);this.addNode(u),c.parent=u,this.lastNode=c},l.prototype.oncdataend=function(){this.lastNode=null},l.prototype.onprocessinginstruction=function(c,u){var h=new r.ProcessingInstruction(c,u);this.addNode(h)},l.prototype.handleCallback=function(c){if(typeof this.callback=="function")this.callback(c,this.dom);else if(c)throw c},l.prototype.addNode=function(c){var u=this.tagStack[this.tagStack.length-1],h=u.children[u.children.length-1];this.options.withStartIndices&&(c.startIndex=this.parser.startIndex),this.options.withEndIndices&&(c.endIndex=this.parser.endIndex),u.children.push(c),h&&(c.prev=h,h.next=c),c.parent=u,this.lastNode=null},l}();i.DomHandler=a,i.default=a})(qd);var oT={},EN={},Yc={};const v7="",_7="",b7="",y7="",x7="",w7="",S7="",M7="",C7="",E7="",T7="",A7="",P7="",R7="",k7="",L7="",O7="",D7="",I7="",N7="",z7="",U7="",F7="",V7="",B7="",H7="",$7="&",G7="&",q7="",W7="",j7="",X7="",Y7="",K7="",Z7="",J7="",Q7="",tK="",eK="",nK="",iK="",rK="",sK="",oK="",aK="",lK="",cK="",uK="",hK="",dK="",pK="",fK="",mK="",gK="",vK="",_K="",bK="",yK="",xK="",wK="",SK="",MK="'",CK="",EK="",TK="",AK="",PK="",RK="",kK="",LK="",OK="*",DK="",IK="",NK="",zK="",UK="",FK="",VK="",BK="",HK="",$K="",GK="",qK="",WK="",jK="",XK="",YK="",KK="",ZK="",JK="",QK="",tZ="",eZ="",nZ="",iZ="",rZ="",sZ="",oZ="",aZ="",lZ="",cZ="",uZ="",hZ="",dZ="",pZ="",fZ="",mZ="",gZ="",vZ="",_Z="",bZ="",yZ="",xZ="",wZ="",SZ="",MZ="",CZ="",EZ="",TZ="",AZ="",PZ="",RZ="",kZ="",LZ="",OZ="",DZ="",IZ="",NZ="",zZ="",UZ="",FZ="",VZ="",BZ="",HZ="",$Z="=",GZ="",qZ="",WZ="",jZ="",XZ="",YZ="",KZ="",ZZ="",JZ="",QZ="",tJ="",eJ="",nJ="",iJ="",rJ="",sJ="",oJ="",aJ="",lJ="",cJ="",uJ="",hJ="",dJ="",pJ="",fJ="",mJ="",gJ="",vJ="",_J="",bJ="",yJ="",xJ="",wJ="",SJ="",MJ="",CJ="",EJ="",TJ="",AJ="",PJ="",RJ="",kJ="",LJ="",OJ="",DJ="",IJ="",NJ="",zJ="",UJ="",FJ="",VJ="",BJ="",HJ="",$J="",GJ="",qJ="",WJ="",jJ="",XJ="",YJ="",KJ="",ZJ="",JJ="\\",QJ="",tQ="",eQ="",nQ="",iQ="",rQ="",sQ="",oQ="",aQ="",lQ="",cQ="",uQ="",hQ="",dQ="",pQ="",fQ="",mQ="",gQ="",vQ="",_Q="",bQ="",yQ="",xQ="",wQ="",SQ="",MQ="",CQ="",EQ="",TQ="",AQ="",PQ="",RQ="",kQ="",LQ="",OQ="",DQ="",IQ="",NQ="",zQ="",UQ="",FQ="",VQ="",BQ="",HQ="",$Q="",GQ="",qQ="",WQ="",jQ="",XQ="",YQ="",KQ="",ZQ="",JQ="",QQ="",ttt="",ett="",ntt="",itt="",rtt="",stt="",ott="",att="",ltt="",ctt="",utt="",htt="",dtt="",ptt="",ftt="",mtt="",gtt="",vtt=":",_tt="",btt="",ytt="",xtt="",wtt=",",Stt="@",Mtt="",Ctt="",Ett="",Ttt="",Att="",Ptt="",Rtt="",ktt="",Ltt="",Ott="",Dtt="",Itt="",Ntt="",ztt="",Utt="",Ftt="",Vtt="",Btt="",Htt="",$tt="",Gtt="",qtt="",Wtt="",jtt="",Xtt="",Ytt="",Ktt="",Ztt="",Jtt="",Qtt="",tet="",eet="",net="",iet="",ret="",set="",oet="",aet="",cet="",uet="",het="",det="",pet="",fet="",met="",get="",vet="",_et="",bet="",yet="",xet="",wet="",Met="",Cet="",Eet="",Tet="",Aet="",Pet="",Ret="",ket="",Let="",Oet="",Det="",Iet="",Net="",zet="",Uet="",Fet="",Vet="",Bet="",Het="",$et="",Get="",qet="",Wet="",jet="",Xet="",Yet="",Ket="",Zet="",Jet="",Qet="",tnt="",ent="",nnt="",int="",rnt="",snt="",ont="",ant="",lnt="",cnt="",unt="`",hnt="",dnt="",pnt="",fnt="",mnt="",gnt="",vnt="",_nt="",bnt="",ynt="",xnt="",wnt="",Snt="",Mnt="",Cnt="",Ent="",Tnt="",Ant="",Pnt="$",Rnt="",knt="",Lnt="",Ont="",Dnt="",Int="",Nnt="",znt="",Unt="",Fnt="",Vnt="",Bnt="",Hnt="",$nt="",Gnt="",qnt="",Wnt="",jnt="",Xnt="",Ynt="",Knt="",Znt="",Jnt="",Qnt="",tit="",eit="",nit="",iit="",rit="",sit="",oit="",ait="",lit="",cit="",uit="",hit="",dit="",pit="",fit="",mit="",git="",vit="",_it="",bit="",yit="",xit="",wit="",Sit="",Mit="",Cit="",Eit="",Tit="",Ait="",Pit="",Rit="",kit="",Lit="",Oit="",Dit="",Iit="",Nit="",zit="",Uit="",Fit="",Vit="",Bit="",Hit="",$it="",Git="",qit="",Wit="",jit="",Xit="",Yit="",Kit="",Zit="",Jit="",Qit="",trt="",ert="",nrt="",irt="",rrt="",srt="",ort="",art="",lrt="",crt="",urt="",hrt="",drt="",prt="",frt="",mrt="",grt="",vrt="",_rt="",brt="",yrt="",xrt="",wrt="",Srt="",Mrt="",Crt="",Ert="",Trt="",Art="",Prt="",Rrt="",krt="",Lrt="",Ort="",Drt="",Irt="",Nrt="",zrt="",Urt="",Frt="",Vrt="",Brt="",Hrt="",$rt="",Grt="",qrt="=",Wrt="",jrt="",Xrt="",Yrt="",Krt="",Zrt="",Jrt="",Qrt="",tst="",est="",nst="",ist="",rst="",sst="",ost="",ast="",lst="",cst="",ust="",hst="",dst="!",pst="",fst="",mst="",gst="",vst="",_st="",bst="",yst="",xst="",wst="",Sst="",Mst="",Cst="",Est="",Tst="",Ast="",Pst="",Rst="fj",kst="",Lst="",Ost="",Dst="",Ist="",Nst="",zst="",Ust="",Fst="",Vst="",Bst="",Hst="",$st="",Gst="",qst="",Wst="",jst="",Xst="",Yst="",Kst="",Zst="",Jst="",Qst="",tot="",eot="",not="",iot="",rot="",sot="",oot="",aot="",lot="",cot="",uot="",hot="",dot="",pot="",fot="",mot="",got="",vot="",_ot="",bot="",yot="",xot="",wot="",Sot="",Mot="",Cot="",Eot="",Tot="",Aot="",Pot="",Rot="",kot="",Lot="",Oot="",Dot="",Iot="",Not="",zot="",Uot="",Fot="",Vot="",Bot="",Hot="",$ot="",Got="",qot="",Wot="",jot="",Xot="",Yot="",Kot="",Zot="",Jot="",Qot="",tat="",eat="",nat="",iat="",rat="`",sat="",oat="",aat="",lat="",cat="",uat="",hat="",dat="",pat="",fat="",mat="",gat="",vat="",_at="",bat=">",yat=">",xat="",wat="",Sat="",Mat="",Cat="",Eat="",Tat="",Aat="",Pat="",Rat="",kat="",Lat="",Oat="",Dat="",Iat="",Nat="",zat="",Uat="",Fat="",Vat="",Bat="",Hat="",$at="",Gat="^",qat="",Wat="",jat="",Xat="",Yat="",Kat="",Zat="",Jat="",Qat="",tlt="",elt="",nlt="",ilt="",rlt="",slt="",olt="",alt="",llt="",clt="",ult="",hlt="",dlt="",plt="",flt="",mlt="",glt="",vlt="",_lt="",blt="",ylt="",xlt="",wlt="",Slt="",Mlt="",Clt="",Elt="",Tlt="",Alt="",Plt="",Rlt="",klt="",Llt="",Olt="",Dlt="",Ilt="",Nlt="",zlt="",Ult="",Flt="",Vlt="",Blt="",Hlt="",$lt="",Glt="",qlt="",Wlt="",jlt="",Xlt="",Ylt="",Klt="",Zlt="",Jlt="",Qlt="",tct="",ect="",nct="",ict="",rct="",sct="",oct="",act="",lct="",cct="",uct="",hct="",dct="",pct="",fct="",mct="",gct="",vct="",_ct="",bct="",yct="",xct="",wct="",Sct="",Mct="",Cct="",Ect="",Tct="",Act="",Pct="",Rct="",kct="",Lct="",Oct="",Dct="",Ict="",Nct="",zct="",Uct="",Fct="",Vct="",Bct="",Hct="",$ct="",Gct="",qct="",Wct="",jct="",Xct="",Yct="",Kct="",Zct="",Jct="",Qct="",tut="",eut="",nut="",iut="",rut="",sut="",out="",aut="",lut="",cut="",uut="",hut="",dut="",put="",fut="",mut="",gut="",vut="",_ut="",but="",yut="",xut="",wut="",Sut="",Mut="",Cut="",Eut="",Tut="",Aut="",Put="",Rut="",kut="",Lut="",Out="",Dut="",Iut="",Nut="",zut="",Uut="",Fut="",Vut="",But="",Hut="",$ut="",Gut="",qut="",Wut="",jut="",Xut="",Yut="",Kut="",Zut="",Jut="{",Qut="[",tht="",eht="",nht="",iht="",rht="",sht="",oht="",aht="",lht="{",cht="",uht="",hht="",dht="",pht="",fht="",mht="",ght="",vht="",_ht="",bht="",yht="",xht="",wht="",Sht="",Mht="",Cht="",Eht="",Tht="",Aht="",Pht="",Rht="",kht="",Lht="",Oht="",Dht="",Iht="",Nht="",zht="",Uht="",Fht="",Vht="",Bht="",Hht="",$ht="",Ght="",qht="",Wht="",jht="",Xht="",Yht="",Kht="",Zht="",Jht="",Qht="",tdt="",edt="",ndt="",idt="",rdt="",sdt="",odt="",adt="",ldt="",cdt="",udt="",hdt="",ddt="",pdt="",fdt="",mdt="",gdt="",vdt="",_dt="",bdt="",ydt="",xdt="",wdt="",Sdt="",Mdt="",Cdt="",Edt="",Tdt="",Adt="",Pdt="",Rdt="",kdt="",Ldt="",Odt="",Ddt="",Idt="",Ndt="",zdt="",Udt="",Fdt="",Vdt="",Bdt="",Hdt="",$dt="",Gdt="",qdt="",Wdt="",jdt="",Xdt="",Ydt="",Kdt="",Zdt="",Jdt="",Qdt="",tpt="",ept="",npt="",ipt="",rpt="",spt="",opt="",apt="",lpt="",cpt="",upt="",hpt="",dpt="",ppt="",fpt="",mpt="",gpt="",vpt="",_pt="",bpt="",ypt="",xpt="",wpt="",Spt="_",Mpt="",Cpt="",Ept="",Tpt="",Apt="",Ppt="(",Rpt="",kpt="",Lpt="",Opt="",Dpt="",Ipt="",Npt="",zpt="",Upt="",Fpt="",Vpt="",Bpt="",Hpt="",$pt="",Gpt="",qpt="[",Wpt="",jpt="",Xpt="",Ypt="",Kpt="",Zpt="",Jpt="<",Qpt="<",tft="",eft="",nft="",ift="",rft="",sft="",oft="",aft="",lft="",cft="",uft="",hft="",dft="",pft="",fft="",mft="",gft="",vft="",_ft="",bft="",yft="",xft="",wft="",Sft="",Mft="",Cft="",Eft="",Tft="",Aft="",Pft="",Rft="",kft="",Lft="",Oft="",Dft="",Ift="",Nft="*",zft="",Uft="",Fft="",Vft="",Bft="",Hft="",$ft="",Gft="",qft="",Wft="",jft="",Xft="",Yft="",Kft="",Zft="",Jft="",Qft="",tmt="",emt="",nmt="",imt="",rmt="",smt="",omt="",amt="",lmt="",cmt="",umt="",hmt="",dmt="",pmt="",fmt="",mmt="",gmt="",vmt="",_mt="",bmt="",ymt="",xmt="",wmt="",Smt="",Mmt="",Cmt="",Emt="",Tmt="",Amt="",Pmt="",Rmt="",kmt="",Lmt="",Omt="",Dmt="",Imt="",Nmt="",zmt="",Umt="",Fmt="",Vmt="",Bmt="",Hmt="",$mt="",Gmt="",qmt="",Wmt=`
`,jmt="",Xmt="",Ymt="",Kmt="",Zmt="",Jmt="",Qmt="",tgt="",egt="",ngt="",igt="",rgt="",sgt="",ogt="",agt="",lgt="",cgt="",ugt="",hgt="",dgt="",pgt="",fgt="",mgt="",ggt="",vgt="",_gt="",bgt="",ygt="",xgt="",wgt="",Sgt="",Mgt="",Cgt="",Egt="",Tgt="",Agt="",Pgt="",Rgt="",kgt="",Lgt="",Ogt="",Dgt="",Igt="",Ngt="",zgt="",Ugt="",Fgt="",Vgt="",Bgt="",Hgt="",$gt="",Ggt="",qgt="",Wgt="",jgt="",Xgt="",Ygt="",Kgt="",Zgt="",Jgt="",Qgt="",tvt="",evt="",nvt="",ivt="",rvt="",svt="",ovt="",avt="",lvt="",cvt="",uvt="",hvt="",dvt="",pvt="",fvt="",mvt="",gvt="",vvt="",_vt="",bvt="",yvt="",xvt="",wvt="",Svt="",Mvt="",Cvt="",Evt="",Tvt="",Avt="",Pvt="",Rvt="",kvt="",Lvt="",Ovt="",Dvt="",Ivt="",Nvt="",zvt="",Uvt="",Fvt="",Vvt="",Bvt="",Hvt="",$vt="",Gvt="",qvt="",Wvt="",jvt="",Xvt="",Yvt="",Kvt="",Zvt="",Jvt="",Qvt="",t_t="",e_t="",n_t="",i_t="",r_t="",s_t="",o_t="",a_t="",l_t="",c_t="",u_t="",h_t="",d_t="",p_t="",f_t="",m_t="",g_t="",v_t="",__t="",b_t="",y_t="",x_t="",w_t="",S_t="",M_t="",C_t="",E_t="",T_t="",A_t="",P_t="",R_t="",k_t="",L_t="",O_t="",D_t="",I_t="",N_t="",z_t="",U_t="",F_t="",V_t="",B_t="",H_t="",$_t="",G_t="",q_t="",W_t="",j_t="",X_t="",Y_t="",K_t="",Z_t="",J_t="",Q_t="",t0t="",e0t="#",n0t="",i0t="",r0t="",s0t="",o0t="",a0t="",l0t="",c0t="",u0t=">",h0t="",d0t="",p0t="",f0t="",m0t="<",g0t="",v0t="",_0t="",b0t="",y0t="",x0t="",w0t="",S0t="",M0t="",C0t="",E0t="",T0t="",A0t="",P0t="",R0t="",k0t="",L0t="",O0t="",D0t="",I0t="",N0t="",z0t="",U0t="",F0t="",V0t="",B0t="",H0t="",$0t="",G0t="",q0t="",W0t="",j0t="",X0t="",Y0t="",K0t="",Z0t="",J0t="",Q0t="",tbt="",ebt="",nbt="",ibt="",rbt="",sbt="",obt="",abt="",lbt="",cbt="",ubt="",hbt="",dbt="",pbt="",fbt="",mbt="",gbt="",vbt="",_bt="",bbt="",ybt="",xbt="",wbt="",Sbt="",Mbt="",Cbt="",Ebt="",Tbt="",Abt="",Pbt="",Rbt="",kbt="",Lbt="",Obt="",Dbt="",Ibt="",Nbt="",zbt="",Ubt="",Fbt="",Vbt="",Bbt="",Hbt="",$bt="",Gbt="",qbt="",Wbt="",jbt="",Xbt="",Ybt="",Kbt="",Zbt="",Jbt="",Qbt="",tyt="",eyt="",nyt="%",iyt=".",ryt="",syt="",oyt="",ayt="",lyt="",cyt="",uyt="",hyt="",dyt="",pyt="",fyt="",myt="",gyt="",vyt="",_yt="",byt="",yyt="",xyt="",wyt="",Syt="",Myt="+",Cyt="",Eyt="",Tyt="",Ayt="",Pyt="",Ryt="",kyt="",Lyt="",Oyt="",Dyt="",Iyt="",Nyt="",zyt="",Uyt="",Fyt="",Vyt="",Byt="",Hyt="",$yt="",Gyt="",qyt="",Wyt="",jyt="",Xyt="",Yyt="",Kyt="",Zyt="",Jyt="",Qyt="",txt="",ext="",nxt="",ixt="",rxt="",sxt="",oxt="",axt="",lxt="",cxt="",uxt="",hxt="",dxt="",pxt="",fxt="",mxt="",gxt="",vxt="",_xt="",bxt="",yxt="",xxt="",wxt="",Sxt="",Mxt="",Cxt="",Ext="",Txt="",Axt="",Pxt="",Rxt="",kxt="",Lxt="",Oxt="",Dxt="?",Ixt="",Nxt='"',zxt='"',Uxt="",Fxt="",Vxt="",Bxt="",Hxt="",$xt="",Gxt="",qxt="",Wxt="",jxt="",Xxt="",Yxt="",Kxt="",Zxt="",Jxt="",Qxt="",twt="",ewt="",nwt="",iwt="",rwt="",swt="",owt="",awt="",lwt="",cwt="",uwt="",hwt="",dwt="",pwt="",fwt="",mwt="",gwt="",vwt="",_wt="",bwt="}",ywt="]",xwt="",wwt="",Swt="",Mwt="",Cwt="",Ewt="",Twt="",Awt="",Pwt="}",Rwt="",kwt="",Lwt="",Owt="",Dwt="",Iwt="",Nwt="",zwt="",Uwt="",Fwt="",Vwt="",Bwt="",Hwt="",$wt="",Gwt="",qwt="",Wwt="",jwt="",Xwt="",Ywt="",Kwt="",Zwt="",Jwt="",Qwt="",t1t="",e1t="",n1t="",i1t="",r1t="",s1t="",o1t="",a1t="",l1t="",c1t="",u1t="",h1t="",d1t="",p1t="",f1t="",m1t="",g1t="",v1t="",_1t="",b1t="",y1t="",x1t="",w1t="",S1t="",M1t="",C1t="",E1t="",T1t="",A1t="",P1t="",R1t="",k1t="",L1t="",O1t="",D1t="",I1t="",N1t="",z1t="",U1t="",F1t="",V1t="",B1t="",H1t="",$1t="",G1t="",q1t="",W1t="",j1t="",X1t="",Y1t="",K1t="",Z1t="",J1t="",Q1t="",tSt=")",eSt="",nSt="",iSt="",rSt="",sSt="",oSt="",aSt="",lSt="",cSt="",uSt="]",hSt="",dSt="",pSt="",fSt="",mSt="",gSt="",vSt="",_St="",bSt="",ySt="",xSt="",wSt="",SSt="",MSt="",CSt="",ESt="",TSt="",ASt="",PSt="",RSt="",kSt="",LSt="",OSt="",DSt="",ISt="",NSt="",zSt="",USt="",FSt="",VSt="",BSt="",HSt="",$St="",GSt="",qSt="",WSt="",jSt="",XSt="",YSt="",KSt="",ZSt="",JSt=";",QSt="",tMt="",eMt="",nMt="",iMt="",rMt="",sMt="",oMt="",aMt="",lMt="",cMt="",uMt="",hMt="",dMt="",pMt="",fMt="",mMt="",gMt="",vMt="",_Mt="",bMt="",yMt="",xMt="",wMt="",SMt="",MMt="",CMt="",EMt="",TMt="",AMt="",PMt="",RMt="",kMt="",LMt="",OMt="",DMt="",IMt="",NMt="",zMt="",UMt="",FMt="",VMt="",BMt="",HMt="",$Mt="",GMt="",qMt="",WMt="",jMt="/",XMt="",YMt="",KMt="",ZMt="",JMt="",QMt="",tCt="",eCt="",nCt="",iCt="",rCt="",sCt="",oCt="",aCt="",lCt="",cCt="",uCt="",hCt="",dCt="",pCt="",fCt="",mCt="",gCt="",vCt="",_Ct="",bCt="",yCt="",xCt="",wCt="",SCt="",MCt="",CCt="",ECt="",TCt="",ACt="",PCt="",RCt="",kCt="",LCt="",OCt="",DCt="",ICt="",NCt="",zCt="",UCt="",FCt="",VCt="",BCt="",HCt="",$Ct="",GCt="",qCt="",WCt="",jCt="",XCt="",YCt="",KCt="",ZCt="",JCt="",QCt="",tEt="",eEt="",nEt="",iEt="",rEt="",sEt="",oEt="",aEt="",lEt="",cEt="",uEt="",hEt="",dEt="",pEt="",fEt="",mEt="",gEt="",vEt="",_Et="",bEt="",yEt="",xEt="",wEt="",SEt="",MEt="",CEt="",EEt="",TEt="",AEt="",PEt="",REt="",kEt="",LEt="",OEt="",DEt="",IEt="",NEt="",zEt="",UEt="",FEt="",VEt="",BEt="",HEt="",$Et="",GEt="",qEt="",WEt="",jEt="",XEt="",YEt="",KEt="",ZEt="",JEt="	",QEt="",tTt="",eTt="",nTt="",iTt="",rTt="",sTt="",oTt="",aTt="",lTt="",cTt="",uTt="",hTt="",dTt="",pTt="",fTt="",mTt="",gTt="",vTt="",_Tt="",bTt="",yTt="",xTt="",wTt="",STt="",MTt="",CTt="",ETt="",TTt="",ATt="",PTt="",RTt="",kTt="",LTt="",OTt="",DTt="",ITt="",NTt="",zTt="",UTt="",FTt="",VTt="",BTt="",HTt="",$Tt="",GTt="",qTt="",WTt="",jTt="",XTt="",YTt="",KTt="",ZTt="",JTt="",QTt="",tAt="",eAt="",nAt="",iAt="",rAt="",sAt="",oAt="",aAt="",lAt="",cAt="",uAt="",hAt="",dAt="",pAt="",fAt="",mAt="",gAt="",vAt="",_At="",bAt="",yAt="",xAt="",wAt="",SAt="",MAt="",CAt="",EAt="",TAt="",AAt="",PAt="",RAt="",kAt="",LAt="",OAt="",DAt="",IAt="",NAt="",zAt="",UAt="",FAt="",VAt="",BAt="",HAt="",$At="",GAt="",qAt="",WAt="",jAt="",XAt="",YAt="",KAt="",ZAt="",JAt="",QAt="",tPt="",ePt="",nPt="_",iPt="",rPt="",sPt="",oPt="",aPt="",lPt="",cPt="",uPt="",hPt="",dPt="",pPt="",fPt="",mPt="",gPt="",vPt="",_Pt="",bPt="",yPt="",xPt="",wPt="",SPt="",MPt="",CPt="",EPt="",TPt="",APt="",PPt="",RPt="",kPt="",LPt="",OPt="",DPt="",IPt="",NPt="",zPt="",UPt="",FPt="",VPt="",BPt="",HPt="",$Pt="",GPt="",qPt="",WPt="",jPt="",XPt="",YPt="",KPt="",ZPt="",JPt="",QPt="",t2t="",e2t="",n2t="",i2t="",r2t="",s2t="",o2t="",a2t="",l2t="",c2t="",u2t="",h2t="",d2t="",p2t="",f2t="",m2t="",g2t="",v2t="",_2t="",b2t="",y2t="",x2t="",w2t="",S2t="",M2t="",C2t="",E2t="",T2t="",A2t="",P2t="",R2t="|",k2t="",L2t="|",O2t="",D2t="",I2t="|",N2t="",z2t="",U2t="",F2t="",V2t="",B2t="",H2t="",$2t="",G2t="",q2t="",W2t="",j2t="",X2t="",Y2t="",K2t="",Z2t="",J2t="",Q2t="",tRt="",eRt="",nRt="",iRt="",rRt="",sRt="",oRt="",aRt="",lRt="",cRt="",uRt="",hRt="",dRt="",pRt="",fRt="",mRt="",gRt="",vRt="",_Rt="",bRt="",yRt="",xRt="",wRt="",SRt="",MRt="",CRt="",ERt="",TRt="",ARt="",PRt="",RRt="",kRt="",LRt="",ORt="",DRt="",IRt="",NRt="",zRt="",URt="",FRt="",VRt="",BRt="",HRt="",$Rt="",GRt="",qRt="",WRt="",jRt="",XRt="",YRt="",KRt="",ZRt="",JRt="",QRt="",tkt="",ekt="",nkt="",ikt="",rkt="",skt="",okt="",akt="",lkt="",ckt="",ukt="",hkt="",dkt="",pkt="",fkt="",mkt="",gkt="",vkt="",_kt="",bkt="",ykt="",xkt="",wkt="",Skt="",Mkt="",Ckt="",Ekt="",Tkt="",Akt="",Pkt="",Rkt="",kkt="",Lkt="",Okt="",Dkt="",Ikt="",TN={Aacute:v7,aacute:_7,Abreve:b7,abreve:y7,ac:x7,acd:w7,acE:S7,Acirc:M7,acirc:C7,acute:E7,Acy:T7,acy:A7,AElig:P7,aelig:R7,af:k7,Afr:L7,afr:O7,Agrave:D7,agrave:I7,alefsym:N7,aleph:z7,Alpha:U7,alpha:F7,Amacr:V7,amacr:B7,amalg:H7,amp:$7,AMP:G7,andand:q7,And:W7,and:j7,andd:X7,andslope:Y7,andv:K7,ang:Z7,ange:J7,angle:Q7,angmsdaa:tK,angmsdab:eK,angmsdac:nK,angmsdad:iK,angmsdae:rK,angmsdaf:sK,angmsdag:oK,angmsdah:aK,angmsd:lK,angrt:cK,angrtvb:uK,angrtvbd:hK,angsph:dK,angst:pK,angzarr:fK,Aogon:mK,aogon:gK,Aopf:vK,aopf:_K,apacir:bK,ap:yK,apE:xK,ape:wK,apid:SK,apos:MK,ApplyFunction:CK,approx:EK,approxeq:TK,Aring:AK,aring:PK,Ascr:RK,ascr:kK,Assign:LK,ast:OK,asymp:DK,asympeq:IK,Atilde:NK,atilde:zK,Auml:UK,auml:FK,awconint:VK,awint:BK,backcong:HK,backepsilon:$K,backprime:GK,backsim:qK,backsimeq:WK,Backslash:jK,Barv:XK,barvee:YK,barwed:KK,Barwed:ZK,barwedge:JK,bbrk:QK,bbrktbrk:tZ,bcong:eZ,Bcy:nZ,bcy:iZ,bdquo:rZ,becaus:sZ,because:oZ,Because:aZ,bemptyv:lZ,bepsi:cZ,bernou:uZ,Bernoullis:hZ,Beta:dZ,beta:pZ,beth:fZ,between:mZ,Bfr:gZ,bfr:vZ,bigcap:_Z,bigcirc:bZ,bigcup:yZ,bigodot:xZ,bigoplus:wZ,bigotimes:SZ,bigsqcup:MZ,bigstar:CZ,bigtriangledown:EZ,bigtriangleup:TZ,biguplus:AZ,bigvee:PZ,bigwedge:RZ,bkarow:kZ,blacklozenge:LZ,blacksquare:OZ,blacktriangle:DZ,blacktriangledown:IZ,blacktriangleleft:NZ,blacktriangleright:zZ,blank:UZ,blk12:FZ,blk14:VZ,blk34:BZ,block:HZ,bne:$Z,bnequiv:GZ,bNot:qZ,bnot:WZ,Bopf:jZ,bopf:XZ,bot:YZ,bottom:KZ,bowtie:ZZ,boxbox:JZ,boxdl:QZ,boxdL:tJ,boxDl:eJ,boxDL:nJ,boxdr:iJ,boxdR:rJ,boxDr:sJ,boxDR:oJ,boxh:aJ,boxH:lJ,boxhd:cJ,boxHd:uJ,boxhD:hJ,boxHD:dJ,boxhu:pJ,boxHu:fJ,boxhU:mJ,boxHU:gJ,boxminus:vJ,boxplus:_J,boxtimes:bJ,boxul:yJ,boxuL:xJ,boxUl:wJ,boxUL:SJ,boxur:MJ,boxuR:CJ,boxUr:EJ,boxUR:TJ,boxv:AJ,boxV:PJ,boxvh:RJ,boxvH:kJ,boxVh:LJ,boxVH:OJ,boxvl:DJ,boxvL:IJ,boxVl:NJ,boxVL:zJ,boxvr:UJ,boxvR:FJ,boxVr:VJ,boxVR:BJ,bprime:HJ,breve:$J,Breve:GJ,brvbar:qJ,bscr:WJ,Bscr:jJ,bsemi:XJ,bsim:YJ,bsime:KJ,bsolb:ZJ,bsol:JJ,bsolhsub:QJ,bull:tQ,bullet:eQ,bump:nQ,bumpE:iQ,bumpe:rQ,Bumpeq:sQ,bumpeq:oQ,Cacute:aQ,cacute:lQ,capand:cQ,capbrcup:uQ,capcap:hQ,cap:dQ,Cap:pQ,capcup:fQ,capdot:mQ,CapitalDifferentialD:gQ,caps:vQ,caret:_Q,caron:bQ,Cayleys:yQ,ccaps:xQ,Ccaron:wQ,ccaron:SQ,Ccedil:MQ,ccedil:CQ,Ccirc:EQ,ccirc:TQ,Cconint:AQ,ccups:PQ,ccupssm:RQ,Cdot:kQ,cdot:LQ,cedil:OQ,Cedilla:DQ,cemptyv:IQ,cent:NQ,centerdot:zQ,CenterDot:UQ,cfr:FQ,Cfr:VQ,CHcy:BQ,chcy:HQ,check:$Q,checkmark:GQ,Chi:qQ,chi:WQ,circ:jQ,circeq:XQ,circlearrowleft:YQ,circlearrowright:KQ,circledast:ZQ,circledcirc:JQ,circleddash:QQ,CircleDot:ttt,circledR:ett,circledS:ntt,CircleMinus:itt,CirclePlus:rtt,CircleTimes:stt,cir:ott,cirE:att,cire:ltt,cirfnint:ctt,cirmid:utt,cirscir:htt,ClockwiseContourIntegral:dtt,CloseCurlyDoubleQuote:ptt,CloseCurlyQuote:ftt,clubs:mtt,clubsuit:gtt,colon:vtt,Colon:_tt,Colone:btt,colone:ytt,coloneq:xtt,comma:wtt,commat:Stt,comp:Mtt,compfn:Ctt,complement:Ett,complexes:Ttt,cong:Att,congdot:Ptt,Congruent:Rtt,conint:ktt,Conint:Ltt,ContourIntegral:Ott,copf:Dtt,Copf:Itt,coprod:Ntt,Coproduct:ztt,copy:Utt,COPY:Ftt,copysr:Vtt,CounterClockwiseContourIntegral:Btt,crarr:Htt,cross:$tt,Cross:Gtt,Cscr:qtt,cscr:Wtt,csub:jtt,csube:Xtt,csup:Ytt,csupe:Ktt,ctdot:Ztt,cudarrl:Jtt,cudarrr:Qtt,cuepr:tet,cuesc:eet,cularr:net,cularrp:iet,cupbrcap:ret,cupcap:set,CupCap:oet,cup:aet,Cup:cet,cupcup:uet,cupdot:het,cupor:det,cups:pet,curarr:fet,curarrm:met,curlyeqprec:get,curlyeqsucc:vet,curlyvee:_et,curlywedge:bet,curren:yet,curvearrowleft:xet,curvearrowright:wet,cuvee:Met,cuwed:Cet,cwconint:Eet,cwint:Tet,cylcty:Aet,dagger:Pet,Dagger:Ret,daleth:ket,darr:Let,Darr:Oet,dArr:Det,dash:Iet,Dashv:Net,dashv:zet,dbkarow:Uet,dblac:Fet,Dcaron:Vet,dcaron:Bet,Dcy:Het,dcy:$et,ddagger:Get,ddarr:qet,DD:Wet,dd:jet,DDotrahd:Xet,ddotseq:Yet,deg:Ket,Del:Zet,Delta:Jet,delta:Qet,demptyv:tnt,dfisht:ent,Dfr:nnt,dfr:int,dHar:rnt,dharl:snt,dharr:ont,DiacriticalAcute:ant,DiacriticalDot:lnt,DiacriticalDoubleAcute:cnt,DiacriticalGrave:unt,DiacriticalTilde:hnt,diam:dnt,diamond:pnt,Diamond:fnt,diamondsuit:mnt,diams:gnt,die:vnt,DifferentialD:_nt,digamma:bnt,disin:ynt,div:xnt,divide:wnt,divideontimes:Snt,divonx:Mnt,DJcy:Cnt,djcy:Ent,dlcorn:Tnt,dlcrop:Ant,dollar:Pnt,Dopf:Rnt,dopf:knt,Dot:Lnt,dot:Ont,DotDot:Dnt,doteq:Int,doteqdot:Nnt,DotEqual:znt,dotminus:Unt,dotplus:Fnt,dotsquare:Vnt,doublebarwedge:Bnt,DoubleContourIntegral:Hnt,DoubleDot:$nt,DoubleDownArrow:Gnt,DoubleLeftArrow:qnt,DoubleLeftRightArrow:Wnt,DoubleLeftTee:jnt,DoubleLongLeftArrow:Xnt,DoubleLongLeftRightArrow:Ynt,DoubleLongRightArrow:Knt,DoubleRightArrow:Znt,DoubleRightTee:Jnt,DoubleUpArrow:Qnt,DoubleUpDownArrow:tit,DoubleVerticalBar:eit,DownArrowBar:nit,downarrow:iit,DownArrow:rit,Downarrow:sit,DownArrowUpArrow:oit,DownBreve:ait,downdownarrows:lit,downharpoonleft:cit,downharpoonright:uit,DownLeftRightVector:hit,DownLeftTeeVector:dit,DownLeftVectorBar:pit,DownLeftVector:fit,DownRightTeeVector:mit,DownRightVectorBar:git,DownRightVector:vit,DownTeeArrow:_it,DownTee:bit,drbkarow:yit,drcorn:xit,drcrop:wit,Dscr:Sit,dscr:Mit,DScy:Cit,dscy:Eit,dsol:Tit,Dstrok:Ait,dstrok:Pit,dtdot:Rit,dtri:kit,dtrif:Lit,duarr:Oit,duhar:Dit,dwangle:Iit,DZcy:Nit,dzcy:zit,dzigrarr:Uit,Eacute:Fit,eacute:Vit,easter:Bit,Ecaron:Hit,ecaron:$it,Ecirc:Git,ecirc:qit,ecir:Wit,ecolon:jit,Ecy:Xit,ecy:Yit,eDDot:Kit,Edot:Zit,edot:Jit,eDot:Qit,ee:trt,efDot:ert,Efr:nrt,efr:irt,eg:rrt,Egrave:srt,egrave:ort,egs:art,egsdot:lrt,el:crt,Element:urt,elinters:hrt,ell:drt,els:prt,elsdot:frt,Emacr:mrt,emacr:grt,empty:vrt,emptyset:_rt,EmptySmallSquare:brt,emptyv:yrt,EmptyVerySmallSquare:xrt,emsp13:wrt,emsp14:Srt,emsp:Mrt,ENG:Crt,eng:Ert,ensp:Trt,Eogon:Art,eogon:Prt,Eopf:Rrt,eopf:krt,epar:Lrt,eparsl:Ort,eplus:Drt,epsi:Irt,Epsilon:Nrt,epsilon:zrt,epsiv:Urt,eqcirc:Frt,eqcolon:Vrt,eqsim:Brt,eqslantgtr:Hrt,eqslantless:$rt,Equal:Grt,equals:qrt,EqualTilde:Wrt,equest:jrt,Equilibrium:Xrt,equiv:Yrt,equivDD:Krt,eqvparsl:Zrt,erarr:Jrt,erDot:Qrt,escr:tst,Escr:est,esdot:nst,Esim:ist,esim:rst,Eta:sst,eta:ost,ETH:ast,eth:lst,Euml:cst,euml:ust,euro:hst,excl:dst,exist:pst,Exists:fst,expectation:mst,exponentiale:gst,ExponentialE:vst,fallingdotseq:_st,Fcy:bst,fcy:yst,female:xst,ffilig:wst,fflig:Sst,ffllig:Mst,Ffr:Cst,ffr:Est,filig:Tst,FilledSmallSquare:Ast,FilledVerySmallSquare:Pst,fjlig:Rst,flat:kst,fllig:Lst,fltns:Ost,fnof:Dst,Fopf:Ist,fopf:Nst,forall:zst,ForAll:Ust,fork:Fst,forkv:Vst,Fouriertrf:Bst,fpartint:Hst,frac12:$st,frac13:Gst,frac14:qst,frac15:Wst,frac16:jst,frac18:Xst,frac23:Yst,frac25:Kst,frac34:Zst,frac35:Jst,frac38:Qst,frac45:tot,frac56:eot,frac58:not,frac78:iot,frasl:rot,frown:sot,fscr:oot,Fscr:aot,gacute:lot,Gamma:cot,gamma:uot,Gammad:hot,gammad:dot,gap:pot,Gbreve:fot,gbreve:mot,Gcedil:got,Gcirc:vot,gcirc:_ot,Gcy:bot,gcy:yot,Gdot:xot,gdot:wot,ge:Sot,gE:Mot,gEl:Cot,gel:Eot,geq:Tot,geqq:Aot,geqslant:Pot,gescc:Rot,ges:kot,gesdot:Lot,gesdoto:Oot,gesdotol:Dot,gesl:Iot,gesles:Not,Gfr:zot,gfr:Uot,gg:Fot,Gg:Vot,ggg:Bot,gimel:Hot,GJcy:$ot,gjcy:Got,gla:qot,gl:Wot,glE:jot,glj:Xot,gnap:Yot,gnapprox:Kot,gne:Zot,gnE:Jot,gneq:Qot,gneqq:tat,gnsim:eat,Gopf:nat,gopf:iat,grave:rat,GreaterEqual:sat,GreaterEqualLess:oat,GreaterFullEqual:aat,GreaterGreater:lat,GreaterLess:cat,GreaterSlantEqual:uat,GreaterTilde:hat,Gscr:dat,gscr:pat,gsim:fat,gsime:mat,gsiml:gat,gtcc:vat,gtcir:_at,gt:bat,GT:yat,Gt:xat,gtdot:wat,gtlPar:Sat,gtquest:Mat,gtrapprox:Cat,gtrarr:Eat,gtrdot:Tat,gtreqless:Aat,gtreqqless:Pat,gtrless:Rat,gtrsim:kat,gvertneqq:Lat,gvnE:Oat,Hacek:Dat,hairsp:Iat,half:Nat,hamilt:zat,HARDcy:Uat,hardcy:Fat,harrcir:Vat,harr:Bat,hArr:Hat,harrw:$at,Hat:Gat,hbar:qat,Hcirc:Wat,hcirc:jat,hearts:Xat,heartsuit:Yat,hellip:Kat,hercon:Zat,hfr:Jat,Hfr:Qat,HilbertSpace:tlt,hksearow:elt,hkswarow:nlt,hoarr:ilt,homtht:rlt,hookleftarrow:slt,hookrightarrow:olt,hopf:alt,Hopf:llt,horbar:clt,HorizontalLine:ult,hscr:hlt,Hscr:dlt,hslash:plt,Hstrok:flt,hstrok:mlt,HumpDownHump:glt,HumpEqual:vlt,hybull:_lt,hyphen:blt,Iacute:ylt,iacute:xlt,ic:wlt,Icirc:Slt,icirc:Mlt,Icy:Clt,icy:Elt,Idot:Tlt,IEcy:Alt,iecy:Plt,iexcl:Rlt,iff:klt,ifr:Llt,Ifr:Olt,Igrave:Dlt,igrave:Ilt,ii:Nlt,iiiint:zlt,iiint:Ult,iinfin:Flt,iiota:Vlt,IJlig:Blt,ijlig:Hlt,Imacr:$lt,imacr:Glt,image:qlt,ImaginaryI:Wlt,imagline:jlt,imagpart:Xlt,imath:Ylt,Im:Klt,imof:Zlt,imped:Jlt,Implies:Qlt,incare:tct,in:"",infin:ect,infintie:nct,inodot:ict,intcal:rct,int:sct,Int:oct,integers:act,Integral:lct,intercal:cct,Intersection:uct,intlarhk:hct,intprod:dct,InvisibleComma:pct,InvisibleTimes:fct,IOcy:mct,iocy:gct,Iogon:vct,iogon:_ct,Iopf:bct,iopf:yct,Iota:xct,iota:wct,iprod:Sct,iquest:Mct,iscr:Cct,Iscr:Ect,isin:Tct,isindot:Act,isinE:Pct,isins:Rct,isinsv:kct,isinv:Lct,it:Oct,Itilde:Dct,itilde:Ict,Iukcy:Nct,iukcy:zct,Iuml:Uct,iuml:Fct,Jcirc:Vct,jcirc:Bct,Jcy:Hct,jcy:$ct,Jfr:Gct,jfr:qct,jmath:Wct,Jopf:jct,jopf:Xct,Jscr:Yct,jscr:Kct,Jsercy:Zct,jsercy:Jct,Jukcy:Qct,jukcy:tut,Kappa:eut,kappa:nut,kappav:iut,Kcedil:rut,kcedil:sut,Kcy:out,kcy:aut,Kfr:lut,kfr:cut,kgreen:uut,KHcy:hut,khcy:dut,KJcy:put,kjcy:fut,Kopf:mut,kopf:gut,Kscr:vut,kscr:_ut,lAarr:but,Lacute:yut,lacute:xut,laemptyv:wut,lagran:Sut,Lambda:Mut,lambda:Cut,lang:Eut,Lang:Tut,langd:Aut,langle:Put,lap:Rut,Laplacetrf:kut,laquo:Lut,larrb:Out,larrbfs:Dut,larr:Iut,Larr:Nut,lArr:zut,larrfs:Uut,larrhk:Fut,larrlp:Vut,larrpl:But,larrsim:Hut,larrtl:$ut,latail:Gut,lAtail:qut,lat:Wut,late:jut,lates:Xut,lbarr:Yut,lBarr:Kut,lbbrk:Zut,lbrace:Jut,lbrack:Qut,lbrke:tht,lbrksld:eht,lbrkslu:nht,Lcaron:iht,lcaron:rht,Lcedil:sht,lcedil:oht,lceil:aht,lcub:lht,Lcy:cht,lcy:uht,ldca:hht,ldquo:dht,ldquor:pht,ldrdhar:fht,ldrushar:mht,ldsh:ght,le:vht,lE:_ht,LeftAngleBracket:bht,LeftArrowBar:yht,leftarrow:xht,LeftArrow:wht,Leftarrow:Sht,LeftArrowRightArrow:Mht,leftarrowtail:Cht,LeftCeiling:Eht,LeftDoubleBracket:Tht,LeftDownTeeVector:Aht,LeftDownVectorBar:Pht,LeftDownVector:Rht,LeftFloor:kht,leftharpoondown:Lht,leftharpoonup:Oht,leftleftarrows:Dht,leftrightarrow:Iht,LeftRightArrow:Nht,Leftrightarrow:zht,leftrightarrows:Uht,leftrightharpoons:Fht,leftrightsquigarrow:Vht,LeftRightVector:Bht,LeftTeeArrow:Hht,LeftTee:$ht,LeftTeeVector:Ght,leftthreetimes:qht,LeftTriangleBar:Wht,LeftTriangle:jht,LeftTriangleEqual:Xht,LeftUpDownVector:Yht,LeftUpTeeVector:Kht,LeftUpVectorBar:Zht,LeftUpVector:Jht,LeftVectorBar:Qht,LeftVector:tdt,lEg:edt,leg:ndt,leq:idt,leqq:rdt,leqslant:sdt,lescc:odt,les:adt,lesdot:ldt,lesdoto:cdt,lesdotor:udt,lesg:hdt,lesges:ddt,lessapprox:pdt,lessdot:fdt,lesseqgtr:mdt,lesseqqgtr:gdt,LessEqualGreater:vdt,LessFullEqual:_dt,LessGreater:bdt,lessgtr:ydt,LessLess:xdt,lesssim:wdt,LessSlantEqual:Sdt,LessTilde:Mdt,lfisht:Cdt,lfloor:Edt,Lfr:Tdt,lfr:Adt,lg:Pdt,lgE:Rdt,lHar:kdt,lhard:Ldt,lharu:Odt,lharul:Ddt,lhblk:Idt,LJcy:Ndt,ljcy:zdt,llarr:Udt,ll:Fdt,Ll:Vdt,llcorner:Bdt,Lleftarrow:Hdt,llhard:$dt,lltri:Gdt,Lmidot:qdt,lmidot:Wdt,lmoustache:jdt,lmoust:Xdt,lnap:Ydt,lnapprox:Kdt,lne:Zdt,lnE:Jdt,lneq:Qdt,lneqq:tpt,lnsim:ept,loang:npt,loarr:ipt,lobrk:rpt,longleftarrow:spt,LongLeftArrow:opt,Longleftarrow:apt,longleftrightarrow:lpt,LongLeftRightArrow:cpt,Longleftrightarrow:upt,longmapsto:hpt,longrightarrow:dpt,LongRightArrow:ppt,Longrightarrow:fpt,looparrowleft:mpt,looparrowright:gpt,lopar:vpt,Lopf:_pt,lopf:bpt,loplus:ypt,lotimes:xpt,lowast:wpt,lowbar:Spt,LowerLeftArrow:Mpt,LowerRightArrow:Cpt,loz:Ept,lozenge:Tpt,lozf:Apt,lpar:Ppt,lparlt:Rpt,lrarr:kpt,lrcorner:Lpt,lrhar:Opt,lrhard:Dpt,lrm:Ipt,lrtri:Npt,lsaquo:zpt,lscr:Upt,Lscr:Fpt,lsh:Vpt,Lsh:Bpt,lsim:Hpt,lsime:$pt,lsimg:Gpt,lsqb:qpt,lsquo:Wpt,lsquor:jpt,Lstrok:Xpt,lstrok:Ypt,ltcc:Kpt,ltcir:Zpt,lt:Jpt,LT:Qpt,Lt:tft,ltdot:eft,lthree:nft,ltimes:ift,ltlarr:rft,ltquest:sft,ltri:oft,ltrie:aft,ltrif:lft,ltrPar:cft,lurdshar:uft,luruhar:hft,lvertneqq:dft,lvnE:pft,macr:fft,male:mft,malt:gft,maltese:vft,Map:"",map:_ft,mapsto:bft,mapstodown:yft,mapstoleft:xft,mapstoup:wft,marker:Sft,mcomma:Mft,Mcy:Cft,mcy:Eft,mdash:Tft,mDDot:Aft,measuredangle:Pft,MediumSpace:Rft,Mellintrf:kft,Mfr:Lft,mfr:Oft,mho:Dft,micro:Ift,midast:Nft,midcir:zft,mid:Uft,middot:Fft,minusb:Vft,minus:Bft,minusd:Hft,minusdu:$ft,MinusPlus:Gft,mlcp:qft,mldr:Wft,mnplus:jft,models:Xft,Mopf:Yft,mopf:Kft,mp:Zft,mscr:Jft,Mscr:Qft,mstpos:tmt,Mu:emt,mu:nmt,multimap:imt,mumap:rmt,nabla:smt,Nacute:omt,nacute:amt,nang:lmt,nap:cmt,napE:umt,napid:hmt,napos:dmt,napprox:pmt,natural:fmt,naturals:mmt,natur:gmt,nbsp:vmt,nbump:_mt,nbumpe:bmt,ncap:ymt,Ncaron:xmt,ncaron:wmt,Ncedil:Smt,ncedil:Mmt,ncong:Cmt,ncongdot:Emt,ncup:Tmt,Ncy:Amt,ncy:Pmt,ndash:Rmt,nearhk:kmt,nearr:Lmt,neArr:Omt,nearrow:Dmt,ne:Imt,nedot:Nmt,NegativeMediumSpace:zmt,NegativeThickSpace:Umt,NegativeThinSpace:Fmt,NegativeVeryThinSpace:Vmt,nequiv:Bmt,nesear:Hmt,nesim:$mt,NestedGreaterGreater:Gmt,NestedLessLess:qmt,NewLine:Wmt,nexist:jmt,nexists:Xmt,Nfr:Ymt,nfr:Kmt,ngE:Zmt,nge:Jmt,ngeq:Qmt,ngeqq:tgt,ngeqslant:egt,nges:ngt,nGg:igt,ngsim:rgt,nGt:sgt,ngt:ogt,ngtr:agt,nGtv:lgt,nharr:cgt,nhArr:ugt,nhpar:hgt,ni:dgt,nis:pgt,nisd:fgt,niv:mgt,NJcy:ggt,njcy:vgt,nlarr:_gt,nlArr:bgt,nldr:ygt,nlE:xgt,nle:wgt,nleftarrow:Sgt,nLeftarrow:Mgt,nleftrightarrow:Cgt,nLeftrightarrow:Egt,nleq:Tgt,nleqq:Agt,nleqslant:Pgt,nles:Rgt,nless:kgt,nLl:Lgt,nlsim:Ogt,nLt:Dgt,nlt:Igt,nltri:Ngt,nltrie:zgt,nLtv:Ugt,nmid:Fgt,NoBreak:Vgt,NonBreakingSpace:Bgt,nopf:Hgt,Nopf:$gt,Not:Ggt,not:qgt,NotCongruent:Wgt,NotCupCap:jgt,NotDoubleVerticalBar:Xgt,NotElement:Ygt,NotEqual:Kgt,NotEqualTilde:Zgt,NotExists:Jgt,NotGreater:Qgt,NotGreaterEqual:tvt,NotGreaterFullEqual:evt,NotGreaterGreater:nvt,NotGreaterLess:ivt,NotGreaterSlantEqual:rvt,NotGreaterTilde:svt,NotHumpDownHump:ovt,NotHumpEqual:avt,notin:lvt,notindot:cvt,notinE:uvt,notinva:hvt,notinvb:dvt,notinvc:pvt,NotLeftTriangleBar:fvt,NotLeftTriangle:mvt,NotLeftTriangleEqual:gvt,NotLess:vvt,NotLessEqual:_vt,NotLessGreater:bvt,NotLessLess:yvt,NotLessSlantEqual:xvt,NotLessTilde:wvt,NotNestedGreaterGreater:Svt,NotNestedLessLess:Mvt,notni:Cvt,notniva:Evt,notnivb:Tvt,notnivc:Avt,NotPrecedes:Pvt,NotPrecedesEqual:Rvt,NotPrecedesSlantEqual:kvt,NotReverseElement:Lvt,NotRightTriangleBar:Ovt,NotRightTriangle:Dvt,NotRightTriangleEqual:Ivt,NotSquareSubset:Nvt,NotSquareSubsetEqual:zvt,NotSquareSuperset:Uvt,NotSquareSupersetEqual:Fvt,NotSubset:Vvt,NotSubsetEqual:Bvt,NotSucceeds:Hvt,NotSucceedsEqual:$vt,NotSucceedsSlantEqual:Gvt,NotSucceedsTilde:qvt,NotSuperset:Wvt,NotSupersetEqual:jvt,NotTilde:Xvt,NotTildeEqual:Yvt,NotTildeFullEqual:Kvt,NotTildeTilde:Zvt,NotVerticalBar:Jvt,nparallel:Qvt,npar:t_t,nparsl:e_t,npart:n_t,npolint:i_t,npr:r_t,nprcue:s_t,nprec:o_t,npreceq:a_t,npre:l_t,nrarrc:c_t,nrarr:u_t,nrArr:h_t,nrarrw:d_t,nrightarrow:p_t,nRightarrow:f_t,nrtri:m_t,nrtrie:g_t,nsc:v_t,nsccue:__t,nsce:b_t,Nscr:y_t,nscr:x_t,nshortmid:w_t,nshortparallel:S_t,nsim:M_t,nsime:C_t,nsimeq:E_t,nsmid:T_t,nspar:A_t,nsqsube:P_t,nsqsupe:R_t,nsub:k_t,nsubE:L_t,nsube:O_t,nsubset:D_t,nsubseteq:I_t,nsubseteqq:N_t,nsucc:z_t,nsucceq:U_t,nsup:F_t,nsupE:V_t,nsupe:B_t,nsupset:H_t,nsupseteq:$_t,nsupseteqq:G_t,ntgl:q_t,Ntilde:W_t,ntilde:j_t,ntlg:X_t,ntriangleleft:Y_t,ntrianglelefteq:K_t,ntriangleright:Z_t,ntrianglerighteq:J_t,Nu:Q_t,nu:t0t,num:e0t,numero:n0t,numsp:i0t,nvap:r0t,nvdash:s0t,nvDash:o0t,nVdash:a0t,nVDash:l0t,nvge:c0t,nvgt:u0t,nvHarr:h0t,nvinfin:d0t,nvlArr:p0t,nvle:f0t,nvlt:m0t,nvltrie:g0t,nvrArr:v0t,nvrtrie:_0t,nvsim:b0t,nwarhk:y0t,nwarr:x0t,nwArr:w0t,nwarrow:S0t,nwnear:M0t,Oacute:C0t,oacute:E0t,oast:T0t,Ocirc:A0t,ocirc:P0t,ocir:R0t,Ocy:k0t,ocy:L0t,odash:O0t,Odblac:D0t,odblac:I0t,odiv:N0t,odot:z0t,odsold:U0t,OElig:F0t,oelig:V0t,ofcir:B0t,Ofr:H0t,ofr:$0t,ogon:G0t,Ograve:q0t,ograve:W0t,ogt:j0t,ohbar:X0t,ohm:Y0t,oint:K0t,olarr:Z0t,olcir:J0t,olcross:Q0t,oline:tbt,olt:ebt,Omacr:nbt,omacr:ibt,Omega:rbt,omega:sbt,Omicron:obt,omicron:abt,omid:lbt,ominus:cbt,Oopf:ubt,oopf:hbt,opar:dbt,OpenCurlyDoubleQuote:pbt,OpenCurlyQuote:fbt,operp:mbt,oplus:gbt,orarr:vbt,Or:_bt,or:bbt,ord:ybt,order:xbt,orderof:wbt,ordf:Sbt,ordm:Mbt,origof:Cbt,oror:Ebt,orslope:Tbt,orv:Abt,oS:Pbt,Oscr:Rbt,oscr:kbt,Oslash:Lbt,oslash:Obt,osol:Dbt,Otilde:Ibt,otilde:Nbt,otimesas:zbt,Otimes:Ubt,otimes:Fbt,Ouml:Vbt,ouml:Bbt,ovbar:Hbt,OverBar:$bt,OverBrace:Gbt,OverBracket:qbt,OverParenthesis:Wbt,para:jbt,parallel:Xbt,par:Ybt,parsim:Kbt,parsl:Zbt,part:Jbt,PartialD:Qbt,Pcy:tyt,pcy:eyt,percnt:nyt,period:iyt,permil:ryt,perp:syt,pertenk:oyt,Pfr:ayt,pfr:lyt,Phi:cyt,phi:uyt,phiv:hyt,phmmat:dyt,phone:pyt,Pi:fyt,pi:myt,pitchfork:gyt,piv:vyt,planck:_yt,planckh:byt,plankv:yyt,plusacir:xyt,plusb:wyt,pluscir:Syt,plus:Myt,plusdo:Cyt,plusdu:Eyt,pluse:Tyt,PlusMinus:Ayt,plusmn:Pyt,plussim:Ryt,plustwo:kyt,pm:Lyt,Poincareplane:Oyt,pointint:Dyt,popf:Iyt,Popf:Nyt,pound:zyt,prap:Uyt,Pr:Fyt,pr:Vyt,prcue:Byt,precapprox:Hyt,prec:$yt,preccurlyeq:Gyt,Precedes:qyt,PrecedesEqual:Wyt,PrecedesSlantEqual:jyt,PrecedesTilde:Xyt,preceq:Yyt,precnapprox:Kyt,precneqq:Zyt,precnsim:Jyt,pre:Qyt,prE:txt,precsim:ext,prime:nxt,Prime:ixt,primes:rxt,prnap:sxt,prnE:oxt,prnsim:axt,prod:lxt,Product:cxt,profalar:uxt,profline:hxt,profsurf:dxt,prop:pxt,Proportional:fxt,Proportion:mxt,propto:gxt,prsim:vxt,prurel:_xt,Pscr:bxt,pscr:yxt,Psi:xxt,psi:wxt,puncsp:Sxt,Qfr:Mxt,qfr:Cxt,qint:Ext,qopf:Txt,Qopf:Axt,qprime:Pxt,Qscr:Rxt,qscr:kxt,quaternions:Lxt,quatint:Oxt,quest:Dxt,questeq:Ixt,quot:Nxt,QUOT:zxt,rAarr:Uxt,race:Fxt,Racute:Vxt,racute:Bxt,radic:Hxt,raemptyv:$xt,rang:Gxt,Rang:qxt,rangd:Wxt,range:jxt,rangle:Xxt,raquo:Yxt,rarrap:Kxt,rarrb:Zxt,rarrbfs:Jxt,rarrc:Qxt,rarr:twt,Rarr:ewt,rArr:nwt,rarrfs:iwt,rarrhk:rwt,rarrlp:swt,rarrpl:owt,rarrsim:awt,Rarrtl:lwt,rarrtl:cwt,rarrw:uwt,ratail:hwt,rAtail:dwt,ratio:pwt,rationals:fwt,rbarr:mwt,rBarr:gwt,RBarr:vwt,rbbrk:_wt,rbrace:bwt,rbrack:ywt,rbrke:xwt,rbrksld:wwt,rbrkslu:Swt,Rcaron:Mwt,rcaron:Cwt,Rcedil:Ewt,rcedil:Twt,rceil:Awt,rcub:Pwt,Rcy:Rwt,rcy:kwt,rdca:Lwt,rdldhar:Owt,rdquo:Dwt,rdquor:Iwt,rdsh:Nwt,real:zwt,realine:Uwt,realpart:Fwt,reals:Vwt,Re:Bwt,rect:Hwt,reg:$wt,REG:Gwt,ReverseElement:qwt,ReverseEquilibrium:Wwt,ReverseUpEquilibrium:jwt,rfisht:Xwt,rfloor:Ywt,rfr:Kwt,Rfr:Zwt,rHar:Jwt,rhard:Qwt,rharu:t1t,rharul:e1t,Rho:n1t,rho:i1t,rhov:r1t,RightAngleBracket:s1t,RightArrowBar:o1t,rightarrow:a1t,RightArrow:l1t,Rightarrow:c1t,RightArrowLeftArrow:u1t,rightarrowtail:h1t,RightCeiling:d1t,RightDoubleBracket:p1t,RightDownTeeVector:f1t,RightDownVectorBar:m1t,RightDownVector:g1t,RightFloor:v1t,rightharpoondown:_1t,rightharpoonup:b1t,rightleftarrows:y1t,rightleftharpoons:x1t,rightrightarrows:w1t,rightsquigarrow:S1t,RightTeeArrow:M1t,RightTee:C1t,RightTeeVector:E1t,rightthreetimes:T1t,RightTriangleBar:A1t,RightTriangle:P1t,RightTriangleEqual:R1t,RightUpDownVector:k1t,RightUpTeeVector:L1t,RightUpVectorBar:O1t,RightUpVector:D1t,RightVectorBar:I1t,RightVector:N1t,ring:z1t,risingdotseq:U1t,rlarr:F1t,rlhar:V1t,rlm:B1t,rmoustache:H1t,rmoust:$1t,rnmid:G1t,roang:q1t,roarr:W1t,robrk:j1t,ropar:X1t,ropf:Y1t,Ropf:K1t,roplus:Z1t,rotimes:J1t,RoundImplies:Q1t,rpar:tSt,rpargt:eSt,rppolint:nSt,rrarr:iSt,Rrightarrow:rSt,rsaquo:sSt,rscr:oSt,Rscr:aSt,rsh:lSt,Rsh:cSt,rsqb:uSt,rsquo:hSt,rsquor:dSt,rthree:pSt,rtimes:fSt,rtri:mSt,rtrie:gSt,rtrif:vSt,rtriltri:_St,RuleDelayed:bSt,ruluhar:ySt,rx:xSt,Sacute:wSt,sacute:SSt,sbquo:MSt,scap:CSt,Scaron:ESt,scaron:TSt,Sc:ASt,sc:PSt,sccue:RSt,sce:kSt,scE:LSt,Scedil:OSt,scedil:DSt,Scirc:ISt,scirc:NSt,scnap:zSt,scnE:USt,scnsim:FSt,scpolint:VSt,scsim:BSt,Scy:HSt,scy:$St,sdotb:GSt,sdot:qSt,sdote:WSt,searhk:jSt,searr:XSt,seArr:YSt,searrow:KSt,sect:ZSt,semi:JSt,seswar:QSt,setminus:tMt,setmn:eMt,sext:nMt,Sfr:iMt,sfr:rMt,sfrown:sMt,sharp:oMt,SHCHcy:aMt,shchcy:lMt,SHcy:cMt,shcy:uMt,ShortDownArrow:hMt,ShortLeftArrow:dMt,shortmid:pMt,shortparallel:fMt,ShortRightArrow:mMt,ShortUpArrow:gMt,shy:vMt,Sigma:_Mt,sigma:bMt,sigmaf:yMt,sigmav:xMt,sim:wMt,simdot:SMt,sime:MMt,simeq:CMt,simg:EMt,simgE:TMt,siml:AMt,simlE:PMt,simne:RMt,simplus:kMt,simrarr:LMt,slarr:OMt,SmallCircle:DMt,smallsetminus:IMt,smashp:NMt,smeparsl:zMt,smid:UMt,smile:FMt,smt:VMt,smte:BMt,smtes:HMt,SOFTcy:$Mt,softcy:GMt,solbar:qMt,solb:WMt,sol:jMt,Sopf:XMt,sopf:YMt,spades:KMt,spadesuit:ZMt,spar:JMt,sqcap:QMt,sqcaps:tCt,sqcup:eCt,sqcups:nCt,Sqrt:iCt,sqsub:rCt,sqsube:sCt,sqsubset:oCt,sqsubseteq:aCt,sqsup:lCt,sqsupe:cCt,sqsupset:uCt,sqsupseteq:hCt,square:dCt,Square:pCt,SquareIntersection:fCt,SquareSubset:mCt,SquareSubsetEqual:gCt,SquareSuperset:vCt,SquareSupersetEqual:_Ct,SquareUnion:bCt,squarf:yCt,squ:xCt,squf:wCt,srarr:SCt,Sscr:MCt,sscr:CCt,ssetmn:ECt,ssmile:TCt,sstarf:ACt,Star:PCt,star:RCt,starf:kCt,straightepsilon:LCt,straightphi:OCt,strns:DCt,sub:ICt,Sub:NCt,subdot:zCt,subE:UCt,sube:FCt,subedot:VCt,submult:BCt,subnE:HCt,subne:$Ct,subplus:GCt,subrarr:qCt,subset:WCt,Subset:jCt,subseteq:XCt,subseteqq:YCt,SubsetEqual:KCt,subsetneq:ZCt,subsetneqq:JCt,subsim:QCt,subsub:tEt,subsup:eEt,succapprox:nEt,succ:iEt,succcurlyeq:rEt,Succeeds:sEt,SucceedsEqual:oEt,SucceedsSlantEqual:aEt,SucceedsTilde:lEt,succeq:cEt,succnapprox:uEt,succneqq:hEt,succnsim:dEt,succsim:pEt,SuchThat:fEt,sum:mEt,Sum:gEt,sung:vEt,sup1:_Et,sup2:bEt,sup3:yEt,sup:xEt,Sup:wEt,supdot:SEt,supdsub:MEt,supE:CEt,supe:EEt,supedot:TEt,Superset:AEt,SupersetEqual:PEt,suphsol:REt,suphsub:kEt,suplarr:LEt,supmult:OEt,supnE:DEt,supne:IEt,supplus:NEt,supset:zEt,Supset:UEt,supseteq:FEt,supseteqq:VEt,supsetneq:BEt,supsetneqq:HEt,supsim:$Et,supsub:GEt,supsup:qEt,swarhk:WEt,swarr:jEt,swArr:XEt,swarrow:YEt,swnwar:KEt,szlig:ZEt,Tab:JEt,target:QEt,Tau:tTt,tau:eTt,tbrk:nTt,Tcaron:iTt,tcaron:rTt,Tcedil:sTt,tcedil:oTt,Tcy:aTt,tcy:lTt,tdot:cTt,telrec:uTt,Tfr:hTt,tfr:dTt,there4:pTt,therefore:fTt,Therefore:mTt,Theta:gTt,theta:vTt,thetasym:_Tt,thetav:bTt,thickapprox:yTt,thicksim:xTt,ThickSpace:wTt,ThinSpace:STt,thinsp:MTt,thkap:CTt,thksim:ETt,THORN:TTt,thorn:ATt,tilde:PTt,Tilde:RTt,TildeEqual:kTt,TildeFullEqual:LTt,TildeTilde:OTt,timesbar:DTt,timesb:ITt,times:NTt,timesd:zTt,tint:UTt,toea:FTt,topbot:VTt,topcir:BTt,top:HTt,Topf:$Tt,topf:GTt,topfork:qTt,tosa:WTt,tprime:jTt,trade:XTt,TRADE:YTt,triangle:KTt,triangledown:ZTt,triangleleft:JTt,trianglelefteq:QTt,triangleq:tAt,triangleright:eAt,trianglerighteq:nAt,tridot:iAt,trie:rAt,triminus:sAt,TripleDot:oAt,triplus:aAt,trisb:lAt,tritime:cAt,trpezium:uAt,Tscr:hAt,tscr:dAt,TScy:pAt,tscy:fAt,TSHcy:mAt,tshcy:gAt,Tstrok:vAt,tstrok:_At,twixt:bAt,twoheadleftarrow:yAt,twoheadrightarrow:xAt,Uacute:wAt,uacute:SAt,uarr:MAt,Uarr:CAt,uArr:EAt,Uarrocir:TAt,Ubrcy:AAt,ubrcy:PAt,Ubreve:RAt,ubreve:kAt,Ucirc:LAt,ucirc:OAt,Ucy:DAt,ucy:IAt,udarr:NAt,Udblac:zAt,udblac:UAt,udhar:FAt,ufisht:VAt,Ufr:BAt,ufr:HAt,Ugrave:$At,ugrave:GAt,uHar:qAt,uharl:WAt,uharr:jAt,uhblk:XAt,ulcorn:YAt,ulcorner:KAt,ulcrop:ZAt,ultri:JAt,Umacr:QAt,umacr:tPt,uml:ePt,UnderBar:nPt,UnderBrace:iPt,UnderBracket:rPt,UnderParenthesis:sPt,Union:oPt,UnionPlus:aPt,Uogon:lPt,uogon:cPt,Uopf:uPt,uopf:hPt,UpArrowBar:dPt,uparrow:pPt,UpArrow:fPt,Uparrow:mPt,UpArrowDownArrow:gPt,updownarrow:vPt,UpDownArrow:_Pt,Updownarrow:bPt,UpEquilibrium:yPt,upharpoonleft:xPt,upharpoonright:wPt,uplus:SPt,UpperLeftArrow:MPt,UpperRightArrow:CPt,upsi:EPt,Upsi:TPt,upsih:APt,Upsilon:PPt,upsilon:RPt,UpTeeArrow:kPt,UpTee:LPt,upuparrows:OPt,urcorn:DPt,urcorner:IPt,urcrop:NPt,Uring:zPt,uring:UPt,urtri:FPt,Uscr:VPt,uscr:BPt,utdot:HPt,Utilde:$Pt,utilde:GPt,utri:qPt,utrif:WPt,uuarr:jPt,Uuml:XPt,uuml:YPt,uwangle:KPt,vangrt:ZPt,varepsilon:JPt,varkappa:QPt,varnothing:t2t,varphi:e2t,varpi:n2t,varpropto:i2t,varr:r2t,vArr:s2t,varrho:o2t,varsigma:a2t,varsubsetneq:l2t,varsubsetneqq:c2t,varsupsetneq:u2t,varsupsetneqq:h2t,vartheta:d2t,vartriangleleft:p2t,vartriangleright:f2t,vBar:m2t,Vbar:g2t,vBarv:v2t,Vcy:_2t,vcy:b2t,vdash:y2t,vDash:x2t,Vdash:w2t,VDash:S2t,Vdashl:M2t,veebar:C2t,vee:E2t,Vee:T2t,veeeq:A2t,vellip:P2t,verbar:R2t,Verbar:k2t,vert:L2t,Vert:O2t,VerticalBar:D2t,VerticalLine:I2t,VerticalSeparator:N2t,VerticalTilde:z2t,VeryThinSpace:U2t,Vfr:F2t,vfr:V2t,vltri:B2t,vnsub:H2t,vnsup:$2t,Vopf:G2t,vopf:q2t,vprop:W2t,vrtri:j2t,Vscr:X2t,vscr:Y2t,vsubnE:K2t,vsubne:Z2t,vsupnE:J2t,vsupne:Q2t,Vvdash:tRt,vzigzag:eRt,Wcirc:nRt,wcirc:iRt,wedbar:rRt,wedge:sRt,Wedge:oRt,wedgeq:aRt,weierp:lRt,Wfr:cRt,wfr:uRt,Wopf:hRt,wopf:dRt,wp:pRt,wr:fRt,wreath:mRt,Wscr:gRt,wscr:vRt,xcap:_Rt,xcirc:bRt,xcup:yRt,xdtri:xRt,Xfr:wRt,xfr:SRt,xharr:MRt,xhArr:CRt,Xi:ERt,xi:TRt,xlarr:ARt,xlArr:PRt,xmap:RRt,xnis:kRt,xodot:LRt,Xopf:ORt,xopf:DRt,xoplus:IRt,xotime:NRt,xrarr:zRt,xrArr:URt,Xscr:FRt,xscr:VRt,xsqcup:BRt,xuplus:HRt,xutri:$Rt,xvee:GRt,xwedge:qRt,Yacute:WRt,yacute:jRt,YAcy:XRt,yacy:YRt,Ycirc:KRt,ycirc:ZRt,Ycy:JRt,ycy:QRt,yen:tkt,Yfr:ekt,yfr:nkt,YIcy:ikt,yicy:rkt,Yopf:skt,yopf:okt,Yscr:akt,yscr:lkt,YUcy:ckt,yucy:ukt,yuml:hkt,Yuml:dkt,Zacute:pkt,zacute:fkt,Zcaron:mkt,zcaron:gkt,Zcy:vkt,zcy:_kt,Zdot:bkt,zdot:ykt,zeetrf:xkt,ZeroWidthSpace:wkt,Zeta:Skt,zeta:Mkt,zfr:Ckt,Zfr:Ekt,ZHcy:Tkt,zhcy:Akt,zigrarr:Pkt,zopf:Rkt,Zopf:kkt,Zscr:Lkt,zscr:Okt,zwj:Dkt,zwnj:Ikt},Nkt="",zkt="",Ukt="",Fkt="",Vkt="",Bkt="",Hkt="",$kt="",Gkt="",qkt="&",Wkt="&",jkt="",Xkt="",Ykt="",Kkt="",Zkt="",Jkt="",Qkt="",tLt="",eLt="",nLt="",iLt="",rLt="",sLt="",oLt="",aLt="",lLt="",cLt="",uLt="",hLt="",dLt="",pLt="",fLt="",mLt="",gLt="",vLt="",_Lt="",bLt="",yLt="",xLt="",wLt=">",SLt=">",MLt="",CLt="",ELt="",TLt="",ALt="",PLt="",RLt="",kLt="",LLt="",OLt="",DLt="",ILt="<",NLt="<",zLt="",ULt="",FLt="",VLt="",BLt="",HLt="",$Lt="",GLt="",qLt="",WLt="",jLt="",XLt="",YLt="",KLt="",ZLt="",JLt="",QLt="",tOt="",eOt="",nOt="",iOt="",rOt="",sOt="",oOt="",aOt='"',lOt='"',cOt="",uOt="",hOt="",dOt="",pOt="",fOt="",mOt="",gOt="",vOt="",_Ot="",bOt="",yOt="",xOt="",wOt="",SOt="",MOt="",COt="",EOt="",TOt="",AOt="",POt="",ROt="",kOt="",LOt="",OOt="",DOt={Aacute:Nkt,aacute:zkt,Acirc:Ukt,acirc:Fkt,acute:Vkt,AElig:Bkt,aelig:Hkt,Agrave:$kt,agrave:Gkt,amp:qkt,AMP:Wkt,Aring:jkt,aring:Xkt,Atilde:Ykt,atilde:Kkt,Auml:Zkt,auml:Jkt,brvbar:Qkt,Ccedil:tLt,ccedil:eLt,cedil:nLt,cent:iLt,copy:rLt,COPY:sLt,curren:oLt,deg:aLt,divide:lLt,Eacute:cLt,eacute:uLt,Ecirc:hLt,ecirc:dLt,Egrave:pLt,egrave:fLt,ETH:mLt,eth:gLt,Euml:vLt,euml:_Lt,frac12:bLt,frac14:yLt,frac34:xLt,gt:wLt,GT:SLt,Iacute:MLt,iacute:CLt,Icirc:ELt,icirc:TLt,iexcl:ALt,Igrave:PLt,igrave:RLt,iquest:kLt,Iuml:LLt,iuml:OLt,laquo:DLt,lt:ILt,LT:NLt,macr:zLt,micro:ULt,middot:FLt,nbsp:VLt,not:BLt,Ntilde:HLt,ntilde:$Lt,Oacute:GLt,oacute:qLt,Ocirc:WLt,ocirc:jLt,Ograve:XLt,ograve:YLt,ordf:KLt,ordm:ZLt,Oslash:JLt,oslash:QLt,Otilde:tOt,otilde:eOt,Ouml:nOt,ouml:iOt,para:rOt,plusmn:sOt,pound:oOt,quot:aOt,QUOT:lOt,raquo:cOt,reg:uOt,REG:hOt,sect:dOt,shy:pOt,sup1:fOt,sup2:mOt,sup3:gOt,szlig:vOt,THORN:_Ot,thorn:bOt,times:yOt,Uacute:xOt,uacute:wOt,Ucirc:SOt,ucirc:MOt,Ugrave:COt,ugrave:EOt,uml:TOt,Uuml:AOt,uuml:POt,Yacute:ROt,yacute:kOt,yen:LOt,yuml:OOt},IOt="&",NOt="'",zOt=">",UOt="<",FOt='"',AN={amp:IOt,apos:NOt,gt:zOt,lt:UOt,quot:FOt};var aT={};const VOt={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376};var BOt=zt&&zt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(aT,"__esModule",{value:!0});var PR=BOt(VOt),HOt=String.fromCodePoint||function(i){var t="";return i>65535&&(i-=65536,t+=String.fromCharCode(i>>>10&1023|55296),i=56320|i&1023),t+=String.fromCharCode(i),t};function $Ot(i){return i>=55296&&i<=57343||i>1114111?"":(i in PR.default&&(i=PR.default[i]),HOt(i))}aT.default=$Ot;var hx=zt&&zt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Yc,"__esModule",{value:!0});Yc.decodeHTML=Yc.decodeHTMLStrict=Yc.decodeXML=void 0;var iC=hx(TN),GOt=hx(DOt),qOt=hx(AN),RR=hx(aT),WOt=/&(?:[a-zA-Z0-9]+|#[xX][\da-fA-F]+|#\d+);/g;Yc.decodeXML=PN(qOt.default);Yc.decodeHTMLStrict=PN(iC.default);function PN(i){var t=RN(i);return function(e){return String(e).replace(WOt,t)}}var kR=function(i,t){return i<t?1:-1};Yc.decodeHTML=function(){for(var i=Object.keys(GOt.default).sort(kR),t=Object.keys(iC.default).sort(kR),e=0,n=0;e<t.length;e++)i[n]===t[e]?(t[e]+=";?",n++):t[e]+=";";var r=new RegExp("&(?:"+t.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),s=RN(iC.default);function o(a){return a.substr(-1)!==";"&&(a+=";"),s(a)}return function(a){return String(a).replace(r,o)}}();function RN(i){return function(e){if(e.charAt(1)==="#"){var n=e.charAt(2);return n==="X"||n==="x"?RR.default(parseInt(e.substr(3),16)):RR.default(parseInt(e.substr(2),10))}return i[e.slice(1,-1)]||e}}var ca={},kN=zt&&zt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ca,"__esModule",{value:!0});ca.escapeUTF8=ca.escape=ca.encodeNonAsciiHTML=ca.encodeHTML=ca.encodeXML=void 0;var jOt=kN(AN),LN=DN(jOt.default),ON=IN(LN);ca.encodeXML=UN(LN);var XOt=kN(TN),lT=DN(XOt.default),YOt=IN(lT);ca.encodeHTML=ZOt(lT,YOt);ca.encodeNonAsciiHTML=UN(lT);function DN(i){return Object.keys(i).sort().reduce(function(t,e){return t[i[e]]="&"+e+";",t},{})}function IN(i){for(var t=[],e=[],n=0,r=Object.keys(i);n<r.length;n++){var s=r[n];s.length===1?t.push("\\"+s):e.push(s)}t.sort();for(var o=0;o<t.length-1;o++){for(var a=o;a<t.length-1&&t[a].charCodeAt(1)+1===t[a+1].charCodeAt(1);)a+=1;var l=1+a-o;l<3||t.splice(o,l,t[o]+"-"+t[a])}return e.unshift("["+t.join("")+"]"),new RegExp(e.join("|"),"g")}var NN=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,KOt=String.prototype.codePointAt!=null?function(i){return i.codePointAt(0)}:function(i){return(i.charCodeAt(0)-55296)*1024+i.charCodeAt(1)-56320+65536};function dx(i){return"&#x"+(i.length>1?KOt(i):i.charCodeAt(0)).toString(16).toUpperCase()+";"}function ZOt(i,t){return function(e){return e.replace(t,function(n){return i[n]}).replace(NN,dx)}}var zN=new RegExp(ON.source+"|"+NN.source,"g");function JOt(i){return i.replace(zN,dx)}ca.escape=JOt;function QOt(i){return i.replace(ON,dx)}ca.escapeUTF8=QOt;function UN(i){return function(t){return t.replace(zN,function(e){return i[e]||dx(e)})}}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.decodeXMLStrict=i.decodeHTML5Strict=i.decodeHTML4Strict=i.decodeHTML5=i.decodeHTML4=i.decodeHTMLStrict=i.decodeHTML=i.decodeXML=i.encodeHTML5=i.encodeHTML4=i.escapeUTF8=i.escape=i.encodeNonAsciiHTML=i.encodeHTML=i.encodeXML=i.encode=i.decodeStrict=i.decode=void 0;var t=Yc,e=ca;function n(l,c){return(!c||c<=0?t.decodeXML:t.decodeHTML)(l)}i.decode=n;function r(l,c){return(!c||c<=0?t.decodeXML:t.decodeHTMLStrict)(l)}i.decodeStrict=r;function s(l,c){return(!c||c<=0?e.encodeXML:e.encodeHTML)(l)}i.encode=s;var o=ca;Object.defineProperty(i,"encodeXML",{enumerable:!0,get:function(){return o.encodeXML}}),Object.defineProperty(i,"encodeHTML",{enumerable:!0,get:function(){return o.encodeHTML}}),Object.defineProperty(i,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return o.encodeNonAsciiHTML}}),Object.defineProperty(i,"escape",{enumerable:!0,get:function(){return o.escape}}),Object.defineProperty(i,"escapeUTF8",{enumerable:!0,get:function(){return o.escapeUTF8}}),Object.defineProperty(i,"encodeHTML4",{enumerable:!0,get:function(){return o.encodeHTML}}),Object.defineProperty(i,"encodeHTML5",{enumerable:!0,get:function(){return o.encodeHTML}});var a=Yc;Object.defineProperty(i,"decodeXML",{enumerable:!0,get:function(){return a.decodeXML}}),Object.defineProperty(i,"decodeHTML",{enumerable:!0,get:function(){return a.decodeHTML}}),Object.defineProperty(i,"decodeHTMLStrict",{enumerable:!0,get:function(){return a.decodeHTMLStrict}}),Object.defineProperty(i,"decodeHTML4",{enumerable:!0,get:function(){return a.decodeHTML}}),Object.defineProperty(i,"decodeHTML5",{enumerable:!0,get:function(){return a.decodeHTML}}),Object.defineProperty(i,"decodeHTML4Strict",{enumerable:!0,get:function(){return a.decodeHTMLStrict}}),Object.defineProperty(i,"decodeHTML5Strict",{enumerable:!0,get:function(){return a.decodeHTMLStrict}}),Object.defineProperty(i,"decodeXMLStrict",{enumerable:!0,get:function(){return a.decodeXML}})})(EN);var yf={};Object.defineProperty(yf,"__esModule",{value:!0});yf.attributeNames=yf.elementNames=void 0;yf.elementNames=new Map([["altglyph","altGlyph"],["altglyphdef","altGlyphDef"],["altglyphitem","altGlyphItem"],["animatecolor","animateColor"],["animatemotion","animateMotion"],["animatetransform","animateTransform"],["clippath","clipPath"],["feblend","feBlend"],["fecolormatrix","feColorMatrix"],["fecomponenttransfer","feComponentTransfer"],["fecomposite","feComposite"],["feconvolvematrix","feConvolveMatrix"],["fediffuselighting","feDiffuseLighting"],["fedisplacementmap","feDisplacementMap"],["fedistantlight","feDistantLight"],["fedropshadow","feDropShadow"],["feflood","feFlood"],["fefunca","feFuncA"],["fefuncb","feFuncB"],["fefuncg","feFuncG"],["fefuncr","feFuncR"],["fegaussianblur","feGaussianBlur"],["feimage","feImage"],["femerge","feMerge"],["femergenode","feMergeNode"],["femorphology","feMorphology"],["feoffset","feOffset"],["fepointlight","fePointLight"],["fespecularlighting","feSpecularLighting"],["fespotlight","feSpotLight"],["fetile","feTile"],["feturbulence","feTurbulence"],["foreignobject","foreignObject"],["glyphref","glyphRef"],["lineargradient","linearGradient"],["radialgradient","radialGradient"],["textpath","textPath"]]);yf.attributeNames=new Map([["definitionurl","definitionURL"],["attributename","attributeName"],["attributetype","attributeType"],["basefrequency","baseFrequency"],["baseprofile","baseProfile"],["calcmode","calcMode"],["clippathunits","clipPathUnits"],["diffuseconstant","diffuseConstant"],["edgemode","edgeMode"],["filterunits","filterUnits"],["glyphref","glyphRef"],["gradienttransform","gradientTransform"],["gradientunits","gradientUnits"],["kernelmatrix","kernelMatrix"],["kernelunitlength","kernelUnitLength"],["keypoints","keyPoints"],["keysplines","keySplines"],["keytimes","keyTimes"],["lengthadjust","lengthAdjust"],["limitingconeangle","limitingConeAngle"],["markerheight","markerHeight"],["markerunits","markerUnits"],["markerwidth","markerWidth"],["maskcontentunits","maskContentUnits"],["maskunits","maskUnits"],["numoctaves","numOctaves"],["pathlength","pathLength"],["patterncontentunits","patternContentUnits"],["patterntransform","patternTransform"],["patternunits","patternUnits"],["pointsatx","pointsAtX"],["pointsaty","pointsAtY"],["pointsatz","pointsAtZ"],["preservealpha","preserveAlpha"],["preserveaspectratio","preserveAspectRatio"],["primitiveunits","primitiveUnits"],["refx","refX"],["refy","refY"],["repeatcount","repeatCount"],["repeatdur","repeatDur"],["requiredextensions","requiredExtensions"],["requiredfeatures","requiredFeatures"],["specularconstant","specularConstant"],["specularexponent","specularExponent"],["spreadmethod","spreadMethod"],["startoffset","startOffset"],["stddeviation","stdDeviation"],["stitchtiles","stitchTiles"],["surfacescale","surfaceScale"],["systemlanguage","systemLanguage"],["tablevalues","tableValues"],["targetx","targetX"],["targety","targetY"],["textlength","textLength"],["viewbox","viewBox"],["viewtarget","viewTarget"],["xchannelselector","xChannelSelector"],["ychannelselector","yChannelSelector"],["zoomandpan","zoomAndPan"]]);var Qp=zt&&zt.__assign||function(){return Qp=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Qp.apply(this,arguments)},tDt=zt&&zt.__createBinding||(Object.create?function(i,t,e,n){n===void 0&&(n=e),Object.defineProperty(i,n,{enumerable:!0,get:function(){return t[e]}})}:function(i,t,e,n){n===void 0&&(n=e),i[n]=t[e]}),eDt=zt&&zt.__setModuleDefault||(Object.create?function(i,t){Object.defineProperty(i,"default",{enumerable:!0,value:t})}:function(i,t){i.default=t}),nDt=zt&&zt.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)e!=="default"&&Object.prototype.hasOwnProperty.call(i,e)&&tDt(t,i,e);return eDt(t,i),t};Object.defineProperty(oT,"__esModule",{value:!0});var Uc=nDt(Av),FN=EN,VN=yf,iDt=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function rDt(i,t){if(i)return Object.keys(i).map(function(e){var n,r,s=(n=i[e])!==null&&n!==void 0?n:"";return t.xmlMode==="foreign"&&(e=(r=VN.attributeNames.get(e))!==null&&r!==void 0?r:e),!t.emptyAttrs&&!t.xmlMode&&s===""?e:e+'="'+(t.decodeEntities!==!1?FN.encodeXML(s):s.replace(/"/g,"&quot;"))+'"'}).join(" ")}var LR=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function cT(i,t){t===void 0&&(t={});for(var e=("length"in i)?i:[i],n="",r=0;r<e.length;r++)n+=sDt(e[r],t);return n}oT.default=cT;function sDt(i,t){switch(i.type){case Uc.Root:return cT(i.children,t);case Uc.Directive:case Uc.Doctype:return cDt(i);case Uc.Comment:return dDt(i);case Uc.CDATA:return hDt(i);case Uc.Script:case Uc.Style:case Uc.Tag:return lDt(i,t);case Uc.Text:return uDt(i,t)}}var oDt=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),aDt=new Set(["svg","math"]);function lDt(i,t){var e;t.xmlMode==="foreign"&&(i.name=(e=VN.elementNames.get(i.name))!==null&&e!==void 0?e:i.name,i.parent&&oDt.has(i.parent.name)&&(t=Qp(Qp({},t),{xmlMode:!1}))),!t.xmlMode&&aDt.has(i.name)&&(t=Qp(Qp({},t),{xmlMode:"foreign"}));var n="<"+i.name,r=rDt(i.attribs,t);return r&&(n+=" "+r),i.children.length===0&&(t.xmlMode?t.selfClosingTags!==!1:t.selfClosingTags&&LR.has(i.name))?(t.xmlMode||(n+=" "),n+="/>"):(n+=">",i.children.length>0&&(n+=cT(i.children,t)),(t.xmlMode||!LR.has(i.name))&&(n+="</"+i.name+">")),n}function cDt(i){return"<"+i.data+">"}function uDt(i,t){var e=i.data||"";return t.decodeEntities!==!1&&!(!t.xmlMode&&i.parent&&iDt.has(i.parent.name))&&(e=FN.encodeXML(e)),e}function hDt(i){return"<![CDATA["+i.children[0].data+"]]>"}function dDt(i){return"<!--"+i.data+"-->"}var pDt=zt&&zt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(la,"__esModule",{value:!0});la.innerText=la.textContent=la.getText=la.getInnerHTML=la.getOuterHTML=void 0;var Kl=qd,fDt=pDt(oT),mDt=Av;function BN(i,t){return(0,fDt.default)(i,t)}la.getOuterHTML=BN;function gDt(i,t){return(0,Kl.hasChildren)(i)?i.children.map(function(e){return BN(e,t)}).join(""):""}la.getInnerHTML=gDt;function Ib(i){return Array.isArray(i)?i.map(Ib).join(""):(0,Kl.isTag)(i)?i.name==="br"?`
`:Ib(i.children):(0,Kl.isCDATA)(i)?Ib(i.children):(0,Kl.isText)(i)?i.data:""}la.getText=Ib;function rC(i){return Array.isArray(i)?i.map(rC).join(""):(0,Kl.hasChildren)(i)&&!(0,Kl.isComment)(i)?rC(i.children):(0,Kl.isText)(i)?i.data:""}la.textContent=rC;function sC(i){return Array.isArray(i)?i.map(sC).join(""):(0,Kl.hasChildren)(i)&&(i.type===mDt.ElementType.Tag||(0,Kl.isCDATA)(i))?sC(i.children):(0,Kl.isText)(i)?i.data:""}la.innerText=sC;var vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.prevElementSibling=vs.nextElementSibling=vs.getName=vs.hasAttrib=vs.getAttributeValue=vs.getSiblings=vs.getParent=vs.getChildren=void 0;var HN=qd,vDt=[];function $N(i){var t;return(t=i.children)!==null&&t!==void 0?t:vDt}vs.getChildren=$N;function GN(i){return i.parent||null}vs.getParent=GN;function _Dt(i){var t,e,n=GN(i);if(n!=null)return $N(n);for(var r=[i],s=i.prev,o=i.next;s!=null;)r.unshift(s),t=s,s=t.prev;for(;o!=null;)r.push(o),e=o,o=e.next;return r}vs.getSiblings=_Dt;function bDt(i,t){var e;return(e=i.attribs)===null||e===void 0?void 0:e[t]}vs.getAttributeValue=bDt;function yDt(i,t){return i.attribs!=null&&Object.prototype.hasOwnProperty.call(i.attribs,t)&&i.attribs[t]!=null}vs.hasAttrib=yDt;function xDt(i){return i.name}vs.getName=xDt;function wDt(i){for(var t,e=i.next;e!==null&&!(0,HN.isTag)(e);)t=e,e=t.next;return e}vs.nextElementSibling=wDt;function SDt(i){for(var t,e=i.prev;e!==null&&!(0,HN.isTag)(e);)t=e,e=t.prev;return e}vs.prevElementSibling=SDt;var Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.prepend=Ro.prependChild=Ro.append=Ro.appendChild=Ro.replaceElement=Ro.removeElement=void 0;function Pv(i){if(i.prev&&(i.prev.next=i.next),i.next&&(i.next.prev=i.prev),i.parent){var t=i.parent.children;t.splice(t.lastIndexOf(i),1)}}Ro.removeElement=Pv;function MDt(i,t){var e=t.prev=i.prev;e&&(e.next=t);var n=t.next=i.next;n&&(n.prev=t);var r=t.parent=i.parent;if(r){var s=r.children;s[s.lastIndexOf(i)]=t}}Ro.replaceElement=MDt;function CDt(i,t){if(Pv(t),t.next=null,t.parent=i,i.children.push(t)>1){var e=i.children[i.children.length-2];e.next=t,t.prev=e}else t.prev=null}Ro.appendChild=CDt;function EDt(i,t){Pv(t);var e=i.parent,n=i.next;if(t.next=n,t.prev=i,i.next=t,t.parent=e,n){if(n.prev=t,e){var r=e.children;r.splice(r.lastIndexOf(n),0,t)}}else e&&e.children.push(t)}Ro.append=EDt;function TDt(i,t){if(Pv(t),t.parent=i,t.prev=null,i.children.unshift(t)!==1){var e=i.children[1];e.prev=t,t.next=e}else t.next=null}Ro.prependChild=TDt;function ADt(i,t){Pv(t);var e=i.parent;if(e){var n=e.children;n.splice(n.indexOf(i),0,t)}i.prev&&(i.prev.next=t),t.parent=e,t.prev=i.prev,t.next=i,i.prev=t}Ro.prepend=ADt;var so={};Object.defineProperty(so,"__esModule",{value:!0});so.findAll=so.existsOne=so.findOne=so.findOneChild=so.find=so.filter=void 0;var Jg=qd;function PDt(i,t,e,n){return e===void 0&&(e=!0),n===void 0&&(n=1/0),Array.isArray(t)||(t=[t]),uT(i,t,e,n)}so.filter=PDt;function uT(i,t,e,n){for(var r=[],s=0,o=t;s<o.length;s++){var a=o[s];if(i(a)&&(r.push(a),--n<=0))break;if(e&&(0,Jg.hasChildren)(a)&&a.children.length>0){var l=uT(i,a.children,e,n);if(r.push.apply(r,l),n-=l.length,n<=0)break}}return r}so.find=uT;function RDt(i,t){return t.find(i)}so.findOneChild=RDt;function qN(i,t,e){e===void 0&&(e=!0);for(var n=null,r=0;r<t.length&&!n;r++){var s=t[r];if((0,Jg.isTag)(s))i(s)?n=s:e&&s.children.length>0&&(n=qN(i,s.children));else continue}return n}so.findOne=qN;function WN(i,t){return t.some(function(e){return(0,Jg.isTag)(e)&&(i(e)||e.children.length>0&&WN(i,e.children))})}so.existsOne=WN;function kDt(i,t){for(var e,n=[],r=t.filter(Jg.isTag),s;s=r.shift();){var o=(e=s.children)===null||e===void 0?void 0:e.filter(Jg.isTag);o&&o.length>0&&r.unshift.apply(r,o),i(s)&&n.push(s)}return n}so.findAll=kDt;var ua={};Object.defineProperty(ua,"__esModule",{value:!0});ua.getElementsByTagType=ua.getElementsByTagName=ua.getElementById=ua.getElements=ua.testElement=void 0;var hd=qd,px=so,ty={tag_name:function(i){return typeof i=="function"?function(t){return(0,hd.isTag)(t)&&i(t.name)}:i==="*"?hd.isTag:function(t){return(0,hd.isTag)(t)&&t.name===i}},tag_type:function(i){return typeof i=="function"?function(t){return i(t.type)}:function(t){return t.type===i}},tag_contains:function(i){return typeof i=="function"?function(t){return(0,hd.isText)(t)&&i(t.data)}:function(t){return(0,hd.isText)(t)&&t.data===i}}};function jN(i,t){return typeof t=="function"?function(e){return(0,hd.isTag)(e)&&t(e.attribs[i])}:function(e){return(0,hd.isTag)(e)&&e.attribs[i]===t}}function LDt(i,t){return function(e){return i(e)||t(e)}}function XN(i){var t=Object.keys(i).map(function(e){var n=i[e];return Object.prototype.hasOwnProperty.call(ty,e)?ty[e](n):jN(e,n)});return t.length===0?null:t.reduce(LDt)}function ODt(i,t){var e=XN(i);return e?e(t):!0}ua.testElement=ODt;function DDt(i,t,e,n){n===void 0&&(n=1/0);var r=XN(i);return r?(0,px.filter)(r,t,e,n):[]}ua.getElements=DDt;function IDt(i,t,e){return e===void 0&&(e=!0),Array.isArray(t)||(t=[t]),(0,px.findOne)(jN("id",i),t,e)}ua.getElementById=IDt;function NDt(i,t,e,n){return e===void 0&&(e=!0),n===void 0&&(n=1/0),(0,px.filter)(ty.tag_name(i),t,e,n)}ua.getElementsByTagName=NDt;function zDt(i,t,e,n){return e===void 0&&(e=!0),n===void 0&&(n=1/0),(0,px.filter)(ty.tag_type(i),t,e,n)}ua.getElementsByTagType=zDt;var Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.uniqueSort=Wu.compareDocumentPosition=Wu.removeSubsets=void 0;var OR=qd;function UDt(i){for(var t=i.length;--t>=0;){var e=i[t];if(t>0&&i.lastIndexOf(e,t-1)>=0){i.splice(t,1);continue}for(var n=e.parent;n;n=n.parent)if(i.includes(n)){i.splice(t,1);break}}return i}Wu.removeSubsets=UDt;function YN(i,t){var e=[],n=[];if(i===t)return 0;for(var r=(0,OR.hasChildren)(i)?i:i.parent;r;)e.unshift(r),r=r.parent;for(r=(0,OR.hasChildren)(t)?t:t.parent;r;)n.unshift(r),r=r.parent;for(var s=Math.min(e.length,n.length),o=0;o<s&&e[o]===n[o];)o++;if(o===0)return 1;var a=e[o-1],l=a.children,c=e[o],u=n[o];return l.indexOf(c)>l.indexOf(u)?a===t?20:4:a===i?10:2}Wu.compareDocumentPosition=YN;function FDt(i){return i=i.filter(function(t,e,n){return!n.includes(t,e+1)}),i.sort(function(t,e){var n=YN(t,e);return n&2?-1:n&4?1:0}),i}Wu.uniqueSort=FDt;var fx={};Object.defineProperty(fx,"__esModule",{value:!0});fx.getFeed=void 0;var VDt=la,Rv=ua;function BDt(i){var t=ey(WDt,i);return t?t.name==="feed"?HDt(t):$Dt(t):null}fx.getFeed=BDt;function HDt(i){var t,e=i.children,n={type:"atom",items:(0,Rv.getElementsByTagName)("entry",e).map(function(o){var a,l=o.children,c={media:KN(l)};Ao(c,"id","id",l),Ao(c,"title","title",l);var u=(a=ey("link",l))===null||a===void 0?void 0:a.attribs.href;u&&(c.link=u);var h=vd("summary",l)||vd("content",l);h&&(c.description=h);var p=vd("updated",l);return p&&(c.pubDate=new Date(p)),c})};Ao(n,"id","id",e),Ao(n,"title","title",e);var r=(t=ey("link",e))===null||t===void 0?void 0:t.attribs.href;r&&(n.link=r),Ao(n,"description","subtitle",e);var s=vd("updated",e);return s&&(n.updated=new Date(s)),Ao(n,"author","email",e,!0),n}function $Dt(i){var t,e,n=(e=(t=ey("channel",i.children))===null||t===void 0?void 0:t.children)!==null&&e!==void 0?e:[],r={type:i.name.substr(0,3),id:"",items:(0,Rv.getElementsByTagName)("item",i.children).map(function(o){var a=o.children,l={media:KN(a)};Ao(l,"id","guid",a),Ao(l,"title","title",a),Ao(l,"link","link",a),Ao(l,"description","description",a);var c=vd("pubDate",a);return c&&(l.pubDate=new Date(c)),l})};Ao(r,"title","title",n),Ao(r,"link","link",n),Ao(r,"description","description",n);var s=vd("lastBuildDate",n);return s&&(r.updated=new Date(s)),Ao(r,"author","managingEditor",n,!0),r}var GDt=["url","type","lang"],qDt=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function KN(i){return(0,Rv.getElementsByTagName)("media:content",i).map(function(t){for(var e=t.attribs,n={medium:e.medium,isDefault:!!e.isDefault},r=0,s=GDt;r<s.length;r++){var o=s[r];e[o]&&(n[o]=e[o])}for(var a=0,l=qDt;a<l.length;a++){var o=l[a];e[o]&&(n[o]=parseInt(e[o],10))}return e.expression&&(n.expression=e.expression),n})}function ey(i,t){return(0,Rv.getElementsByTagName)(i,t,!0,1)[0]}function vd(i,t,e){return e===void 0&&(e=!1),(0,VDt.textContent)((0,Rv.getElementsByTagName)(i,t,e,1)).trim()}function Ao(i,t,e,n,r){r===void 0&&(r=!1);var s=vd(e,n,r);s&&(i[t]=s)}function WDt(i){return i==="rss"||i==="feed"||i==="rdf:RDF"}(function(i){var t=zt&&zt.__createBinding||(Object.create?function(r,s,o,a){a===void 0&&(a=o),Object.defineProperty(r,a,{enumerable:!0,get:function(){return s[o]}})}:function(r,s,o,a){a===void 0&&(a=o),r[a]=s[o]}),e=zt&&zt.__exportStar||function(r,s){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&t(s,r,o)};Object.defineProperty(i,"__esModule",{value:!0}),i.hasChildren=i.isDocument=i.isComment=i.isText=i.isCDATA=i.isTag=void 0,e(la,i),e(vs,i),e(Ro,i),e(so,i),e(ua,i),e(Wu,i),e(fx,i);var n=qd;Object.defineProperty(i,"isTag",{enumerable:!0,get:function(){return n.isTag}}),Object.defineProperty(i,"isCDATA",{enumerable:!0,get:function(){return n.isCDATA}}),Object.defineProperty(i,"isText",{enumerable:!0,get:function(){return n.isText}}),Object.defineProperty(i,"isComment",{enumerable:!0,get:function(){return n.isComment}}),Object.defineProperty(i,"isDocument",{enumerable:!0,get:function(){return n.isDocument}}),Object.defineProperty(i,"hasChildren",{enumerable:!0,get:function(){return n.hasChildren}})})(fN);var jd={trueFunc:function(){return!0},falseFunc:function(){return!1}},ju={},Fn;(function(i){i.Attribute="attribute",i.Pseudo="pseudo",i.PseudoElement="pseudo-element",i.Tag="tag",i.Universal="universal",i.Adjacent="adjacent",i.Child="child",i.Descendant="descendant",i.Parent="parent",i.Sibling="sibling",i.ColumnCombinator="column-combinator"})(Fn||(Fn={}));const jDt={Unknown:null,QuirksMode:"quirks",IgnoreCase:!0,CaseSensitive:!1};var Gi;(function(i){i.Any="any",i.Element="element",i.End="end",i.Equals="equals",i.Exists="exists",i.Hyphen="hyphen",i.Not="not",i.Start="start"})(Gi||(Gi={}));const DR=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,XDt=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,YDt=new Map([[126,Gi.Element],[94,Gi.Start],[36,Gi.End],[42,Gi.Any],[33,Gi.Not],[124,Gi.Hyphen]]),KDt=new Set(["has","not","matches","is","where","host","host-context"]);function ZN(i){switch(i.type){case Fn.Adjacent:case Fn.Child:case Fn.Descendant:case Fn.Parent:case Fn.Sibling:case Fn.ColumnCombinator:return!0;default:return!1}}const ZDt=new Set(["contains","icontains"]);function JDt(i,t,e){const n=parseInt(t,16)-65536;return n!==n||e?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function jm(i){return i.replace(XDt,JDt)}function xS(i){return i===39||i===34}function IR(i){return i===32||i===9||i===10||i===12||i===13}function QDt(i){const t=[],e=JN(t,`${i}`,0);if(e<i.length)throw new Error(`Unmatched selector: ${i.slice(e)}`);return t}function JN(i,t,e){let n=[];function r(p){const m=t.slice(e+p).match(DR);if(!m)throw new Error(`Expected name, found ${t.slice(e)}`);const[v]=m;return e+=p+v.length,jm(v)}function s(p){for(e+=p;e<t.length&&IR(t.charCodeAt(e));)e++}function o(){e+=1;const p=e;let m=1;for(;m>0&&e<t.length;e++)t.charCodeAt(e)===40&&!a(e)?m++:t.charCodeAt(e)===41&&!a(e)&&m--;if(m)throw new Error("Parenthesis not matched");return jm(t.slice(p,e-1))}function a(p){let m=0;for(;t.charCodeAt(--p)===92;)m++;return(m&1)===1}function l(){if(n.length>0&&ZN(n[n.length-1]))throw new Error("Did not expect successive traversals.")}function c(p){if(n.length>0&&n[n.length-1].type===Fn.Descendant){n[n.length-1].type=p;return}l(),n.push({type:p})}function u(p,m){n.push({type:Fn.Attribute,name:p,action:m,value:r(1),namespace:null,ignoreCase:"quirks"})}function h(){if(n.length&&n[n.length-1].type===Fn.Descendant&&n.pop(),n.length===0)throw new Error("Empty sub-selector");i.push(n)}if(s(0),t.length===e)return e;t:for(;e<t.length;){const p=t.charCodeAt(e);switch(p){case 32:case 9:case 10:case 12:case 13:{(n.length===0||n[0].type!==Fn.Descendant)&&(l(),n.push({type:Fn.Descendant})),s(1);break}case 62:{c(Fn.Child),s(1);break}case 60:{c(Fn.Parent),s(1);break}case 126:{c(Fn.Sibling),s(1);break}case 43:{c(Fn.Adjacent),s(1);break}case 46:{u("class",Gi.Element);break}case 35:{u("id",Gi.Equals);break}case 91:{s(1);let m,v=null;t.charCodeAt(e)===124?m=r(1):t.startsWith("*|",e)?(v="*",m=r(2)):(m=r(0),t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==61&&(v=m,m=r(1))),s(0);let _=Gi.Exists;const b=YDt.get(t.charCodeAt(e));if(b){if(_=b,t.charCodeAt(e+1)!==61)throw new Error("Expected `=`");s(2)}else t.charCodeAt(e)===61&&(_=Gi.Equals,s(1));let y="",M=null;if(_!=="exists"){if(xS(t.charCodeAt(e))){const A=t.charCodeAt(e);let R=e+1;for(;R<t.length&&(t.charCodeAt(R)!==A||a(R));)R+=1;if(t.charCodeAt(R)!==A)throw new Error("Attribute value didn't end");y=jm(t.slice(e+1,R)),e=R+1}else{const A=e;for(;e<t.length&&(!IR(t.charCodeAt(e))&&t.charCodeAt(e)!==93||a(e));)e+=1;y=jm(t.slice(A,e))}s(0);const E=t.charCodeAt(e)|32;E===115?(M=!1,s(1)):E===105&&(M=!0,s(1))}if(t.charCodeAt(e)!==93)throw new Error("Attribute selector didn't terminate");e+=1;const S={type:Fn.Attribute,name:m,action:_,value:y,namespace:v,ignoreCase:M};n.push(S);break}case 58:{if(t.charCodeAt(e+1)===58){n.push({type:Fn.PseudoElement,name:r(2).toLowerCase(),data:t.charCodeAt(e)===40?o():null});continue}const m=r(1).toLowerCase();let v=null;if(t.charCodeAt(e)===40)if(KDt.has(m)){if(xS(t.charCodeAt(e+1)))throw new Error(`Pseudo-selector ${m} cannot be quoted`);if(v=[],e=JN(v,t,e+1),t.charCodeAt(e)!==41)throw new Error(`Missing closing parenthesis in :${m} (${t})`);e+=1}else{if(v=o(),ZDt.has(m)){const _=v.charCodeAt(0);_===v.charCodeAt(v.length-1)&&xS(_)&&(v=v.slice(1,-1))}v=jm(v)}n.push({type:Fn.Pseudo,name:m,data:v});break}case 44:{h(),n=[],s(1);break}default:{if(t.startsWith("/*",e)){const _=t.indexOf("*/",e+2);if(_<0)throw new Error("Comment was not terminated");e=_+2,n.length===0&&s(0);break}let m=null,v;if(p===42)e+=1,v="*";else if(p===124){if(v="",t.charCodeAt(e+1)===124){c(Fn.ColumnCombinator),s(2);break}}else if(DR.test(t.slice(e)))v=r(0);else break t;t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==124&&(m=v,t.charCodeAt(e+1)===42?(v="*",e+=2):v=r(1)),n.push(v==="*"?{type:Fn.Universal,namespace:m}:{type:Fn.Tag,name:v,namespace:m})}}}return h(),e}const QN=["\\",'"'],tz=[...QN,"(",")"],tIt=new Set(QN.map(i=>i.charCodeAt(0))),NR=new Set(tz.map(i=>i.charCodeAt(0))),tf=new Set([...tz,"~","^","$","*","+","!","|",":","[","]"," ","."].map(i=>i.charCodeAt(0)));function ez(i){return i.map(t=>t.map(eIt).join("")).join(", ")}function eIt(i,t,e){switch(i.type){case Fn.Child:return t===0?"> ":" > ";case Fn.Parent:return t===0?"< ":" < ";case Fn.Sibling:return t===0?"~ ":" ~ ";case Fn.Adjacent:return t===0?"+ ":" + ";case Fn.Descendant:return" ";case Fn.ColumnCombinator:return t===0?"|| ":" || ";case Fn.Universal:return i.namespace==="*"&&t+1<e.length&&"name"in e[t+1]?"":`${nz(i.namespace)}*`;case Fn.Tag:return zR(i);case Fn.PseudoElement:return`::${Bc(i.name,tf)}${i.data===null?"":`(${Bc(i.data,NR)})`}`;case Fn.Pseudo:return`:${Bc(i.name,tf)}${i.data===null?"":`(${typeof i.data=="string"?Bc(i.data,NR):ez(i.data)})`}`;case Fn.Attribute:{if(i.name==="id"&&i.action===Gi.Equals&&i.ignoreCase==="quirks"&&!i.namespace)return`#${Bc(i.value,tf)}`;if(i.name==="class"&&i.action===Gi.Element&&i.ignoreCase==="quirks"&&!i.namespace)return`.${Bc(i.value,tf)}`;const n=zR(i);return i.action===Gi.Exists?`[${n}]`:`[${n}${nIt(i.action)}="${Bc(i.value,tIt)}"${i.ignoreCase===null?"":i.ignoreCase?" i":" s"}]`}}}function nIt(i){switch(i){case Gi.Equals:return"";case Gi.Element:return"~";case Gi.Start:return"^";case Gi.End:return"$";case Gi.Any:return"*";case Gi.Not:return"!";case Gi.Hyphen:return"|";case Gi.Exists:throw new Error("Shouldn't be here")}}function zR(i){return`${nz(i.namespace)}${Bc(i.name,tf)}`}function nz(i){return i!==null?`${i==="*"?"*":Bc(i,tf)}|`:""}function Bc(i,t){let e=0,n="";for(let r=0;r<i.length;r++)t.has(i.charCodeAt(r))&&(n+=`${i.slice(e,r)}\\${i.charAt(r)}`,e=r+1);return n.length>0?n+i.slice(e):i}const iIt=Object.freeze(Object.defineProperty({__proto__:null,get AttributeAction(){return Gi},IgnoreCaseMode:jDt,get SelectorType(){return Fn},isTraversal:ZN,parse:QDt,stringify:ez},Symbol.toStringTag,{value:"Module"})),mx=tG(iIt);var hT={},gx={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.isTraversal=i.procedure=void 0,i.procedure={universal:50,tag:30,attribute:1,pseudo:0,"pseudo-element":0,"column-combinator":-1,descendant:-1,child:-1,parent:-1,sibling:-1,adjacent:-1,_flexibleDescendant:-1};function t(e){return i.procedure[e.type]<0}i.isTraversal=t})(gx);Object.defineProperty(hT,"__esModule",{value:!0});var UR=mx,rIt=gx,FR={exists:10,equals:8,not:7,start:6,end:6,any:5,hyphen:4,element:4};function sIt(i){for(var t=i.map(iz),e=1;e<i.length;e++){var n=t[e];if(!(n<0))for(var r=e-1;r>=0&&n<t[r];r--){var s=i[r+1];i[r+1]=i[r],i[r]=s,t[r+1]=t[r],t[r]=n}}}hT.default=sIt;function iz(i){var t=rIt.procedure[i.type];if(i.type===UR.SelectorType.Attribute)t=FR[i.action],t===FR.equals&&i.name==="id"&&(t=9),i.ignoreCase&&(t>>=1);else if(i.type===UR.SelectorType.Pseudo)if(!i.data)t=3;else if(i.name==="has"||i.name==="contains")t=0;else if(Array.isArray(i.data)){t=0;for(var e=0;e<i.data.length;e++)if(i.data[e].length===1){var n=iz(i.data[e][0]);if(n===0){t=0;break}n>t&&(t=n)}i.data.length>1&&t>0&&(t-=1)}else t=1;return t}var vx={},_x={};Object.defineProperty(_x,"__esModule",{value:!0});_x.attributeRules=void 0;var nb=jd,oIt=/[-[\]{}()*+?.,\\^$|#\s]/g;function VR(i){return i.replace(oIt,"\\$&")}var aIt=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function Qh(i,t){return typeof i.ignoreCase=="boolean"?i.ignoreCase:i.ignoreCase==="quirks"?!!t.quirksMode:!t.xmlMode&&aIt.has(i.name)}_x.attributeRules={equals:function(i,t,e){var n=e.adapter,r=t.name,s=t.value;return Qh(t,e)?(s=s.toLowerCase(),function(o){var a=n.getAttributeValue(o,r);return a!=null&&a.length===s.length&&a.toLowerCase()===s&&i(o)}):function(o){return n.getAttributeValue(o,r)===s&&i(o)}},hyphen:function(i,t,e){var n=e.adapter,r=t.name,s=t.value,o=s.length;return Qh(t,e)?(s=s.toLowerCase(),function(l){var c=n.getAttributeValue(l,r);return c!=null&&(c.length===o||c.charAt(o)==="-")&&c.substr(0,o).toLowerCase()===s&&i(l)}):function(l){var c=n.getAttributeValue(l,r);return c!=null&&(c.length===o||c.charAt(o)==="-")&&c.substr(0,o)===s&&i(l)}},element:function(i,t,e){var n=e.adapter,r=t.name,s=t.value;if(/\s/.test(s))return nb.falseFunc;var o=new RegExp("(?:^|\\s)".concat(VR(s),"(?:$|\\s)"),Qh(t,e)?"i":"");return function(l){var c=n.getAttributeValue(l,r);return c!=null&&c.length>=s.length&&o.test(c)&&i(l)}},exists:function(i,t,e){var n=t.name,r=e.adapter;return function(s){return r.hasAttrib(s,n)&&i(s)}},start:function(i,t,e){var n=e.adapter,r=t.name,s=t.value,o=s.length;return o===0?nb.falseFunc:Qh(t,e)?(s=s.toLowerCase(),function(a){var l=n.getAttributeValue(a,r);return l!=null&&l.length>=o&&l.substr(0,o).toLowerCase()===s&&i(a)}):function(a){var l;return!!(!((l=n.getAttributeValue(a,r))===null||l===void 0)&&l.startsWith(s))&&i(a)}},end:function(i,t,e){var n=e.adapter,r=t.name,s=t.value,o=-s.length;return o===0?nb.falseFunc:Qh(t,e)?(s=s.toLowerCase(),function(a){var l;return((l=n.getAttributeValue(a,r))===null||l===void 0?void 0:l.substr(o).toLowerCase())===s&&i(a)}):function(a){var l;return!!(!((l=n.getAttributeValue(a,r))===null||l===void 0)&&l.endsWith(s))&&i(a)}},any:function(i,t,e){var n=e.adapter,r=t.name,s=t.value;if(s==="")return nb.falseFunc;if(Qh(t,e)){var o=new RegExp(VR(s),"i");return function(l){var c=n.getAttributeValue(l,r);return c!=null&&c.length>=s.length&&o.test(c)&&i(l)}}return function(a){var l;return!!(!((l=n.getAttributeValue(a,r))===null||l===void 0)&&l.includes(s))&&i(a)}},not:function(i,t,e){var n=e.adapter,r=t.name,s=t.value;return s===""?function(o){return!!n.getAttributeValue(o,r)&&i(o)}:Qh(t,e)?(s=s.toLowerCase(),function(o){var a=n.getAttributeValue(o,r);return(a==null||a.length!==s.length||a.toLowerCase()!==s)&&i(o)}):function(o){return n.getAttributeValue(o,r)!==s&&i(o)}}};var dT={},rz={},sz={},bx={};Object.defineProperty(bx,"__esModule",{value:!0});bx.parse=void 0;var lIt=new Set([9,10,12,13,32]),BR="0".charCodeAt(0),cIt="9".charCodeAt(0);function uIt(i){if(i=i.trim().toLowerCase(),i==="even")return[2,0];if(i==="odd")return[2,1];var t=0,e=0,n=s(),r=o();if(t<i.length&&i.charAt(t)==="n"&&(t++,e=n*(r??1),a(),t<i.length?(n=s(),a(),r=o()):n=r=0),r===null||t<i.length)throw new Error("n-th rule couldn't be parsed ('".concat(i,"')"));return[e,n*r];function s(){return i.charAt(t)==="-"?(t++,-1):(i.charAt(t)==="+"&&t++,1)}function o(){for(var l=t,c=0;t<i.length&&i.charCodeAt(t)>=BR&&i.charCodeAt(t)<=cIt;)c=c*10+(i.charCodeAt(t)-BR),t++;return t===l?null:c}function a(){for(;t<i.length&&lIt.has(i.charCodeAt(t));)t++}}bx.parse=uIt;var xf={},hIt=zt&&zt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(xf,"__esModule",{value:!0});xf.generate=xf.compile=void 0;var HR=hIt(jd);function dIt(i){var t=i[0],e=i[1]-1;if(e<0&&t<=0)return HR.default.falseFunc;if(t===-1)return function(s){return s<=e};if(t===0)return function(s){return s===e};if(t===1)return e<0?HR.default.trueFunc:function(s){return s>=e};var n=Math.abs(t),r=(e%n+n)%n;return t>1?function(s){return s>=e&&s%n===r}:function(s){return s<=e&&s%n===r}}xf.compile=dIt;function pIt(i){var t=i[0],e=i[1]-1,n=0;if(t<0){var r=-t,s=(e%r+r)%r;return function(){var o=s+r*n++;return o>e?null:o}}return t===0?e<0?function(){return null}:function(){return n++===0?e:null}:(e<0&&(e+=t*Math.ceil(-e/t)),function(){return t*n+++e})}xf.generate=pIt;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sequence=i.generate=i.compile=i.parse=void 0;var t=bx;Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return t.parse}});var e=xf;Object.defineProperty(i,"compile",{enumerable:!0,get:function(){return e.compile}}),Object.defineProperty(i,"generate",{enumerable:!0,get:function(){return e.generate}});function n(s){return(0,e.compile)((0,t.parse)(s))}i.default=n;function r(s){return(0,e.generate)((0,t.parse)(s))}i.sequence=r})(sz);(function(i){var t=zt&&zt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(i,"__esModule",{value:!0}),i.filters=void 0;var e=t(sz),n=jd;function r(o,a){return function(l){var c=a.getParent(l);return c!=null&&a.isTag(c)&&o(l)}}i.filters={contains:function(o,a,l){var c=l.adapter;return function(h){return o(h)&&c.getText(h).includes(a)}},icontains:function(o,a,l){var c=l.adapter,u=a.toLowerCase();return function(p){return o(p)&&c.getText(p).toLowerCase().includes(u)}},"nth-child":function(o,a,l){var c=l.adapter,u=l.equals,h=(0,e.default)(a);return h===n.falseFunc?n.falseFunc:h===n.trueFunc?r(o,c):function(m){for(var v=c.getSiblings(m),_=0,b=0;b<v.length&&!u(m,v[b]);b++)c.isTag(v[b])&&_++;return h(_)&&o(m)}},"nth-last-child":function(o,a,l){var c=l.adapter,u=l.equals,h=(0,e.default)(a);return h===n.falseFunc?n.falseFunc:h===n.trueFunc?r(o,c):function(m){for(var v=c.getSiblings(m),_=0,b=v.length-1;b>=0&&!u(m,v[b]);b--)c.isTag(v[b])&&_++;return h(_)&&o(m)}},"nth-of-type":function(o,a,l){var c=l.adapter,u=l.equals,h=(0,e.default)(a);return h===n.falseFunc?n.falseFunc:h===n.trueFunc?r(o,c):function(m){for(var v=c.getSiblings(m),_=0,b=0;b<v.length;b++){var y=v[b];if(u(m,y))break;c.isTag(y)&&c.getName(y)===c.getName(m)&&_++}return h(_)&&o(m)}},"nth-last-of-type":function(o,a,l){var c=l.adapter,u=l.equals,h=(0,e.default)(a);return h===n.falseFunc?n.falseFunc:h===n.trueFunc?r(o,c):function(m){for(var v=c.getSiblings(m),_=0,b=v.length-1;b>=0;b--){var y=v[b];if(u(m,y))break;c.isTag(y)&&c.getName(y)===c.getName(m)&&_++}return h(_)&&o(m)}},root:function(o,a,l){var c=l.adapter;return function(u){var h=c.getParent(u);return(h==null||!c.isTag(h))&&o(u)}},scope:function(o,a,l,c){var u=l.equals;return!c||c.length===0?i.filters.root(o,a,l):c.length===1?function(h){return u(c[0],h)&&o(h)}:function(h){return c.includes(h)&&o(h)}},hover:s("isHovered"),visited:s("isVisited"),active:s("isActive")};function s(o){return function(l,c,u){var h=u.adapter,p=h[o];return typeof p!="function"?n.falseFunc:function(v){return p(v)&&l(v)}}}})(rz);var wf={};Object.defineProperty(wf,"__esModule",{value:!0});wf.verifyPseudoArgs=wf.pseudos=void 0;wf.pseudos={empty:function(i,t){var e=t.adapter;return!e.getChildren(i).some(function(n){return e.isTag(n)||e.getText(n)!==""})},"first-child":function(i,t){var e=t.adapter,n=t.equals,r=e.getSiblings(i).find(function(s){return e.isTag(s)});return r!=null&&n(i,r)},"last-child":function(i,t){for(var e=t.adapter,n=t.equals,r=e.getSiblings(i),s=r.length-1;s>=0;s--){if(n(i,r[s]))return!0;if(e.isTag(r[s]))break}return!1},"first-of-type":function(i,t){for(var e=t.adapter,n=t.equals,r=e.getSiblings(i),s=e.getName(i),o=0;o<r.length;o++){var a=r[o];if(n(i,a))return!0;if(e.isTag(a)&&e.getName(a)===s)break}return!1},"last-of-type":function(i,t){for(var e=t.adapter,n=t.equals,r=e.getSiblings(i),s=e.getName(i),o=r.length-1;o>=0;o--){var a=r[o];if(n(i,a))return!0;if(e.isTag(a)&&e.getName(a)===s)break}return!1},"only-of-type":function(i,t){var e=t.adapter,n=t.equals,r=e.getName(i);return e.getSiblings(i).every(function(s){return n(i,s)||!e.isTag(s)||e.getName(s)!==r})},"only-child":function(i,t){var e=t.adapter,n=t.equals;return e.getSiblings(i).every(function(r){return n(i,r)||!e.isTag(r)})}};function fIt(i,t,e){if(e===null){if(i.length>2)throw new Error("pseudo-selector :".concat(t," requires an argument"))}else if(i.length===2)throw new Error("pseudo-selector :".concat(t," doesn't have any arguments"))}wf.verifyPseudoArgs=fIt;var yx={};Object.defineProperty(yx,"__esModule",{value:!0});yx.aliases=void 0;yx.aliases={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"};var xx={};(function(i){var t=zt&&zt.__spreadArray||function(a,l,c){if(c||arguments.length===2)for(var u=0,h=l.length,p;u<h;u++)(p||!(u in l))&&(p||(p=Array.prototype.slice.call(l,0,u)),p[u]=l[u]);return a.concat(p||Array.prototype.slice.call(l))};Object.defineProperty(i,"__esModule",{value:!0}),i.subselects=i.getNextSiblings=i.ensureIsTag=i.PLACEHOLDER_ELEMENT=void 0;var e=jd,n=gx;i.PLACEHOLDER_ELEMENT={};function r(a,l){return a===e.falseFunc?e.falseFunc:function(c){return l.isTag(c)&&a(c)}}i.ensureIsTag=r;function s(a,l){var c=l.getSiblings(a);if(c.length<=1)return[];var u=c.indexOf(a);return u<0||u===c.length-1?[]:c.slice(u+1).filter(l.isTag)}i.getNextSiblings=s;var o=function(a,l,c,u,h){var p={xmlMode:!!c.xmlMode,adapter:c.adapter,equals:c.equals},m=h(l,p,u);return function(v){return m(v)&&a(v)}};i.subselects={is:o,matches:o,where:o,not:function(a,l,c,u,h){var p={xmlMode:!!c.xmlMode,adapter:c.adapter,equals:c.equals},m=h(l,p,u);return m===e.falseFunc?a:m===e.trueFunc?e.falseFunc:function(_){return!m(_)&&a(_)}},has:function(a,l,c,u,h){var p=c.adapter,m={xmlMode:!!c.xmlMode,adapter:p,equals:c.equals},v=l.some(function(S){return S.some(n.isTraversal)})?[i.PLACEHOLDER_ELEMENT]:void 0,_=h(l,m,v);if(_===e.falseFunc)return e.falseFunc;if(_===e.trueFunc)return function(S){return p.getChildren(S).some(p.isTag)&&a(S)};var b=r(_,p),y=_.shouldTestNextSiblings,M=y===void 0?!1:y;return v?function(S){v[0]=S;var E=p.getChildren(S),A=M?t(t([],E,!0),s(S,p),!0):E;return a(S)&&p.existsOne(b,A)}:function(S){return a(S)&&p.existsOne(b,p.getChildren(S))}}}})(xx);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.compilePseudoSelector=i.aliases=i.pseudos=i.filters=void 0;var t=jd,e=mx,n=rz;Object.defineProperty(i,"filters",{enumerable:!0,get:function(){return n.filters}});var r=wf;Object.defineProperty(i,"pseudos",{enumerable:!0,get:function(){return r.pseudos}});var s=yx;Object.defineProperty(i,"aliases",{enumerable:!0,get:function(){return s.aliases}});var o=xx;function a(l,c,u,h,p){var m=c.name,v=c.data;if(Array.isArray(v))return o.subselects[m](l,v,u,h,p);if(m in s.aliases){if(v!=null)throw new Error("Pseudo ".concat(m," doesn't have any arguments"));var _=(0,e.parse)(s.aliases[m]);return o.subselects.is(l,_,u,h,p)}if(m in n.filters)return n.filters[m](l,v,u,h);if(m in r.pseudos){var b=r.pseudos[m];return(0,r.verifyPseudoArgs)(b,m,v),b===t.falseFunc?t.falseFunc:l===t.trueFunc?function(y){return b(y,u,v)}:function(y){return b(y,u,v)&&l(y)}}throw new Error("unmatched pseudo-class :".concat(m))}i.compilePseudoSelector=a})(dT);Object.defineProperty(vx,"__esModule",{value:!0});vx.compileGeneralSelector=void 0;var mIt=_x,gIt=dT,ul=mx;function vIt(i,t,e,n,r){var s=e.adapter,o=e.equals;switch(t.type){case ul.SelectorType.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case ul.SelectorType.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case ul.SelectorType.Attribute:{if(t.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!e.xmlMode||e.lowerCaseAttributeNames)&&(t.name=t.name.toLowerCase()),mIt.attributeRules[t.action](i,t,e)}case ul.SelectorType.Pseudo:return(0,gIt.compilePseudoSelector)(i,t,e,n,r);case ul.SelectorType.Tag:{if(t.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");var a=t.name;return(!e.xmlMode||e.lowerCaseTags)&&(a=a.toLowerCase()),function(u){return s.getName(u)===a&&i(u)}}case ul.SelectorType.Descendant:{if(e.cacheResults===!1||typeof WeakSet>"u")return function(u){for(var h=u;h=s.getParent(h);)if(s.isTag(h)&&i(h))return!0;return!1};var l=new WeakSet;return function(u){for(var h=u;h=s.getParent(h);)if(!l.has(h)){if(s.isTag(h)&&i(h))return!0;l.add(h)}return!1}}case"_flexibleDescendant":return function(u){var h=u;do if(s.isTag(h)&&i(h))return!0;while(h=s.getParent(h));return!1};case ul.SelectorType.Parent:return function(u){return s.getChildren(u).some(function(h){return s.isTag(h)&&i(h)})};case ul.SelectorType.Child:return function(u){var h=s.getParent(u);return h!=null&&s.isTag(h)&&i(h)};case ul.SelectorType.Sibling:return function(u){for(var h=s.getSiblings(u),p=0;p<h.length;p++){var m=h[p];if(o(u,m))break;if(s.isTag(m)&&i(m))return!0}return!1};case ul.SelectorType.Adjacent:return s.prevElementSibling?function(u){var h=s.prevElementSibling(u);return h!=null&&i(h)}:function(u){for(var h=s.getSiblings(u),p,m=0;m<h.length;m++){var v=h[m];if(o(u,v))break;s.isTag(v)&&(p=v)}return!!p&&i(p)};case ul.SelectorType.Universal:{if(t.namespace!=null&&t.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return i}}}vx.compileGeneralSelector=vIt;var _It=zt&&zt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ju,"__esModule",{value:!0});ju.compileToken=ju.compileUnsafe=ju.compile=void 0;var pT=mx,Uu=jd,bIt=_It(hT),yIt=gx,xIt=vx,oz=xx;function wIt(i,t,e){var n=az(i,t,e);return(0,oz.ensureIsTag)(n,t.adapter)}ju.compile=wIt;function az(i,t,e){var n=typeof i=="string"?(0,pT.parse)(i):i;return fT(n,t,e)}ju.compileUnsafe=az;function lz(i){return i.type==="pseudo"&&(i.name==="scope"||Array.isArray(i.data)&&i.data.some(function(t){return t.some(lz)}))}var SIt={type:pT.SelectorType.Descendant},MIt={type:"_flexibleDescendant"},CIt={type:pT.SelectorType.Pseudo,name:"scope",data:null};function EIt(i,t,e){for(var n=t.adapter,r=!!(e!=null&&e.every(function(l){var c=n.isTag(l)&&n.getParent(l);return l===oz.PLACEHOLDER_ELEMENT||c&&n.isTag(c)})),s=0,o=i;s<o.length;s++){var a=o[s];if(!(a.length>0&&(0,yIt.isTraversal)(a[0])&&a[0].type!=="descendant"))if(r&&!a.some(lz))a.unshift(SIt);else continue;a.unshift(CIt)}}function fT(i,t,e){var n;i=i.filter(function(l){return l.length>0}),i.forEach(bIt.default),e=(n=t.context)!==null&&n!==void 0?n:e;var r=Array.isArray(e),s=e&&(Array.isArray(e)?e:[e]);EIt(i,t,s);var o=!1,a=i.map(function(l){if(l.length>=2){var c=l[0],u=l[1];c.type!=="pseudo"||c.name!=="scope"||(r&&u.type==="descendant"?l[1]=MIt:(u.type==="adjacent"||u.type==="sibling")&&(o=!0))}return TIt(l,t,s)}).reduce(AIt,Uu.falseFunc);return a.shouldTestNextSiblings=o,a}ju.compileToken=fT;function TIt(i,t,e){var n;return i.reduce(function(r,s){return r===Uu.falseFunc?Uu.falseFunc:(0,xIt.compileGeneralSelector)(r,s,t,e,fT)},(n=t.rootFunc)!==null&&n!==void 0?n:Uu.trueFunc)}function AIt(i,t){return t===Uu.falseFunc||i===Uu.trueFunc?i:i===Uu.falseFunc||t===Uu.trueFunc?t:function(n){return i(n)||t(n)}}(function(i){var t=zt&&zt.__createBinding||(Object.create?function(y,M,S,E){E===void 0&&(E=S);var A=Object.getOwnPropertyDescriptor(M,S);(!A||("get"in A?!M.__esModule:A.writable||A.configurable))&&(A={enumerable:!0,get:function(){return M[S]}}),Object.defineProperty(y,E,A)}:function(y,M,S,E){E===void 0&&(E=S),y[E]=M[S]}),e=zt&&zt.__setModuleDefault||(Object.create?function(y,M){Object.defineProperty(y,"default",{enumerable:!0,value:M})}:function(y,M){y.default=M}),n=zt&&zt.__importStar||function(y){if(y&&y.__esModule)return y;var M={};if(y!=null)for(var S in y)S!=="default"&&Object.prototype.hasOwnProperty.call(y,S)&&t(M,y,S);return e(M,y),M};Object.defineProperty(i,"__esModule",{value:!0}),i.aliases=i.pseudos=i.filters=i.is=i.selectOne=i.selectAll=i.prepareContext=i._compileToken=i._compileUnsafe=i.compile=void 0;var r=n(fN),s=jd,o=ju,a=xx,l=function(y,M){return y===M},c={adapter:r,equals:l};function u(y){var M,S,E,A,R=y??c;return(M=R.adapter)!==null&&M!==void 0||(R.adapter=r),(S=R.equals)!==null&&S!==void 0||(R.equals=(A=(E=R.adapter)===null||E===void 0?void 0:E.equals)!==null&&A!==void 0?A:l),R}function h(y){return function(S,E,A){var R=u(E);return y(S,R,A)}}i.compile=h(o.compile),i._compileUnsafe=h(o.compileUnsafe),i._compileToken=h(o.compileToken);function p(y){return function(S,E,A){var R=u(A);typeof S!="function"&&(S=(0,o.compileUnsafe)(S,R,E));var O=m(E,R.adapter,S.shouldTestNextSiblings);return y(S,O,R)}}function m(y,M,S){return S===void 0&&(S=!1),S&&(y=v(y,M)),Array.isArray(y)?M.removeSubsets(y):M.getChildren(y)}i.prepareContext=m;function v(y,M){for(var S=Array.isArray(y)?y.slice(0):[y],E=S.length,A=0;A<E;A++){var R=(0,a.getNextSiblings)(S[A],M);S.push.apply(S,R)}return S}i.selectAll=p(function(y,M,S){return y===s.falseFunc||!M||M.length===0?[]:S.adapter.findAll(y,M)}),i.selectOne=p(function(y,M,S){return y===s.falseFunc||!M||M.length===0?null:S.adapter.findOne(y,M)});function _(y,M,S){var E=u(S);return(typeof M=="function"?M:(0,o.compile)(M,E))(y)}i.is=_,i.default=i.selectAll;var b=dT;Object.defineProperty(i,"filters",{enumerable:!0,get:function(){return b.filters}}),Object.defineProperty(i,"pseudos",{enumerable:!0,get:function(){return b.pseudos}}),Object.defineProperty(i,"aliases",{enumerable:!0,get:function(){return b.aliases}})})(Qb);function PIt(i){return!0}function Xm(i){return i.children||[]}function $R(i){return i.parent}function RIt(i){const t=new Set(i);return t.forEach(e=>{let n=e.parent;for(;n;){if(t.has(n)){t.delete(e);return}n=n.parent}}),Array.from(t)}const Sf={isTag:PIt,existsOne(i,t){return t.some(e=>i(e)||Sf.existsOne(i,Xm(e)))},getSiblings(i){const t=$R(i);return t?Xm(t):[i]},getChildren:Xm,getParent:$R,getAttributeValue(i,t){return t==="class"?i.props.classes.join(" "):t==="id"?i.id:""},hasAttrib(i,t){return t==="id"?!!i.id:t==="class"?i.props.classes.length>0:i.traits.hash?Object.prototype.hasOwnProperty.call(i.traits.hash,t):!1},removeSubsets:RIt,getName(i){var t;return(t=i.type)!==null&&t!==void 0?t:""},findOne:function i(t,e){for(const n of e){if(t(n))return n;{const r=i(t,Xm(n));if(r)return r}}return null},findAll:function i(t,e){const n=[];for(const r of e)t(r)&&n.push(r),n.push(...i(t,Xm(r)));return n},getText:function(t){return""}},kIt=(i,t)=>{const e=[],n=Array.isArray(t)?t:[t],r=new Set(n);for(const s of Array.from(i)){let o=s;for(;o!=null;){if(r.has(o)){e.push(s);break}o=Sf.getParent(o)}}return e},LIt=i=>{let t=i;for(;Sf.getParent(t)!==null;)t=Sf.getParent(t);return t},OIt=(i,t)=>{try{Qb.compile(i)}catch{return[]}const e=Array.isArray(t);if(e&&t.length===0)return[];const n=LIt(e?t[0]:t),r=Qb.selectAll(i,n,{adapter:Sf});return t?kIt(r,t):r},DIt=i=>{try{return Qb.compile(i,{adapter:Sf})}catch{return()=>!1}},IIt=/^<([0-9]+|<*)$/;class cz{constructor(t){this.root=t,this.root.model=this,this.root.root=this.root,this.ids={},this.classes={},this.traits={},this.types={},this.nodes=[],this.watchers=[],this.fire=!1,this.lastNode=null,this.event={type:"update"};const e=L=>r(L.node),n=L=>s(L.node);this.root.on("add",e),this.root.on("remove",n);const r=L=>(M(L),E(L),R(L),L.on("change:node",c),c(null,L,!0),l(L)),s=L=>(S(L),A(L),O(L),_(L.id,L),y(L.classes,L),L.off("change:node",c),l(L)),o=L=>{for(const P of Array.from(this.watchers))P.match=P.matcher(L);return null},a=L=>{for(const P of Array.from(this.watchers)){const D=P.fire||(P.fire=P.match!==P.matcher(L));D&&(this.lastNode=L),this.fire||(this.fire=D)}return null},l=L=>{for(const P of Array.from(this.watchers)){const D=P.fire||(P.fire=P.matcher(L));D&&(this.lastNode=L),this.fire||(this.fire=D)}return null};this.digest=()=>{if(!this.fire)return!1;for(const L of Array.from(this.watchers.slice()))L.fire&&(L.fire=!1,L.handler());return this.fire=!1,!0};const c=(L,P,D)=>{const V=D||L.changed["node.id"],K=D||L.changed["node.classes"];let W=!1;if(V){const Z=P.get("node.id");Z!==P.id&&(D||o(P),W=!0,P.id!=null&&_(P.id,P),v(Z,P))}if(K){let Z,z=(Z=P.get("node.classes"))!=null?Z:[];const ut=z.join(",");ut!==(P.classes!=null?P.classes.klass:void 0)&&(z=z.slice(),!D&&!W&&o(P),W=!0,P.classes!=null&&y(P.classes,P),b(z,P),P.classes=z,P.classes.klass=ut)}return!D&&W&&a(P),null},u=function(L,P,D){if(P!=null){for(const V of Array.from(P)){const K=L[V]!=null?L[V]:[];K.push(D),L[V]=K}return null}},h=function(L,P,D){if(P!=null){for(const V of Array.from(P)){const K=L[V],W=K.indexOf(D);W>=0&&K.splice(W,1),K.length===0&&delete L[V]}return null}},p=function(L){if(!(L.length>0))return;const P=L.hash={};return Array.from(L).map(D=>P[D]=!0)},m=L=>delete L.hash,v=(L,P)=>{if(this.ids[L])throw new Error(`Duplicate node id \`${L}\``);return L!=null&&(this.ids[L]=[P]),P.id=L??P._id},_=(L,P)=>(L!=null&&delete this.ids[L],P.id=P._id),b=(L,P)=>{if(u(this.classes,L,P),L!=null)return p(L)},y=(L,P)=>{if(h(this.classes,L,P),L!=null)return m(L)},M=L=>this.nodes.push(L),S=L=>this.nodes.splice(this.nodes.indexOf(L),1),E=L=>u(this.types,[L.type],L),A=L=>h(this.types,[L.type],L),R=L=>(u(this.traits,L.traits,L),p(L.traits)),O=L=>(h(this.traits,L.traits,L),m(L.traits));r(this.root),this.root.trigger({type:"added"})}select(t,e){return OIt(t,e||this.getRoot())}watch(t,e){let n;return e.unwatch=()=>this.unwatch(e),e.watcher=n={selector:t,handler:e,matcher:this._matcher(t),match:!1,fire:!1},this.watchers.push(n),this.select(t)}unwatch(t){const{watcher:e}=t;if(e!=null)return this.watchers.splice(this.watchers.indexOf(e),1),delete t.unwatch,delete t.watcher}_matcher(t){if(IIt.test(t))throw new Error("Auto-link matcher unsupported");return DIt(t)}getRoot(){return this.root}getLastTrigger(){return this.lastNode.toString()}}const NIt=Object.freeze(Object.defineProperty({__proto__:null,Attributes:lN,Group:dN,Guard:pN,Model:cz,Node:Zg},Symbol.toStringTag,{value:"Module"}));class uz{constructor(t,e){this.classes=t,this.canvas=e;const n=document.createElement("div");n.classList.add("mathbox-overlays"),this.div=n}inject(){const t=this.canvas.parentNode;if(!t)throw new Error("Canvas not inserted into document.");return t.insertBefore(this.div,this.canvas)}unject(){return this.div.parentNode.removeChild(this.div)}getTypes(){return Object.keys(this.classes)}make(t,e){return new this.classes[t](this.div,e)}}const Qg=[];let zIt=0;const ny={},hz=()=>({id:zIt++,type:null,props:null,children:null,rendered:null,instance:null}),dz=function(i){return i*=2,i=Math.max(0,Qg.length-i),BIt(0,i,!1).map(t=>Qg.push(hz()))},tv=function(i,t,e){const n=Qg.length?Qg.pop():hz();return n.type=i??"div",n.props=t??null,n.children=e??null,n},mT=function(i){if(!i.type)return;const{children:t}=i;if(i.type=i.props=i.children=i.instance=null,Qg.push(i),t!=null)for(const e of Array.from(t))mT(e)},ef=function(i,t,e,n,r){if(i!=null){if(t==null)return nf(i,n,r);{let s;if(i instanceof Node){if(s=i===t,s)return}else s=typeof i==typeof t&&t!==null&&i!==null&&i.type===t.type;if(s){let o,a,l;i.instance=t.instance;const c=i.type!=null&&i.type.isComponentClass?i.type:ny[i.type],u=t!=null?t.props:void 0,h=i.props,p=(t!=null?t.children:void 0)!=null?t!=null?t.children:void 0:null,m=i.children;if(h!=null&&(h.children=m),c!=null){let v=e._COMPONENT_DIRTY;if(u!=null!=(h!=null)&&(v=!0),p!==m&&(v=!0),u!=null&&h!=null){if(!v)for(o in u)Object.prototype.hasOwnProperty.call(h,o)||(v=!0);if(!v)for(o in h)l=h[o],(a=u[o])!==l&&(v=!0)}if(v){let _;const b=t.instance;i.props==null&&(i.props={});for(const E in b.defaultProps){const A=b.defaultProps[E];i.props[E]==null&&(i.props[E]=A)}i.props.children=i.children,typeof b.willReceiveProps=="function"&&b.willReceiveProps(i.props);const y=e._COMPONENT_FORCE||((_=typeof b.shouldUpdate=="function"?b.shouldUpdate(i.props):void 0)!=null?_:!0);if(y){const E=b.getNextState();typeof b.willUpdate=="function"&&b.willUpdate(i.props,E)}const M=b.props,S=b.applyNextState();b.props=i.props,b.children=i.children,y&&(i=i.rendered=typeof b.render=="function"?b.render(tv,i.props,i.children):void 0,ef(i,t.rendered,e,n,r),typeof b.didUpdate=="function"&&b.didUpdate(M,S))}return}else{if(u!=null)for(o in u)Object.prototype.hasOwnProperty.call(h,o)||FIt(e,o,u[o]);if(h!=null)for(o in h)l=h[o],(a=u[o])!==l&&o!=="children"&&pz(e,o,l,a);if(m!=null)if(["string","number"].includes(typeof m))m!==p&&(e.textContent=m);else if(m.type!=null)ef(m,p,e.childNodes[0],e,0);else{let v,_;const{childNodes:b}=e;if(p!=null)for(_=0;_<m.length;_++)v=m[_],ef(v,p[_],b[_],e,_);else for(_=0;_<m.length;_++)v=m[_],ef(v,null,b[_],e,_)}else p!=null&&(Nb(null,e),e.innerHTML="")}return}else return Nb(t.instance,e),e.remove(),nf(i,n,r)}}if(t!=null)return Nb(t.instance,e),t.node.remove()},nf=function(i,t,e){let n;e==null&&(e=0);const r=i.type!=null&&i.type.isComponentClass?i.type:ny[i.type];if(i instanceof Node)n=i;else{if(r!=null){let o;const a=i.type!=null&&i.type.isComponentClass?i.type:ny[i.type];if(!a)return i=i.rendered=tv("noscript"),n=nf(i,t,e),n;i.instance=o=new a(t),i.props==null&&(i.props={});for(const l in o.defaultProps){const c=o.defaultProps[l];i.props[l]==null&&(i.props[l]=c)}return i.props.children=i.children,o.props=i.props,o.children=i.children,o.setState(typeof o.getInitialState=="function"?o.getInitialState():void 0),typeof o.willMount=="function"&&o.willMount(),i=i.rendered=typeof o.render=="function"?o.render(tv,i.props,i.children):void 0,n=nf(i,t,e),typeof o.didMount=="function"&&o.didMount(i),n._COMPONENT=o,n}else if(["string","number"].includes(typeof i))n=document.createTextNode(i);else{n=document.createElement(i.type);for(const o in i.props){const a=i.props[o];pz(n,o,a)}}const{children:s}=i;if(s!=null)if(["string","number"].includes(typeof s))n.textContent=s;else if(s.type!=null)nf(s,n,0);else for(let o=0;o<s.length;o++){const a=s[o];nf(a,n,o)}}return t.insertBefore(n,t.childNodes[e]),n},Nb=function(i,t){if(i){typeof i.willUnmount=="function"&&i.willUnmount();for(const e in i)delete i[e]}return(()=>{const e=[];for(const n of Array.from(t.childNodes))Nb(n._COMPONENT,n),e.push(delete n._COMPONENT);return e})()},UIt=function(i){if(typeof document>"u")return!0;if(document.documentElement.style[i]!=null)return i;i=i[0].toUpperCase()+i.slice(1);const t=["webkit","moz","ms","o"];for(const e of Array.from(t))if(document.documentElement.style[e+i]!=null)return e+i},ev={};for(const i of["transform"])ev[i]=UIt(i);const pz=function(i,t,e,n){if(t==="style"){for(const r in e){const s=e[r];(n!=null?n[r]:void 0)!==s&&(i.style[ev[r]!=null?ev[r]:r]=s)}return}if(i[t]!=null){try{i[t]=e}catch{console.log("failed setting "+t)}return}if(i instanceof Node){i.setAttribute(t,e);return}},FIt=function(i,t,e){if(t==="style"){for(const n in e)i.style[ev[n]!=null?ev[n]:n]="";return}if(i[t]!=null&&(i[t]=void 0),i instanceof Node){i.removeAttribute(t);return}},VIt=function(i){let t;const e={willMount:"componentWillMount",didMount:"componentDidMount",willReceiveProps:"componentWillReceiveProps",shouldUpdate:"shouldComponentUpdate",willUpdate:"componentWillUpdate",didUpdate:"componentDidUpdate",willUnmount:"componentWillUnmount"};for(const r in e){const s=e[r];i[r]==null&&(i[r]=i[s])}class n{constructor(s,o,a=null,l=null){let c,u;o==null&&(o={}),this.props=o,this.state=a,this.children=l;const h=function(m,v){return typeof m=="function"?m.bind(v):m};for(c in i)u=i[c],this[c]=h(u,this);let p=null;this.setState=function(m){p==null&&(p=m?p??{}:null);for(c in m)u=m[c],p[c]=u;s._COMPONENT_DIRTY=!0},this.forceUpdate=function(){s._COMPONENT_FORCE=s._COMPONENT_DIRTY=!0;let m=s;return(()=>{const v=[];for(;m=m.parentNode;)m._COMPONENT?v.push(m._COMPONENT_FORCE=!0):v.push(void 0);return v})()},this.getNextState=()=>p,this.applyNextState=function(){s._COMPONENT_FORCE=s._COMPONENT_DIRTY=!1;const m=this.state;return[p,this.state]=Array.from([null,p]),m}}}return n.isComponentClass=!0,n.prototype.defaultProps=(t=typeof i.getDefaultProps=="function"?i.getDefaultProps():void 0)!=null?t:{},n};function BIt(i,t,e){const n=[],r=i<t,s=e?r?t+1:t-1:t;for(let o=i;r?o<s:o>s;r?o++:o--)n.push(o);return n}const HIt=Object.freeze(Object.defineProperty({__proto__:null,Types:ny,apply:ef,createClass:VIt,element:tv,hint:dz,recycle:mT},Symbol.toStringTag,{value:"Module"}));class fz{constructor(t,e){this.element=t,typeof this.init=="function"&&this.init(e)}dispose(){}}let mz=class extends fz{static initClass(){this.prototype.el=tv,this.prototype.hint=dz,this.prototype.apply=ef,this.prototype.recycle=mT}init(t){return this.last=null}dispose(){return this.unmount(),super.dispose()}mount(){const t=document.createElement("div");return t.classList.add("mathbox-overlay"),this.element.appendChild(t),this.overlay=t}unmount(t){return this.overlay&&this.overlay.parentNode&&this.element.removeChild(this.overlay),this.overlay=null}render(t){this.overlay||this.mount(),["string","number"].includes(typeof t)&&(t=this.el("div",null,t)),t instanceof Array&&(t=this.el("div",null,t)),t==null&&(t=this.el("div"));const e=t.type==="div";let{last:n}=this;const{overlay:r}=this,s=e?r:r.childNodes[0],o=e?r.parentNode:r;!n&&s&&(n=this.el("div")),this.apply(t,n,s,o,0),this.last=t,n!=null&&this.recycle(n)}};mz.initClass();const gz={dom:mz},$It=Object.freeze(Object.defineProperty({__proto__:null,Classes:gz,Factory:uz,Overlay:fz},Symbol.toStringTag,{value:"Module"}));class gr{static initClass(){this.Node=Zg,this.Group=dN,this.model=this.Node,this.defaults=null,this.traits=null,this.props=null,this.finals=null,this.freeform=!1}constructor(t,e,n){this.node=t,this._context=e,this._renderables=this._context.renderables,this._attributes=this._context.attributes,this._shaders=this._context.shaders,this._overlays=this._context.overlays,this._animator=this._context.animator,this._types=this._attributes.types,this.node.controller=this,this.node.on("added",r=>this._added()),this.node.on("removed",r=>this._removed()),this.node.on("change",r=>{if(this._root)return this.change(r.changed,r.touched)}),this.reconfigure(),this._get=this.node.get.bind(this.node),this._helpers=n(this,this.node.traits),this._handlers={inherit:{},listen:[],watch:[],compute:[]},this._root=this._parent=null,this.init()}is(t){return this.traits.hash[t]}init(){}make(){}made(){}unmake(t){}unmade(){}change(t,e,n){}refresh(){return this.change({},{},!0)}rebuild(){if(this._root)return this._removed(!0),this._added()}reconfigure(t){return t!=null&&this.node.configure(t,this._attributes),this.traits=this.node.traits,this.props=this.node.props}_added(){let t,e;this._parent=this.node.parent!=null?this.node.parent.controller:void 0,this._root=this.node.root!=null?this.node.root.controller:void 0,this.node.clock=(e=this._inherit("clock"))!=null?e:this._root;try{try{return this.make(),this.refresh(),this.made()}catch(n){throw t=n,this.node.print("warn"),console.error(t),t}}catch(n){t=n;try{return this._removed()}catch{}}}_removed(t){return t==null&&(t=!1),this.unmake(t),this._unlisten(),this._unattach(),this._uncompute(),this._root=null,this._parent=null,this.unmade(t)}_listen(t,e,n,r){if(r==null&&(r=this),t instanceof Array)for(const s of Array.from(t))return this.__listen(s,e,n,r);return this.__listen(t,e,n,r)}__listen(t,e,n,r){if(r==null&&(r=this),typeof t=="string"&&(t=this._inherit(t)),t!=null){const s=n.bind(r);s.node=this.node,t.on(e,s),this._handlers.listen.push([t,e,s])}return t}_unlisten(){if(this._handlers.listen.length){for(const[t,e,n]of Array.from(this._handlers.listen))t.off(e,n);return this._handlers.listen=[]}}_inherit(t){const e=this._handlers.inherit[t];return e!==void 0?e:this._handlers.inherit[t]=this._parent!=null?this._parent._find(t??null):void 0}_find(t){return this.is(t)?this:this._parent!=null?this._parent._find(t):void 0}_uninherit(){return this._handlers.inherit={}}_attach(t,e,n,r,s,o,a){r==null&&(r=this),s==null&&(s=this),o==null&&(o=!1),a==null&&(a=!1);const l=function(m){if(m!=null&&Array.from(m.traits).includes(e))return m},c=m=>m!=null?m.controller:void 0,u=function(m){if(m==null)return m;let v=[];for(const _ of Array.from(m))_ instanceof Array?v=v.concat(_):v.push(_);return v},h=m=>{let v,_;if(typeof m=="object"){if(v=m,v!=null&&v._up)return m=a?v._targets:[v[0]],m;if(v instanceof Array)return m=a?u(v.map(h)):h(v[0]),m;if(v instanceof Zg)return[v]}else if(typeof m=="string"&&m[0]==="<"){let b,y=0;(b=m.match(/^<([0-9])+$/))&&(y=+b[1]-1),m.match(/^<+$/)&&(y=+m.length-1),_=[];let M=s.node;for(;M;){const{parent:S}=M;if(!S)break;if(M=S.children[M.index-1],!M&&!_.length&&(M=S),v=null,l(M)&&(v=M),v!=null&&y--<=0&&_.push(v),!a&&_.length)return _}if(a&&_.length)return _}else if(typeof m=="string"){const b=n.bind(r);this._handlers.watch.push(b);const y=this._root.watch(m,b);if(a){if(_=y.filter(l),_.length)return _}else if(l(y[0])&&(v=y[0]),v!=null)return[v]}if(!o)throw console.warn(this.node.toMarkup()),new Error(`${this.node.toString()} - Could not find ${e} \`${m}\``);return a?[]:null},p=u(h(t));return a?p!=null?p.map(c):null:p!=null?c(p[0]):null}_unattach(){if(this._handlers.watch.length){for(const t of Array.from(this._handlers.watch))t!=null&&t.unwatch();return this._handlers.watch=[]}}_compute(t,e){return this._handlers.compute.push(t),this.node.bind(t,e,!0)}_uncompute(){if(this._handlers.compute.length){for(const t of Array.from(this._handlers.compute))this.node.unbind(t,!0);return this._handlers.compute=[]}}}gr.initClass();ml.apply(gr.prototype);class $o extends gr{static initClass(){this.model=gr.Group,this.traits=["node"]}}$o.initClass();class vz extends $o{static initClass(){this.traits=["node","object","entity","visible","active"]}make(){return this._helpers.visible.make(),this._helpers.active.make()}unmake(){return this._helpers.visible.unmake(),this._helpers.active.unmake()}}vz.initClass();class _z extends $o{static initClass(){this.traits=["node","bind"]}make(){return this._helpers.bind.make([{to:"inherit.source",trait:"node"}])}unmake(){return this._helpers.bind.unmake()}_find(t){return this.bind.source&&Array.from(this.props.traits).includes(t)?this.bind.source._inherit(t):super._find()}}_z.initClass();class bz extends $o{static initClass(){this.traits=["node","root","clock","scene","vertex","unit"]}init(){return this.size=null,this.cameraEvent={type:"root.camera"},this.preEvent={type:"root.pre"},this.updateEvent={type:"root.update"},this.renderEvent={type:"root.render"},this.postEvent={type:"root.post"},this.clockEvent={type:"clock.tick"},this.camera=null}make(){return this._helpers.unit.make()}unmake(){return this._helpers.unit.unmake()}change(t,e,n){if(t["root.camera"]||n)return this._unattach(),this._attach(this.props.camera,"camera",this.setCamera,this,this,!0),this.setCamera()}adopt(t){return Array.from(t.renders).map(e=>this._context.scene.add(e))}unadopt(t){return Array.from(t.renders).map(e=>this._context.scene.remove(e))}select(t){return this.node.model.select(t)}watch(t,e){return this.node.model.watch(t,e)}unwatch(t){return this.node.model.unwatch(t)}resize(t){return this.size=t,this.trigger({type:"root.resize",size:t})}getSize(){return this.size}getSpeed(){return this.props.speed}getUnit(){return this._helpers.unit.get()}getUnitUniforms(){return this._helpers.unit.uniforms()}pre(){return this.getCamera().updateProjectionMatrix(),this.trigger(this.clockEvent),this.trigger(this.preEvent)}update(){return this.trigger(this.updateEvent)}render(){return this.trigger(this.renderEvent)}post(){return this.trigger(this.postEvent)}setCamera(){const t=GIt(this.select(this.props.camera)[0],e=>e.controller);if(this.camera!==t)return this.camera=t,this.trigger({type:"root.camera"})}getCamera(){let t;return(t=this.camera!=null?this.camera.getCamera():void 0)!=null?t:this._context.defaultCamera}getTime(){return this._context.time}vertex(t,e){return e===2?t.pipe("view.position"):e===3?t.pipe("root.position"):t}}bz.initClass();function GIt(i,t){return typeof i<"u"&&i!==null?t(i):void 0}class yz extends $o{static initClass(){this.traits=["node","unit"]}make(){return this._helpers.unit.make()}unmake(){return this._helpers.unit.unmake()}getUnit(){return this._helpers.unit.get()}getUnitUniforms(){return this._helpers.unit.uniforms()}}yz.initClass();const zb=function(i,t){return t===ff?i.REPEAT:t===es?i.CLAMP_TO_EDGE:t===mf?i.MIRRORED_REPEAT:t===si?i.NEAREST:t===hE?i.NEAREST_MIPMAP_NEAREST:t===dE?i.NEAREST_MIPMAP_LINEAR:t===Ji?i.LINEAR:t===fE?i.LINEAR_MIPMAP_NEAREST:t===mE?i.LINEAR_MIPMAP_LINEAR:t===lo?i.UNSIGNED_BYTE:t===Ly?i.UNSIGNED_SHORT_4_4_4_4:t===Oy?i.UNSIGNED_SHORT_5_5_5_1:t===bv?i.BYTE:t===yv?i.SHORT:t===Ud?i.UNSIGNED_SHORT:t===Uf?i.INT:t===Fa?i.UNSIGNED_INT:t===Hr?i.FLOAT:t===gE?i.ALPHA:t===Es?i.RGBA:t===Dy?i.LUMINANCE:t===Iy?i.LUMINANCE_ALPHA:t===Nu?i.FUNC_ADD:t===QC?i.FUNC_SUBTRACT:t===tE?i.FUNC_REVERSE_SUBTRACT:t===eE?i.ZERO:t===nE?i.ONE:t===iE?i.SRC_COLOR:t===rE?i.ONE_MINUS_SRC_COLOR:t===Ry?i.SRC_ALPHA:t===ky?i.ONE_MINUS_SRC_ALPHA:t===sE?i.DST_ALPHA:t===oE?i.ONE_MINUS_DST_ALPHA:t===aE?i.DST_COLOR:t===lE?i.ONE_MINUS_DST_COLOR:t===cE?i.SRC_ALPHA_SATURATE:0},xz=function(i){switch(i){case lo:return Uint8Array;case bv:return Int8Array;case yv:return Int16Array;case Ud:return Uint16Array;case Uf:return Int32Array;case Fa:return Uint32Array;case Hr:return Float32Array}},gT=i=>i.map(t=>["","X","Y","Z"][t]).join(""),qf=function(){const i=new Vd,t=new $r,e=new Y,n=new Y,r=new rn;return function(s,o,a,l,c,u){return u==null&&(u="XYZ"),o!=null?(u instanceof Array&&(u=gT(u)),i.setFromVector3(o,u),t.setFromEuler(i)):t.set(0,0,0,1),a!=null&&t.multiply(a),s!=null?e.copy(s):e.set(0,0,0),l!=null?n.copy(l):n.set(1,1,1),r.compose(e,t,n),c!=null&&r.multiplyMatrices(r,c),r}},qIt=Object.freeze(Object.defineProperty({__proto__:null,paramToArrayStorage:xz,paramToGL:zb,swizzleToEulerOrder:gT,transformComposer:qf},Symbol.toStringTag,{value:"Module"}));class wz extends gr{static initClass(){this.traits=["node","camera"]}init(){}make(){const t=this._context.defaultCamera;return this.camera=this.props.proxy?t:t.clone(),this.euler=new Vd,this.quat=new $r}unmake(){}getCamera(){return this.camera}change(t,e,n){if(t["camera.position"]||t["camera.quaternion"]||t["camera.rotation"]||t["camera.lookAt"]||t["camera.up"]||t["camera.fov"]||n){const{position:r,quaternion:s,rotation:o,lookAt:a,up:l,fov:c}=this.props;return r!=null&&this.camera.position.copy(r),(s!=null||o!=null||a!=null)&&(a!=null?this.camera.lookAt(a):this.camera.quaternion.set(0,0,0,1),o!=null&&(this.euler.setFromVector3(o,gT(this.props.eulerOrder)),this.quat.setFromEuler(this.euler),this.camera.quaternion.multiply(this.quat)),s!=null&&this.camera.quaternion.multiply(s)),c!=null&&this.camera.fov!=null&&(this.camera.fov=c),l!=null&&this.camera.up.copy(l),this.camera.updateMatrix()}}}wz.initClass();const kd=function(i){const t=[];let e=i;for(;typeof e!="string"&&(e!=null?e.length:void 0)!=null;)t.push(e.length),e=e[0];return t},ih=function(i,t){let e;t==null&&(t={});const{items:n,channels:r,width:s,height:o,depth:a}=t,l={};if(!i||!i.length)return{items:n,channels:r,width:s??0,height:o??0,depth:a??0};const c=kd(i),u=c.length;l.channels=r!==1&&c.length>1?c.pop():r,l.items=n!==1&&c.length>1?c.pop():n,l.width=s!==1&&c.length>1?c.pop():s,l.height=o!==1&&c.length>1?c.pop():o,l.depth=a!==1&&c.length>1?c.pop():a;let h=u;r===1&&h++,n===1&&h>1&&h++,s===1&&h>2&&h++,o===1&&h>3&&h++;let p=(e=c.pop())!=null?e:1;return h<=1&&(p/=l.channels!=null?l.channels:1),h<=2&&(p/=l.items!=null?l.items:1),h<=3&&(p/=l.width!=null?l.width:1),h<=4&&(p/=l.height!=null?l.height:1),p=Math.floor(p),l.width==null&&(l.width=p,p=1),l.height==null&&(l.height=p,p=1),l.depth==null&&(l.depth=p,p=1),l},kv=function(i,t){switch(t){case 0:return()=>!0;case 1:return()=>i();case 2:return function(){return i(),i()};case 3:return function(){return i(),i(),i(),i()};case 4:return function(){return i(),i(),i(),i()};case 6:return function(){return i(),i(),i(),i(),i(),i()};case 8:return function(){return i(),i(),i(),i(),i(),i()}}},Sz=function(i,t,e){let n;const r=(()=>{switch(e){case 0:return()=>!0;case 1:return o=>o(i());case 2:return o=>o(i(),i());case 3:return o=>o(i(),i(),i());case 4:return o=>o(i(),i(),i(),i());case 6:return o=>o(i(),i(),i(),i(),i(),i());case 8:return o=>o(i(),i(),i(),i(),i(),i(),i(),i())}})();let s=null;for(;t>0;){const o=Math.min(t,8);n=(()=>{switch(o){case 1:return a=>r(a);case 2:return function(a){return r(a),r(a)};case 3:return function(a){return r(a),r(a),r(a)};case 4:return function(a){return r(a),r(a),r(a),r(a)};case 5:return function(a){return r(a),r(a),r(a),r(a),r(a)};case 6:return function(a){return r(a),r(a),r(a),r(a),r(a),r(a)};case 7:return function(a){return r(a),r(a),r(a),r(a),r(a),r(a),r(a)};case 8:return function(a){return r(a),r(a),r(a),r(a),r(a),r(a),r(a),r(a)}}})(),s!=null?s=((a,l)=>function(c){return a(c),l(c)})(n,s):s=n,t-=o}return n=s??(()=>!0),n.reset=i.reset,n.rebind=i.rebind,n},iy=function(i){let t,e,n,r,s,o=kd(i);const a=o.length;let l=o.pop(),c=o.pop(),u=o.pop();const h=o.pop();let p,m,v,_,b;switch(a){case 0:t=()=>0,t.reset=function(){};break;case 1:p=0,t=()=>i[p++],t.reset=()=>p=0;break;case 2:p=e=0,m=i[e]!=null?i[e]:[],t=function(){const y=m[p++];return p===l&&(p=0,e++,m=i[e]!=null?i[e]:[]),y},t.reset=function(){p=e=0,m=i[e]!=null?i[e]:[]};break;case 3:p=e=n=0,v=i[n]!=null?i[n]:[],m=v[e]!=null?v[e]:[],t=function(){const y=m[p++];return p===l&&(p=0,e++,e===c&&(e=0,n++,v=i[n]!=null?i[n]:[]),m=v[e]!=null?v[e]:[]),y},t.reset=function(){p=e=n=0,v=i[n]!=null?i[n]:[],m=v[e]!=null?v[e]:[]};break;case 4:p=e=n=r=0,_=i[r]!=null?i[r]:[],v=_[n]!=null?_[n]:[],m=v[e]!=null?v[e]:[],t=function(){const y=m[p++];return p===l&&(p=0,e++,e===c&&(e=0,n++,n===u&&(n=0,r++,_=i[r]!=null?i[r]:[]),v=_[n]!=null?_[n]:[]),m=v[e]!=null?v[e]:[]),y},t.reset=function(){p=e=n=r=0,_=i[r]!=null?i[r]:[],v=_[n]!=null?_[n]:[],m=v[e]!=null?v[e]:[]};break;case 5:p=e=n=r=s=0,b=i[s]!=null?i[s]:[],_=b[r]!=null?b[r]:[],v=_[n]!=null?_[n]:[],m=v[e]!=null?v[e]:[],t=function(){const y=m[p++];return p===l&&(p=0,e++,e===c&&(e=0,n++,n===u&&(n=0,r++,r===h&&(r=0,s++,b=i[s]!=null?i[s]:[]),_=b[r]!=null?b[r]:[]),v=_[n]!=null?_[n]:[]),m=v[e]!=null?v[e]:[]),y},t.reset=function(){p=e=n=r=s=0,b=i[s]!=null?i[s]:[],_=b[r]!=null?b[r]:[],v=_[n]!=null?_[n]:[],m=v[e]!=null?v[e]:[]};break}return t.rebind=function(y){if(i=y,o=kd(i),o.length&&(l=o.pop()),o.length&&(c=o.pop()),o.length&&(u=o.pop()),o.length)return y=o.pop()},t},vT=function(i,t,e,n){let r,s,o=r=s=0;const a=function(){return o=t*e*n,r=s=0},l=()=>s,c=()=>o-r<=0,u=(()=>{switch(e){case 1:return function(m){r+=m,s+=m};case 2:return function(m){r+=m*2,s+=m};case 3:return function(m){r+=m*3,s+=m};case 4:return function(m){r+=m*4,s+=m}}})(),h=(()=>{switch(e){case 1:return function(m){m(i[r++]),++s};case 2:return function(m){m(i[r++],i[r++]),++s};case 3:return function(m){m(i[r++],i[r++],i[r++]),++s};case 4:return function(m){m(i[r++],i[r++],i[r++],i[r++]),++s}}})(),p=(()=>{switch(e){case 1:return function(m){i[r++]=m,++s};case 2:return function(m,v){i[r++]=m,i[r++]=v,++s};case 3:return function(m,v,_){i[r++]=m,i[r++]=v,i[r++]=_,++s};case 4:return function(m,v,_,b){i[r++]=m,i[r++]=v,i[r++]=_,i[r++]=b,++s}}})();return h.reset=a,p.reset=a,a(),{emit:p,consume:h,skip:u,count:l,done:c,reset:a}},Mz=function(i,t){let e,n,r,s,o;const a=new Float32Array(4096);let l=n=.5,c=r=s=o=0;const u=function(m,v,_,b){return s++,a[c++]=m*l,a[c++]=v*l,a[c++]=_*l,a[c++]=b*l},h=function(m,v,_,b){return o++,a[r++]+=m*n,a[r++]+=v*n,a[r++]+=_*n,a[r++]+=b*n},p=Math.max(i.length,t.length);return p<=3?e=function(m,v,_){c=r=s=o=0,i(u,v,_),t(h,v,_);const b=Math.min(s,o);let y=0;return GR(0,b,!1).map(M=>m(a[y++],a[y++],a[y++],a[y++]))}:p<=5?e=function(m,v,_,b,y){c=r=s=o=0,i(u,v,_,b,y),t(h,v,_,b,y);const M=Math.min(s,o);let S=0;return GR(0,M,!1).map(E=>m(a[S++],a[S++],a[S++],a[S++]))}:p<=7?e=function(m,v,_,b,y,M,S){c=r=s=o=0,i(u,v,_,b,y,M,S),t(h,v,_,b,y,M,S);const E=Math.min(s,o);let A=0;return(()=>{let R,O;const L=[];for(S=0,O=E,R=0<=O;R?S<O:S>O;R?S++:S--)L.push(m(a[A++],a[A++],a[A++],a[A++]));return L})()}:p<=9?e=function(m,v,_,b,y,M,S,E,A){c=r=s=o=0,i(u,v,_,b,y,M,S,E,A),t(h,v,_,b,y,M,S,E,A);const R=Math.min(s,o);return A=0,(()=>{let O,L;const P=[];for(E=0,L=R,O=0<=L;O?E<L:E>L;O?E++:E--)P.push(m(a[A++],a[A++],a[A++],a[A++]));return P})()}:e=function(m,v,_,b,y,M,S,E,A,R,O){c=r=0,i(u,v,_,b,y,M,S,E,A,R,O),t(h,v,_,b,y,M,S,E,A,R,O);const L=Math.min(s,o);return A=0,(()=>{let P,D;const V=[];for(E=0,D=L,P=0<=D;P?E<D:E>D;P?E++:E--)V.push(m(a[A++],a[A++],a[A++],a[A++]));return V})()},e.lerp=function(m){let v;return[l,n]=Array.from(v=[1-m,m]),v},e},Cz=function(i,t){const e=kd(i).reduce((l,c)=>l*c),n=kd(t).reduce((l,c)=>l*c),r=Math.min(e,n),s=iy(i),o=iy(t),a=new Float32Array(r);return a.lerp=function(l){s.reset(),o.reset();let c=0;return(()=>{const u=[];for(;c<r;){const h=s(),p=o();u.push(a[c++]=h+(p-h)*l)}return u})()},a};function GR(i,t,e){const n=[],r=i<t,s=e?r?t+1:t-1:t;for(let o=i;r?o<s:o>s;r?o++:o--)n.push(o);return n}const WIt=Object.freeze(Object.defineProperty({__proto__:null,getDimensions:ih,getLerpEmitter:Mz,getLerpThunk:Cz,getSizes:kd,getStreamer:vT,getThunk:iy,makeEmitter:Sz,repeatCall:kv},Symbol.toStringTag,{value:"Module"})),qR="xyzw".split(""),_T={0:-1,x:0,y:1,z:2,w:3},bT=function(i){return i===""+i&&(i=i.split("")),i===+i&&(i=[i]),i},Mf=function(i){return i===+i&&(i="vec"+i),i==="vec1"&&(i="float"),i},Ez=function(i){if(i=""+i,i.indexOf(".")<0)return i+=".0"},Tz=function(i){i==null&&(i=4);const t=Ez(i);return`vec4 float2ByteIndex(vec4 xyzw, out float channelIndex) {
  float relative = xyzw.w / ${t};
  float w = floor(relative);
  channelIndex = (relative - w) * ${t};
  return vec4(xyzw.xyz, w);
}`},Az=function(i){const t=function(n,r){let s;if(n===r)s=`return texture2D(dataTextures[${n}], uv);`;else{const o=Math.ceil(n+(r-n)/2);s=`if (z < ${o-.5}) {
  ${t(n,o-1)}
}
else {
  ${t(o,r)}
}`}return s=s.replace(/\n/g,`
  `)},e=t(0,i-1);return`uniform sampler2D dataTextures[${i}];

vec4 sample2DArray(vec2 uv, float z) {
  ${e}
}`},ha=function(i,t,e){return i=Mf(i),e!=null?`${i} binaryOperator(${i} a) {
  return a ${t} ${e};
}`:`${i} binaryOperator(${i} a, ${i} b) {
  return a ${t} b;
}`},Ld=function(i,t,e){if(e==null&&(e=0),i>t)return rh(i,t);const n=t-i;i=Mf(i),t=Mf(t),e=Ez(e);const s=jIt(0,n,!0).map(function(o){return o?e:"v"}).join(",");return`${t} extendVec(${i} v) { return ${t}(${s}); }`},rh=function(i,t){if(i<t)return Ld(i,t);const e="."+"xyzw".substr(0,t);return i=Mf(i),t=Mf(t),`${t} truncateVec(${i} v) { return v${e}; }`},yT=function(i){const t=["0.0","0.0","0.0","0.0"];i=bT(i),i=i.map(function(r){return r===""+r?_T[r]:r});for(let r=0;r<i.length;r++){const s=i[r];t[s]=["a","b","c","d"][r]}const e=t.slice(0,4).join(", ");return`vec4 inject(${["float a","float b","float c","float d"].slice(0,i.length)}) {
  return vec4(${e});
}`},Do=function(i,t=null){const e=["0.0","xyzw.x","xyzw.y","xyzw.z","xyzw.w"];for(t==null&&(t=i.length),i=bT(i),i=i.map(function(r){return Array.from([0,1,2,3,4]).includes(+r)&&(r=+r),r===""+r&&(r=_T[r]+1),e[r]});i.length<t;)i.push("0.0");const n=i.join(", ");return`vec${t} swizzle(vec4 xyzw) {
  return vec${t}(${n});
}`.replace(/vec1/g,"float")},wx=function(i){const t=["0.0","0.0","0.0","0.0"];i=bT(i),i=i.map(function(n){return n===+n?qR[n-1]:n});for(let n=0;n<i.length;n++){const r=i[n],s=qR[n],o=_T[r];t[o]=`xyzw.${s}`}return`vec4 invertSwizzle(vec4 xyzw) {
  return vec4(${t.join(", ")});
}`},tc=function(i){let t=[].slice.call(arguments);return t.length>1?(t=t.map((e,n)=>["inout",e,String.fromCharCode(97+n)].join(" ")),t=t.join(", "),`void identity(${t}) { }`):`${i} identity(${i} x) {
  return x;
}`},oC=(i,t)=>`${i} constant() {
return ${t};
}`;function jIt(i,t,e){const n=[],r=i<t,s=e?r?t+1:t-1:t;for(let o=i;r?o<s:o>s;r?o++:o--)n.push(o);return n}const XIt=Object.freeze(Object.defineProperty({__proto__:null,binaryOperator:ha,constant:oC,extendVec:Ld,identity:tc,injectVec4:yT,invertSwizzleVec4:wx,mapByte2FloatOffset:Tz,sample2DArray:Az,swizzleVec4:Do,toType:Mf,truncateVec:rh},Symbol.toStringTag,{value:"Module"}));class Sx extends gr{static initClass(){this.traits=["node","source","index"]}made(){return this.trigger({type:"source.rebuild"})}indexShader(t){return t.pipe(tc("vec4"))}sourceShader(t){return t.pipe(tc("vec4"))}getDimensions(){return{items:1,width:1,height:1,depth:1}}getActiveDimensions(){return this.getDimensions()}getIndexDimensions(){return this.getActiveDimensions()}getFutureDimensions(){return this.getActiveDimensions()}}Sx.initClass();let Pz=class extends Sx{static initClass(){this.traits=["node","data","source","index","entity","active"]}init(){return this.dataEmitter=null,this.dataSizes=null}emitter(t,e){let n;const{data:r,bind:s,expr:o}=this.props;if(r!=null){const a=this.dataSizes,l=kd(r);if(!a||a.length!==l.length){const c=iy(r);this.dataEmitter=this.callback(Sz(c,e,t)),this.dataSizes=l}n=this.dataEmitter}else o!=null?n=this.callback(o):n=this.callback(this.passthrough);return n}callback(t){return t??function(){}}update(){}make(){return this._helpers.active.make(),this.first=!0,this._listen("root","root.update",()=>((this.isActive||this.first)&&this.update(),this.first=!1))}unmake(){return this._helpers.active.unmake(),this.dataEmitter=null,this.dataSizes=null}};Pz.initClass();let Lv=class extends Pz{static initClass(){this.traits=["node","buffer","active","data","source","index","texture"]}init(){this.bufferSlack=0,this.bufferFrames=0,this.bufferTime=0,this.bufferDelta=0,this.bufferClock=0,this.bufferStep=0,super.init()}make(){super.make(),this.clockParent=this._inherit("clock"),this.latchParent=this._inherit("latch")}unmake(){return super.unmake()}rawBuffer(){return this.buffer}emitter(){const{channels:t,items:e}=this.props;return super.emitter(t,e)}change(t,e,n){if(t["buffer.fps"]||n){const{fps:r}=this.props;return this.bufferSlack=r?.5/r:0}}syncBuffer(t){let e,n;if(!this.buffer)return;const{live:r,fps:s,hurry:o,limit:a,realtime:l,observe:c}=this.props,u=this.buffer.getFilled();if(u&&!r||this.latchParent&&!this.latchParent.isDirty)return;const h=this.clockParent.getTime();if(s!=null){const p=this.bufferSlack,m=h.step/h.delta;e=l?h.delta:h.step;const v=1/s;n=l&&c?m*v:v,Math.abs(h.time-this.bufferTime)>h.step*a&&(this.bufferTime=h.time,this.bufferClock=h.clock),this.bufferSlack=Math.min(a/s,p+e),this.bufferDelta=e,this.bufferStep=n;let _=Math.min(o,Math.floor(p*s));u||(_=Math.max(1,_));let b=!1;const y=()=>b=!0;return(()=>{const M=[];for(let S=0,E=_,A=0<=E;(A?S<E:S>E)&&(this.bufferTime+=e,this.bufferClock+=n,!b);A?S++:S--)t(y,this.bufferFrames++,S,_),M.push(this.bufferSlack-=v);return M})()}else return this.bufferTime=h.time,this.bufferDelta=h.delta,this.bufferClock=h.clock,this.bufferStep=h.step,t(function(){},this.bufferFrames++,0,1)}alignShader(t,e){const{minFilter:n,magFilter:r,aligned:s}=this.props,o=t.items>1&&t.width>1||t.height>1&&t.depth>1;return s||!o?void 0:(n===this.node.attributes["texture.minFilter"].enum.nearest&&r===this.node.attributes["texture.magFilter"].enum.nearest||console.warn(`${this.node.toString()} - Cannot use linear min/magFilter with 3D/4D sampling`),e.pipe("map.xyzw.align"))}};Lv.initClass();class xT extends Lv{static initClass(){this.traits=["node","buffer","active","data","source","index","array","texture","raw"]}init(){return this.buffer=this.spec=null,this.space={width:0,history:0},this.used={width:0},this.storage="arrayBuffer",this.passthrough=(t,e)=>t(e,0,0,0),super.init()}sourceShader(t){const e=this.getDimensions();return this.alignShader(e,t),this.buffer.shader(t)}getDimensions(){return{items:this.items,width:this.space.width,height:this.space.history,depth:1}}getActiveDimensions(){return{items:this.items,width:this.used.width,height:this.buffer.getFilled(),depth:1}}getFutureDimensions(){return{items:this.items,width:this.used.width,height:this.space.history,depth:1}}getRawDimensions(){return{items:this.items,width:this.space.width,height:1,depth:1}}make(){super.make();const t=this.minFilter!=null?this.minFilter:this.props.minFilter,e=this.magFilter!=null?this.magFilter:this.props.magFilter,n=this.type!=null?this.type:this.props.type,{width:r}=this.props,{history:s}=this.props,o=this.props.bufferWidth,{channels:a}=this.props,{items:l}=this.props;let c=this.spec={channels:a,items:l,width:r};this.items=c.items,this.channels=c.channels;const{data:u}=this.props;c=ih(u,c);const{space:h}=this;return h.width=Math.max(o,c.width||1),h.history=s,this.buffer=this._renderables.make(this.storage,{width:h.width,history:h.history,channels:a,items:l,minFilter:t,magFilter:e,type:n})}unmake(){if(super.unmake(),this.buffer)return this.buffer.dispose(),this.buffer=this.spec=null}change(t,e,n){if(e.texture||t["history.history"]||t["buffer.channels"]||t["buffer.items"]||t["array.bufferWidth"])return this.rebuild();if(this.buffer){if(t["array.width"]){const{width:r,bufferWidth:s}=this.props;if(this.spec.width=r,r>s)return this.rebuild()}if(t["data.map"]||t["data.data"]||t["data.resolve"]||t["data.expr"]||n)return this.buffer.setCallback(this.emitter())}}callback(t){return t.length<=2?t:(e,n)=>t(e,n,this.bufferClock,this.bufferStep)}update(){if(!this.buffer)return;const{data:t}=this.props;let{width:e}=this.props;const{space:n,used:r}=this,s=r.width,o=this.buffer.getFilled();if(this.syncBuffer(a=>{if(t!=null){const l=ih(t,this.spec);return l.width>n.width?(a(),this.rebuild()):(r.width=l.width,this.buffer.setActive(r.width),typeof this.buffer.callback.rebind=="function"&&this.buffer.callback.rebind(t),this.buffer.update())}else return e=this.spec.width||1,this.buffer.setActive(e),e=this.buffer.update(),r.width=e}),r.width!==s||o!==this.buffer.getFilled())return this.trigger({type:"source.resize"})}}xT.initClass();class Rz extends xT{static initClass(){this.traits=["node","buffer","active","data","source","index","texture","array","span","interval","sampler","raw"]}updateSpan(){let t;const e=this.props.axis;let{width:n}=this.props;const{centered:r}=this.props,s=this.props.padding,o=this._helpers.span.get("",e);n+=s*2,this.a=o.x;const a=o.y-o.x;return r?(t=1/Math.max(1,n),this.a+=a*t/2):t=1/Math.max(1,n-1),this.b=a*t,this.a+=s*this.b}callback(t){return this.updateSpan(),this.last===t?this._callback:(this.last=t,t.length<=3?this._callback=(e,n)=>{const r=this.a+this.b*n;return t(e,r,n)}:this._callback=(e,n)=>{const r=this.a+this.b*n;return t(e,r,n,this.bufferClock,this.bufferStep)})}make(){return super.make(),this._helpers.span.make(),this._listen(this,"span.range",this.updateSpan)}unmake(){return super.unmake(),this._helpers.span.unmake()}change(t,e,n){super.change(t,e,n),e.span&&this.updateSpan()}}Rz.initClass();function YIt(){this.__data__=[],this.size=0}var KIt=YIt;function ZIt(i,t){return i===t||i!==i&&t!==t}var wT=ZIt,JIt=wT;function QIt(i,t){for(var e=i.length;e--;)if(JIt(i[e][0],t))return e;return-1}var Mx=QIt,tNt=Mx,eNt=Array.prototype,nNt=eNt.splice;function iNt(i){var t=this.__data__,e=tNt(t,i);if(e<0)return!1;var n=t.length-1;return e==n?t.pop():nNt.call(t,e,1),--this.size,!0}var rNt=iNt,sNt=Mx;function oNt(i){var t=this.__data__,e=sNt(t,i);return e<0?void 0:t[e][1]}var aNt=oNt,lNt=Mx;function cNt(i){return lNt(this.__data__,i)>-1}var uNt=cNt,hNt=Mx;function dNt(i,t){var e=this.__data__,n=hNt(e,i);return n<0?(++this.size,e.push([i,t])):e[n][1]=t,this}var pNt=dNt,fNt=KIt,mNt=rNt,gNt=aNt,vNt=uNt,_Nt=pNt;function Wf(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var n=i[t];this.set(n[0],n[1])}}Wf.prototype.clear=fNt;Wf.prototype.delete=mNt;Wf.prototype.get=gNt;Wf.prototype.has=vNt;Wf.prototype.set=_Nt;var Cx=Wf,bNt=Cx;function yNt(){this.__data__=new bNt,this.size=0}var xNt=yNt;function wNt(i){var t=this.__data__,e=t.delete(i);return this.size=t.size,e}var SNt=wNt;function MNt(i){return this.__data__.get(i)}var CNt=MNt;function ENt(i){return this.__data__.has(i)}var TNt=ENt,ANt=typeof zt=="object"&&zt&&zt.Object===Object&&zt,kz=ANt,PNt=kz,RNt=typeof self=="object"&&self&&self.Object===Object&&self,kNt=PNt||RNt||Function("return this")(),ac=kNt,LNt=ac,ONt=LNt.Symbol,Ex=ONt,WR=Ex,Lz=Object.prototype,DNt=Lz.hasOwnProperty,INt=Lz.toString,Ym=WR?WR.toStringTag:void 0;function NNt(i){var t=DNt.call(i,Ym),e=i[Ym];try{i[Ym]=void 0;var n=!0}catch{}var r=INt.call(i);return n&&(t?i[Ym]=e:delete i[Ym]),r}var zNt=NNt,UNt=Object.prototype,FNt=UNt.toString;function VNt(i){return FNt.call(i)}var BNt=VNt,jR=Ex,HNt=zNt,$Nt=BNt,GNt="[object Null]",qNt="[object Undefined]",XR=jR?jR.toStringTag:void 0;function WNt(i){return i==null?i===void 0?qNt:GNt:XR&&XR in Object(i)?HNt(i):$Nt(i)}var Tx=WNt;function jNt(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var Ov=jNt,XNt=Tx,YNt=Ov,KNt="[object AsyncFunction]",ZNt="[object Function]",JNt="[object GeneratorFunction]",QNt="[object Proxy]";function tzt(i){if(!YNt(i))return!1;var t=XNt(i);return t==ZNt||t==JNt||t==KNt||t==QNt}var Oz=tzt,ezt=ac,nzt=ezt["__core-js_shared__"],izt=nzt,wS=izt,YR=function(){var i=/[^.]+$/.exec(wS&&wS.keys&&wS.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function rzt(i){return!!YR&&YR in i}var szt=rzt,ozt=Function.prototype,azt=ozt.toString;function lzt(i){if(i!=null){try{return azt.call(i)}catch{}try{return i+""}catch{}}return""}var Dz=lzt,czt=Oz,uzt=szt,hzt=Ov,dzt=Dz,pzt=/[\\^$.*+?()[\]{}|]/g,fzt=/^\[object .+?Constructor\]$/,mzt=Function.prototype,gzt=Object.prototype,vzt=mzt.toString,_zt=gzt.hasOwnProperty,bzt=RegExp("^"+vzt.call(_zt).replace(pzt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function yzt(i){if(!hzt(i)||uzt(i))return!1;var t=czt(i)?bzt:fzt;return t.test(dzt(i))}var xzt=yzt;function wzt(i,t){return i==null?void 0:i[t]}var Szt=wzt,Mzt=xzt,Czt=Szt;function Ezt(i,t){var e=Czt(i,t);return Mzt(e)?e:void 0}var Xd=Ezt,Tzt=Xd,Azt=ac,Pzt=Tzt(Azt,"Map"),ST=Pzt,Rzt=Xd,kzt=Rzt(Object,"create"),Ax=kzt,KR=Ax;function Lzt(){this.__data__=KR?KR(null):{},this.size=0}var Ozt=Lzt;function Dzt(i){var t=this.has(i)&&delete this.__data__[i];return this.size-=t?1:0,t}var Izt=Dzt,Nzt=Ax,zzt="__lodash_hash_undefined__",Uzt=Object.prototype,Fzt=Uzt.hasOwnProperty;function Vzt(i){var t=this.__data__;if(Nzt){var e=t[i];return e===zzt?void 0:e}return Fzt.call(t,i)?t[i]:void 0}var Bzt=Vzt,Hzt=Ax,$zt=Object.prototype,Gzt=$zt.hasOwnProperty;function qzt(i){var t=this.__data__;return Hzt?t[i]!==void 0:Gzt.call(t,i)}var Wzt=qzt,jzt=Ax,Xzt="__lodash_hash_undefined__";function Yzt(i,t){var e=this.__data__;return this.size+=this.has(i)?0:1,e[i]=jzt&&t===void 0?Xzt:t,this}var Kzt=Yzt,Zzt=Ozt,Jzt=Izt,Qzt=Bzt,t3t=Wzt,e3t=Kzt;function jf(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var n=i[t];this.set(n[0],n[1])}}jf.prototype.clear=Zzt;jf.prototype.delete=Jzt;jf.prototype.get=Qzt;jf.prototype.has=t3t;jf.prototype.set=e3t;var n3t=jf,ZR=n3t,i3t=Cx,r3t=ST;function s3t(){this.size=0,this.__data__={hash:new ZR,map:new(r3t||i3t),string:new ZR}}var o3t=s3t;function a3t(i){var t=typeof i;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?i!=="__proto__":i===null}var l3t=a3t,c3t=l3t;function u3t(i,t){var e=i.__data__;return c3t(t)?e[typeof t=="string"?"string":"hash"]:e.map}var Px=u3t,h3t=Px;function d3t(i){var t=h3t(this,i).delete(i);return this.size-=t?1:0,t}var p3t=d3t,f3t=Px;function m3t(i){return f3t(this,i).get(i)}var g3t=m3t,v3t=Px;function _3t(i){return v3t(this,i).has(i)}var b3t=_3t,y3t=Px;function x3t(i,t){var e=y3t(this,i),n=e.size;return e.set(i,t),this.size+=e.size==n?0:1,this}var w3t=x3t,S3t=o3t,M3t=p3t,C3t=g3t,E3t=b3t,T3t=w3t;function Xf(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var n=i[t];this.set(n[0],n[1])}}Xf.prototype.clear=S3t;Xf.prototype.delete=M3t;Xf.prototype.get=C3t;Xf.prototype.has=E3t;Xf.prototype.set=T3t;var Iz=Xf,A3t=Cx,P3t=ST,R3t=Iz,k3t=200;function L3t(i,t){var e=this.__data__;if(e instanceof A3t){var n=e.__data__;if(!P3t||n.length<k3t-1)return n.push([i,t]),this.size=++e.size,this;e=this.__data__=new R3t(n)}return e.set(i,t),this.size=e.size,this}var O3t=L3t,D3t=Cx,I3t=xNt,N3t=SNt,z3t=CNt,U3t=TNt,F3t=O3t;function Yf(i){var t=this.__data__=new D3t(i);this.size=t.size}Yf.prototype.clear=I3t;Yf.prototype.delete=N3t;Yf.prototype.get=z3t;Yf.prototype.has=U3t;Yf.prototype.set=F3t;var Nz=Yf;function V3t(i,t){for(var e=-1,n=i==null?0:i.length;++e<n&&t(i[e],e,i)!==!1;);return i}var B3t=V3t,H3t=Xd,$3t=function(){try{var i=H3t(Object,"defineProperty");return i({},"",{}),i}catch{}}(),G3t=$3t,JR=G3t;function q3t(i,t,e){t=="__proto__"&&JR?JR(i,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):i[t]=e}var zz=q3t,W3t=zz,j3t=wT,X3t=Object.prototype,Y3t=X3t.hasOwnProperty;function K3t(i,t,e){var n=i[t];(!(Y3t.call(i,t)&&j3t(n,e))||e===void 0&&!(t in i))&&W3t(i,t,e)}var Uz=K3t,Z3t=Uz,J3t=zz;function Q3t(i,t,e,n){var r=!e;e||(e={});for(var s=-1,o=t.length;++s<o;){var a=t[s],l=n?n(e[a],i[a],a,e,i):void 0;l===void 0&&(l=i[a]),r?J3t(e,a,l):Z3t(e,a,l)}return e}var Rx=Q3t;function tUt(i,t){for(var e=-1,n=Array(i);++e<i;)n[e]=t(e);return n}var eUt=tUt;function nUt(i){return i!=null&&typeof i=="object"}var Kf=nUt,iUt=Tx,rUt=Kf,sUt="[object Arguments]";function oUt(i){return rUt(i)&&iUt(i)==sUt}var aUt=oUt,QR=aUt,lUt=Kf,Fz=Object.prototype,cUt=Fz.hasOwnProperty,uUt=Fz.propertyIsEnumerable,hUt=QR(function(){return arguments}())?QR:function(i){return lUt(i)&&cUt.call(i,"callee")&&!uUt.call(i,"callee")},dUt=hUt,pUt=Array.isArray,kx=pUt,ry={exports:{}};function fUt(){return!1}var mUt=fUt;ry.exports;(function(i,t){var e=ac,n=mUt,r=t&&!t.nodeType&&t,s=r&&!0&&i&&!i.nodeType&&i,o=s&&s.exports===r,a=o?e.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||n;i.exports=c})(ry,ry.exports);var MT=ry.exports,gUt=9007199254740991,vUt=/^(?:0|[1-9]\d*)$/;function _Ut(i,t){var e=typeof i;return t=t??gUt,!!t&&(e=="number"||e!="symbol"&&vUt.test(i))&&i>-1&&i%1==0&&i<t}var bUt=_Ut,yUt=9007199254740991;function xUt(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=yUt}var Vz=xUt,wUt=Tx,SUt=Vz,MUt=Kf,CUt="[object Arguments]",EUt="[object Array]",TUt="[object Boolean]",AUt="[object Date]",PUt="[object Error]",RUt="[object Function]",kUt="[object Map]",LUt="[object Number]",OUt="[object Object]",DUt="[object RegExp]",IUt="[object Set]",NUt="[object String]",zUt="[object WeakMap]",UUt="[object ArrayBuffer]",FUt="[object DataView]",VUt="[object Float32Array]",BUt="[object Float64Array]",HUt="[object Int8Array]",$Ut="[object Int16Array]",GUt="[object Int32Array]",qUt="[object Uint8Array]",WUt="[object Uint8ClampedArray]",jUt="[object Uint16Array]",XUt="[object Uint32Array]",Li={};Li[VUt]=Li[BUt]=Li[HUt]=Li[$Ut]=Li[GUt]=Li[qUt]=Li[WUt]=Li[jUt]=Li[XUt]=!0;Li[CUt]=Li[EUt]=Li[UUt]=Li[TUt]=Li[FUt]=Li[AUt]=Li[PUt]=Li[RUt]=Li[kUt]=Li[LUt]=Li[OUt]=Li[DUt]=Li[IUt]=Li[NUt]=Li[zUt]=!1;function YUt(i){return MUt(i)&&SUt(i.length)&&!!Li[wUt(i)]}var KUt=YUt;function ZUt(i){return function(t){return i(t)}}var CT=ZUt,sy={exports:{}};sy.exports;(function(i,t){var e=kz,n=t&&!t.nodeType&&t,r=n&&!0&&i&&!i.nodeType&&i,s=r&&r.exports===n,o=s&&e.process,a=function(){try{var l=r&&r.require&&r.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();i.exports=a})(sy,sy.exports);var ET=sy.exports,JUt=KUt,QUt=CT,tk=ET,ek=tk&&tk.isTypedArray,tFt=ek?QUt(ek):JUt,Bz=tFt,eFt=eUt,nFt=dUt,iFt=kx,rFt=MT,sFt=bUt,oFt=Bz,aFt=Object.prototype,lFt=aFt.hasOwnProperty;function cFt(i,t){var e=iFt(i),n=!e&&nFt(i),r=!e&&!n&&rFt(i),s=!e&&!n&&!r&&oFt(i),o=e||n||r||s,a=o?eFt(i.length,String):[],l=a.length;for(var c in i)(t||lFt.call(i,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||sFt(c,l)))&&a.push(c);return a}var Hz=cFt,uFt=Object.prototype;function hFt(i){var t=i&&i.constructor,e=typeof t=="function"&&t.prototype||uFt;return i===e}var TT=hFt;function dFt(i,t){return function(e){return i(t(e))}}var $z=dFt,pFt=$z,fFt=pFt(Object.keys,Object),mFt=fFt,gFt=TT,vFt=mFt,_Ft=Object.prototype,bFt=_Ft.hasOwnProperty;function yFt(i){if(!gFt(i))return vFt(i);var t=[];for(var e in Object(i))bFt.call(i,e)&&e!="constructor"&&t.push(e);return t}var xFt=yFt,wFt=Oz,SFt=Vz;function MFt(i){return i!=null&&SFt(i.length)&&!wFt(i)}var Gz=MFt,CFt=Hz,EFt=xFt,TFt=Gz;function AFt(i){return TFt(i)?CFt(i):EFt(i)}var AT=AFt,PFt=Rx,RFt=AT;function kFt(i,t){return i&&PFt(t,RFt(t),i)}var LFt=kFt;function OFt(i){var t=[];if(i!=null)for(var e in Object(i))t.push(e);return t}var DFt=OFt,IFt=Ov,NFt=TT,zFt=DFt,UFt=Object.prototype,FFt=UFt.hasOwnProperty;function VFt(i){if(!IFt(i))return zFt(i);var t=NFt(i),e=[];for(var n in i)n=="constructor"&&(t||!FFt.call(i,n))||e.push(n);return e}var BFt=VFt,HFt=Hz,$Ft=BFt,GFt=Gz;function qFt(i){return GFt(i)?HFt(i,!0):$Ft(i)}var PT=qFt,WFt=Rx,jFt=PT;function XFt(i,t){return i&&WFt(t,jFt(t),i)}var YFt=XFt,oy={exports:{}};oy.exports;(function(i,t){var e=ac,n=t&&!t.nodeType&&t,r=n&&!0&&i&&!i.nodeType&&i,s=r&&r.exports===n,o=s?e.Buffer:void 0,a=o?o.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var h=c.length,p=a?a(h):new c.constructor(h);return c.copy(p),p}i.exports=l})(oy,oy.exports);var KFt=oy.exports;function ZFt(i,t){var e=-1,n=i.length;for(t||(t=Array(n));++e<n;)t[e]=i[e];return t}var JFt=ZFt;function QFt(i,t){for(var e=-1,n=i==null?0:i.length,r=0,s=[];++e<n;){var o=i[e];t(o,e,i)&&(s[r++]=o)}return s}var tVt=QFt;function eVt(){return[]}var qz=eVt,nVt=tVt,iVt=qz,rVt=Object.prototype,sVt=rVt.propertyIsEnumerable,nk=Object.getOwnPropertySymbols,oVt=nk?function(i){return i==null?[]:(i=Object(i),nVt(nk(i),function(t){return sVt.call(i,t)}))}:iVt,RT=oVt,aVt=Rx,lVt=RT;function cVt(i,t){return aVt(i,lVt(i),t)}var uVt=cVt;function hVt(i,t){for(var e=-1,n=t.length,r=i.length;++e<n;)i[r+e]=t[e];return i}var Wz=hVt,dVt=$z,pVt=dVt(Object.getPrototypeOf,Object),jz=pVt,fVt=Wz,mVt=jz,gVt=RT,vVt=qz,_Vt=Object.getOwnPropertySymbols,bVt=_Vt?function(i){for(var t=[];i;)fVt(t,gVt(i)),i=mVt(i);return t}:vVt,Xz=bVt,yVt=Rx,xVt=Xz;function wVt(i,t){return yVt(i,xVt(i),t)}var SVt=wVt,MVt=Wz,CVt=kx;function EVt(i,t,e){var n=t(i);return CVt(i)?n:MVt(n,e(i))}var Yz=EVt,TVt=Yz,AVt=RT,PVt=AT;function RVt(i){return TVt(i,PVt,AVt)}var Kz=RVt,kVt=Yz,LVt=Xz,OVt=PT;function DVt(i){return kVt(i,OVt,LVt)}var IVt=DVt,NVt=Xd,zVt=ac,UVt=NVt(zVt,"DataView"),FVt=UVt,VVt=Xd,BVt=ac,HVt=VVt(BVt,"Promise"),$Vt=HVt,GVt=Xd,qVt=ac,WVt=GVt(qVt,"Set"),jVt=WVt,XVt=Xd,YVt=ac,KVt=XVt(YVt,"WeakMap"),ZVt=KVt,aC=FVt,lC=ST,cC=$Vt,uC=jVt,hC=ZVt,Zz=Tx,Zf=Dz,ik="[object Map]",JVt="[object Object]",rk="[object Promise]",sk="[object Set]",ok="[object WeakMap]",ak="[object DataView]",QVt=Zf(aC),tBt=Zf(lC),eBt=Zf(cC),nBt=Zf(uC),iBt=Zf(hC),ad=Zz;(aC&&ad(new aC(new ArrayBuffer(1)))!=ak||lC&&ad(new lC)!=ik||cC&&ad(cC.resolve())!=rk||uC&&ad(new uC)!=sk||hC&&ad(new hC)!=ok)&&(ad=function(i){var t=Zz(i),e=t==JVt?i.constructor:void 0,n=e?Zf(e):"";if(n)switch(n){case QVt:return ak;case tBt:return ik;case eBt:return rk;case nBt:return sk;case iBt:return ok}return t});var Lx=ad,rBt=Object.prototype,sBt=rBt.hasOwnProperty;function oBt(i){var t=i.length,e=new i.constructor(t);return t&&typeof i[0]=="string"&&sBt.call(i,"index")&&(e.index=i.index,e.input=i.input),e}var aBt=oBt,lBt=ac,cBt=lBt.Uint8Array,Jz=cBt,lk=Jz;function uBt(i){var t=new i.constructor(i.byteLength);return new lk(t).set(new lk(i)),t}var kT=uBt,hBt=kT;function dBt(i,t){var e=t?hBt(i.buffer):i.buffer;return new i.constructor(e,i.byteOffset,i.byteLength)}var pBt=dBt,fBt=/\w*$/;function mBt(i){var t=new i.constructor(i.source,fBt.exec(i));return t.lastIndex=i.lastIndex,t}var gBt=mBt,ck=Ex,uk=ck?ck.prototype:void 0,hk=uk?uk.valueOf:void 0;function vBt(i){return hk?Object(hk.call(i)):{}}var _Bt=vBt,bBt=kT;function yBt(i,t){var e=t?bBt(i.buffer):i.buffer;return new i.constructor(e,i.byteOffset,i.length)}var xBt=yBt,wBt=kT,SBt=pBt,MBt=gBt,CBt=_Bt,EBt=xBt,TBt="[object Boolean]",ABt="[object Date]",PBt="[object Map]",RBt="[object Number]",kBt="[object RegExp]",LBt="[object Set]",OBt="[object String]",DBt="[object Symbol]",IBt="[object ArrayBuffer]",NBt="[object DataView]",zBt="[object Float32Array]",UBt="[object Float64Array]",FBt="[object Int8Array]",VBt="[object Int16Array]",BBt="[object Int32Array]",HBt="[object Uint8Array]",$Bt="[object Uint8ClampedArray]",GBt="[object Uint16Array]",qBt="[object Uint32Array]";function WBt(i,t,e){var n=i.constructor;switch(t){case IBt:return wBt(i);case TBt:case ABt:return new n(+i);case NBt:return SBt(i,e);case zBt:case UBt:case FBt:case VBt:case BBt:case HBt:case $Bt:case GBt:case qBt:return EBt(i,e);case PBt:return new n;case RBt:case OBt:return new n(i);case kBt:return MBt(i);case LBt:return new n;case DBt:return CBt(i)}}var jBt=WBt,XBt=Ov,dk=Object.create,YBt=function(){function i(){}return function(t){if(!XBt(t))return{};if(dk)return dk(t);i.prototype=t;var e=new i;return i.prototype=void 0,e}}(),KBt=YBt,ZBt=KBt,JBt=jz,QBt=TT;function t4t(i){return typeof i.constructor=="function"&&!QBt(i)?ZBt(JBt(i)):{}}var e4t=t4t,n4t=Lx,i4t=Kf,r4t="[object Map]";function s4t(i){return i4t(i)&&n4t(i)==r4t}var o4t=s4t,a4t=o4t,l4t=CT,pk=ET,fk=pk&&pk.isMap,c4t=fk?l4t(fk):a4t,u4t=c4t,h4t=Lx,d4t=Kf,p4t="[object Set]";function f4t(i){return d4t(i)&&h4t(i)==p4t}var m4t=f4t,g4t=m4t,v4t=CT,mk=ET,gk=mk&&mk.isSet,_4t=gk?v4t(gk):g4t,b4t=_4t,y4t=Nz,x4t=B3t,w4t=Uz,S4t=LFt,M4t=YFt,C4t=KFt,E4t=JFt,T4t=uVt,A4t=SVt,P4t=Kz,R4t=IVt,k4t=Lx,L4t=aBt,O4t=jBt,D4t=e4t,I4t=kx,N4t=MT,z4t=u4t,U4t=Ov,F4t=b4t,V4t=AT,B4t=PT,H4t=1,$4t=2,G4t=4,Qz="[object Arguments]",q4t="[object Array]",W4t="[object Boolean]",j4t="[object Date]",X4t="[object Error]",t3="[object Function]",Y4t="[object GeneratorFunction]",K4t="[object Map]",Z4t="[object Number]",e3="[object Object]",J4t="[object RegExp]",Q4t="[object Set]",tHt="[object String]",eHt="[object Symbol]",nHt="[object WeakMap]",iHt="[object ArrayBuffer]",rHt="[object DataView]",sHt="[object Float32Array]",oHt="[object Float64Array]",aHt="[object Int8Array]",lHt="[object Int16Array]",cHt="[object Int32Array]",uHt="[object Uint8Array]",hHt="[object Uint8ClampedArray]",dHt="[object Uint16Array]",pHt="[object Uint32Array]",Ti={};Ti[Qz]=Ti[q4t]=Ti[iHt]=Ti[rHt]=Ti[W4t]=Ti[j4t]=Ti[sHt]=Ti[oHt]=Ti[aHt]=Ti[lHt]=Ti[cHt]=Ti[K4t]=Ti[Z4t]=Ti[e3]=Ti[J4t]=Ti[Q4t]=Ti[tHt]=Ti[eHt]=Ti[uHt]=Ti[hHt]=Ti[dHt]=Ti[pHt]=!0;Ti[X4t]=Ti[t3]=Ti[nHt]=!1;function Ub(i,t,e,n,r,s){var o,a=t&H4t,l=t&$4t,c=t&G4t;if(e&&(o=r?e(i,n,r,s):e(i)),o!==void 0)return o;if(!U4t(i))return i;var u=I4t(i);if(u){if(o=L4t(i),!a)return E4t(i,o)}else{var h=k4t(i),p=h==t3||h==Y4t;if(N4t(i))return C4t(i,a);if(h==e3||h==Qz||p&&!r){if(o=l||p?{}:D4t(i),!a)return l?A4t(i,M4t(o,i)):T4t(i,S4t(o,i))}else{if(!Ti[h])return r?i:{};o=O4t(i,h,a)}}s||(s=new y4t);var m=s.get(i);if(m)return m;s.set(i,o),F4t(i)?i.forEach(function(b){o.add(Ub(b,t,e,b,i,s))}):z4t(i)&&i.forEach(function(b,y){o.set(y,Ub(b,t,e,y,i,s))});var v=c?l?R4t:P4t:l?B4t:V4t,_=u?void 0:v(i);return x4t(_||i,function(b,y){_&&(y=b,b=i[y]),w4t(o,y,Ub(b,t,e,y,i,s))}),o}var fHt=Ub,mHt=fHt,gHt=1,vHt=4;function _Ht(i){return mHt(i,gHt|vHt)}var bHt=_Ht;const yHt=zd(bHt);var xHt="__lodash_hash_undefined__";function wHt(i){return this.__data__.set(i,xHt),this}var SHt=wHt;function MHt(i){return this.__data__.has(i)}var CHt=MHt,EHt=Iz,THt=SHt,AHt=CHt;function ay(i){var t=-1,e=i==null?0:i.length;for(this.__data__=new EHt;++t<e;)this.add(i[t])}ay.prototype.add=ay.prototype.push=THt;ay.prototype.has=AHt;var PHt=ay;function RHt(i,t){for(var e=-1,n=i==null?0:i.length;++e<n;)if(t(i[e],e,i))return!0;return!1}var kHt=RHt;function LHt(i,t){return i.has(t)}var OHt=LHt,DHt=PHt,IHt=kHt,NHt=OHt,zHt=1,UHt=2;function FHt(i,t,e,n,r,s){var o=e&zHt,a=i.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(i),u=s.get(t);if(c&&u)return c==t&&u==i;var h=-1,p=!0,m=e&UHt?new DHt:void 0;for(s.set(i,t),s.set(t,i);++h<a;){var v=i[h],_=t[h];if(n)var b=o?n(_,v,h,t,i,s):n(v,_,h,i,t,s);if(b!==void 0){if(b)continue;p=!1;break}if(m){if(!IHt(t,function(y,M){if(!NHt(m,M)&&(v===y||r(v,y,e,n,s)))return m.push(M)})){p=!1;break}}else if(!(v===_||r(v,_,e,n,s))){p=!1;break}}return s.delete(i),s.delete(t),p}var n3=FHt;function VHt(i){var t=-1,e=Array(i.size);return i.forEach(function(n,r){e[++t]=[r,n]}),e}var BHt=VHt;function HHt(i){var t=-1,e=Array(i.size);return i.forEach(function(n){e[++t]=n}),e}var $Ht=HHt,vk=Ex,_k=Jz,GHt=wT,qHt=n3,WHt=BHt,jHt=$Ht,XHt=1,YHt=2,KHt="[object Boolean]",ZHt="[object Date]",JHt="[object Error]",QHt="[object Map]",t5t="[object Number]",e5t="[object RegExp]",n5t="[object Set]",i5t="[object String]",r5t="[object Symbol]",s5t="[object ArrayBuffer]",o5t="[object DataView]",bk=vk?vk.prototype:void 0,SS=bk?bk.valueOf:void 0;function a5t(i,t,e,n,r,s,o){switch(e){case o5t:if(i.byteLength!=t.byteLength||i.byteOffset!=t.byteOffset)return!1;i=i.buffer,t=t.buffer;case s5t:return!(i.byteLength!=t.byteLength||!s(new _k(i),new _k(t)));case KHt:case ZHt:case t5t:return GHt(+i,+t);case JHt:return i.name==t.name&&i.message==t.message;case e5t:case i5t:return i==t+"";case QHt:var a=WHt;case n5t:var l=n&XHt;if(a||(a=jHt),i.size!=t.size&&!l)return!1;var c=o.get(i);if(c)return c==t;n|=YHt,o.set(i,t);var u=qHt(a(i),a(t),n,r,s,o);return o.delete(i),u;case r5t:if(SS)return SS.call(i)==SS.call(t)}return!1}var l5t=a5t,yk=Kz,c5t=1,u5t=Object.prototype,h5t=u5t.hasOwnProperty;function d5t(i,t,e,n,r,s){var o=e&c5t,a=yk(i),l=a.length,c=yk(t),u=c.length;if(l!=u&&!o)return!1;for(var h=l;h--;){var p=a[h];if(!(o?p in t:h5t.call(t,p)))return!1}var m=s.get(i),v=s.get(t);if(m&&v)return m==t&&v==i;var _=!0;s.set(i,t),s.set(t,i);for(var b=o;++h<l;){p=a[h];var y=i[p],M=t[p];if(n)var S=o?n(M,y,p,t,i,s):n(y,M,p,i,t,s);if(!(S===void 0?y===M||r(y,M,e,n,s):S)){_=!1;break}b||(b=p=="constructor")}if(_&&!b){var E=i.constructor,A=t.constructor;E!=A&&"constructor"in i&&"constructor"in t&&!(typeof E=="function"&&E instanceof E&&typeof A=="function"&&A instanceof A)&&(_=!1)}return s.delete(i),s.delete(t),_}var p5t=d5t,MS=Nz,f5t=n3,m5t=l5t,g5t=p5t,xk=Lx,wk=kx,Sk=MT,v5t=Bz,_5t=1,Mk="[object Arguments]",Ck="[object Array]",ib="[object Object]",b5t=Object.prototype,Ek=b5t.hasOwnProperty;function y5t(i,t,e,n,r,s){var o=wk(i),a=wk(t),l=o?Ck:xk(i),c=a?Ck:xk(t);l=l==Mk?ib:l,c=c==Mk?ib:c;var u=l==ib,h=c==ib,p=l==c;if(p&&Sk(i)){if(!Sk(t))return!1;o=!0,u=!1}if(p&&!u)return s||(s=new MS),o||v5t(i)?f5t(i,t,e,n,r,s):m5t(i,t,l,e,n,r,s);if(!(e&_5t)){var m=u&&Ek.call(i,"__wrapped__"),v=h&&Ek.call(t,"__wrapped__");if(m||v){var _=m?i.value():i,b=v?t.value():t;return s||(s=new MS),r(_,b,e,n,s)}}return p?(s||(s=new MS),g5t(i,t,e,n,r,s)):!1}var x5t=y5t,w5t=x5t,Tk=Kf;function i3(i,t,e,n,r){return i===t?!0:i==null||t==null||!Tk(i)&&!Tk(t)?i!==i&&t!==t:w5t(i,t,e,n,i3,r)}var S5t=i3,M5t=S5t;function C5t(i,t){return M5t(i,t)}var E5t=C5t;const T5t=zd(E5t);class r3 extends $o{static initClass(){this.traits=["node","entity","active","latch"]}init(){this.data=void 0,this.isDirty=!0}make(){this._helpers.active.make(),this._listen("root","root.update",function(){this.isActive&&this.update()})}unmake(){this._helpers.active.unmake(),this.data=void 0}swap(){const{deep:t,data:e}=this.props;(t?!T5t(e,this.data):e!=this.data)&&(this.data=t?yHt(e):e)}update(){this.isDirty=this.swap()}}r3.initClass();class LT extends Lv{static initClass(){this.traits=["node","buffer","active","data","source","index","texture","matrix","raw"]}init(){return this.buffer=this.spec=null,this.space={width:0,height:0,history:0},this.used={width:0,height:0},this.storage="matrixBuffer",this.passthrough=(t,e,n)=>t(e,n,0,0),super.init()}sourceShader(t){const e=this.getDimensions();return this.alignShader(e,t),this.buffer.shader(t)}getDimensions(){return{items:this.items,width:this.space.width,height:this.space.height,depth:this.space.history}}getActiveDimensions(){return{items:this.items,width:this.used.width,height:this.used.height,depth:this.buffer.getFilled()}}getFutureDimensions(){return{items:this.items,width:this.used.width,height:this.used.height,depth:this.space.history}}getRawDimensions(){return{items:this.items,width:this.space.width,height:this.space.height,depth:1}}make(){super.make();const t=this.minFilter!=null?this.minFilter:this.props.minFilter,e=this.magFilter!=null?this.magFilter:this.props.magFilter,n=this.type!=null?this.type:this.props.type,{width:r}=this.props,{height:s}=this.props,{history:o}=this.props,a=this.props.bufferWidth,l=this.props.bufferHeight,{channels:c}=this.props,{items:u}=this.props;let h=this.spec={channels:c,items:u,width:r,height:s};this.items=h.items,this.channels=h.channels;const{data:p}=this.props;h=ih(p,h);const{space:m}=this;return m.width=Math.max(a,h.width||1),m.height=Math.max(l,h.height||1),m.history=o,this.buffer=this._renderables.make(this.storage,{width:m.width,height:m.height,history:m.history,channels:c,items:u,minFilter:t,magFilter:e,type:n})}unmake(){if(super.unmake(),this.buffer)return this.buffer.dispose(),this.buffer=this.spec=null}change(t,e,n){if(e.texture||t["matrix.history"]||t["buffer.channels"]||t["buffer.items"]||t["matrix.bufferWidth"]||t["matrix.bufferHeight"])return this.rebuild();if(this.buffer){if(t["matrix.width"]){const{width:r,bufferWidth:s}=this.props;if(this.spec.width=r,r>s)return this.rebuild()}if(t["matrix.height"]){const{height:r,bufferHeight:s}=this.props;if(this.spec.height=r,r>s)return this.rebuild()}if(t["data.map"]||t["data.data"]||t["data.resolve"]||t["data.expr"]||n)return this.buffer.setCallback(this.emitter())}}callback(t){return t.length<=3?t:(e,n,r)=>t(e,n,r,this.bufferClock,this.bufferStep)}update(){if(!this.buffer)return;const{data:t}=this.props,{space:e,used:n}=this,r=n.width,s=n.height,o=this.buffer.getFilled();if(this.syncBuffer(a=>{if(t!=null){const l=ih(t,this.spec);return l.width>e.width||l.height>e.height?(a(),this.rebuild()):(n.width=l.width,n.height=l.height,this.buffer.setActive(n.width,n.height),typeof this.buffer.callback.rebind=="function"&&this.buffer.callback.rebind(t),this.buffer.update())}else{let l;const c=this.spec.width||1,u=this.spec.height||1;this.buffer.setActive(c,u);const h=this.buffer.update();n.width=l=c,n.height=Math.min(u,Math.ceil(h/l)),n.height===1&&(n.width=Math.min(c,h))}}),n.width!==r||n.height!==s||o!==this.buffer.getFilled())return this.trigger({type:"source.resize"})}}LT.initClass();class s3 extends LT{static initClass(){this.traits=["node","buffer","active","data","source","index","matrix","texture","raw","span:x","span:y","area","sampler:x","sampler:y"]}updateSpan(){let t,e;const n=this.props.axes;let{width:r}=this.props,{height:s}=this.props;const{centeredX:o}=this.props,{centeredY:a}=this.props,l=this.props.paddingX,c=this.props.paddingY,u=this._helpers.span.get("x.",n[0]),h=this._helpers.span.get("y.",n[1]);this.aX=u.x,this.aY=h.x;const p=u.y-u.x,m=h.y-h.x;return r+=l*2,s+=c*2,o?(t=1/Math.max(1,r),this.aX+=p*t/2):t=1/Math.max(1,r-1),a?(e=1/Math.max(1,s),this.aY+=m*e/2):e=1/Math.max(1,s-1),this.bX=p*t,this.bY=m*e,this.aX+=l*this.bX,this.aY+=c*this.bY}callback(t){return this.updateSpan(),this.last===t?this._callback:(this.last=t,t.length<=5?this._callback=(e,n,r)=>{const s=this.aX+this.bX*n,o=this.aY+this.bY*r;return t(e,s,o,n,r)}:this._callback=(e,n,r)=>{const s=this.aX+this.bX*n,o=this.aY+this.bY*r;return t(e,s,o,n,r,this.bufferClock,this.bufferStep)})}make(){return super.make(),this._helpers.span.make(),this._listen(this,"span.range",this.updateSpan)}unmake(){return super.unmake(),this._helpers.span.unmake()}change(t,e,n){super.change(t,e,n),(e.x||e.y)&&this.updateSpan()}}s3.initClass();class Dv extends Lv{constructor(...t){super(...t),this.update=this.update.bind(this)}static initClass(){this.traits=["node","buffer","active","data","source","index","texture","voxel","raw"]}init(){this.buffer=this.spec=null,this.space={width:0,height:0,depth:0},this.used={width:0,height:0,depth:0},this.storage="voxelBuffer",this.passthrough=(t,e,n,r)=>t(e,n,r,0),super.init()}sourceShader(t){const e=this.getDimensions();return this.alignShader(e,t),this.buffer.shader(t)}getDimensions(){return{items:this.items,width:this.space.width,height:this.space.height,depth:this.space.depth}}getActiveDimensions(){return{items:this.items,width:this.used.width,height:this.used.height,depth:this.used.depth*this.buffer.getFilled()}}getRawDimensions(){return this.getDimensions()}make(){super.make();const t=this.minFilter!=null?this.minFilter:this.props.minFilter,e=this.magFilter!=null?this.magFilter:this.props.magFilter,n=this.type!=null?this.type:this.props.type,{width:r}=this.props,{height:s}=this.props,{depth:o}=this.props,a=this.props.bufferWidth,l=this.props.bufferHeight,c=this.props.bufferDepth,{channels:u}=this.props,{items:h}=this.props;let p=this.spec={channels:u,items:h,width:r,height:s,depth:o};this.items=p.items,this.channels=p.channels;const{data:m}=this.props;p=ih(m,p);const{space:v}=this;return v.width=Math.max(a,p.width||1),v.height=Math.max(l,p.height||1),v.depth=Math.max(c,p.depth||1),this.buffer=this._renderables.make(this.storage,{width:v.width,height:v.height,depth:v.depth,channels:u,items:h,minFilter:t,magFilter:e,type:n})}unmake(){if(super.unmake(),this.buffer)return this.buffer.dispose(),this.buffer=this.spec=null}change(t,e,n){if(e.texture||t["buffer.channels"]||t["buffer.items"]||t["voxel.bufferWidth"]||t["voxel.bufferHeight"]||t["voxel.bufferDepth"])return this.rebuild();if(this.buffer){if(t["voxel.width"]){const{width:r,bufferWidth:s}=this.props;if(this.spec.width=r,r>s)return this.rebuild()}if(t["voxel.height"]){const{height:r,bufferHeight:s}=this.props;if(this.spec.height=r,r>s)return this.rebuild()}if(t["voxel.depth"]){const{depth:r,bufferDepth:s}=this.props;if(this.spec.depth=r,r>s)return this.rebuild()}if(t["data.map"]||t["data.data"]||t["data.resolve"]||t["data.expr"]||n)return this.buffer.setCallback(this.emitter())}}callback(t){return t.length<=4?t:(e,n,r,s)=>t(e,n,r,s,this.bufferClock,this.bufferStep)}update(){if(!this.buffer)return;const{data:t}=this.props,{space:e,used:n}=this,r=n.width,s=n.height,o=n.depth,a=this.buffer.getFilled();if(this.syncBuffer(l=>{if(t!=null){const c=ih(t,this.spec);return c.width>e.width||c.height>e.height||c.depth>e.depth?(l(),this.rebuild()):(n.width=c.width,n.height=c.height,n.depth=c.depth,this.buffer.setActive(n.width,n.height,n.depth),typeof this.buffer.callback.rebind=="function"&&this.buffer.callback.rebind(t),this.buffer.update())}else{let c,u;const h=this.spec.width||1,p=this.spec.height||1,m=this.spec.depth||1;this.buffer.setActive(h,p,m);const v=this.buffer.update();n.width=u=h,n.height=c=p,n.depth=Math.min(m,Math.ceil(v/u/c)),n.depth===1&&(n.height=Math.min(p,Math.ceil(v/u)),n.height===1&&(n.width=Math.min(h,v)))}}),n.width!==r||n.height!==s||n.depth!==o||a!==this.buffer.getFilled())return this.trigger({type:"source.resize"})}}Dv.initClass();class o3 extends Dv{static initClass(){this.traits=["node","buffer","active","data","source","index","texture","voxel","span:x","span:y","span:z","volume","sampler:x","sampler:y","sampler:z","raw"]}updateSpan(){let t,e,n;const r=this.props.axes;let{width:s}=this.props,{height:o}=this.props,{depth:a}=this.props;const{centeredX:l}=this.props,{centeredY:c}=this.props,{centeredZ:u}=this.props,h=this.props.paddingX,p=this.props.paddingY,m=this.props.paddingZ,v=this._helpers.span.get("x.",r[0]),_=this._helpers.span.get("y.",r[1]),b=this._helpers.span.get("z.",r[2]);this.aX=v.x,this.aY=_.x,this.aZ=b.x;const y=v.y-v.x,M=_.y-_.x,S=b.y-b.x;return s+=h*2,o+=p*2,a+=m*2,l?(t=1/Math.max(1,s),this.aX+=y*t/2):t=1/Math.max(1,s-1),c?(e=1/Math.max(1,o),this.aY+=M*e/2):e=1/Math.max(1,o-1),u?(n=1/Math.max(1,a),this.aZ+=S*n/2):n=1/Math.max(1,a-1),this.bX=y*t,this.bY=M*e,this.bZ=S*n,this.aX+=this.bX*h,this.aY+=this.bY*p,this.aZ+=this.bZ*p}callback(t){return this.updateSpan(),this.last===t?this._callback:(this.last=t,t.length<=7?this._callback=(e,n,r,s)=>{const o=this.aX+this.bX*n,a=this.aY+this.bY*r,l=this.aZ+this.bZ*s;return t(e,o,a,l,n,r,s)}:this._callback=(e,n,r,s)=>{const o=this.aX+this.bX*n,a=this.aY+this.bY*r,l=this.aZ+this.bZ*s;return t(e,o,a,l,n,r,s,this.bufferClock,this.bufferStep)})}make(){return super.make(),this._helpers.span.make(),this._listen(this,"span.range",this.updateSpan)}unmake(){return super.unmake(),this._helpers.span.unmake()}change(t,e,n){super.change(t,e,n),(e.x||e.y||e.z)&&this.updateSpan()}}o3.initClass();const OT=function(i,t,e){+t===t&&(t=[t]);const n=Array.from(t).includes(1)?0:e.x,r=Array.from(t).includes(2)?0:e.y,s=Array.from(t).includes(3)?0:e.z,o=Array.from(t).includes(4)?0:e.w;return i.set(n,r,s,o)},DT=function(){const i=new Vn;return function(t,e,n){return OT(i,e,n),t.add(i)}}(),xd=function(i,t){const e=t===1?1:0,n=t===2?1:0,r=t===3?1:0,s=t===4?1:0;return i.set(e,n,r,s)},A5t=function(i,t){const e=t===1?1:0,n=t===2?1:0,r=t===3?1:0,s=t===4?1:0;return i.set(n,r+e,s,0)},Cf=function(){const i=[0,0];return function(t,e,n,r){if(r==null&&(r=0),n>0){const s=t,o=t+e,a=Math.max(Math.abs(s),Math.abs(o)),l=a*r,c=Math.min(s,o),u=Math.max(s,o);t=c+(-a+l-c)*n,e=u+(a+l-u)*n-t}return i[0]=t,i[1]=e,i}}(),P5t=Object.freeze(Object.defineProperty({__proto__:null,addOrigin:DT,recenterAxis:Cf,setDimension:xd,setDimensionNormal:A5t,setOrigin:OT},Symbol.toStringTag,{value:"Module"}));class a3 extends Sx{static initClass(){this.traits=["node","source","index","interval","span","scale","raw","origin"]}init(){return this.used=this.space=this.scaleAxis=this.sampler=null}rawBuffer(){return this.buffer}sourceShader(t){return t.pipe(this.sampler)}getDimensions(){return{items:1,width:this.space,height:1,depth:1}}getActiveDimensions(){return{items:1,width:this.used,height:this.buffer.getFilled(),depth:1}}getRawDimensions(){return this.getDimensions()}make(){let t;this.space=t=this._helpers.scale.divide(""),this.buffer=this._renderables.make("dataBuffer",{width:t,channels:1,items:1});const e={scaleAxis:this._attributes.make(this._types.vec4()),scaleOffset:this._attributes.make(this._types.vec4())};this.scaleAxis=e.scaleAxis.value,this.scaleOffset=e.scaleOffset.value;const n=this.sampler=this._shaders.shader();return n.require(this.buffer.shader(this._shaders.shader(),1)),n.pipe("scale.position",e),this._helpers.span.make(),this._listen(this,"span.range",this.updateRanges)}unmake(){return this.scaleAxis=null,this._helpers.span.unmake()}change(t,e,n){if(t["scale.divide"])return this.rebuild();if(e.view||e.interval||e.span||e.scale||e.origin||n)return this.updateRanges()}updateRanges(){const{used:t}=this,{axis:e,origin:n}=this.props,r=this._helpers.span.get("",e),s=r.x,o=r.y,a=this._helpers.scale.generate("",this.buffer,s,o);if(xd(this.scaleAxis,e),OT(this.scaleOffset,e,n),this.used=a.length,this.used!==t)return this.trigger({type:"source.resize"})}}a3.initClass();const Fo=function(){const i={};for(const t of Array.from(arguments))for(const e in t){const n=t[e];i[e]=n}return i},R5t=i=>JSON.parse(JSON.serialize(i)),l3=function(i){let t="";const e=o=>o=o.replace(/\\/g,""),n=function(o){return t.length&&s.push(e(t)),t=o??""};i=i.split(/(?=(?:\\.|["' ,]))/g);let r=!1;const s=[];for(const o of Array.from(i)){const a=o[0],l=o.slice(1);switch(a){case'"':case"'":if(r)r===a?(r=!1,n(l)):t+=o;else{if(t!=="")throw new Error(`ParseError: String \`${i}\` does not contain comma-separated quoted tokens.`);r=a,t+=l}break;case" ":case",":r?t+=o:n(l);break;default:t+=o}}return n(),s},k5t=Object.freeze(Object.defineProperty({__proto__:null,clone:R5t,merge:Fo,parseQuoted:l3},Symbol.toStringTag,{value:"Module"}));let c3=class extends gr{static initClass(){this.traits=["node","object","visible","style","line","axis","span","interval","arrow","position","origin","shade"],this.defaults={end:!0,zBias:-1}}constructor(t,e,n){super(t,e,n),this.axisPosition=this.axisStep=this.resolution=this.line=this.arrows=null}make(){const t={axisPosition:this._attributes.make(this._types.vec4()),axisStep:this._attributes.make(this._types.vec4())};this.axisPosition=t.axisPosition.value,this.axisStep=t.axisStep.value;let e=this._shaders.shader();e.pipe("axis.position",t),e=this._helpers.position.pipeline(e);const n=this._helpers.style.uniforms(),r=this._helpers.line.uniforms(),s=this._helpers.arrow.uniforms(),o=this._inherit("unit").getUnitUniforms(),{detail:a}=this.props,l=a+1;this.resolution=1/a;const{start:c,end:u}=this.props,{stroke:h,join:p}=this.props;let m=this._helpers.object.mask();const v=this._helpers.shade.pipeline()||!1,{crossed:_,axis:b}=this.props;if(!_&&m!=null&&b>1){const M=["x000","y000","z000","w000"][b];m=this._helpers.position.swizzle(m,M)}const y=Fo(s,r,n,o);return this.line=this._renderables.make("line",{uniforms:y,samples:l,position:e,clip:c||u,stroke:h,join:p,mask:m,material:v}),this.arrows=[],c&&this.arrows.push(this._renderables.make("arrow",{uniforms:y,flip:!0,samples:l,position:e,mask:m,material:v})),u&&this.arrows.push(this._renderables.make("arrow",{uniforms:y,samples:l,position:e,mask:m,material:v})),this._helpers.visible.make(),this._helpers.object.make(this.arrows.concat([this.line])),this._helpers.span.make(),this._listen(this,"span.range",this.updateRanges)}unmake(){return this._helpers.visible.unmake(),this._helpers.object.unmake(),this._helpers.span.unmake()}change(t,e,n){if(t["axis.detail"]||t["line.stroke"]||t["line.join"]||t["axis.crossed"]||t["interval.axis"]&&this.props.crossed)return this.rebuild();if(e.interval||e.span||e.view||e.origin||n)return this.updateRanges()}updateRanges(){const{axis:t,origin:e}=this.props,n=this._helpers.span.get("",t),r=n.x,s=n.y;return xd(this.axisPosition,t).multiplyScalar(r),xd(this.axisStep,t).multiplyScalar((s-r)*this.resolution),DT(this.axisPosition,t,e)}};c3.initClass();let u3=class extends gr{static initClass(){this.traits=["node","object","visible","style","line","mesh","face","geometry","position","bind","shade"]}constructor(t,e,n){super(t,e,n),this.face=null}resize(){if(this.bind.points==null)return;const t=this.bind.points.getActiveDimensions(),{items:e,width:n,height:r,depth:s}=t;if(this.face&&this.face.geometry.clip(n,r,s,e),this.line&&this.line.geometry.clip(e,n,r,s),this.bind.map!=null){const o=this.bind.map.getActiveDimensions();if(this.face)return this.face.geometry.map(o.width,o.height,o.depth,o.items)}}make(){let t,e;if(this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"mesh.map",trait:"source"}]),this.bind.points==null)return;let n=this.bind.points.sourceShader(this._shaders.shader());n=this._helpers.position.pipeline(n);const r=this._helpers.style.uniforms(),s=this._helpers.line.uniforms(),o=this._inherit("unit").getUnitUniforms(),a={};a.styleZBias=this._attributes.make(this._types.number()),this.wireZBias=a.styleZBias;const l=this.bind.points.getDimensions(),{items:c,width:u,height:h,depth:p}=l,{line:m,shaded:v,fill:_,stroke:b,join:y}=this.props;this.bind.colors&&(t=this._shaders.shader(),this.bind.colors.sourceShader(t));const M=this._helpers.object.mask(),S=this._helpers.shade.map(this.bind.map!=null?this.bind.map.sourceShader(this._shaders.shader()):void 0),E=this._helpers.shade.pipeline(),A=E||v,R=E||!1,O=[];if(m){const L=this._shaders.shader();L.pipe(Do("yzwx")),L.pipe(n),e=Fo(o,s,r,a),this.line=this._renderables.make("line",{uniforms:e,samples:c,strips:u,ribbons:h,layers:p,position:L,color:t,stroke:b,join:y,material:R,mask:M,closed:!0}),O.push(this.line)}return _&&(e=Fo(o,r,{}),this.face=this._renderables.make("face",{uniforms:e,width:u,height:h,depth:p,items:c,position:n,color:t,material:A,mask:M,map:S}),O.push(this.face)),this._helpers.visible.make(),this._helpers.object.make(O)}made(){return this.resize()}unmake(){return this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake(),this.face=this.line=null}change(t,e,n){if(t["geometry.points"]||e.mesh)return this.rebuild();if(t["style.zBias"]||t["mesh.lineBias"]||n){const{fill:r,zBias:s,lineBias:o}=this.props;return this.wireZBias.value=s+(r?o:0)}}};u3.initClass();class h3 extends gr{static initClass(){this.traits=["node","object","visible","style","line","grid","area","position","origin","shade","axis:x","axis:y","scale:x","scale:y","span:x","span:y"],this.defaults={width:1,zBias:-2}}constructor(t,e,n){super(t,e,n),this.axes=null}make(){let t,e=this._helpers.object.mask();const n=this._helpers.shade.pipeline()||!1;t=(p,m,v)=>{let _;const b=this._get(p+"axis.detail"),y=b+1,M=1/b,S=this._helpers.scale.divide(m),E=this._renderables.make("dataBuffer",{width:S,channels:1}),A={gridPosition:this._attributes.make(this._types.vec4()),gridStep:this._attributes.make(this._types.vec4()),gridAxis:this._attributes.make(this._types.vec4())},R={gridPosition:A.gridPosition.value,gridStep:A.gridStep.value,gridAxis:A.gridAxis.value},O=_=this._shaders.shader();v!=null&&e!=null&&(e=this._helpers.position.swizzle(e,v)),O.require(E.shader(this._shaders.shader(),2)),O.pipe("grid.position",A),_=this._helpers.position.pipeline(O);const L=this._helpers.style.uniforms(),P=this._helpers.line.uniforms(),D=this._inherit("unit").getUnitUniforms(),V=Fo(P,L,D),K=this._renderables.make("line",{uniforms:V,samples:y,strips:S,position:_,stroke:c,join:u,mask:e,material:n});return{first:p,second:m,resolution:M,samples:y,line:K,buffer:E,values:R}};const{lineX:r,lineY:s,crossed:o,axes:a}=this.props,l=["0000","x000","y000","z000","w000"][a[1]],{stroke:c,join:u}=this.props;this.axes=[],r&&this.axes.push(t("x.","y.",null)),s&&this.axes.push(t("y.","x.",o?null:l));const h=(()=>{const p=[];for(t of this.axes)p.push(t.line);return p})();return this._helpers.visible.make(),this._helpers.object.make(h),this._helpers.span.make(),this._listen(this,"span.range",this.updateRanges)}unmake(){this._helpers.visible.unmake(),this._helpers.object.unmake(),this._helpers.span.unmake();for(const t of this.axes)t.buffer.dispose();this.axes=null}change(t,e,n){if(t["x.axis.detail"]||t["y.axis.detail"]||t["x.axis.factor"]||t["y.axis.factor"]||t["grid.lineX"]||t["grid.lineY"]||t["line.stroke"]||t["line.join"]||t["grid.crossed"]||t["grid.axes"]&&this.props.crossed)return this.rebuild();if(e.x||e.y||e.area||e.grid||e.view||e.origin||n)return this.updateRanges()}updateRanges(){const t=(l,c,u,h,p)=>{const{second:m,resolution:v,samples:_,line:b,buffer:y,values:M}=p;let S=u.x,E=u.y;xd(M.gridPosition,l).multiplyScalar(S),xd(M.gridStep,l).multiplyScalar((E-S)*v),DT(M.gridPosition,e,n),S=h.x,E=h.y;const A=this._helpers.scale.generate(m,y,S,E);xd(M.gridAxis,c);const R=A.length;return b.geometry.clip(_,R,1,1)},{axes:e,origin:n}=this.props,r=this._helpers.span.get("x.",e[0]),s=this._helpers.span.get("y.",e[1]),{lineX:o,lineY:a}=this.props;o&&t(e[0],e[1],r,s,this.axes[0]),a&&t(e[1],e[0],s,r,this.axes[+o]),window.cake1=this.axes[0].buffer,window.cake2=this.axes[1].buffer,window.cake3=this.axes[0]}}h3.initClass();let d3=class extends gr{static initClass(){this.traits=["node","object","visible","style","line","arrow","geometry","position","bind","shade"]}constructor(t,e,n){super(t,e,n),this.line=this.arrows=null}resize(){if(this.bind.points==null)return;const t=this.bind.points.getActiveDimensions(),e=t.width,n=t.height,r=t.depth,s=t.items;return this.line.geometry.clip(e,n,r,s),Array.from(this.arrows).map(o=>o.geometry.clip(e,n,r,s))}make(){let t;if(this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]),this.bind.points==null)return;let e=this._shaders.shader();e=this.bind.points.sourceShader(e),e=this._helpers.position.pipeline(e);const n=this._helpers.style.uniforms(),r=this._helpers.line.uniforms(),s=this._helpers.arrow.uniforms(),o=this._inherit("unit").getUnitUniforms(),{start:a,end:l}=this.props,{stroke:c,join:u,proximity:h,closed:p}=this.props;this.proximity=h;const m=this.bind.points.getDimensions(),v=m.width,_=m.height,b=m.depth,y=m.items;this.bind.colors&&(t=this._shaders.shader(),this.bind.colors.sourceShader(t));const M=this._helpers.object.mask(),S=this._helpers.shade.pipeline()||!1,E=Fo(s,r,n,o);return this.line=this._renderables.make("line",{uniforms:E,samples:v,strips:_,ribbons:b,layers:y,position:e,color:t,clip:a||l,stroke:c,join:u,proximity:h,closed:p,mask:M,material:S}),this.arrows=[],a&&this.arrows.push(this._renderables.make("arrow",{uniforms:E,flip:!0,samples:v,strips:_,ribbons:b,layers:y,position:e,color:t,closed:p,mask:M,material:S})),l&&this.arrows.push(this._renderables.make("arrow",{uniforms:E,samples:v,strips:_,ribbons:b,layers:y,position:e,color:t,closed:p,mask:M,material:S})),this._helpers.visible.make(),this._helpers.object.make(this.arrows.concat([this.line]))}made(){return this.resize()}unmake(){return this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake(),this.line=this.arrows=null}change(t,e,n){if(t["geometry.points"]||t["line.stroke"]||t["line.join"]||t["arrow.start"]||t["arrow.end"])return this.rebuild();if(t["line.proximity"]&&this.proximity!=null!=(this.props.proximity!=null))return this.rebuild()}};d3.initClass();let p3=class extends gr{static initClass(){this.traits=["node","object","visible","style","point","geometry","position","bind","shade"]}constructor(t,e,n){super(t,e,n),this.point=null}resize(){if(this.bind.points==null)return;const t=this.bind.points.getActiveDimensions(),{items:e,width:n,height:r,depth:s}=t;return this.point.geometry.clip(n,r,s,e)}make(){let t,e;if(this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"point.sizes",trait:"source"}]),this.bind.points==null)return;let n=this._shaders.shader();n=this.bind.points.sourceShader(n),n=this._helpers.position.pipeline(n);const r=this.bind.points.getDimensions(),{items:s,width:o,height:a,depth:l}=r,c=this._helpers.style.uniforms(),u=this._helpers.point.uniforms(),h=this._inherit("unit").getUnitUniforms();this.bind.colors&&(t=this._shaders.shader(),this.bind.colors.sourceShader(t)),this.bind.sizes&&(e=this._shaders.shader(),this.bind.sizes.sourceShader(e));const p=this._helpers.object.mask(),m=this._helpers.shade.pipeline()||!1,{shape:v}=this.props,{fill:_}=this.props,{optical:b}=this.props,y=Fo(h,u,c);this.point=this._renderables.make("point",{uniforms:y,width:o,height:a,depth:l,items:s,position:n,color:t,size:e,shape:v,optical:b,fill:_,mask:p,material:m}),this._helpers.visible.make(),this._helpers.object.make([this.point])}made(){return this.resize()}unmake(){this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake(),this.point=null}change(t,e,n){if(t["geometry.points"]||t["point.shape"]||t["point.fill"])return this.rebuild()}};p3.initClass();let f3=class extends gr{static initClass(){this.traits=["node","object","visible","style","line","mesh","strip","geometry","position","bind","shade"]}constructor(t,e,n){super(t,e,n),this.strip=null}resize(){if(this.bind.points==null)return;const t=this.bind.points.getActiveDimensions(),{items:e,width:n,height:r,depth:s}=t;if(this.strip&&this.strip.geometry.clip(n,r,s,e),this.line&&this.line.geometry.clip(e,n,r,s),this.bind.map!=null){const o=this.bind.map.getActiveDimensions();if(this.strip)return this.strip.geometry.map(o.width,o.height,o.depth,o.items)}}make(){let t,e;if(this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"mesh.map",trait:"source"}]),this.bind.points==null)return;let n=this._shaders.shader();n=this.bind.points.sourceShader(n),n=this._helpers.position.pipeline(n);const r=this._helpers.style.uniforms(),s=this._helpers.line.uniforms(),o=this._inherit("unit").getUnitUniforms(),{line:a,shaded:l,fill:c,stroke:u,join:h}=this.props,p={};p.styleZBias=this._attributes.make(this._types.number()),this.wireZBias=p.styleZBias;const m=this.bind.points.getDimensions(),{items:v,width:_,height:b,depth:y}=m;this.bind.colors&&(t=this._shaders.shader(),t=this.bind.colors.sourceShader(t));const M=this._helpers.object.mask();this._helpers.shade.map(this.bind.map!=null?this.bind.map.sourceShader(this._shaders.shader()):void 0);const S=this._helpers.shade.pipeline(),E=S||l,A=S||!1,R=[];if(a){const O=this._shaders.shader();O.pipe(Do("yzwx")),O.pipe(n),e=Fo(o,s,r,p),this.line=this._renderables.make("line",{uniforms:e,samples:v,strips:_,ribbons:b,layers:y,position:O,color:t,stroke:u,join:h,mask:M,material:A}),R.push(this.line)}return c&&(e=Fo(r,{}),this.strip=this._renderables.make("strip",{uniforms:e,width:_,height:b,depth:y,items:v,position:n,color:t,material:E}),R.push(this.strip)),this._helpers.visible.make(),this._helpers.object.make(R)}made(){return this.resize()}unmake(){return this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake(),this.strip=null}change(t,e,n){if(t["geometry.points"]||e.mesh)return this.rebuild();if(t["style.zBias"]||t["mesh.lineBias"]||n){const{fill:r,zBias:s,lineBias:o}=this.props;return this.wireZBias.value=s+(r?o:0)}}};f3.initClass();let m3=class extends gr{static initClass(){this.traits=["node","object","visible","style","line","mesh","geometry","surface","position","grid","bind","shade"],this.defaults={lineX:!1,lineY:!1}}constructor(t,e,n){super(t,e,n),this.lineX=this.lineY=this.surface=null}resize(){if(this.bind.points==null)return;const t=this.bind.points.getActiveDimensions(),{width:e,height:n,depth:r,items:s}=t;if(this.surface&&this.surface.geometry.clip(e,n,r,s),this.lineX&&this.lineX.geometry.clip(e,n,r,s),this.lineY&&this.lineY.geometry.clip(n,e,r,s),this.bind.map!=null){const o=this.bind.map.getActiveDimensions();if(this.surface)return this.surface.geometry.map(o.width,o.height,o.depth,o.items)}}make(){let t,e;if(this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"mesh.normals",trait:"source"},{to:"mesh.map",trait:"source"}]),this.bind.points==null)return;let n=this._shaders.shader();n=this.bind.points.sourceShader(n),n=this._helpers.position.pipeline(n);const r=this._helpers.style.uniforms(),s=this._helpers.style.uniforms(),o=this._helpers.line.uniforms(),a=this._helpers.surface.uniforms(),l=this._inherit("unit").getUnitUniforms();s.styleColor=this._attributes.make(this._types.color()),s.styleZBias=this._attributes.make(this._types.number()),this.wireColor=s.styleColor.value,this.wireZBias=s.styleZBias,this.wireScratch=new me;const c=this.bind.points.getDimensions(),{width:u,height:h,depth:p,items:m}=c,{shaded:v,fill:_,lineX:b,lineY:y,closedX:M,closedY:S,stroke:E,join:A,proximity:R,crossed:O}=this.props,L=[];this.proximity=R,this.bind.normals!=null&&(e=this._shaders.shader(),this.bind.normals.sourceShader(e),this._helpers.shade.normal(e)),this.bind.colors!=null&&(t=this._shaders.shader(),this.bind.colors.sourceShader(t));const P=this._helpers.object.mask(),D=this._helpers.shade.map(this.bind.map!=null?this.bind.map.sourceShader(this._shaders.shader()):void 0),V=this._helpers.shade.pipeline(),K=V||v,W=V||!1,{swizzle:Z,swizzle2:z}=this._helpers.position;let ut=Fo(l,o,r,s);const nt=b||y?-50:0;return b&&(this.lineX=this._renderables.make("line",{uniforms:ut,samples:u,strips:h,ribbons:p,layers:m,position:n,color:t,normal:e,zUnits:-nt,stroke:E,join:A,mask:P,material:W,proximity:R,closed:M||closed}),L.push(this.lineX)),y&&(this.lineY=this._renderables.make("line",{uniforms:ut,samples:h,strips:u,ribbons:p,layers:m,position:z(n,"yxzw","yxzw"),color:Z(t,"yxzw"),zUnits:-nt,stroke:E,join:A,mask:Z(P,O?"xyzw":"yxzw"),material:W,proximity:R,closed:S||closed}),L.push(this.lineY)),_&&(ut=Fo(l,a,r),this.surface=this._renderables.make("surface",{uniforms:ut,width:u,height:h,surfaces:p,layers:m,position:n,color:t,zUnits:nt,stroke:E,material:K,mask:P,map:D,intUV:!0,closedX:M||closed,closedY:S||closed}),L.push(this.surface)),this._helpers.visible.make(),this._helpers.object.make(L)}made(){return this.resize()}unmake(){return this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake(),this.lineX=this.lineY=this.surface=null}_convertGammaToLinear(t,e=2){return t.r=Math.pow(t.r,e),t.g=Math.pow(t.g,e),t.b=Math.pow(t.b,e),t}_convertLinearToGamma(t,e=2){const n=e>0?1/e:1;return t.r=Math.pow(t.r,n),t.g=Math.pow(t.g,n),t.b=Math.pow(t.b,n),t}change(t,e,n){if(t["geometry.points"]||t["mesh.shaded"]||t["mesh.fill"]||t["line.stroke"]||t["line.join"]||e.grid)return this.rebuild();if(t["style.color"]||t["style.zBias"]||t["mesh.fill"]||t["mesh.lineBias"]||n){const{fill:r,color:s,zBias:o,lineBias:a}=this.props;if(this.wireZBias.value=o+(r?a:0),this.wireColor.copy(s),r){const l=this.wireScratch;l.setRGB(s.r,s.g,s.b),this._convertLinearToGamma(this._convertGammaToLinear(l).multiplyScalar(.75)),this.wireColor.r=l.r,this.wireColor.g=l.g,this.wireColor.b=l.b}}if(t["line.proximity"]&&this.proximity!=null!=(this.props.proximity!=null))return this.rebuild()}};m3.initClass();let g3=class extends gr{static initClass(){this.traits=["node","object","visible","style","line","ticks","geometry","position","bind","shade"]}init(){return this.tickStrip=this.line=null}resize(){if(this.bind.points==null)return;const t=this.bind.points.getActiveDimensions(),e=+(t.items>0),n=t.width*e,r=t.height*e,s=t.depth*e;return this.line.geometry.clip(2,n,r,s),this.tickStrip.set(0,n-1)}make(){let t,e;if(this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]),this.bind.points==null)return;const n=this._helpers.style.uniforms(),r=this._helpers.line.uniforms(),s=this._inherit("unit").getUnitUniforms(),o=Fo(r,n,s),a={tickEpsilon:this.node.attributes["ticks.epsilon"],tickSize:this.node.attributes["ticks.size"],tickNormal:this.node.attributes["ticks.normal"],tickStrip:this._attributes.make(this._types.vec2(0,0)),worldUnit:o.worldUnit,focusDepth:o.focusDepth};this.tickStrip=a.tickStrip.value;const l=e=this._shaders.shader();l.require(this.bind.points.sourceShader(this._shaders.shader())),l.require(this._helpers.position.pipeline(this._shaders.shader())),l.pipe("ticks.position",a);const{stroke:c,join:u}=this.props,h=this.bind.points.getDimensions(),p=h.width,m=h.height,v=h.depth;this.bind.colors&&(t=this._shaders.shader(),this.bind.colors.sourceShader(t));const _=this._helpers.object.mask(),b=this._helpers.shade.pipeline()||!1,{swizzle:y}=this._helpers.position;return this.line=this._renderables.make("line",{uniforms:o,samples:2,strips:p,ribbons:m,layers:v,position:e,color:t,stroke:c,join:u,mask:y(_,"yzwx"),material:b}),this._helpers.visible.make(),this._helpers.object.make([this.line])}made(){return this.resize()}unmake(){return this.line=null,this._helpers.visible.unmake(),this._helpers.object.unmake()}change(t,e,n){if(t["geometry.points"]||t["line.stroke"]||t["line.join"])return this.rebuild()}};g3.initClass();class v3 extends gr{static initClass(){this.traits=["node","object","visible","style","line","arrow","geometry","position","bind","shade"]}constructor(t,e,n){super(t,e,n),this.line=this.arrows=null}resize(){if(this.bind.points==null)return;const t=this.bind.points.getActiveDimensions(),e=t.items,n=t.width,r=t.height,s=t.depth;return this.line.geometry.clip(e,n,r,s),Array.from(this.arrows).map(o=>o.geometry.clip(e,n,r,s))}make(){let t;if(this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]),this.bind.points==null)return;let e=this._shaders.shader();this.bind.points.sourceShader(e),this._helpers.position.pipeline(e);const n=this._helpers.style.uniforms(),r=this._helpers.line.uniforms(),s=this._helpers.arrow.uniforms(),o=this._inherit("unit").getUnitUniforms(),{start:a,end:l}=this.props,{stroke:c,join:u,proximity:h,closed:p}=this.props;this.proximity=h;const m=this.bind.points.getDimensions(),v=m.items,_=m.width,b=m.height,y=m.depth;this.bind.colors&&(t=this._shaders.shader(),this.bind.colors.sourceShader(t));let M=this._helpers.object.mask(),S=this._helpers.shade.pipeline()||!1;const{swizzle:E,swizzle2:A}=this._helpers.position;e=A(e,"yzwx","yzwx"),t=E(t,"yzwx"),M=E(M,"yzwx"),S=E(S,"yzwx");const R=Fo(s,r,n,o);return this.line=this._renderables.make("line",{uniforms:R,samples:v,ribbons:b,strips:_,layers:y,position:e,color:t,clip:a||l,stroke:c,join:u,proximity:h,closed:p,mask:M,material:S}),this.arrows=[],a&&this.arrows.push(this._renderables.make("arrow",{uniforms:R,flip:!0,samples:v,ribbons:b,strips:_,layers:y,position:e,color:t,closed:p,mask:M,material:S})),l&&this.arrows.push(this._renderables.make("arrow",{uniforms:R,samples:v,ribbons:b,strips:_,layers:y,position:e,color:t,closed:p,mask:M,material:S})),this._helpers.visible.make(),this._helpers.object.make(this.arrows.concat([this.line]))}made(){return this.resize()}unmake(){return this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake(),this.line=this.arrows=null}change(t,e,n){if(t["geometry.points"]||t["line.stroke"]||t["line.join"]||t["arrow.start"]||t["arrow.end"])return this.rebuild();if(t["line.proximity"]&&this.proximity!=null!=(this.props.proximity!=null))return this.rebuild()}}v3.initClass();class _3 extends Dv{static initClass(){this.traits=["node","buffer","active","data","voxel","html"],this.finals={channels:1}}init(){super.init(),this.storage="pushBuffer"}make(){super.make();const{items:t,width:e,height:n,depth:r}=this.getDimensions();return this.dom=this._overlays.make("dom"),this.dom.hint(t*e*n*r)}unmake(){if(super.unmake(),this.dom!=null)return this.dom.dispose(),this.dom=null}update(){return super.update()}change(t,e,n){return e.html?this.rebuild():super.change(t,e,n)}nodes(){return this.buffer.read()}callback(t){const{el:e}=this.dom;return t.length<=6?(n,r,s,o,a)=>t(n,e,r,s,o,a):(n,r,s,o,a)=>t(n,e,r,s,o,a,this.bufferClock,this.bufferStep)}}_3.initClass();class b3 extends gr{static initClass(){this.traits=["node","bind","object","visible","overlay","dom","attach","position"]}init(){this.emitter=this.root=null,this.active={}}make(){if(super.make(),this._helpers.bind.make([{to:"dom.html",trait:"html"},{to:"dom.points",trait:"source"}]),this.bind.points==null||this.bind.html==null)return;this.root=this._inherit("root"),this._listen("root","root.update",this.update),this._listen("root","root.post",this.post);const t=this.bind.points.getDimensions(),e=this.bind.html.getDimensions(),n=Math.min(t.items,e.items),r=Math.min(t.width,e.width),s=Math.min(t.height,e.height),o=Math.min(t.depth,e.depth);let a=this.bind.points.sourceShader(this._shaders.shader());a=this._helpers.position.pipeline(a);const l=this._shaders.shader({globals:["projectionMatrix"]});l.pipe("project.readback"),a.pipe(l);const c=this._shaders.shader();this.readback=this._renderables.make("readback",{map:a,indexer:c,items:n,width:r,height:s,depth:o,channels:4,stpq:!0}),this.dom=this._overlays.make("dom"),this.dom.hint(n*r*s*o*2),this.emitter=this.callback(this.bind.html.nodes()),this.readback.setCallback(this.emitter),this._helpers.visible.make()}unmake(){this.readback!=null&&(this.readback.dispose(),this.dom.dispose(),this.readback=this.dom=null,this.root=null,this.emitter=null,this.active={}),this._helpers.bind.unmake(),this._helpers.visible.unmake()}update(){this.readback!=null&&this.props.visible&&(this.readback.update(this.root!=null?this.root.getCamera():void 0),this.readback.post(),this.readback.iterate())}post(){this.readback!=null&&this.dom.render(this.isVisible?this.emitter.nodes():null)}callback(t){let e,n;const r=this._inherit("unit").getUnitUniforms(),s=r.viewWidth,o=r.viewHeight,a=this.node.attributes["dom.attributes"],l=this.node.attributes["dom.size"],c=this.node.attributes["dom.zoom"],u=this.node.attributes["dom.color"],h=this.node.attributes["dom.outline"],p=this.node.attributes["dom.pointerEvents"],m=this.node.attributes["overlay.opacity"],v=this.node.attributes["overlay.zIndex"],_=this.node.attributes["attach.offset"],b=this.node.attributes["attach.depth"],y=this.node.attributes["attach.snap"],{el:M}=this.dom;let S=[],E=null,A=null,R=e=n=0,O="";const L=function(P,D,V,K,W,Z,z,ut){let nt;const Q=ut+R*W+e*Z+n*z,St=t[Q],Pt=K<0,Rt=1+(1/K-1)*b.value,Jt=Pt?0:Rt,Bt=+_.value.x*Jt,Wt=+_.value.y*Jt;let be=(P+1)*s.value*.5+Bt,re=(D-1)*o.value*.5+Wt;be/=c.value,re/=c.value,y.value&&(be=Math.round(be),re=Math.round(re));const It=Math.min(.999,Pt?0:m.value),ye={className:A,style:{transform:`translate3d(${be}px, ${-re}px, ${1-K}px) translate(-50%, -50%) scale(${Jt},${Jt})`,opacity:It}};for(z in E)nt=E[z],ye.style[z]=nt;const ce=a.value;if(ce!=null){const ne=ce.style;for(z in ce)nt=ce[z],["style","className"].includes(z)||(ye[z]=nt);if(ne!=null)for(z in ne)nt=ne[z],ye.style[z]=nt}return ye.className+=" "+((ce!=null?ce.className:void 0)!=null?ce!=null?ce.className:void 0:"mathbox-label"),S.push(M("div",ye,St))};return L.reset=()=>{S=[],[R,e,n]=Array.from([this.strideI,this.strideJ,this.strideK]);const P=u.value,D=V=>Math.floor(V*255);if(O=P?`rgb(${[D(P.x),D(P.y),D(P.z)]})`:"",A=`mathbox-outline-${Math.round(h.value)}`,E={},P&&(E.color=O),E.fontSize=`${l.value}px`,c.value!==1&&(E.zoom=c.value),v.value>0&&(E.zIndex=v.value),p.value)return E.pointerEvents="auto"},L.nodes=()=>S,L}resize(){let t,e;if(this.readback==null)return;const n=this.bind.points.getActiveDimensions(),r=this.bind.html.getActiveDimensions(),s=Math.min(n.items,r.items),o=Math.min(n.width,r.width),a=Math.min(n.height,r.height),l=Math.min(n.depth,r.depth);this.readback.setActive(s,o,a,l),this.strideI=t=r.items,this.strideJ=e=t*r.width,this.strideK=e*r.height}change(t,e,n){if(t["dom.html"]||t["dom.points"])return this.rebuild()}}b3.initClass();class y3 extends Dv{static initClass(){this.traits=["node","buffer","active","data","texture","voxel","text","font"],this.defaults={minFilter:"linear",magFilter:"linear"},this.finals={channels:1}}init(){return super.init(),this.atlas=null}textShader(t){return this.atlas.shader(t)}textIsSDF(){return this.props.sdf>0}textHeight(){return this.props.detail}make(){let{minFilter:t,magFilter:e,type:n}=this.props;const{font:r,style:s,variant:o,weight:a,detail:l,sdf:c}=this.props;this.atlas=this._renderables.make("textAtlas",{font:r,size:l,style:s,variant:o,weight:a,outline:c,minFilter:t,magFilter:e,type:n}),this.minFilter=si,this.magFilter=si,this.type=Hr,Lv.prototype.make.call(this),t=this.minFilter!=null?this.minFilter:this.props.minFilter,e=this.magFilter!=null?this.magFilter:this.props.magFilter,n=this.type!=null?this.type:this.props.type;const{width:u}=this.props,{height:h}=this.props,{depth:p}=this.props,m=this.props.bufferWidth,v=this.props.bufferHeight,_=this.props.bufferDepth,{channels:b}=this.props,{items:y}=this.props;let M=this.spec={channels:b,items:y,width:u,height:h,depth:p};this.items=M.items,this.channels=M.channels;const{data:S}=this.props;M=ih(S,M);const{space:E}=this;E.width=Math.max(m,M.width||1),E.height=Math.max(v,M.height||1),E.depth=Math.max(_,M.depth||1),this.buffer=this._renderables.make(this.storage,{width:E.width,height:E.height,depth:E.depth,channels:4,items:y,minFilter:t,magFilter:e,type:n});const{atlas:A}=this,{emit:R}=this.buffer.streamer;return this.buffer.streamer.emit=O=>A.map(O,R)}unmake(){if(super.unmake(),this.atlas)return this.atlas.dispose(),this.atlas=null}update(){return this.atlas.begin(),super.update(),this.atlas.end()}change(t,e,n){return e.font?this.rebuild():super.change(t,e,n)}}y3.initClass();class $s extends Sx{static initClass(){this.traits=["node","bind","operator","source","index"]}indexShader(t){return Ak(this.bind.source,"indexShader",e=>e.indexShader(t))}sourceShader(t){return Ak(this.bind.source,"sourceShader",e=>e.sourceShader(t))}getDimensions(){return this.bind.source.getDimensions()}getFutureDimensions(){return this.bind.source.getFutureDimensions()}getActiveDimensions(){return this.bind.source.getActiveDimensions()}getIndexDimensions(){return this.bind.source.getIndexDimensions()}init(){return this.sourceSpec=[{to:"operator.source",trait:"source",optional:!0}]}make(){return super.make(),this._helpers.bind.make(this.sourceSpec)}made(){return this.resize(),super.made()}unmake(){return this._helpers.bind.unmake()}resize(t){return this.trigger({type:"source.resize"})}}$s.initClass();function Ak(i,t,e){if(typeof i<"u"&&i!==null&&typeof i[t]=="function")return e(i,t)}class x3 extends $s{static initClass(){this.traits=["node","bind","operator","texture","text","format","font"],this.defaults={minFilter:"linear",magFilter:"linear"}}init(){return super.init(),this.atlas=this.buffer=this.used=this.time=null,this.filled=!1}sourceShader(t){return this.buffer.shader(t)}textShader(t){return this.atlas.shader(t)}textIsSDF(){return this.props.sdf>0}textHeight(){return this.props.detail}make(){this._helpers.bind.make([{to:"operator.source",trait:"raw"}]);let{minFilter:t,magFilter:e,type:n}=this.props;const{font:r,style:s,variant:o,weight:a,detail:l,sdf:c}=this.props;this.atlas=this._renderables.make("textAtlas",{font:r,size:l,style:s,variant:o,weight:a,outline:c,minFilter:t,magFilter:e,type:n}),t=si,e=si,n=Hr;const u=this.bind.source.getDimensions(),{items:h,width:p,height:m,depth:v}=u;this.buffer=this._renderables.make("voxelBuffer",{width:p,height:m,depth:v,channels:4,items:h,minFilter:t,magFilter:e,type:n});const{atlas:_}=this,{emit:b}=this.buffer.streamer;return this.buffer.streamer.emit=y=>_.map(y,b),this.clockParent=this._inherit("clock"),this._listen("root","root.update",this.update)}made(){return super.made(),this.resize()}unmake(){if(super.unmake(),this.buffer&&(this.buffer.dispose(),this.buffer=null),this.atlas)return this.atlas.dispose(),this.atlas=null}update(){if(this.filled&&!this.props.live||!this.through)return;this.time=this.clockParent.getTime();const{used:t}=this;if(this.atlas.begin(),this.used=this.through(),this.buffer.write(this.used),this.atlas.end(),this.filled=!0,t!==this.used)return this.trigger({type:"source.resize"})}change(t,e,n){if(e.font)return this.rebuild();if(t["format.expr"]||t["format.digits"]||t["format.data"]||n){let r,{expr:s}=this.props;const{digits:o,data:a}=this.props;s==null&&(a!=null?s=(c,u,h,p,m)=>a[m]:s=c=>c);const{length:l}=s;return o!=null&&(s=(c=>(u,h,p,m,v,_,b,y,M,S)=>+c(u,h,p,m,v,_,b,y,M,S).toPrecision(o))(s)),l>8?r=(c,u,h,p,m,v,_,b,y,M,S)=>c(s(u,h,p,m,v,_,b,y,this.time.clock,this.time.step)):r=(c,u,h,p,m,v,_,b,y)=>c(s(u,h,p,m,v,_,b,y)),this.through=this.bind.source.rawBuffer().through(r,this.buffer)}}}x3.initClass();class w3 extends gr{static initClass(){this.traits=["node","bind","object","visible","style","label","attach","geometry","position"]}make(){let t;if(super.make(),this._helpers.bind.make([{to:"label.text",trait:"text"},{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]),this.bind.points==null||this.bind.text==null)return;const e=this.bind.points.getDimensions(),n=this.bind.text.getDimensions(),r=this.bind.text.textIsSDF(),s=Math.min(e.items,n.items),o=Math.min(e.width,n.width),a=Math.min(e.height,n.height),l=Math.min(e.depth,n.depth);let c=this.bind.points.sourceShader(this._shaders.shader());c=this._helpers.position.pipeline(c);const u=this.bind.text.sourceShader(this._shaders.shader()),h=this._shaders.shader().pipe("label.map");h.pipe(this.bind.text.textShader(this._shaders.shader()));const p={spriteDepth:this.node.attributes["attach.depth"],spriteOffset:this.node.attributes["attach.offset"],spriteSnap:this.node.attributes["attach.snap"],spriteScale:this._attributes.make(this._types.number()),outlineStep:this._attributes.make(this._types.number()),outlineExpand:this._attributes.make(this._types.number()),outlineColor:this.node.attributes["label.background"]};this.spriteScale=p.spriteScale,this.outlineStep=p.outlineStep,this.outlineExpand=p.outlineExpand;const m=r?"label.outline":"label.alpha",v=this._shaders.shader().pipe(m,p);this.bind.colors&&(t=this._shaders.shader(),this.bind.colors.sourceShader(t));const _=this._helpers.object.mask(),b=this._helpers.style.uniforms(),y=this._inherit("unit").getUnitUniforms(),M=Fo(y,b,p);return this.sprite=this._renderables.make("sprite",{uniforms:M,width:o,height:a,depth:l,items:s,position:c,sprite:u,map:h,combine:v,color:t,mask:_,linear:!0}),this._helpers.visible.make(),this._helpers.object.make([this.sprite])}unmake(){return this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake(),this.sprite=null}resize(){const t=this.bind.points.getActiveDimensions(),e=this.bind.text.getActiveDimensions(),n=Math.min(t.items,e.items),r=Math.min(t.width,e.width),s=Math.min(t.height,e.height),o=Math.min(t.depth,e.depth);return this.sprite.geometry.clip(r,s,o,n)}change(t,e,n){if(e.geometry||t["label.text"])return this.rebuild();if(this.bind.points==null)return;const{size:r}=this.props,{outline:s}=this.props,{expand:o}=this.props,a=this.bind.text.textHeight(),l=r/a;return this.outlineExpand.value=o/l*16/255,this.outlineStep.value=s/l*16/255,this.spriteScale.value=l}}w3.initClass();class IT extends $s{static initClass(){this.traits=["node","bind","operator","source","index","resample","sampler:x","sampler:y","sampler:z","sampler:w","include"]}indexShader(t){return t.pipe(this.indexer),super.indexShader(t)}sourceShader(t){return t.pipe(this.operator)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(t){const e=this.resampled,n=this.centered,r=this.padding;return this.relativeSize?(n.items||t.items--,n.width||t.width--,n.height||t.height--,n.depth||t.depth--,e.items!=null&&(t.items*=e.items),e.width!=null&&(t.width*=e.width),e.height!=null&&(t.height*=e.height),e.depth!=null&&(t.depth*=e.depth),n.items||t.items++,n.width||t.width++,n.height||t.height++,n.depth||t.depth++,t.items-=r.items*2,t.width-=r.width*2,t.height-=r.height*2,t.depth-=r.depth*2):(e.items!=null&&(t.items=e.items),e.width!=null&&(t.width=e.width),e.height!=null&&(t.height=e.height),e.depth!=null&&(t.depth=e.depth)),t.items=Math.max(0,Math.floor(t.items)),t.width=Math.max(0,Math.floor(t.width)),t.height=Math.max(0,Math.floor(t.height)),t.depth=Math.max(0,Math.floor(t.depth)),t}make(){if(super.make(),this.bind.source==null)return;this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}]);const{indices:t,channels:e}=this.props,{shader:n}=this.bind,{sample:r,size:s,items:o,width:a,height:l,depth:c}=this.props,u=r===this.node.attributes["resample.sample"].enum.relative,h=s===this.node.attributes["resample.size"].enum.relative;this.resampled={},o!=null&&(this.resampled.items=o),a!=null&&(this.resampled.width=a),l!=null&&(this.resampled.height=l),c!=null&&(this.resampled.depth=c),this.centered={},this.centered.items=this.props.centeredW,this.centered.width=this.props.centeredX,this.centered.height=this.props.centeredY,this.centered.depth=this.props.centeredZ,this.padding={},this.padding.items=this.props.paddingW,this.padding.width=this.props.paddingX,this.padding.height=this.props.paddingY,this.padding.depth=this.props.paddingZ;const p=this._shaders.shader(),m=this._shaders.shader(),v=[null,this._types.number,this._types.vec2,this._types.vec3,this._types.vec4][t],_={dataSize:this._attributes.make(v(0,0,0,0)),dataResolution:this._attributes.make(v(0,0,0,0)),targetSize:this._attributes.make(v(0,0,0,0)),targetResolution:this._attributes.make(v(0,0,0,0)),resampleFactor:this._attributes.make(this._types.vec4(0,0,0,0)),resampleBias:this._attributes.make(this._types.vec4(0,0,0,0))};this.dataResolution=_.dataResolution,this.dataSize=_.dataSize,this.targetResolution=_.targetResolution,this.targetSize=_.targetSize,this.resampleFactor=_.resampleFactor,this.resampleBias=_.resampleBias;const b=o!=null||a!=null||l!=null||c!=null;p.pipe("resample.padding",_);let y=[],M=!1;const S=["width","height","depth","items"];for(let E=0;E<S.length;E++){const A=S[E],R=this.centered[A];M||(M=R),y[E]=R?"0.5":"0.0"}return M&&(y=`vec4(${y})`,p.pipe(ha(4,"+",y)),b&&m.pipe(ha(4,"+",y))),u&&(b?(p.pipe("resample.relative",_),m.pipe("resample.relative",_)):m.pipe(tc("vec4"))),n!=null?(t!==4&&p.pipe(rh(4,t)),p.callback(),t!==4&&p.pipe(Ld(t,4)),M&&p.pipe(ha(4,"-",y)),p.pipe(this.bind.source.sourceShader(this._shaders.shader())),e!==4&&p.pipe(rh(4,e)),p.join(),this.bind.shader!=null&&p.pipe(this.bind.shader.shaderBind(_)),e!==4&&p.pipe(Ld(e,4))):(M&&p.pipe(ha(4,"-",y)),p.pipe(this.bind.source.sourceShader(this._shaders.shader()))),M&&b&&m.pipe(ha(4,"-",y)),this.operator=p,this.indexer=m,this.indices=t,this.relativeSample=u,this.relativeSize=h}unmake(){return super.unmake(),this.operator=null}resize(){if(this.bind.source==null)return;const t=this.bind.source.getActiveDimensions(),e=this.getActiveDimensions(),n=p=>{const m=this.centered[p],v=this.padding[p];return e[p]+=v*2,[m?t[p]/Math.max(1,e[p]):Math.max(1,t[p]-1)/Math.max(1,e[p]-1),v]},[r,s]=Array.from(n("width")),[o,a]=Array.from(n("height")),[l,c]=Array.from(n("depth")),[u,h]=Array.from(n("items"));return this.indices===1?(this.dataResolution.value=1/t.width,this.targetResolution.value=1/e.width,this.dataSize.value=t.width,this.targetSize.value=e.width):(this.dataResolution.value.set(1/t.width,1/t.height,1/t.depth,1/t.items),this.targetResolution.value.set(1/e.width,1/e.height,1/e.depth,1/e.items),this.dataSize.value.set(t.width,t.height,t.depth,t.items),this.targetSize.value.set(e.width,e.height,e.depth,e.items)),this.resampleFactor.value.set(r,o,l,u),this.resampleBias.value.set(s,a,c,h),super.resize()}change(t,e,n){if(e.operator||e.resample||e.sampler||e.include)return this.rebuild()}}IT.initClass();class S3 extends IT{static initClass(){this.traits=["node","bind","operator","resample","sampler:x","sampler:y","sampler:z","sampler:w","include","text"]}init(){return this.sourceSpec=[{to:"operator.source",trait:"text"}]}textShader(t){return this.bind.source.textShader(t)}textIsSDF(){return(this.bind.source!=null?this.bind.source.props.sdf:void 0)>0}textHeight(){return this.bind.source!=null?this.bind.source.props.detail:void 0}}S3.initClass();class M3 extends $o{static initClass(){this.traits=["node","clock","seek","play"]}init(){return this.skew=0,this.last=0,this.time={now:+new Date/1e3,time:0,delta:0,clock:0,step:0}}make(){return this._listen("clock","clock.tick",this.tick)}reset(){return this.skew=0}tick(t){const{from:e,to:n,speed:r,seek:s,pace:o,delay:a,realtime:l}=this.props,c=this._inherit("clock").getTime(),u=l?c.time:c.clock,h=l?c.delta:c.step,p=r/o;this.skew+=h*(p-1),this.last>u&&(this.skew=0),this.time.now=c.now+this.skew,this.time.time=c.time,this.time.delta=c.delta;const m=s??c.clock+this.skew;return this.time.clock=Math.min(n,e+Math.max(0,m-a*p)),this.time.step=h*p,this.last=u,this.trigger(t)}getTime(){return this.time}}M3.initClass();class C3 extends $o{static initClass(){this.traits=["node","clock","now"]}init(){let t;return this.now=t=+new Date/1e3,this.skew=0,this.time={now:t,time:0,delta:0,clock:0,step:0}}make(){return this.clockParent=this._inherit("clock"),this._listen("clock","clock.tick",this.tick)}unmake(){return this.clockParent=null}change(t,e,n){if(t["date.now"])return this.skew=0}tick(t){const{seek:e,pace:n,speed:r}=this.props,s=this.clockParent.getTime();return this.skew+=s.step*n/r,e!=null&&(this.skew=e),this.time.now=this.time.time=this.time.clock=(this.props.now!=null?this.props.now:this.now)+this.skew,this.time.delta=this.time.step=s.delta,this.trigger(t)}getTime(){return this.time}}C3.initClass();class Yd extends $o{static initClass(){this.traits=["node","vertex","fragment"]}vertex(t,e){let n;return(n=Pk(this._inherit("vertex"),r=>r.vertex(t,e)))!=null?n:t}fragment(t,e){let n;return(n=Pk(this._inherit("fragment"),r=>r.fragment(t,e)))!=null?n:t}}Yd.initClass();function Pk(i,t){return typeof i<"u"&&i!==null?t(i):void 0}class E3 extends Yd{static initClass(){this.traits=["node","vertex","transform3"]}make(){return this.uniforms={transformMatrix:this._attributes.make(this._types.mat4())},this.composer=qf()}unmake(){return delete this.uniforms}change(t,e,n){if(t["transform3.pass"])return this.rebuild();if(!e.transform3&&!n)return;const r=this.props.position,s=this.props.quaternion,o=this.props.rotation,a=this.props.scale,l=this.props.matrix,c=this.props.eulerOrder;return this.uniforms.transformMatrix.value=this.composer(r,o,s,a,l,c)}vertex(t,e){return e===this.props.pass&&t.pipe("transform3.position",this.uniforms),super.vertex(t,e)}}E3.initClass();class T3 extends Yd{static initClass(){this.traits=["node","vertex","transform4"]}make(){return this.uniforms={transformMatrix:this._attributes.make(this._types.mat4()),transformOffset:this.node.attributes["transform4.position"]},this.transformMatrix=this.uniforms.transformMatrix.value}unmake(){return delete this.uniforms}change(t,e,n){if(t["transform4.pass"])return this.rebuild();if(!e.transform4&&!n)return;const r=this.props.scale,s=this.props.matrix,o=this.transformMatrix;return o.copy(s),o.scale(r)}vertex(t,e){return e===this.props.pass&&t.pipe("transform4.position",this.uniforms),super.vertex(t,e)}}T3.initClass();class A3 extends Yd{static initClass(){this.traits=["node","include","vertex","bind"]}make(){return this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}])}unmake(){return this._helpers.bind.unmake()}change(t,e,n){if(e.include)return this.rebuild()}vertex(t,e){return this.bind.shader!=null&&e===this.props.pass&&t.pipe(this.bind.shader.shaderBind()),super.vertex(t,e)}}A3.initClass();class P3 extends Yd{static initClass(){this.traits=["node","include","fragment","bind"]}make(){return this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}])}unmake(){return this._helpers.bind.unmake()}change(t,e,n){if(e.include||t["fragment.gamma"])return this.rebuild()}fragment(t,e){return this.bind.shader!=null&&e===this.props.pass&&(this.props.gamma&&t.pipe("mesh.gamma.out"),t.pipe(this.bind.shader.shaderBind()),t.split(),this.props.gamma&&t.pipe("mesh.gamma.in"),t.pass()),super.fragment(t,e)}}P3.initClass();class R3 extends Yd{static initClass(){this.traits=["node","vertex","layer"]}make(){return this._listen("root","root.resize",this.update),this.uniforms={layerScale:this._attributes.make(this._types.vec4()),layerBias:this._attributes.make(this._types.vec4())}}update(){const t=this._inherit("root").getCamera(),e=t.aspect!=null?t.aspect:1,n=t.fov!=null?t.fov:1,r=Math.tan(n*Math.PI/360),s=this.node.attributes["layer.fit"].enum;let{fit:o}=this.props;const{depth:a}=this.props;switch(o){case s.contain:o=e>1?s.y:s.x;break;case s.cover:o=e>1?s.x:s.y;break}switch(o){case s.x:this.uniforms.layerScale.value.set(r*e,r*e,1,1);break;case s.y:this.uniforms.layerScale.value.set(r,r,1,1);break}return this.uniforms.layerBias.value.set(0,0,-a,0)}change(t,e,n){if(t["layer.fit"]||t["layer.depth"]||n)return this.update()}vertex(t,e){return e===2?t.pipe("layer.position",this.uniforms):e===3?t.pipe("root.position"):t}}R3.initClass();class k3 extends $o{static initClass(){this.traits=["node","include","mask","bind"]}make(){return this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}])}unmake(){return this._helpers.bind.unmake()}change(t,e,n){if(e.include)return this.rebuild()}mask(t){let e,n;return this.bind.shader!=null?t?(n=this._shaders.shader(),n.pipe(tc("vec4")),n.fan(),n.pipe(t),n.next(),n.pipe(this.bind.shader.shaderBind()),n.end(),n.pipe("float combine(float a, float b) { return min(a, b); }")):(n=this._shaders.shader(),n.pipe(this.bind.shader.shaderBind())):n=t,(e=L5t(this._inherit("mask"),r=>r.mask(n)))!=null?e:n}}k3.initClass();function L5t(i,t){return typeof i<"u"&&i!==null?t(i):void 0}class L3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","clamp"]}indexShader(t){return t.pipe(this.operator),super.indexShader(t)}sourceShader(t){return t.pipe(this.operator),super.sourceShader(t)}make(){if(super.make(),this.bind.source==null)return;const t={clampLimit:this._attributes.make(this._types.vec4())};this.clampLimit=t.clampLimit;const e=this._shaders.shader();return e.pipe("clamp.position",t),this.operator=e}unmake(){return super.unmake()}resize(){if(this.bind.source!=null){const t=this.bind.source.getActiveDimensions();this.clampLimit.value.set(t.width-1,t.height-1,t.depth-1,t.items-1)}return super.resize()}change(t,e,n){if(e.operator||e.clamp)return this.rebuild()}}L3.initClass();class O3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","grow"]}sourceShader(t){return t.pipe(this.operator)}make(){if(super.make(),this.bind.source==null)return;const t={growScale:this.node.attributes["grow.scale"],growMask:this._attributes.make(this._types.vec4()),growAnchor:this._attributes.make(this._types.vec4())};this.growMask=t.growMask.value,this.growAnchor=t.growAnchor.value;const e=this._shaders.shader();return e.require(this.bind.source.sourceShader(this._shaders.shader())),e.pipe("grow.position",t),this.operator=e}unmake(){return super.unmake()}resize(){return this.update(),super.resize()}update(){const t=this.bind.source.getFutureDimensions(),e=["width","height","depth","items"],n=(r,s)=>((r||1)-1)*(.5-s*.5);return(()=>{const r=[];for(let s=0;s<e.length;s++){const o=e[s],a=this.props[o];this.growMask.setComponent(s,+(a==null)),r.push(this.growAnchor.setComponent(s,a!=null?n(t[o],a):0))}return r})()}change(t,e,n){if(e.operator)return this.rebuild();if(e.grow)return this.update()}}O3.initClass();let D3=class extends $s{static initClass(){this.traits=["node","bind","operator","source","index","join"]}indexShader(t){return t.pipe(this.operator),super.indexShader(t)}sourceShader(t){return t.pipe(this.operator),super.sourceShader(t)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(t){let e,n;const{order:r,axis:s,stride:o}=this,a=["width","height","depth","items"],l=r.map(m=>a[m-1]),c=r.indexOf(s);let u=(()=>{const m=[];for(n of Array.from(l))m.push(t[n]);return m})();const h=((e=u[c+1])!=null?e:1)*o;u.splice(c,2,h),u=u.slice(0,3),u.push(1);const p={};for(let m=0;m<l.length;m++)n=l[m],p[n]=u[m];return p}make(){if(super.make(),this.bind.source==null)return;const{order:t}=this.props;let{axis:e}=this.props,{overlap:n}=this.props;const r=t.join("");e==null&&(e=t[0]);const s=r.indexOf(e),o=r.replace(e,"00").substring(0,4),l=[null,"width","height","depth","items"][e],u=this.bind.source.getDimensions()[l];n=Math.min(u-1,n);const h=u-n,p={joinStride:this._attributes.make(this._types.number(h)),joinStrideInv:this._attributes.make(this._types.number(1/h))},m=this._shaders.shader();return m.require(Do(e,1)),m.require(Do(o,4)),m.require(yT([s,s+1])),m.pipe("join.position",p),m.pipe(wx(t)),this.operator=m,this.order=t,this.axis=e,this.overlap=n,this.length=u,this.stride=h}unmake(){return super.unmake()}change(t,e,n){if(e.join||e.operator)return this.rebuild()}};D3.initClass();class I3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","lerp","sampler:x","sampler:y","sampler:z","sampler:w"]}indexShader(t){return t.pipe(this.indexer),super.indexShader(t)}sourceShader(t){return t.pipe(this.operator)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(t){const e=this.resampled,n=this.centered,r=this.padding;return this.relativeSize?(n.items||t.items--,n.width||t.width--,n.height||t.height--,n.depth||t.depth--,e.items!=null&&(t.items*=e.items),e.width!=null&&(t.width*=e.width),e.height!=null&&(t.height*=e.height),e.depth!=null&&(t.depth*=e.depth),n.items||t.items++,n.width||t.width++,n.height||t.height++,n.depth||t.depth++,t.items-=r.items*2,t.width-=r.width*2,t.height-=r.height*2,t.depth-=r.depth*2):(e.items!=null&&(t.items=e.items),e.width!=null&&(t.width=e.width),e.height!=null&&(t.height=e.height),e.depth!=null&&(t.depth=e.depth)),t.items=Math.max(0,Math.floor(t.items)),t.width=Math.max(0,Math.floor(t.width)),t.height=Math.max(0,Math.floor(t.height)),t.depth=Math.max(0,Math.floor(t.depth)),t}make(){let t,e;if(super.make(),this.bind.source==null)return;const{size:n,items:r,width:s,height:o,depth:a}=this.props,l=n===this.node.attributes["lerp.size"].enum.relative;this.resampled={},r!=null&&(this.resampled.items=r),s!=null&&(this.resampled.width=s),o!=null&&(this.resampled.height=o),a!=null&&(this.resampled.depth=a),this.centered={},this.centered.items=this.props.centeredW,this.centered.width=this.props.centeredX,this.centered.height=this.props.centeredY,this.centered.depth=this.props.centeredZ,this.padding={},this.padding.items=this.props.paddingW,this.padding.width=this.props.paddingX,this.padding.height=this.props.paddingY,this.padding.depth=this.props.paddingZ;const c=this._shaders.shader(),u=this._shaders.shader(),h={resampleFactor:this._attributes.make(this._types.vec4(0,0,0,0)),resampleBias:this._attributes.make(this._types.vec4(0,0,0,0))};this.resampleFactor=h.resampleFactor,this.resampleBias=h.resampleBias;const p=r!=null||s!=null||o!=null||a!=null;c.pipe("resample.padding",h);const m=[];let v=!1;const _=["width","height","depth","items"];for(t=0;t<_.length;t++){e=_[t];const S=this.centered[e];v||(v=S),m[t]=S?"0.5":"0.0"}let b;v&&p&&(b=`vec4(${m})`,c.pipe(ha(4,"+",b)),u.pipe(ha(4,"+",b))),p?(c.pipe("resample.relative",h),u.pipe("resample.relative",h)):(c.pipe(tc("vec4")),u.pipe(tc("vec4"))),v&&p&&(c.pipe(ha(4,"-",b)),u.pipe(ha(4,"-",b)));let y=this.bind.source.sourceShader(this._shaders.shader());const M=["width","height","depth","items"];for(t=0;t<M.length;t++){e=M[t];const S=`lerp.${e}`;this.props[e]!=null&&(y=this._shaders.shader().require(y),y.pipe(S,h))}return c.pipe(y),this.operator=c,this.indexer=u,this.relativeSize=l}unmake(){return super.unmake(),this.operator=null}resize(){if(this.bind.source==null)return;const t=this.bind.source.getActiveDimensions(),e=this.getActiveDimensions(),n=p=>{const m=this.centered[p],v=this.padding[p];return e[p]+=v*2,[m?t[p]/Math.max(1,e[p]):Math.max(1,t[p]-1)/Math.max(1,e[p]-1),v]},[r,s]=Array.from(n("width")),[o,a]=Array.from(n("height")),[l,c]=Array.from(n("depth")),[u,h]=Array.from(n("items"));return this.resampleFactor.value.set(r,o,l,u),this.resampleBias.value.set(s,a,c,h),super.resize()}change(t,e,n){if(e.operator||e.lerp||e.sampler)return this.rebuild()}}I3.initClass();let N3=class extends $s{static initClass(){this.traits=["node","bind","active","operator","source","index","texture","memo"]}sourceShader(t){return this.memo.shaderAbsolute(t,1)}make(){if(super.make(),this.bind.source==null)return;this._helpers.active.make(),this._listen("root","root.update",()=>{if(this.isActive)return this.update()});const{minFilter:t,magFilter:e,type:n}=this.props,r=this.bind.source.getDimensions(),{items:s,width:o,height:a,depth:l}=r;this.memo=this._renderables.make("memo",{items:s,width:o,height:a,depth:l,minFilter:t,magFilter:e,type:n});const c=this._shaders.shader();return this.bind.source.sourceShader(c),this.compose=this._renderables.make("memoScreen",{map:c,items:s,width:o,height:a,depth:l}),this.memo.adopt(this.compose),this.objects=[this.compose],this.renders=this.compose.renders}unmake(){this._helpers.active.unmake(),this.bind.source!=null&&(this.memo.unadopt(this.compose),this.memo.dispose(),this.memo=this.compose=null,super.unmake())}update(){return this.memo!=null?this.memo.render():void 0}resize(){if(this.bind.source==null)return;const t=this.bind.source.getActiveDimensions(),{width:e,height:n,depth:r}=t;return this.compose.cover(e,n,r),super.resize()}change(t,e,n){if(e.texture||e.operator)return this.rebuild()}};N3.initClass();let z3=class extends gr{static initClass(){this.traits=["node","bind","operator","readback","entity","active"],this.finals={channels:4}}init(){return this.emitter=this.root=null,this.active={}}make(){if(super.make(),this._compute("readback.data",()=>this.readback!=null?this.readback.data:void 0),this._compute("readback.items",()=>this.readback!=null?this.readback.items:void 0),this._compute("readback.width",()=>this.readback!=null?this.readback.width:void 0),this._compute("readback.height",()=>this.readback!=null?this.readback.height:void 0),this._compute("readback.depth",()=>this.readback!=null?this.readback.depth:void 0),this._helpers.bind.make([{to:"operator.source",trait:"source"}]),this.bind.source==null)return;const{type:t,channels:e,expr:n}=this.props;this.root=this._inherit("root"),this._listen("root","root.update",this.update);const{items:r,width:s,height:o,depth:a}=this.bind.source.getDimensions(),l=this.bind.source.sourceShader(this._shaders.shader());this.readback=this._renderables.make("readback",{map:l,items:r,width:s,height:o,depth:a,channels:e,type:t}),n!=null&&this.readback.setCallback(n),this._helpers.active.make()}unmake(){return this.readback!=null&&(this.readback.dispose(),this.readback=null,this.root=null,this.emitter=null,this.active={}),this._helpers.active.unmake(),this._helpers.bind.unmake()}update(){this.readback!=null&&this.isActive&&(this.readback.update(this.root!=null?this.root.getCamera():void 0),this.readback.post(),this.props.expr!=null&&this.readback.iterate())}resize(){let t,e;if(this.readback==null)return;const{items:n,width:r,height:s,depth:o}=this.bind.source.getActiveDimensions();return this.readback.setActive(n,r,s,o),this.strideI=t=n,this.strideJ=e=t*r,this.strideK=e*s}change(t,e,n){if(t["readback.type"])return this.rebuild();if(t["readback.expr"]&&this.readback)return this.readback.setCallback(this.props.expr)}};z3.initClass();class U3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","repeat"]}indexShader(t){return t.pipe(this.operator),super.indexShader(t)}sourceShader(t){return t.pipe(this.operator),super.sourceShader(t)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(t){const e=this.resample;return{items:e.items*t.items,width:e.width*t.width,height:e.height*t.height,depth:e.depth*t.depth}}make(){if(super.make(),this.bind.source==null)return;this.resample={};const t={repeatModulus:this._attributes.make(this._types.vec4())};this.repeatModulus=t.repeatModulus;const e=this._shaders.shader();return e.pipe("repeat.position",t),this.operator=e}unmake(){return super.unmake()}resize(){if(this.bind.source!=null){const t=this.bind.source.getActiveDimensions();this.repeatModulus.value.set(t.width,t.height,t.depth,t.items)}return super.resize()}change(t,e,n){if(e.operator||e.repeat)return this.rebuild();if(n)return["items","width","height","depth"].map(r=>this.resample[r]=this.props[r])}}U3.initClass();class F3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","reverse"]}getDimensions(){return this.bind.source.getDimensions()}getActiveDimensions(){return this.bind.source.getActiveDimensions()}getFutureDimensions(){return this.bind.source.getFutureDimensions()}getIndexDimensions(){return this.bind.source.getIndexDimensions()}sourceShader(t){return t.pipe("reverse.position",this.uniforms),this.bind.source.sourceShader(t)}_resolveScale(t,e){return this.props[t]?-1:1}_resolveOffset(t,e){const n=this.props[t],r=e[t];return n?r-1:0}make(){if(super.make(),this.bind.source!=null)return this.uniforms={reverseScale:this._attributes.make(this._types.vec4()),reverseOffset:this._attributes.make(this._types.vec4())}}unmake(){return super.unmake()}resize(){if(this.bind.source==null)return;const t=this.bind.source.getActiveDimensions();return this.uniforms.reverseScale.value.set(this._resolveScale("width",t),this._resolveScale("height",t),this._resolveScale("depth",t),this._resolveScale("items",t)),this.uniforms.reverseOffset.value.set(this._resolveOffset("width",t),this._resolveOffset("height",t),this._resolveOffset("depth",t),this._resolveOffset("items",t)),super.resize()}change(t,e,n){if(e.operator)return this.rebuild();if(e.reverse)return this.resize()}}F3.initClass();class V3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","swizzle"]}sourceShader(t){return t=super.sourceShader(t),this.swizzler&&t.pipe(this.swizzler),t}make(){if(super.make(),this.bind.source==null)return;const{order:t}=this.props;if(t.join()!=="1234")return this.swizzler=Do(t,4)}unmake(){return super.unmake(),this.swizzler=null}change(t,e,n){if(e.swizzle||e.operator)return this.rebuild()}}V3.initClass();class B3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","spread"]}sourceShader(t){return t.pipe(this.operator)}make(){if(super.make(),this.bind.source==null)return;const t={spreadMatrix:this._attributes.make(this._types.mat4()),spreadOffset:this._attributes.make(this._types.vec4())};this.spreadMatrix=t.spreadMatrix,this.spreadOffset=t.spreadOffset;const e=this._shaders.shader();return e.require(this.bind.source.sourceShader(this._shaders.shader())),e.pipe("spread.position",t),this.operator=e}unmake(){return super.unmake()}resize(){return this.update(),super.resize()}update(){let t,e,n,r;const s=this.bind.source.getFutureDimensions(),a=this.spreadMatrix.value.elements,l=["width","height","depth","items"],c=["alignWidth","alignHeight","alignDepth","alignItems"],{unit:u}=this.props,h=this.node.attributes["spread.unit"].enum,p=(()=>{switch(u){case h.relative:return(m,v,_,b)=>a[v*4+_]=b/Math.max(1,s[m]-1);case h.absolute:return(m,v,_,b)=>a[v*4+_]=b}})();return(()=>{const m=[];for(e=0;e<l.length;e++){let v;t=l[e];const _=this.props[t],b=this.props[c[e]];_!=null?v=-((s[t]!=null?s[t]:1)-1)*(.5-b*.5):v=0,this.spreadOffset.value.setComponent(e,v),m.push((()=>{const y=[];for(n=0;n<=3;n++){let M;r=(M=_!=null?_.getComponent(n):void 0)!=null?M:0,y.push(a[e*4+n]=p(t,e,n,r))}return y})())}return m})()}change(t,e,n){if(e.operator)return this.rebuild();if(e.spread)return this.update()}}B3.initClass();class H3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","split"]}indexShader(t){return t.pipe(this.operator),super.indexShader(t)}sourceShader(t){return t.pipe(this.operator),super.sourceShader(t)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(t){let e;const{order:n}=this,{axis:r}=this,{overlap:s}=this,{length:o}=this,{stride:a}=this,l=["width","height","depth","items"],c=n.map(v=>l[v-1]),u=n.indexOf(r);let h=(()=>{const v=[];for(e of Array.from(c))v.push(t[e]);return v})();const p=Math.floor((h[u]-s)/a);h.splice(u,1,o,p),h=h.slice(0,4);const m={};for(let v=0;v<c.length;v++)e=c[v],m[e]=h[v];return m}make(){let t;if(super.make(),this.bind.source==null)return;const{order:e}=this.props;let{axis:n}=this.props,{overlap:r}=this.props;const{length:s}=this.props,o=e.join("");n==null&&(n=e[0]);const a=o.indexOf(n),l=o[a]+((t=o[a+1])!=null?t:0),c=o.replace(l[1],"").replace(l[0],"0")+"0";r=Math.min(s-1,r);const u=s-r,h={splitStride:this._attributes.make(this._types.number(u))},p=this._shaders.shader();return p.require(Do(l,2)),p.require(Do(c,4)),p.require(yT(a)),p.pipe("split.position",h),p.pipe(wx(e)),this.operator=p,this.order=e,this.axis=n,this.overlap=r,this.length=s,this.stride=u}unmake(){return super.unmake()}change(t,e,n){if(t["split.axis"]||t["split.order"]||e.operator)return this.rebuild()}}H3.initClass();class $3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","slice"]}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}sourceShader(t){return t.pipe("slice.position",this.uniforms),this.bind.source.sourceShader(t)}_resolve(t,e){const n=this.props[t],r=e[t];if(n==null)return[0,r];const s=function(l,c){return l<0?c+l:l},o=s(Math.round(n.x),r);let a=s(Math.round(n.y),r);return a=Math.max(o,a),[o,a-o]}_resample(t){return t.width=this._resolve("width",t)[1],t.height=this._resolve("height",t)[1],t.depth=this._resolve("depth",t)[1],t.items=this._resolve("items",t)[1],t}make(){if(super.make(),this.bind.source!=null)return this.uniforms={sliceOffset:this._attributes.make(this._types.vec4())}}unmake(){return super.unmake()}resize(){if(this.bind.source==null)return;const t=this.bind.source.getActiveDimensions();return this.uniforms.sliceOffset.value.set(this._resolve("width",t)[0],this._resolve("height",t)[0],this._resolve("depth",t)[0],this._resolve("items",t)[0]),super.resize()}change(t,e,n){if(e.operator)return this.rebuild();if(e.slice)return this.resize()}}$3.initClass();class G3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","subdivide"]}indexShader(t){return t.pipe(this.indexer),super.indexShader(t)}sourceShader(t){return t.pipe(this.operator)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(t){const e=this.resampled;return t.items--,t.width--,t.height--,t.depth--,e.items!=null&&(t.items*=e.items),e.width!=null&&(t.width*=e.width),e.height!=null&&(t.height*=e.height),e.depth!=null&&(t.depth*=e.depth),t.items++,t.width++,t.height++,t.depth++,t}make(){if(super.make(),this.bind.source==null)return;let{lerp:t}=this.props;const{items:e,width:n,height:r,depth:s}=this.props;this.resampled={},e!=null&&(this.resampled.items=e),n!=null&&(this.resampled.width=n),r!=null&&(this.resampled.height=r),s!=null&&(this.resampled.depth=s);const o=this._shaders.shader(),a=this._shaders.shader(),l={resampleFactor:this._attributes.make(this._types.vec4(0,0,0,0)),subdivideBevel:this.node.attributes["subdivide.bevel"]};this.resampleFactor=l.resampleFactor,this.resampleBias=l.resampleBias,e!=null||n!=null||r!=null||s!=null?(o.pipe("resample.relative",l),a.pipe("resample.relative",l)):(o.pipe(tc("vec4")),a.pipe(tc("vec4")));let u=this.bind.source.sourceShader(this._shaders.shader());t=t?".lerp":"";const h=["width","height","depth","items"];for(let p=0;p<h.length;p++){const m=h[p],v=`subdivide.${m}${t}`;this.props[m]!=null&&(u=this._shaders.shader().require(u),u.pipe(v,l))}return o.pipe(u),this.operator=o,this.indexer=a}unmake(){return super.unmake(),this.operator=null}resize(){if(this.bind.source==null)return;const t=this.bind.source.getActiveDimensions(),e=this.getActiveDimensions(),n=l=>Math.max(1,t[l]-1)/Math.max(1,e[l]-1),r=n("width"),s=n("height"),o=n("depth"),a=n("items");return this.resampleFactor.value.set(r,s,o,a),super.resize()}change(t,e,n){if(e.operator||e.subdivide)return this.rebuild()}}G3.initClass();const Rk={1:"width",2:"height",3:"depth",4:"items"};class q3 extends $s{static initClass(){this.traits=["node","bind","operator","source","index","transpose"]}indexShader(t){return this.swizzler&&t.pipe(this.swizzler),super.indexShader(t)}sourceShader(t){return this.swizzler&&t.pipe(this.swizzler),super.sourceShader(t)}getDimensions(){return this._remap(this.transpose,this.bind.source.getDimensions())}getActiveDimensions(){return this._remap(this.transpose,this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._remap(this.transpose,this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._remap(this.transpose,this.bind.source.getIndexDimensions())}_remap(t,e){const n={};for(let r=0;r<=3;r++){const s=Rk[r+1],o=Rk[t[r]];n[s]=e[o]!=null?e[o]:1}return n}make(){if(super.make(),this.bind.source==null)return;const{order:t}=this.props;return t.join()!=="1234"&&(this.swizzler=wx(t)),this.transpose=t,this.trigger({type:"source.rebuild"})}unmake(){return super.unmake(),this.swizzler=null}change(t,e,n){if(e.transpose||e.operator)return this.rebuild()}}q3.initClass();class NT extends $o{static initClass(){this.traits=["node","transition","transform","mask","visible","active"]}init(){return this.animate=null,this.uniforms=null,this.state={isVisible:!0,isActive:!0,enter:1,exit:1},this.latched=null,this.locked=null}make(){this.uniforms={transitionFrom:this._attributes.make(this._types.vec4()),transitionTo:this._attributes.make(this._types.vec4()),transitionActive:this._attributes.make(this._types.bool()),transitionScale:this._attributes.make(this._types.vec4()),transitionBias:this._attributes.make(this._types.vec4()),transitionEnter:this._attributes.make(this._types.number()),transitionExit:this._attributes.make(this._types.number()),transitionSkew:this._attributes.make(this._types.number())};const t=this._inherit("slide"),e=this._inherit("visible"),n=this._inherit("active");return this._listen(t,"transition.latch",r=>this.latch(r.step)),this._listen(t,"transition.release",()=>this.release()),this._listen(e,"visible.change",()=>this.update(this.state.isVisible=e.isVisible)),this._listen(n,"active.change",()=>this.update(this.state.isActive=n.isActive)),this.animate=this._animator.make(this._types.vec2(1,1),{step:r=>(this.state.enter=r.x,this.state.exit=r.y,this.update()),complete:r=>this.complete(r)}),this.move=this.props.from!=null||this.props.to!=null}unmake(){return this.animate.dispose()}latch(t){let e;if(this.locked=null,this.latched=e={isVisible:this.state.isVisible,isActive:this.state.isActive,step:t},!this.isVisible){const r=e.step>=0,[s,o]=Array.from(r?[0,1]:[1,0]);return this.animate.set(s,o)}}release(){const{latched:t}=this,{state:e}=this;if(this.latched=null,t.isVisible!==e.isVisible){const n=t.step>=0,r=e.isVisible,[s,o]=Array.from(r?[1,1]:n?[1,0]:[0,1]);let{duration:a,durationEnter:l,durationExit:c}=this.props;l==null&&(l=a),c==null&&(c=a),a=r*l+!r*c;let{delay:u,delayEnter:h,delayExit:p}=this.props;h==null&&(h=u),p==null&&(p=u),u=r*h+!r*p,this.animate.immediate({x:s,y:o},{duration:a,delay:u,ease:"linear"}),this.locked={isVisible:!0,isActive:t.isActive||e.isActive}}return this.update()}complete(t){if(t)return this.locked=null,this.update()}update(){if(this.latched!=null)return;let{enter:t,exit:e}=this.props;t==null&&({enter:t}=this.state),e==null&&({exit:e}=this.state);const n=t*e;let r=n>0;const s=n<1;this.uniforms.transitionEnter.value=t,this.uniforms.transitionExit.value=e,this.uniforms.transitionActive.value=s,r&&(r=!!this.state.isVisible),this.locked!=null&&(r=this.locked.isVisible),this.isVisible!==r&&(this.isVisible=r,this.trigger({type:"visible.change"}));const o=!!(this.state.isActive||this.locked!=null&&this.locked.isActive);if(this.isActive!==o)return this.isActive=o,this.trigger({type:"active.change"})}change(t,e,n){if((t["transition.enter"]||t["transition.exit"]||n)&&this.update(),t["transition.stagger"]||n){const{stagger:r}=this.props,s=r.x<0,o=r.y<0,a=r.z<0,l=r.w<0,c=Math.abs(r.x),u=Math.abs(r.y),h=Math.abs(r.z),p=Math.abs(r.w);return this.uniforms.transitionSkew.value=c+u+h+p,this.uniforms.transitionScale.value.set((1-s*2)*c,(1-o*2)*u,(1-a*2)*h,(1-l*2)*p),this.uniforms.transitionBias.value.set(s*c,o*u,a*h,l*p)}}}NT.initClass();class W3 extends NT{static initClass(){this.traits=["node","transition","vertex","move","visible","active"]}make(){super.make();const t={moveFrom:this.node.attributes["move.from"],moveTo:this.node.attributes["move.to"]};for(const e in t){const n=t[e];this.uniforms[e]=n}}vertex(t,e){let n;return e===this.props.pass&&t.pipe("move.position",this.uniforms),(n=O5t(this._inherit("vertex"),r=>r.vertex(t,e)))!=null?n:t}}W3.initClass();function O5t(i,t){return typeof i<"u"&&i!==null?t(i):void 0}function Ox(i,t,e){return Math.max(t,Math.min(e,i))}function nv(i){return .5-.5*Math.cos(Ox(i,0,1)*Math.PI)}function zT(i){return+(i>=.5)}function UT(i){return+(i>=1)}const D5t=Object.freeze(Object.defineProperty({__proto__:null,binary:zT,clamp:Ox,cosine:nv,hold:UT},Symbol.toStringTag,{value:"Module"})),fg=function(i){const t={};for(const e in i){const n=i[e];n instanceof Array?t[e]=n.slice():n!=null&&typeof n=="object"?t[e]=fg(n):t[e]=n}return t};class FT extends gr{static initClass(){this.traits=["node","track","seek","bind"]}init(){return this.handlers={},this.script=null,this.values=null,this.playhead=0,this.velocity=null,this.section=null,this.expr=null}make(){let t;this._helpers.bind.make([{to:"track.target",trait:"node",callback:null}]);const{script:e}=this.props,{node:n}=this.bind.target;return this.targetNode=n,[this.script,this.values,this.start,this.end]=Array.from(t=this._process(n,e)),t}unmake(){return this.unbindExpr(),this._helpers.bind.unmake(),this.script=this.values=this.start=this.end=this.section=this.expr=null,this.playhead=0}bindExpr(t){this.unbindExpr(),this.expr=t,this.targetNode.bind(t,!0);const{clock:e}=this.targetNode,n=this;return this._attributes.bind(this.measure=function(){let r=null;return()=>{const{step:s}=e.getTime();return r!=null&&(n.velocity=(n.playhead-r)/s),r=n.playhead}}())}unbindExpr(){return this.expr!=null&&this.targetNode.unbind(this.expr,!0),this.measure!=null&&this._attributes.unbind(this.measure),this.expr=this.measure=null}_process(t,e){let n,r,s,o,a,l,c;if(e instanceof Array){a={};for(let _=0;_<e.length;_++)l=e[_],a[_]=l;e=a}a=[];for(r in e)l=e[r],l==null&&(l=[]),l instanceof Array?l={key:+r,props:l[0]!=null?fg(l[0]):{},bind:l[1]!=null?fg(l[1]):{}}:(l.key==null&&!l.props&&!l.bind?l={props:fg(l)}:l=fg(l),l.key=l.key!=null?+l.key:+r,l.props==null&&(l.props={}),l.bind==null&&(l.bind={})),a.push(l);if(e=a,!e.length)return[[],{},0,0];e.sort((_,b)=>_.key-b.key);const u=e[0].key,h=e[e.length-1].key;for(r in e)l=e[r],s!=null&&(s.next=l),s=l;s.next=s,e=a;const p={},m={};for(r in e){l=e[r];for(n in l.props)c=l.props[n],p[n]=!0}for(r in e){l=e[r];for(n in l.bind)c=l.bind[n],p[n]=!0}for(n in p)p[n]=t.get(n);try{for(n in p)m[n]=[t.attribute(n).T.make(),t.attribute(n).T.make(),t.attribute(n).T.make()]}catch{throw console.warn(this.node.toMarkup()),o=`${this.node.toString()} - Target ${t} has no \`${n}\` property`,new Error(o)}const v=[];for(l of Array.from(e)){for(n in p)if(c=p[n],c=t.validate(n,l.props[n]!=null?l.props[n]:c),p[n]=l.props[n]=c,l.bind[n]!=null&&typeof l.bind[n]!="function")throw console.warn(this.node.toMarkup()),o=`${this.node.toString()} - Bind expression \`${l.bind[n]}\` on property \`${n}\` is not a function`,new Error(o);v.push(l)}return[v,m,u,h]}update(){let{playhead:t}=this;const{script:e}=this,{ease:n,seek:r}=this.props,s=this.targetNode;if(r!=null&&(t=r),e.length){let o;const a=function(){let S=e[0];for(let E=0;E<e.length;E++){const A=e[E];if(A.key>t)break;S=A}return S};let{section:l}=this;if((!l||t<l.key||t>l.next.key)&&(l=a()),l===this.section)return;this.section=l;const c=l,u=l.next,h=c.key,p=u.key,m=(()=>{switch(n){case"linear":case 0:return Ox;case"cosine":case 1:return nv;case"binary":case 2:return zT;case"hold":case 3:return UT;default:return nv}})(),{clock:v}=s,_=S=>{if(this.velocity==null)return this.playhead;const E=v.getTime();return this.playhead+this.velocity*(S-E.time)},b=function(){const S=1/Math.max(1e-4,p-h);return E=>m((_(E)-h)*S,0,1)}(),y=S=>{const E=c.bind[S],A=u.bind[S],R=c.props[S],O=u.props[S],L=function(){throw console.warn(s.toMarkup()),new Error(`${this.node.toString()} - Invalid expression result on track \`${S}\``)},P=s.attribute(S),D=this.values[S],V=this._animator;return E&&A?((K,W,Z)=>function(z,ut){let nt,Q;return K[0]=nt=P.T.validate(E(z,ut),K[0],L),K[1]=Q=P.T.validate(A(z,ut),K[1],L),K[2]=V.lerp(P.T,nt,Q,b(z),K[2])})(D):E?((K,W,Z)=>function(z,ut){let nt;return K[0]=nt=P.T.validate(E(z,ut),K[0],L),K[1]=V.lerp(P.T,nt,O,b(z),K[1])})(D):A?((K,W,Z)=>function(z,ut){let nt;return K[0]=nt=P.T.validate(A(z,ut),K[0],L),K[1]=V.lerp(P.T,R,nt,b(z),K[1])})(D):((K,W,Z)=>(z,ut)=>K[0]=V.lerp(P.T,R,O,b(z),K[0]))(D)},M={};for(o in c.bind)M[o]==null&&(M[o]=y(o));for(o in u.bind)M[o]==null&&(M[o]=y(o));for(o in c.props)M[o]==null&&(M[o]=y(o));for(o in u.props)M[o]==null&&(M[o]=y(o));return this.bindExpr(M)}}change(t,e,n){if(t["track.target"]||t["track.script"]||t["track.mode"])return this.rebuild();if(t["seek.seek"]||n)return this.update()}}FT.initClass();class j3 extends FT{static initClass(){this.traits=["node","track","trigger","play","bind"]}init(){return super.init(),this.skew=null,this.start=null}reset(t){return t==null&&(t=!0),this.skew=t?0:null,this.start=null}make(){super.make(),this._listen("slide","slide.step",e=>{const{trigger:n}=this.props;if(n!=null&&e.index===n)return this.reset();if(n!=null&&e.index===0)return this.reset(!1)}),(!this.props.trigger||this._inherit("slide")==null)&&this.reset();const t=this._inherit("clock");return this._listen(t,"clock.tick",()=>{const{from:e,to:n,speed:r,pace:s,delay:o,realtime:a}=this.props,l=t.getTime();if(this.skew!=null){const c=a?l.time:l.clock,u=a?l.delta:l.step,h=r/s;this.start==null&&(this.start=c),this.skew+=u*(h-1);let p=Math.max(0,c-this.start+this.skew-o*h);this.props.loop&&(p=p%(n-e)),this.playhead=Math.min(n,e+p)}else this.playhead=0;return this.update()})}update(){return super.update()}change(t,e,n){return t["trigger.trigger"]||t["play.realtime"]?this.rebuild():super.change(t,e,n)}}j3.initClass();class X3 extends $o{static initClass(){this.traits=["node","present"]}init(){}make(){return this.nodes=[],this.steps=[],this.length=0,this.last=[],this.index=0,this.dirty=[],this._listen("root","root.update",this.update),this._compute("present.length",()=>this.length)}adopt(t){const{node:e}=t;return this.nodes.indexOf(t)<0&&this.nodes.push(e),this.dirty.push(t)}unadopt(t){return this.nodes=this.nodes.filter(e=>e!==t),this.dirty.push(t)}update(){if(this.dirty.length){for(const t of Array.from(this.dirty))this.slideReset(t);return[this.steps,this.indices]=Array.from(this.process(this.nodes)),this.length=this.steps.length,this.index=null,this.go(this.props.index),this.dirty=[]}}slideLatch(t,e,n){return t.slideLatch(e,n)}slideStep(t,e,n){return t.slideStep(this.mapIndex(t,e),n)}slideRelease(t,e){return t.slideRelease()}slideReset(t){return t.slideReset()}mapIndex(t,e){return e-this.indices[t.node._id]}process(t){const e=m=>Array.from(m).map(v=>r(v).filter(s)),r=(m=>v=>(()=>{let _,b;const y=[];for(;v&&([v,_]=Array.from(b=[m(v),v]),b);)y.push(_);return y})())(function(m){return m.parent.traits.hash.present?null:m.parent}),s=m=>t.indexOf(m)>=0,o=m=>m.sort(function(v,_){const b=v.length,y=_.length;let M=Math.min(b,y);for(let S=1,E=M,A=1<=E;A?S<=E:S>=E;A?S++:S--){const R=v[b-S],O=_[y-S],L=R.props.order,P=O.props.order;if(L!=null||P!=null){if(L!=null&&P!=null&&(M=L-P)!==0)return M;if(L!=null)return-1;if(P!=null)return 1}if(O.order!==R.order)return O.order-R.order}return M=b-y,M!==0?M:0}),a=function(m){const v=[],_=[];for(const b of Array.from(m))(b[0].props.steps!=null?v:_).push(b);return[v,_]},l=function(m){let v;const[_,b]=Array.from(m),y=100,M={};let S=[];const E=function(R,O){let L;const{props:P}=L=R[0],D=R[1],V=D!=null?M[D._id]:0,K=O;let W=P.from!=null?V+P.from:K-P.early,Z=P.to!=null?V+P.to:K+P.steps+P.late;W=Math.max(0,W),Z=Math.min(y,Z),M[L._id]==null&&(M[L._id]=W);for(let z=W,ut=Z,nt=W<=ut;nt?z<ut:z>ut;nt?z++:z--)S[z]=(S[z]!=null?S[z]:S[z]=[]).concat(R);return P.steps};let A=0;for(v of Array.from(_))A+=E(v,A);for(v of Array.from(b))E(v,0);return S=(()=>{const R=[];for(v of Array.from(S))R.push(u(c(v)));return R})(),[S,M]},c=function(m){return m?(()=>{const v=[];for(let _=0;_<m.length;_++){const b=m[_];m.indexOf(b)===_&&v.push(b)}return v})():[]},u=m=>m.sort((v,_)=>v.order-_.order),h=e(t),p=o(h);return l(a(p))}go(t){let e,n;t=Math.max(0,Math.min(this.length+1,+t||0));const r=(e=this.steps[t-1])!=null?e:[],s=this.props.directed?t-this.index:1;this.index=t;const o=(()=>{const h=[];for(n of Array.from(r))this.last.indexOf(n)<0&&h.push(n);return h})(),a=(()=>{const h=[];for(n of Array.from(this.last))r.indexOf(n)<0&&h.push(n);return h})(),l=(()=>{const h=[];for(n of Array.from(r))o.indexOf(n)<0&&a.indexOf(n)<0&&h.push(n);return h})(),c=h=>h.sort((p,m)=>p.order-m.order),u=h=>h.sort((p,m)=>m.order-p.order);for(n of Array.from(c(o)))this.slideLatch(n.controller,!0,s);for(n of Array.from(c(l)))this.slideLatch(n.controller,null,s);for(n of Array.from(c(a)))this.slideLatch(n.controller,!1,s);for(n of Array.from(o))this.slideStep(n.controller,t,s);for(n of Array.from(l))this.slideStep(n.controller,t,s);for(n of Array.from(a))this.slideStep(n.controller,t,s);for(n of Array.from(u(o)))this.slideRelease(n.controller);for(n of Array.from(u(l)))this.slideRelease(n.controller);for(n of Array.from(u(a)))this.slideRelease(n.controller);this.last=r}change(t,e,n){if(t["present.index"]||n)return this.go(this.props.index)}}X3.initClass();class Y3 extends NT{static initClass(){this.traits=["node","transition","mask","visible","active"]}mask(t){let e,n;return t?(n=this._shaders.shader(),n.pipe(tc("vec4")),n.fan(),n.pipe(t,this.uniforms),n.next(),n.pipe("reveal.mask",this.uniforms),n.end(),n.pipe("float combine(float a, float b) { return min(a, b); }")):(n=this._shaders.shader(),n.pipe("reveal.mask",this.uniforms)),(e=I5t(this._inherit("mask"),r=>r.mask(n)))!=null?e:n}}Y3.initClass();function I5t(i,t){return typeof i<"u"&&i!==null?t(i):void 0}class K3 extends $o{static initClass(){this.traits=["node","slide","visible","active"]}make(){if(this._helpers.visible.make(),this._helpers.active.make(),!this._inherit("present"))throw new Error(`${this.node.toString()} must be placed inside <present></present>`);return this._inherit("present").adopt(this)}unmake(){return this._helpers.visible.unmake(),this._helpers.active.unmake(),this._inherit("present").unadopt(this)}change(t,e,n){if(t["slide.early"]||t["slide.late"]||t["slide.steps"]||t["slide.from"]||t["slide.to"])return this.rebuild()}slideLatch(t,e){if(this.trigger({type:"transition.latch",step:e}),t!=null)return this._instant(t)}slideStep(t,e){return this.trigger({type:"slide.step",index:t,step:e})}slideRelease(){return this.trigger({type:"transition.release"})}slideReset(){return this._instant(!1),this.trigger({type:"slide.reset"})}_instant(t){return this.setVisible(t),this.setActive(t)}}K3.initClass();class Z3 extends FT{static initClass(){this.traits=["node","track","step","trigger","bind"]}make(){super.make();const t=this._inherit("clock");return this.actualIndex==null&&(this.actualIndex=null),this.animateIndex=this._animator.make(this._types.number(0),{clock:t,realtime:this.props.realtime,step:e=>this.actualIndex=e}),this.lastIndex==null&&(this.lastIndex=null),this.animateStep=this._animator.make(this._types.number(0),{clock:t,realtime:this.props.realtime,step:e=>(this.playhead=e,this.update())}),this.stops=this.props.stops!=null?this.props.stops:N5t(0,this.script.length,!1),this._listen("slide","slide.reset",e=>this.lastIndex=null),this._listen("slide","slide.step",e=>{let n,{duration:r}=this.props;const{delay:s,pace:o,speed:a,playback:l,rewind:c,skip:u,trigger:h}=this.props,p=Math.max(0,Math.min(this.stops.length-1,e.index-h)),m=this.playhead,v=this.stops[p];if(this.lastIndex==null&&h){this.lastIndex=p,this.animateStep.set(v),this.animateIndex.set(p);return}let _=(n=this.actualIndex!=null?this.actualIndex:this.lastIndex)!=null?n:0;const b=p-_,y=this.stops.slice(Math.min(_,p),Math.max(_,p));let M=0;_=y.shift();for(const E of Array.from(y))_===E&&M++,_=E;this.lastIndex=p;let S=a*(e.step>=0?1:c);if(S*=u?Math.max(1,Math.abs(b)-M):1,r+=Math.abs(v-m)*o/S,m!==v)return this.animateIndex.immediate(p,{delay:s,duration:r,ease:l}),this.animateStep.immediate(v,{delay:s,duration:r,ease:l})})}made(){return this.update()}unmake(){return this.animateIndex.dispose(),this.animateStep.dispose(),this.animateIndex=this.animateStep=null,super.unmake()}change(t,e,n){return t["step.stops"]||t["step.realtime"]?this.rebuild():super.change(t,e,n)}}Z3.initClass();function N5t(i,t,e){const n=[],r=i<t,s=e?r?t+1:t-1:t;for(let o=i;r?o<s:o>s;r?o++:o--)n.push(o);return n}class J3 extends $o{static initClass(){this.traits=["node","root","scene","vertex","texture","rtt","source","index","image"],this.defaults={minFilter:"linear",magFilter:"linear",type:"unsignedByte"}}init(){return this.rtt=this.scene=this.camera=this.width=this.height=this.history=this.rootSize=this.size=null}indexShader(t){return t}imageShader(t){return this.rtt.shaderRelative(t)}sourceShader(t){return this.rtt.shaderAbsolute(t,this.history)}getDimensions(){return{items:1,width:this.width,height:this.height,depth:this.history}}getActiveDimensions(){return this.getDimensions()}make(){let t;if(this.parentRoot=this._inherit("root"),this.rootSize=this.parentRoot.getSize(),this._listen(this.parentRoot,"root.pre",this.pre),this._listen(this.parentRoot,"root.update",this.update),this._listen(this.parentRoot,"root.render",this.render),this._listen(this.parentRoot,"root.post",this.post),this._listen(this.parentRoot,"root.camera",this.setCamera),this._listen(this.parentRoot,"root.resize",function(v){return this.resize(v.size)}),this.rootSize==null)return;const{minFilter:e,magFilter:n,type:r}=this.props,{width:s,height:o,history:a,size:l}=this.props,c=l===this.node.attributes["rtt.size"].enum.relative,u=c?this.rootSize.renderWidth:1,h=c?this.rootSize.renderHeight:1;this.width=Math.round(s!=null?s*u:this.rootSize.renderWidth),this.height=Math.round(o!=null?o*h:this.rootSize.renderHeight),this.history=a,this.aspect=t=this.width/this.height,this.scene==null&&(this.scene=this._renderables.make("scene")),this.rtt=this._renderables.make("renderToTexture",{scene:this.scene,camera:this._context.defaultCamera,width:this.width,height:this.height,frames:this.history,minFilter:e,magFilter:n,type:r}),t=s||o?t:this.rootSize.aspect;const p=s??this.rootSize.viewWidth,m=o??this.rootSize.viewHeight;return this.size={renderWidth:this.width,renderHeight:this.height,aspect:t,viewWidth:p,viewHeight:m,pixelRatio:this.height/m}}made(){if(this.trigger({type:"source.rebuild"}),this.size)return this.trigger({type:"root.resize",size:this.size})}unmake(t){if(this.rtt!=null)return this.rtt.dispose(),t||this.scene.dispose(),this.rtt=this.width=this.height=this.history=null}change(t,e,n){if(e.texture||t["rtt.width"]||t["rtt.height"])return this.rebuild();if(t["root.camera"]||n)return this._unattach(),this._attach(this.props.camera,"camera",this.setCamera,this,this,!0),this.setCamera()}adopt(t){return Array.from(t.renders).map(e=>this.scene.add(e))}unadopt(t){return Array.from(t.renders).map(e=>this.scene.remove(e))}resize(t){let e,n;this.rootSize=t,{width:n,height:e,size:t}=this.props;const r=t===this.node.attributes["rtt.size"].enum.relative;if(!this.rtt||n==null||e==null||r)return this.rebuild()}select(t){return this._root.node.model.select(t,[this.node])}watch(t,e){return this._root.node.model.watch(t,e)}unwatch(t){return this._root.node.model.unwatch(t)}pre(t){return this.trigger(t)}update(t){let e;return(e=this.getOwnCamera())!=null&&(e.aspect=this.aspect||1,e.updateProjectionMatrix()),this.trigger(t)}render(t){return this.trigger(t),this.rtt!=null?this.rtt.render(this.getCamera()):void 0}post(t){return this.trigger(t)}setCamera(){const t=z5t(this.select(this.props.camera)[0],e=>e.controller);if(this.camera!==t)return this.camera=t,this.rtt.camera=this.getCamera(),this.trigger({type:"root.camera"});if(!this.camera)return this.trigger({type:"root.camera"})}getOwnCamera(){return this.camera!=null?this.camera.getCamera():void 0}getCamera(){let t;return(t=this.getOwnCamera())!=null?t:this._inherit("root").getCamera()}vertex(t,e){return e===2?t.pipe("view.position"):e===3?t.pipe("root.position"):t}}J3.initClass();function z5t(i,t){return typeof i<"u"&&i!==null?t(i):void 0}class Q3 extends gr{static initClass(){this.traits=["node","bind","object","visible","operator","style","compose"],this.defaults={zWrite:!1,zTest:!1,color:"#ffffff"}}init(){return this.compose=null}resize(){if(!this.compose||!this.bind.source)return;const t=this.bind.source.getActiveDimensions(),{width:e}=t,{height:n}=t;return this.remapUVScale.set(e,n)}make(){if(this._helpers.bind.make([{to:"operator.source",trait:"source"}]),this.bind.source==null)return;const t={remapUVScale:this._attributes.make(this._types.vec2())};this.remapUVScale=t.remapUVScale.value;let e=this._shaders.shader();const{alpha:n}=this.props;this.bind.source.is("image")?(e.pipe("screen.pass.uv",t),e=this.bind.source.imageShader(e)):(e.pipe("screen.map.xy",t),e=this.bind.source.sourceShader(e)),n||e.pipe("color.opaque");const r=this._helpers.style.uniforms();return this.compose=this._renderables.make("screen",{map:e,uniforms:r,linear:!0}),this._helpers.visible.make(),this._helpers.object.make([this.compose])}made(){return this.resize()}unmake(){return this._helpers.bind.unmake(),this._helpers.visible.unmake(),this._helpers.object.unmake()}change(t,e,n){if(t["operator.source"]||t["compose.alpha"])return this.rebuild()}}Q3.initClass();class _h extends Yd{static initClass(){this.traits=["node","object","visible","view","vertex"]}make(){return this._helpers.visible.make()}unmake(){return this._helpers.visible.unmake()}axis(t){return this.props.range[t-1]}}_h.initClass();class tU extends _h{static initClass(){this.traits=["node","object","visible","view","view3","vertex"]}make(){super.make(),this.uniforms={viewMatrix:this._attributes.make(this._types.mat4())},this.viewMatrix=this.uniforms.viewMatrix.value,this.composer=qf()}unmake(){super.unmake(),delete this.viewMatrix,delete this.objectMatrix,delete this.uniforms}change(t,e,n){if(!e.view&&!e.view3&&!n)return;const r=this.props.position,s=this.props.scale,o=this.props.quaternion,a=this.props.rotation,l=this.props.range,c=this.props.eulerOrder,{x:u}=l[0],h=l[1].x,p=l[2].x,m=l[0].y-u||1,v=l[1].y-h||1,_=l[2].y-p||1;this.viewMatrix.set(2/m,0,0,-(2*u+m)/m,0,2/v,0,-(2*h+v)/v,0,0,2/_,-(2*p+_)/_,0,0,0,1);const b=this.composer(r,a,o,s,null,c);this.viewMatrix.multiplyMatrices(b,this.viewMatrix),t["view.range"]&&this.trigger({type:"view.range"})}vertex(t,e){return e===1&&t.pipe("cartesian.position",this.uniforms),super.vertex(t,e)}}tU.initClass();class eU extends _h{static initClass(){this.traits=["node","object","visible","view","view4","vertex"]}make(){return super.make(),this.uniforms={basisOffset:this._attributes.make(this._types.vec4()),basisScale:this._attributes.make(this._types.vec4())},this.basisScale=this.uniforms.basisScale.value,this.basisOffset=this.uniforms.basisOffset.value}unmake(){return super.unmake(),delete this.basisScale,delete this.basisOffset,delete this.uniforms}change(t,e,n){if(!e.view&&!e.view4&&!n)return;const r=this.props.position,s=this.props.scale,o=this.props.range,{x:a}=o[0],l=o[1].x,c=o[2].x,u=o[3].x,h=o[0].y-a||1,p=o[1].y-l||1,m=o[2].y-c||1,v=o[3].y-u||1,_=function(b,y){return b.x*=y.x,b.y*=y.y,b.z*=y.z,b.w*=y.w};if(this.basisScale.set(2/h,2/p,2/m,2/v),this.basisOffset.set(-(2*a+h)/h,-(2*l+p)/p,-(2*c+m)/m,-(2*u+v)/v),_(this.basisScale,s),_(this.basisOffset,s),this.basisOffset.add(r),t["view.range"])return this.trigger({type:"view.range"})}vertex(t,e){return e===1&&t.pipe("cartesian4.position",this.uniforms),super.vertex(t,e)}}eU.initClass();class nU extends _h{static initClass(){this.traits=["node","object","visible","view","view3","polar","vertex"]}make(){super.make();const{types:t}=this._attributes;return this.uniforms={polarBend:this.node.attributes["polar.bend"],polarHelix:this.node.attributes["polar.helix"],polarFocus:this._attributes.make(t.number()),polarAspect:this._attributes.make(t.number()),viewMatrix:this._attributes.make(t.mat4())},this.viewMatrix=this.uniforms.viewMatrix.value,this.composer=qf(),this.aspect=1}unmake(){return super.unmake(),delete this.viewMatrix,delete this.objectMatrix,delete this.aspect,delete this.uniforms}change(t,e,n){let r,s,o;if(!e.view&&!e.view3&&!e.polar&&!n)return;this.helix=this.props.helix,this.bend=s=this.props.bend,this.focus=o=s>0?1/s-1:0;const a=this.props.position,l=this.props.scale,c=this.props.quaternion,u=this.props.rotation,h=this.props.range,p=this.props.eulerOrder,{x:m}=h[0];let v=h[1].x;const _=h[2].x,b=h[0].y-m||1;let y=h[1].y-v||1;const M=h[2].y-_||1,S=l.x,E=l.y,A=b>0?1:-1;[v,y]=Array.from(Cf(v,y,s));const R=Math.abs(y),O=b+(R*A-b)*s,L=O/S,P=y/E;this.aspect=r=Math.abs(L/P),this.uniforms.polarFocus.value=o,this.uniforms.polarAspect.value=r,this.viewMatrix.set(2/O,0,0,-(2*m+b)/b,0,2/y,0,-(2*v+y)/y,0,0,2/M,-(2*_+M)/M,0,0,0,1);const D=this.composer(a,u,c,l,null,p);this.viewMatrix.multiplyMatrices(D,this.viewMatrix),(t["view.range"]||e.polar)&&this.trigger({type:"view.range"})}vertex(t,e){return e===1&&t.pipe("polar.position",this.uniforms),super.vertex(t,e)}axis(t){const e=this.props.range[t-1];let n=e.x,r=e.y;return t===2&&this.bend>0&&(r=Math.max(Math.abs(r),Math.abs(n)),n=Math.max(-this.focus/this.aspect,n)),new Vt(n,r)}}nU.initClass();class iU extends _h{static initClass(){this.traits=["node","object","visible","view","view3","spherical","vertex"]}make(){return super.make(),this.uniforms={sphericalBend:this.node.attributes["spherical.bend"],sphericalFocus:this._attributes.make(this._types.number()),sphericalAspectX:this._attributes.make(this._types.number()),sphericalAspectY:this._attributes.make(this._types.number()),sphericalScaleY:this._attributes.make(this._types.number()),viewMatrix:this._attributes.make(this._types.mat4())},this.viewMatrix=this.uniforms.viewMatrix.value,this.composer=qf(),this.aspectX=1,this.aspectY=1}unmake(){return super.unmake(),delete this.viewMatrix,delete this.objectMatrix,delete this.aspectX,delete this.aspectY,delete this.uniforms}change(t,e,n){let r,s,o,a,l;if(!e.view&&!e.view3&&!e.spherical&&!n)return;this.bend=o=this.props.bend,this.focus=a=o>0?1/o-1:0;const c=this.props.position,u=this.props.scale,h=this.props.quaternion,p=this.props.rotation,m=this.props.range,v=this.props.eulerOrder,{x:_}=m[0];let b=m[1].x,y=m[2].x;const M=m[0].y-_||1;let S=m[1].y-b||1,E=m[2].y-y||1;const A=u.x,R=u.y,O=u.z;[b,S]=Array.from(Cf(b,S,o)),[y,E]=Array.from(Cf(y,E,o));const L=M>0?1:-1,P=S>0?1:-1,D=Math.abs(E),V=M+(D*L-M)*o,K=S+(D*P-S)*o,W=V/A,Z=K/R,z=E/O;this.aspectX=r=Math.abs(W/z),this.aspectY=s=Math.abs(Z/z/r);const ut=S/M*A/R*2;this.scaleY=l=Math.min(s/o,1+(ut-1)*o),this.uniforms.sphericalBend.value=o,this.uniforms.sphericalFocus.value=a,this.uniforms.sphericalAspectX.value=r,this.uniforms.sphericalAspectY.value=s,this.uniforms.sphericalScaleY.value=l,this.viewMatrix.set(2/V,0,0,-(2*_+M)/M,0,2/K,0,-(2*b+S)/S,0,0,2/E,-(2*y+E)/E,0,0,0,1);const nt=this.composer(c,p,h,u,null,v);if(this.viewMatrix.multiplyMatrices(nt,this.viewMatrix),t["view.range"]||e.spherical)return this.trigger({type:"view.range"})}vertex(t,e){return e===1&&t.pipe("spherical.position",this.uniforms),super.vertex(t,e)}axis(t){const e=this.props.range[t-1];let n=e.x,r=e.y;return t===3&&this.bend>0&&(r=Math.max(Math.abs(r),Math.abs(n)),n=Math.max(-this.focus/this.aspectX+.001,n)),new Vt(n,r)}}iU.initClass();class rU extends _h{static initClass(){this.traits=["node","object","visible","view","view3","stereographic","vertex"]}make(){return super.make(),this.uniforms={stereoBend:this.node.attributes["stereographic.bend"],viewMatrix:this._attributes.make(this._types.mat4())},this.viewMatrix=this.uniforms.viewMatrix.value,this.composer=qf()}unmake(){return super.unmake(),delete this.viewMatrix,delete this.rotationMatrix,delete this.uniforms}change(t,e,n){let r;if(!e.view&&!e.view3&&!e.stereographic&&!n)return;this.bend=r=this.props.bend;const s=this.props.position,o=this.props.scale,a=this.props.quaternion,l=this.props.rotation,c=this.props.range,u=this.props.eulerOrder,{x:h}=c[0],p=c[1].x;let m=c[2].x;const v=c[0].y-h||1,_=c[1].y-p||1;let b=c[2].y-m||1;[m,b]=Array.from(Cf(m,b,r,1)),this.uniforms.stereoBend.value=r,this.viewMatrix.set(2/v,0,0,-(2*h+v)/v,0,2/_,0,-(2*p+_)/_,0,0,2/b,-(2*m+b)/b,0,0,0,1);const y=this.composer(s,l,a,o,null,u);if(this.viewMatrix.multiplyMatrices(y,this.viewMatrix),t["view.range"]||e.stereographic)return this.trigger({type:"view.range"})}vertex(t,e){return e===1&&t.pipe("stereographic.position",this.uniforms),super.vertex(t,e)}}rU.initClass();class sU extends _h{static initClass(){this.traits=["node","object","visible","view","view4","stereographic","vertex"]}make(){super.make(),this.uniforms={basisOffset:this._attributes.make(this._types.vec4()),basisScale:this._attributes.make(this._types.vec4()),stereoBend:this.node.attributes["stereographic.bend"]},this.basisScale=this.uniforms.basisScale.value,this.basisOffset=this.uniforms.basisOffset.value}unmake(){super.unmake(),delete this.basisScale,delete this.basisOffset,delete this.uniforms}change(t,e,n){let r;if(!e.view&&!e.view4&&!e.stereographic&&!n)return;this.bend=r=this.props.bend;const s=this.props.position,o=this.props.scale,a=this.props.range,{x:l}=a[0],c=a[1].x,u=a[2].x;let h=a[3].x;const p=a[0].y-l||1,m=a[1].y-c||1,v=a[2].y-u||1;let _=a[3].y-h||1;const b=function(y,M){y.x*=M.x,y.y*=M.y,y.z*=M.z,y.w*=M.w};[h,_]=Array.from(Cf(h,_,r,1)),this.basisScale.set(2/p,2/m,2/v,2/_),this.basisOffset.set(-(2*l+p)/p,-(2*c+m)/m,-(2*u+v)/v,-(2*h+_)/_),b(this.basisScale,o),b(this.basisOffset,o),this.basisOffset.add(s),(t["view.range"]||e.stereographic)&&this.trigger({type:"view.range"})}vertex(t,e){return e===1&&t.pipe("stereographic4.position",this.uniforms),super.vertex(t,e)}}sU.initClass();class oU extends gr{static initClass(){this.traits=["node","bind","shader"],this.freeform=!0}init(){return this.shader=null}make(){const{language:t,code:e}=this.props;if(t!=="glsl")throw new Error("GLSL required");this._helpers.bind.make([{to:"shader.sources",trait:"source",multiple:!0}]);const n=this._shaders.fetch(e),r=this._types,s={},o=a=>{let l;switch(a){case"i":return r.int();case"f":return r.number();case"v2":return r.vec2();case"v3":return r.vec3();case"v4":return r.vec4();case"m3":return r.mat3();case"m4":return r.mat4();case"t":return r.object();default:return l=a.split(""),l.pop()==="v"?r.array(o(l.join(""))):null}};for(const a of Array.from(n._signatures.uniform)){let l;(l=o(a.type))&&(s[a.name]=l)}return this.reconfigure({props:{uniform:s}})}made(){return this.trigger({type:"source.rebuild"})}unmake(){return this.shader=null}change(t,e,n){if(t["shader.uniforms"]||t["shader.code"]||t["shader.language"])return this.rebuild()}shaderBind(t){let e,n,r;t==null&&(t={});const{code:s,indices:o,channels:a}=this.props;for(e in this.node.attributes)r=this.node.attributes[e],r.type!=null&&r.short!=null&&r.ns==="uniform"&&t[r.short]==null&&(t[r.short]=r);if((n=this.props.uniforms)!=null)for(e in n)r=n[e],t[e]=r;const l=this._shaders.shader();if(this.bind.sources!=null)for(const c of Array.from(this.bind.sources))l.callback(),o!=4&&l.pipe(Ld(o,4)),l.pipe(c.sourceShader(this._shaders.shader())),a!=4&&l.pipe(rh(4,a)),l.join();return l.pipe(s,t)}}oU.initClass();const U5t={axis:c3,face:u3,grid:h3,line:d3,point:p3,strip:f3,surface:m3,ticks:g3,vector:v3,view:_h,cartesian:tU,cartesian4:eU,polar:nU,spherical:iU,stereographic:rU,stereographic4:sU,transform:E3,transform4:T3,vertex:A3,fragment:P3,layer:R3,mask:k3,array:xT,interval:Rz,matrix:LT,area:s3,voxel:Dv,volume:o3,scale:a3,latch:r3,html:_3,dom:b3,text:y3,format:x3,label:w3,retext:S3,clamp:L3,grow:O3,join:D3,lerp:I3,memo:N3,readback:z3,resample:IT,repeat:U3,reverse:F3,swizzle:V3,spread:B3,split:H3,slice:$3,subdivide:G3,transpose:q3,group:vz,inherit:_z,root:bz,unit:yz,shader:oU,camera:wz,rtt:J3,compose:Q3,clock:M3,now:C3,move:W3,play:j3,present:X3,reveal:Y3,slide:K3,step:Z3},F5t={array(i,t,e=null){const n=i.lerp?function(s,o,a,l){const c=Math.min(s.length,o.length);for(let u=0,h=c,p=0<=h;p?u<h:u>h;p?u++:u--)a[u]=i.lerp(s[u],o[u],a[u],l);return a}:void 0,r=i.op?function(s,o,a,l){const c=Math.min(s.length,o.length);for(let u=0,h=c,p=0<=h;p?u<h:u>h;p?u++:u--)a[u]=i.op(s[u],o[u],a[u],l);return a}:void 0;return e!=null&&!(e instanceof Array)&&(e=[e]),{uniform(){if(i.uniform)return i.uniform()+"v"},make(){return e!=null?e.slice():t?B5t(0,t,!1).map(s=>i.make()):[]},validate(s,o,a){s instanceof Array||(s=[s]);const l=o.length=t||s.length;for(let c=0,u=l,h=0<=u;h?c<u:c>u;h?c++:c--){const p=s[c]!=null?s[c]:i.make();o[c]=i.validate(p,o[c],a)}return o},equals(s,o){const a=s.length,l=o.length;if(a!==l)return!1;const c=Math.min(a,l);for(let u=0,h=c,p=0<=h;p?u<h:u>h;p?u++:u--)if(!(typeof i.equals=="function"&&i.equals(s[u],o[u])))return!1;return!0},lerp:n,op:r,clone(s){return Array.from(s).map(o=>i.clone(o))}}},letters(i,t,e=null){if(e!=null){e===""+e&&(e=e.split(""));for(let r=0;r<e.length;r++){const s=e[r];e[r]=i.validate(s,s)}}const n=Gn.array(i,t,e);return{uniform(){return n.uniform()},make(){return n.make()},validate(r,s,o){return r===""+r&&(r=r.split("")),n.validate(r,s,o)},equals(r,s){return n.equals(r,s)},clone:n.clone}},nullable(i,t){t==null&&(t=!1);let e=t?i.make():null;const n=i.emitter?function(o,a){return a==null?o:o==null?a:i.emitter(o,a)}:void 0,r=i.lerp?function(o,a,l,c){return o===null||a===null?c<.5?o:a:(l==null&&(l=i.make()),e=i.lerp(o,a,l,c),l)}:void 0,s=i.op?function(o,a,l,c){return o===null||a===null?null:(l==null&&(l=i.make()),e=i.op(o,a,l,c),e)}:void 0;return{make(){return e},validate(o,a,l){return o===null?o:(a===null&&(a=i.make()),i.validate(o,a,l))},uniform(){return typeof i.uniform=="function"?i.uniform():void 0},equals(o,a){let l;const c=o===null,u=a===null;return c&&u?!0:c^u?!1:(l=typeof i.equals=="function"?i.equals(o,a):void 0)!=null?l:o===a},lerp:r,op:s,emitter:n}},enum(i,t,e){let n;t==null&&(t=[]),e==null&&(e={});let r=0;const s={};for(n of Array.from(t))n!==+n&&e[n]==null&&(e[n]=r++);for(n of Array.from(t))n===+n&&(s[n]=n);for(n in e)r=e[n],s[r]=!0;return s[i]==null&&(i=e[i]),{enum(){return e},make(){return i},validate(o,a,l){const c=s[o]?o:e[o];return c??l()}}},enumber(i,t,e){e==null&&(e={});const n=Gn.enum(i,t,e);return{enum:n.enum,uniform(){return"f"},make(){let r;return(r=n.make())!=null?r:+i},validate(r,s,o){return r===+r?r:n.validate(r,s,o)},op(r,s,o,a){return a(r,s)}}},select(i){return i==null&&(i="<"),{make(){return i},validate(t,e,n){return typeof t=="string"||typeof t=="object"?t:n()}}},bool(i){return i=!!i,{uniform(){return"f"},make(){return i},validate(t,e,n){return!!t}}},int(i){return i==null&&(i=0),i=+Math.round(i),{uniform(){return"i"},make(){return i},validate(t,e,n){let r;return t!==(r=+t)?n():Math.round(r)||0},op(t,e,n,r){return r(t,e)}}},round(i){return i==null&&(i=0),i=+Math.round(i),{uniform(){return"f"},make(){return i},validate(t,e,n){let r;return t!==(r=+t)?n():Math.round(r)||0},op(t,e,n,r){return r(t,e)}}},number(i){return i==null&&(i=0),{uniform(){return"f"},make(){return+i},validate(t,e,n){let r;return t!==(r=+t)?n():r||0},op(t,e,n,r){return r(t,e)}}},positive(i,t){return t==null&&(t=!1),{uniform:i.uniform,make:i.make,validate(e,n,r){return e=i.validate(e,n,r),e<0||t&&e<=0?r():e},op(e,n,r,s){return s(e,n)}}},string(i){return i==null&&(i=""),{make(){return""+i},validate(t,e,n){let r;return t!==(r=""+t)?n():r}}},func(){return{make(){return function(){}},validate(i,t,e){return typeof i=="function"?i:e()}}},emitter(){return{make(){return i=>i(1,1,1,1)},validate(i,t,e){return typeof i=="function"?i:e()},emitter(i,t){return Mz(i,t)}}},object(i){return{make(){return i??{}},validate(t,e,n){return typeof t=="object"?t:n()},clone(t){return JSON.parse(JSON.stringify(t))}}},timestamp(i=null){return typeof i=="string"&&(i=Date.parse(i)),{uniform(){return"f"},make(){return i??+new Date},validate(t,e,n){return t=Date.parse(t),t!==+t?n():t},op(t,e,n,r){return r(t,e)}}},vec2(i,t){i==null&&(i=0),t==null&&(t=0);const e=[i,t];return{uniform(){return"v2"},make(){return new Vt(i,t)},validate(n,r,s){if(n===+n&&(n=[n]),n!=null&&n.isVector2)r.copy(n);else if(n instanceof Array)n=n.concat(e.slice(n.length)),r.set.apply(r,n);else if(n!=null){const o=n.x!=null?n.x:i,a=n.y!=null?n.y:t;r.set(o,a)}else return s();return r},equals(n,r){return n.x===r.x&&n.y===r.y},op(n,r,s,o){return s.x=o(n.x,r.x),s.y=o(n.y,r.y),s}}},ivec2(i,t){i==null&&(i=0),t==null&&(t=0);const e=Gn.vec2(i,t),{validate:n}=e;return e.validate=function(r,s,o){return n(r,s,o),s.x=Math.round(s.x),s.y=Math.round(s.y),s},e},vec3(i,t,e){i==null&&(i=0),t==null&&(t=0),e==null&&(e=0);const n=[i,t,e];return{uniform(){return"v3"},make(){return new Y(i,t,e)},validate(r,s,o){if(r===+r&&(r=[r]),r!=null&&r.isVector3)s.copy(r);else if(r instanceof Array)r=r.concat(n.slice(r.length)),s.set.apply(s,r);else if(r!=null){const a=r.x!=null?r.x:i,l=r.y!=null?r.y:t,c=r.z!=null?r.z:e;s.set(a,l,c)}else return o();return s},equals(r,s){return r.x===s.x&&r.y===s.y&&r.z===s.z},op(r,s,o,a){return o.x=a(r.x,s.x),o.y=a(r.y,s.y),o.z=a(r.z,s.z),o}}},ivec3(i,t,e){i==null&&(i=0),t==null&&(t=0),e==null&&(e=0);const n=Gn.vec3(i,t,e),{validate:r}=n;return n.validate=function(s,o,a){return r(s,o,a),o.x=Math.round(o.x),o.y=Math.round(o.y),o.z=Math.round(o.z),o},n},vec4(i,t,e,n){i==null&&(i=0),t==null&&(t=0),e==null&&(e=0),n==null&&(n=0);const r=[i,t,e,n];return{uniform(){return"v4"},make(){return new Vn(i,t,e,n)},validate(s,o,a){if(s===+s&&(s=[s]),s!=null&&s.isVector4)o.copy(s);else if(s instanceof Array)s=s.concat(r.slice(s.length)),o.set.apply(o,s);else if(s!=null){const l=s.x!=null?s.x:i,c=s.y!=null?s.y:t,u=s.z!=null?s.z:e,h=s.w!=null?s.w:n;o.set(l,c,u,h)}else return a();return o},equals(s,o){return s.x===o.x&&s.y===o.y&&s.z===o.z&&s.w===o.w},op(s,o,a,l){return a.x=l(s.x,o.x),a.y=l(s.y,o.y),a.z=l(s.z,o.z),a.w=l(s.w,o.w),a}}},ivec4(i,t,e,n){i==null&&(i=0),t==null&&(t=0),e==null&&(e=0),n==null&&(n=0);const r=Gn.vec4(i,t,e,n),{validate:s}=r;return r.validate=function(o,a,l){return s(o,a,l),a.x=Math.round(a.x),a.y=Math.round(a.y),a.z=Math.round(a.z),a.w=Math.round(a.w),a},r},mat3(i,t,e,n,r,s,o,a,l){i==null&&(i=1),t==null&&(t=0),e==null&&(e=0),n==null&&(n=0),r==null&&(r=1),s==null&&(s=0),o==null&&(o=0),a==null&&(a=0),l==null&&(l=1);const c=[i,t,e,n,r,s,o,a,l];return{uniform(){return"m4"},make(){const u=new wn;return u.set(i,t,e,n,r,s,o,a,l),u},validate(u,h,p){if(u!=null&&u.isMatrix3)h.copy(u);else if(u instanceof Array)u=u.concat(c.slice(u.length)),h.set.apply(h,u);else return p();return h}}},mat4(i,t,e,n,r,s,o,a,l,c,u,h,p,m,v,_){i==null&&(i=1),t==null&&(t=0),e==null&&(e=0),n==null&&(n=0),r==null&&(r=0),s==null&&(s=1),o==null&&(o=0),a==null&&(a=0),l==null&&(l=0),c==null&&(c=0),u==null&&(u=1),h==null&&(h=0),p==null&&(p=0),m==null&&(m=0),v==null&&(v=0),_==null&&(_=1);const b=[i,t,e,n,r,s,o,a,l,c,u,h,p,m,v,_];return{uniform(){return"m4"},make(){const y=new rn;return y.set(i,t,e,n,r,s,o,a,l,c,u,h,p,m,v,_),y},validate(y,M,S){if(y!=null&&y.isMatrix4)M.copy(y);else if(y instanceof Array)y=y.concat(b.slice(y.length)),M.set.apply(M,y);else return S();return M}}},quat(i,t,e,n){i==null&&(i=0),t==null&&(t=0),e==null&&(e=0),n==null&&(n=1);const r=Gn.vec4(i,t,e,n);return{uniform(){return"v4"},make(){return new $r},validate(s,o,a){return s!=null&&s.isQuaternion?o.copy(s):o=r.validate(s,o,a),o.normalize(),o},equals(s,o){return s.x===o.x&&s.y===o.y&&s.z===o.z&&s.w===o.w},op(s,o,a,l){return a.x=l(s.x,o.x),a.y=l(s.y,o.y),a.z=l(s.z,o.z),a.w=l(s.w,o.w),a.normalize(),a},lerp(s,o,a,l){return a.slerpQuaternions?a.slerpQuaternions(s,o,l):$r.slerp(s,o,a,l),a}}},color(i,t,e){i==null&&(i=.5),t==null&&(t=.5),e==null&&(e=.5);const n=[i,t,e];return{uniform(){return"c"},make(){return new me(i,t,e)},validate(r,s,o){if(r===""+r?r=new me().setStyle(r):r===+r&&(r=new me(r)),r!=null&&r.isColor)s.copy(r);else if(r instanceof Array)r=r.concat(n.slice(r.length)),s.setRGB.apply(s,r);else if(r!=null){const a=r.r!=null?r.r:i,l=r.g!=null?r.g:t,c=r.b!=null?r.b:e;s.set(a,l,c)}else return o();return s},equals(r,s){return r.r===s.r&&r.g===s.g&&r.b===s.b},op(r,s,o,a){return o.r=a(r.r,s.r),o.g=a(r.g,s.g),o.b=a(r.b,s.b),o}}},axis(i,t){let e;i==null&&(i=1),t==null&&(t=!1);const n={x:1,y:2,z:3,w:4,W:1,H:2,D:3,I:4,zero:0,null:0,width:1,height:2,depth:3,items:4},r=t?[0,1,2,3,4]:[1,2,3,4];return(e=n[i])!=null&&(i=e),{make(){return i},validate(s,o,a){let l;return(e=n[s])!=null&&(s=e),s=(l=Math.round(s))!=null?l:0,Array.from(r).includes(s)?s:a()}}},transpose(i){i==null&&(i=[1,2,3,4]);const t=Gn.letters(Gn.axis(null,!1),0,i),e=Gn.letters(Gn.axis(null,!1),4,i);return{make(){return e.make()},validate(n,r,s){let o=[1,2,3,4];if(t.validate(n,o,s),o.length<4){const l=[1,2,3,4].filter(c=>o.indexOf(c)===-1);o=o.concat(l)}return Array.from(o).map((l,c)=>o.indexOf(l)===c).indexOf(!1)<0?e.validate(o,r,s):s()},equals:e.equals,clone:e.clone}},swizzle(i,t=null){i==null&&(i=[1,2,3,4]),t==null&&(t=i.length),i=i.slice(0,t);const e=Gn.letters(Gn.axis(null,!1),0,i),n=Gn.letters(Gn.axis(null,!0),t,i);return{make(){return n.make()},validate(r,s,o){let a=i.slice();return e.validate(r,a,o),a.length<t&&(a=a.concat([0,0,0,0]).slice(0,t)),n.validate(a,s,o)},equals:n.equals,clone:n.clone}},classes(){const i=Gn.array(Gn.string());return{make(){return i.make()},validate(t,e,n){return t===""+t&&(t=t.split(" ")),t=t.filter(r=>!!r.length),i.validate(t,e,n)},equals:i.equals,clone:i.clone}},blending(i){i==null&&(i="normal");const t=["no","normal","add","subtract","multiply","custom"];return Gn.enum(i,t)},filter(i){i==null&&(i="nearest");const t={nearest:si,nearestMipMapNearest:hE,nearestMipMapLinear:dE,linear:Ji,linearMipMapNearest:fE,linearMipmapLinear:mE};return Gn.enum(i,[],t)},type(i){i==null&&(i="unsignedByte");const t={unsignedByte:lo,byte:bv,short:yv,unsignedShort:Ud,int:Uf,unsignedInt:Fa,float:Hr};return Gn.enum(i,[],t)},scale(i){i==null&&(i="linear");const t=["linear","log"];return Gn.enum(i,t)},mapping(i){i==null&&(i="relative");const t=["relative","absolute"];return Gn.enum(i,t)},indexing(i){i==null&&(i="original");const t=["original","final"];return Gn.enum(i,t)},shape(i){i==null&&(i="circle");const t=["circle","square","diamond","up","down","left","right"];return Gn.enum(i,t)},join(i){i==null&&(i="miter");const t=["miter","round","bevel"];return Gn.enum(i,t)},stroke(i){i==null&&(i="solid");const t=["solid","dotted","dashed"];return Gn.enum(i,t)},vertexPass(i){i==null&&(i="view");const t=["data","view","world","eye"];return Gn.enum(i,t)},fragmentPass(i){i==null&&(i="light");const t=["color","light","rgba"];return Gn.enum(i,t)},ease(i){i==null&&(i="linear");const t=["linear","cosine","binary","hold"];return Gn.enum(i,t)},fit(i){i==null&&(i="contain");const t=["x","y","contain","cover"];return Gn.enum(i,t)},anchor(i){i==null&&(i="middle");const t={first:1,middle:0,last:-1};return Gn.enumber(i,[],t)},transitionState(i){i==null&&(i="enter");const t={enter:-1,visible:0,exit:1};return Gn.enumber(i,[],t)},font(i){i==null&&(i="sans-serif");const t=l3;i instanceof Array||(i=t(i));const e=Gn.array(Gn.string(),0,i);return{make(){return e.make()},validate(n,r,s){try{n instanceof Array||(n=t(n))}catch{return s()}return n=n.filter(o=>!!o.length),e.validate(n,r,s)},equals:e.equals,clone:e.clone}},data(i){return{make(){return[]},validate(t,e,n){return t instanceof Array||(t!=null?t.length:void 0)!=null?t:n()},emitter(t,e){return Cz(t,e)}}}},V5t=function(i){for(const t in i){const e=i[t];i[t]=(n=>function(){const r=n.apply(n,arguments);return r.validate==null&&(r.validate=s=>s!=null),r.equals==null&&(r.equals=(s,o)=>s===o),r.clone==null&&(r.clone=function(s){let o;return(o=H5t(s,"clone",a=>a.clone()))!=null?o:s}),r})(e)}return i},Gn=V5t(F5t);function B5t(i,t,e){const n=[],r=i<t,s=e?r?t+1:t-1:t;for(let o=i;r?o<s:o>s;r?o++:o--)n.push(o);return n}function H5t(i,t,e){if(typeof i<"u"&&i!==null&&typeof i[t]=="function")return e(i,t)}const U=Gn,$5t={node:{id:U.nullable(U.string()),classes:U.classes()},entity:{active:U.bool(!0)},object:{visible:U.bool(!0)},latch:{data:U.nullable(U.object()),deep:U.nullable(U.bool(!0))},unit:{scale:U.nullable(U.number()),fov:U.nullable(U.number()),focus:U.nullable(U.number(1),!0)},span:{range:U.nullable(U.vec2(-1,1))},view:{range:U.array(U.vec2(-1,1),4)},view3:{position:U.vec3(),quaternion:U.quat(),rotation:U.vec3(),scale:U.vec3(1,1,1),eulerOrder:U.swizzle("xyz")},view4:{position:U.vec4(),scale:U.vec4(1,1,1,1)},layer:{depth:U.number(1),fit:U.fit("y")},vertex:{pass:U.vertexPass()},fragment:{pass:U.fragmentPass(),gamma:U.bool(!1)},transform3:{position:U.vec3(),quaternion:U.quat(),rotation:U.vec3(),eulerOrder:U.swizzle("xyz"),scale:U.vec3(1,1,1),matrix:U.mat4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transform4:{position:U.vec4(),scale:U.vec4(1,1,1,1),matrix:U.mat4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},camera:{proxy:U.bool(!1),position:U.nullable(U.vec3()),quaternion:U.nullable(U.quat()),rotation:U.nullable(U.vec3()),lookAt:U.nullable(U.vec3()),up:U.nullable(U.vec3()),eulerOrder:U.swizzle("xyz"),fov:U.nullable(U.number(1))},polar:{bend:U.number(1),helix:U.number(0)},spherical:{bend:U.number(1)},stereographic:{bend:U.number(1)},interval:{axis:U.axis()},area:{axes:U.swizzle([1,2],2)},volume:{axes:U.swizzle([1,2,3],3)},origin:{origin:U.vec4()},scale:{divide:U.number(10),unit:U.number(1),base:U.number(10),mode:U.scale(),start:U.bool(!0),end:U.bool(!0),zero:U.bool(!0),factor:U.positive(U.number(1)),nice:U.bool(!0)},grid:{lineX:U.bool(!0),lineY:U.bool(!0),crossed:U.bool(!1),closedX:U.bool(!1),closedY:U.bool(!1)},axis:{detail:U.int(1),crossed:U.bool(!1)},data:{data:U.nullable(U.data()),expr:U.nullable(U.emitter()),bind:U.nullable(U.func()),live:U.bool(!0)},buffer:{channels:U.enum(4,[1,2,3,4]),items:U.int(1),fps:U.nullable(U.int(60)),hurry:U.int(5),limit:U.int(60),realtime:U.bool(!1),observe:U.bool(!1),aligned:U.bool(!1)},sampler:{centered:U.bool(!1),padding:U.number(0)},array:{width:U.nullable(U.positive(U.int(1),!0)),bufferWidth:U.int(1),history:U.int(1)},matrix:{width:U.nullable(U.positive(U.int(1),!0)),height:U.nullable(U.positive(U.int(1),!0)),history:U.int(1),bufferWidth:U.int(1),bufferHeight:U.int(1)},voxel:{width:U.nullable(U.positive(U.int(1),!0)),height:U.nullable(U.positive(U.int(1),!0)),depth:U.nullable(U.positive(U.int(1),!0)),bufferWidth:U.int(1),bufferHeight:U.int(1),bufferDepth:U.int(1)},resolve:{expr:U.nullable(U.func()),items:U.int(1)},style:{opacity:U.positive(U.number(1)),color:U.color(),blending:U.blending(),zWrite:U.bool(!0),zTest:U.bool(!0),zIndex:U.positive(U.round()),zBias:U.number(0),zOrder:U.nullable(U.int())},geometry:{points:U.select(),colors:U.nullable(U.select())},point:{size:U.positive(U.number(4)),sizes:U.nullable(U.select()),shape:U.shape(),optical:U.bool(!0),fill:U.bool(!0),depth:U.number(1)},line:{width:U.positive(U.number(2)),depth:U.positive(U.number(1)),join:U.join(),stroke:U.stroke(),proximity:U.nullable(U.number(1/0)),closed:U.bool(!1)},mesh:{fill:U.bool(!0),shaded:U.bool(!1),normals:U.nullable(U.select()),map:U.nullable(U.select()),lineBias:U.number(5)},strip:{line:U.bool(!1)},face:{line:U.bool(!1)},arrow:{size:U.number(3),start:U.bool(!1),end:U.bool(!1)},ticks:{normal:U.vec3(0,0,1),size:U.positive(U.number(10)),epsilon:U.positive(U.number(.001))},attach:{offset:U.vec2(0,-20),snap:U.bool(!1),depth:U.number(0)},format:{digits:U.nullable(U.positive(U.number(3))),data:U.nullable(U.data()),expr:U.nullable(U.func()),live:U.bool(!0)},font:{font:U.font("sans-serif"),style:U.string(),variant:U.string(),weight:U.string(),detail:U.number(24),sdf:U.number(5)},label:{text:U.select(),size:U.number(16),outline:U.number(2),expand:U.number(0),background:U.color(1,1,1)},overlay:{opacity:U.number(1),zIndex:U.positive(U.round(0))},dom:{points:U.select(),html:U.select(),size:U.number(16),outline:U.number(2),zoom:U.number(1),color:U.nullable(U.color()),attributes:U.nullable(U.object()),pointerEvents:U.bool(!1)},texture:{minFilter:U.filter("nearest"),magFilter:U.filter("nearest"),type:U.type("float")},shader:{sources:U.nullable(U.select()),indices:U.number(4),channels:U.number(4),language:U.string("glsl"),code:U.string(),uniforms:U.nullable(U.object())},include:{shader:U.select()},operator:{source:U.select()},spread:{unit:U.mapping(),items:U.nullable(U.vec4()),width:U.nullable(U.vec4()),height:U.nullable(U.vec4()),depth:U.nullable(U.vec4()),alignItems:U.anchor(),alignWidth:U.anchor(),alignHeight:U.anchor(),alignDepth:U.anchor()},grow:{scale:U.number(1),items:U.nullable(U.anchor()),width:U.nullable(U.anchor()),height:U.nullable(U.anchor()),depth:U.nullable(U.anchor())},split:{order:U.transpose("wxyz"),axis:U.nullable(U.axis()),length:U.int(1),overlap:U.int(0)},join:{order:U.transpose("wxyz"),axis:U.nullable(U.axis()),overlap:U.int(0)},swizzle:{order:U.swizzle()},transpose:{order:U.transpose()},repeat:{items:U.number(1),width:U.number(1),height:U.number(1),depth:U.number(1)},slice:{items:U.nullable(U.vec2()),width:U.nullable(U.vec2()),height:U.nullable(U.vec2()),depth:U.nullable(U.vec2())},reverse:{items:U.bool(!1),width:U.bool(!1),height:U.bool(!1),depth:U.bool(!1)},lerp:{size:U.mapping("absolute"),items:U.nullable(U.number()),width:U.nullable(U.number()),height:U.nullable(U.number()),depth:U.nullable(U.number())},subdivide:{items:U.nullable(U.positive(U.int(),!0)),width:U.nullable(U.positive(U.int(),!0)),height:U.nullable(U.positive(U.int(),!0)),depth:U.nullable(U.positive(U.int(),!0)),bevel:U.number(1),lerp:U.bool(!0)},resample:{indices:U.number(4),channels:U.number(4),sample:U.mapping(),size:U.mapping("absolute"),items:U.nullable(U.number()),width:U.nullable(U.number()),height:U.nullable(U.number()),depth:U.nullable(U.number())},readback:{type:U.type("float"),expr:U.nullable(U.func()),data:U.data(),channels:U.enum(4,[1,2,3,4]),items:U.nullable(U.int()),width:U.nullable(U.int()),height:U.nullable(U.int()),depth:U.nullable(U.int())},root:{speed:U.number(1),camera:U.select("[camera]")},inherit:{source:U.select(),traits:U.array(U.string())},rtt:{size:U.mapping("absolute"),width:U.nullable(U.number()),height:U.nullable(U.number()),history:U.int(1)},compose:{alpha:U.bool(!1)},present:{index:U.int(1),directed:U.bool(!0),length:U.number(0)},slide:{order:U.nullable(U.int(0)),steps:U.number(1),early:U.int(0),late:U.int(0),from:U.nullable(U.int(0)),to:U.nullable(U.int(1))},transition:{stagger:U.vec4(),enter:U.nullable(U.number(1)),exit:U.nullable(U.number(1)),delay:U.number(0),delayEnter:U.nullable(U.number(0)),delayExit:U.nullable(U.number(0)),duration:U.number(.3),durationEnter:U.nullable(U.number(0)),durationExit:U.nullable(U.number(0))},move:{from:U.vec4(),to:U.vec4()},seek:{seek:U.nullable(U.number(0))},track:{target:U.select(),script:U.object({}),ease:U.ease("cosine")},trigger:{trigger:U.nullable(U.int(1),!0)},step:{playback:U.ease("linear"),stops:U.nullable(U.array(U.number())),delay:U.number(0),duration:U.number(.3),pace:U.number(0),speed:U.number(1),rewind:U.number(2),skip:U.bool(!0),realtime:U.bool(!1)},play:{delay:U.number(0),pace:U.number(1),speed:U.number(1),from:U.number(0),to:U.number(1/0),realtime:U.bool(!1),loop:U.bool(!1)},now:{now:U.nullable(U.timestamp()),seek:U.nullable(U.number(0)),pace:U.number(1),speed:U.number(1)}},aU=function(i,t,e,n,r,s,o,a,l,c){let u,h,p;c==null&&(c=!0),e||(e=10),n||(n=1),r||(r=10),s||(s=1);const v=(t-i)/e;if(!c)return u=(()=>{let E,A;const R=[];for(h=0,A=e,E=0<=A;E?h<=A:h>=A;E?h++:h--)R.push(i+h*v);return R})(),o||u.shift(),a||u.pop(),l||(u=u.filter(E=>E!==0)),u;n||(n=1),r||(r=10);const _=n*Math.pow(r,Math.floor(Math.log(v/n)/Math.log(r))),b=r%2===0?[r/2,1,1/2]:r%3===0?[r/3,1,1/3]:[1],y=(()=>{const E=[];for(p of Array.from(b))E.push(_*p);return E})();let M=1/0,S=y.reduce(function(E,A){p=A/v;const R=Math.max(p,1/p);return R<M?(M=R,A):E},_);return S*=s,i=Math.ceil(i/S+ +!o)*S,t=(Math.floor(t/S)-+!a)*S,e=Math.ceil((t-i)/S),u=(()=>{let E,A;const R=[];for(h=0,A=e,E=0<=A;E?h<=A:h>=A;E?h++:h--)R.push(i+h*S);return R})(),l||(u=u.filter(E=>E!==0)),u},lU=function(i,t,e,n,r,s,o,a,l,c){throw new Error("Log ticks not yet implemented.")},G5t=0,q5t=1,cU=function(i,t,e,n,r,s,o,a,l,c,u){switch(i){case G5t:return aU(t,e,n,r,s,o,a,l,c,u);case q5t:return lU()}},W5t=Object.freeze(Object.defineProperty({__proto__:null,linear:aU,log:lU,make:cU},Symbol.toStringTag,{value:"Module"})),j5t={bind:{make(i){this.bind==null&&(this.bind={}),this.bound==null&&(this.bound=[]);for(const t of Array.from(i)){let{callback:e}=t;const{to:n,trait:r,optional:s,unique:o,multiple:a}=t;e==null&&(e=this.rebuild);const l=n.split(/\./g).pop(),c=this._get(n);let u=null;if(c!=null){let h=this,p=!1;for(;!p;){h=u=this._attach(c,r,e,this,h,s,a);const m=o&&(u==null||this.bound.indexOf(u)<0);p=a||s||!o||m}}if(u!=null)if(this.resize!=null&&this._listen(u,"source.resize",this.resize),e&&this._listen(u,"source.rebuild",e),a)for(const h of Array.from(u))this.bound.push(h);else this.bound.push(u);this.bind[l]=u}return null},unmake(){if(this.bind)return delete this.bind,delete this.bound}},span:{make(){return this.spanView=this._inherit("view"),this._listen("view","view.range",()=>this.trigger({type:"span.range"}))},unmake(){return delete this.spanView},get:function(){const i=new Vt(-1,1);return function(t,e){let n;const r=this._get(t+"span.range");return r??((n=this.spanView!=null?this.spanView.axis(e):void 0)!=null?n:i)}}()},scale:{divide(i){const t=this._get(i+"scale.divide"),e=this._get(i+"scale.factor");return Math.round(t*2.5/e)},generate(i,t,e,n){const r=this._get(i+"scale.mode"),s=this._get(i+"scale.divide"),o=this._get(i+"scale.unit"),a=this._get(i+"scale.base"),l=this._get(i+"scale.factor"),c=this._get(i+"scale.start"),u=this._get(i+"scale.end"),h=this._get(i+"scale.zero"),p=this._get(i+"scale.nice"),m=cU(r,e,n,s,o,a,l,c,u,h,p);return t.copy(m),m}},style:{uniforms(){return{styleColor:this.node.attributes["style.color"],styleOpacity:this.node.attributes["style.opacity"],styleZBias:this.node.attributes["style.zBias"],styleZIndex:this.node.attributes["style.zIndex"]}}},arrow:{uniforms(){const{start:i}=this.props,{end:t}=this.props,e=this._attributes.make(this._types.number(1.25/(i+t))),n=this._attributes.make(this._types.vec2(+i,+t)),r=this.node.attributes["arrow.size"];return{clipStyle:n,clipRange:r,clipSpace:e,arrowSpace:e,arrowSize:r}}},point:{uniforms(){return{pointSize:this.node.attributes["point.size"],pointDepth:this.node.attributes["point.depth"]}}},line:{uniforms(){return{lineWidth:this.node.attributes["line.width"],lineDepth:this.node.attributes["line.depth"],lineProximity:this.node.attributes["line.proximity"]}}},surface:{uniforms(){return{}}},shade:{pipeline(i){if(!this._inherit("fragment"))return i;i==null&&(i=this._shaders.shader());for(let t=0;t<=2;t++)i=kk(this._inherit("fragment"),e=>e.fragment(i,t));return i.pipe("fragment.map.rgba"),i},normal(i){return i.pipe(Do("xyz")),i},map(i){return i&&(i=this._shaders.shader().pipe("mesh.map.uvwo").pipe(i))}},position:{pipeline(i){if(!this._inherit("vertex"))return i;i==null&&(i=this._shaders.shader());for(let t=0;t<=3;t++)i=kk(this._inherit("vertex"),e=>e.vertex(i,t));return i},swizzle(i,t){if(i)return this._shaders.shader().pipe(Do(t)).pipe(i)},swizzle2(i,t,e){if(i)return this._shaders.shader().split().pipe(Do(t)).next().pipe(Do(e)).join().pipe(i)}},visible:{make(){const i={type:"visible.change"};let t=null;this.setVisible=function(r){return r!=null&&(t=r),e()};const e=()=>{let r;const s=this.isVisible;let o=(r=t??this._get("object.visible"))!=null?r:!0;if(n!=null&&o&&(o=n.isVisible),this.isVisible=o,s!==this.isVisible)return this.trigger(i)},n=this._inherit("visible");return n&&this._listen(n,"visible.change",e),this.is("object")&&this._listen(this.node,"change:object",e),e()},unmake(){return delete this.isVisible}},active:{make(){const i={type:"active.change"};let t=null;this.setActive=function(r){return r!=null&&(t=r),e()};const e=()=>{let r;const s=this.isActive;let o=(r=t??this._get("entity.active"))!=null?r:!0;if(n!=null&&o&&(o=n.isActive),this.isActive=o,s!==this.isActive)return this.trigger(i)},n=this._inherit("active");return n&&this._listen(n,"active.change",e),this.is("entity")&&this._listen(this.node,"change:entity",e),e()},unmake(){return delete this.isActive}},object:{make(i){let t,e;i==null&&(i=[]),this.objects=i,this.renders=this.objects.reduce((u,h)=>u.concat(h.renders),[]);const n=this._inherit("scene");let r=t=e=null;const s=Array.from(this.traits).includes("style");r=1,t=Hu;let o=!0,a=!0;s&&({opacity:r}=this.props,{blending:t}=this.props,{zOrder:e}=this.props,{zWrite:o}=this.props,{zTest:a}=this.props);const l=u=>{const{changed:h}=u;let p=null;if(h["style.opacity"]&&(p=r=this.props.opacity),h["style.blending"]&&(p=t=this.props.blending),h["style.zOrder"]&&(p=e=this.props.zOrder),h["style.zWrite"]&&(p=o=this.props.zWrite),h["style.zTest"]&&(p=a=this.props.zTest),p!=null)return c()},c=()=>{const u=e!=null?-e:this.node.order;return(this.isVisible!=null?this.isVisible:!0)&&r>0?s?(()=>{const p=[];for(const m of Array.from(this.objects))m.show(r<1,t,u),p.push(m.depth(o,a));return p})():(()=>{const p=[];for(const m of Array.from(this.objects))p.push(m.show(!0,t,u));return p})():(()=>{const p=[];for(const m of Array.from(this.objects))p.push(m.hide());return p})()};this._listen(this.node,"change:style",l),this._listen(this.node,"reindex",c),this._listen(this,"visible.change",c);for(const u of Array.from(this.objects))n.adopt(u);return c()},unmake(i){let t;if(i==null&&(i=!0),!this.objects)return;const e=this._inherit("scene");for(t of Array.from(this.objects))e.unadopt(t);if(i)return(()=>{const n=[];for(t of Array.from(this.objects))n.push(t.dispose());return n})()},mask(){let i,t;if(i=this._inherit("mask"))return t=i.mask(t)}},unit:{make(){let i,t,e,n,r,s,o,a,l,c,u,h,p=Math.PI;this.unitUniforms={renderScaleInv:a=this._attributes.make(this._types.number(1)),renderScale:o=this._attributes.make(this._types.number(1)),renderAspect:n=this._attributes.make(this._types.number(1)),renderWidth:l=this._attributes.make(this._types.number(0)),renderHeight:r=this._attributes.make(this._types.number(0)),viewWidth:u=this._attributes.make(this._types.number(0)),viewHeight:c=this._attributes.make(this._types.number(0)),pixelRatio:t=this._attributes.make(this._types.number(1)),pixelUnit:e=this._attributes.make(this._types.number(1)),worldUnit:h=this._attributes.make(this._types.number(1)),focusDepth:i=this._attributes.make(this._types.number(1)),renderOdd:s=this._attributes.make(this._types.vec2())};const m=new Y,v=new Y,_=()=>{let y,M;if((M=b!=null?b.getSize():void 0)==null)return;p=Math.PI;const{scale:S}=this.props,{fov:E}=this.props,A=this.props.focus!=null?this.props.focus:this.inherit("unit").props.focus,R=S===null;let O=1;if(y=b!=null?b.getCamera():void 0){const W=y.projectionMatrix;m.set(0,-.5,1).applyMatrix4(W),v.set(0,.5,1).applyMatrix4(W),m.sub(v),O=m.y}const L=M.renderHeight/M.viewHeight,P=E!=null?O*Math.tan(E*p/360):1,D=R?L:M.renderHeight/S*P,V=M.renderHeight*O/2,K=D/V;return u.value=M.viewWidth,c.value=M.viewHeight,l.value=M.renderWidth,r.value=M.renderHeight,n.value=M.aspect,o.value=V,a.value=1/V,t.value=L,e.value=D,h.value=K,i.value=A,s.value.set(M.renderWidth%2,M.renderHeight%2).multiplyScalar(.5)},b=this.is("root")?this:this._inherit("root");return this._listen(b,"root.update",_),_()},unmake(){return delete this.unitUniforms},get(){const i={};for(const t in this.unitUniforms){const e=this.unitUniforms[t];i[t]=e.value}return i},uniforms(){return this.unitUniforms}}},X5t=function(i,t){const e={};for(const n of Array.from(t)){let r;if(r=j5t[n]){e[n]={};for(const s in r){const o=r[s];e[n][s]=o.bind(i)}}}return e};function kk(i,t){return typeof i<"u"&&i!==null?t(i):void 0}const Y5t=Object.freeze(Object.defineProperty({__proto__:null,Classes:U5t,Helpers:X5t,Traits:$5t,Types:U},Symbol.toStringTag,{value:"Module"}));class uU{constructor(t,e){this.context=e,this.classes=t.Classes,this.helpers=t.Helpers}getTypes(){return Object.keys(this.classes)}make(t,e,n=null){e==null&&(e={});const r=this.classes[t];if(r==null)throw new Error(`Unknown primitive class \`${t}\``);const s=new r.model(t,r.defaults,e,n,r,this.context.attributes);return new r(s,this.context,this.helpers),s}}const dC=Y5t,K5t=Object.freeze(Object.defineProperty({__proto__:null,Factory:uU,Primitive:gr,Types:dC},Symbol.toStringTag,{value:"Module"}));class Jf{constructor(t,e){this.renderer=t,this.shaders=e,this.gl=this.renderer.getContext(),this.uniforms==null&&(this.uniforms={})}dispose(){this.uniforms=null}_adopt(t){for(const e in t){const n=t[e];this.uniforms[e]=n}}_set(t){for(const e in t){const n=t[e];this.uniforms[e]!=null&&(this.uniforms[e].value=n)}}}class Z5t extends qn{constructor(){super(),this.rotationAutoUpdate=!1,this.frustumCulled=!1,this.matrixAutoUpdate=!1}}let hU=class extends Jf{constructor(t,e,n){super(t,e,n),this.root=new Z5t,(n!=null?n.scene:void 0)!=null&&(this.scene=n.scene),this.scene==null&&(this.scene=new Hf),this.pending=[],this.async=0,this.scratch=new ba(1,1),this.camera=new Di}inject(t){return t!=null&&(this.scene=t),this.scene.add(this.root)}unject(){return this.scene!=null?this.scene.remove(this.root):void 0}add(t){return this.async?this.pending.push(t):this._add(t)}remove(t){if(this.pending=this.pending.filter(e=>e!==t),t.parent!=null)return this._remove(t)}_add(t){return this.root.add(t)}_remove(t){return this.root.remove(t)}dispose(){if(this.root.parent!=null)return this.unject()}warmup(t){return this.async=+t||0}render(){if(!this.pending.length)return;const{children:t}=this.root,e=[];for(let s=0,o=this.async,a=0<=o;a?s<o:s>o;a?s++:s--){const l=this.pending.shift();if(!l)break;this._add(l),e.push(e)}const n=t.map(function(s){return s.visible});t.map(s=>s.visible=!Array.from(e).includes(s));const r=this.renderer.getRenderTarget();return this.renderer.setRenderTarget(this.scratch),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(r),t.map((s,o)=>s.visible=n[o])}toJSON(){return this.root.toJSON()}};class dU{constructor(t,e,n){this.classes=t,this.renderer=e,this.shaders=n}getTypes(){return Object.keys(this.classes)}make(t,e){return new this.classes[t](this.renderer,this.shaders,e)}}class pU extends Jf{constructor(t,e,n){super(t,e),this.items==null&&(this.items=n.items||1),this.samples==null&&(this.samples=n.samples||1),this.channels==null&&(this.channels=n.channels||4),this.callback==null&&(this.callback=n.callback||function(){})}dispose(){return super.dispose()}update(){const t=this.fill();return this.write(t),t}setActive(t,e,n,r){}setCallback(t){this.callback=t}write(){}fill(){}generate(t){return vT(t,this.samples,this.channels,this.items)}}class VT{constructor(t,e,n,r,s){this.renderer=t,this.width=e,this.height=n,this.channels=r,this.n=this.width*this.height*this.channels;const o=this.renderer.getContext();this.gl=o;const a=(s!=null?s.minFilter:void 0)!=null?s!=null?s.minFilter:void 0:si,l=(s!=null?s.magFilter:void 0)!=null?s!=null?s.magFilter:void 0:si,c=(s!=null?s.type:void 0)!=null?s!=null?s.type:void 0:Hr;this.minFilter=zb(o,a),this.magFilter=zb(o,l),this.type=zb(o,c),this.ctor=xz(c),this.build(s)}build(t){const{gl:e}=this,n=this.renderer.state;this.texture=e.createTexture(),this.format=[null,e.LUMINANCE,e.LUMINANCE_ALPHA,e.RGB,e.RGBA][this.channels],this.format3=[null,Dy,Iy,void 0,Es][this.channels],n.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this.minFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this.magFilter),this.data=new this.ctor(this.n),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,this.format,this.width,this.height,0,this.format,this.type,this.data),this.textureObject=new mr(new Image,_v,es,es,t!=null?t.minFilter:void 0,t!=null?t.magFilter:void 0),this.textureProperties=this.renderer.properties.get(this.textureObject),this.textureProperties.__webglInit=!0,this.textureProperties.__webglTexture=this.texture,this.textureObject.format=this.format3,this.textureObject.type=Hr,this.textureObject.unpackAlignment=1,this.textureObject.flipY=!1,this.textureObject.generateMipmaps=!1,this.uniforms={dataResolution:{type:"v2",value:new Vt(1/this.width,1/this.height)},dataTexture:{type:"t",value:this.textureObject}}}write(t,e,n,r,s){const{gl:o}=this;return this.renderer.state.bindTexture(o.TEXTURE_2D,this.texture),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.texSubImage2D(o.TEXTURE_2D,0,e,n,r,s,this.format,this.type,t)}dispose(){return this.gl.deleteTexture(this.texture),this.textureProperties.__webglInit=!1,this.textureProperties.__webglTexture=null,this.textureProperties=null,this.textureObject=this.texture=null}}class Dx extends pU{constructor(t,e,n,r){r==null&&(r=!0);const s=n.width||1,o=n.height||1,a=n.depth||1,l=s*o*a;n.samples||(n.samples=l),super(t,e,n),this.width=s,this.height=o,this.depth=a,this.samples==null&&(this.samples=l),r&&this.build(n)}shader(t,e){e==null&&(e=4),this.items>1||this.depth>1?(e!==4&&t.pipe(Ld(e,4)),t.pipe("map.xyzw.texture",this.uniforms)):e!==2&&t.pipe(rh(e,2));const n=this.wrap?".wrap":"";return t.pipe(`map.2d.data${n}`,this.uniforms),t.pipe("sample.2d",this.uniforms),this.channels<4&&t.pipe(Do(["0000","x000","xw00","xyz0"][this.channels])),t}build(t){this.data=new Float32Array(this.samples*this.channels*this.items),this.texture=new VT(this.renderer,this.items*this.width,this.height*this.depth,this.channels,t),this.filled=0,this.used=0,this._adopt(this.texture.uniforms),this._adopt({dataPointer:{type:"v2",value:new Vt},textureItems:{type:"f",value:this.items},textureHeight:{type:"f",value:this.height}}),this.dataPointer=this.uniforms.dataPointer.value,this.streamer=this.generate(this.data)}dispose(){return this.data=null,this.texture.dispose(),super.dispose()}getFilled(){return this.filled}setCallback(t){return this.callback=t,this.filled=0}copy(t){const e=Math.min(t.length,this.samples*this.channels*this.items),n=this.data;for(let r=0,s=e,o=0<=s;o?r<s:r>s;o?r++:r--)n[r]=t[r];this.write(Math.ceil(e/this.channels/this.items))}write(t){t==null&&(t=this.samples);let e=t/this.width;t*=this.items;const n=e<1?t:this.items*this.width;e=Math.ceil(e),this.texture.write(this.data,0,0,n,e),this.dataPointer.set(.5,.5),this.filled=1,this.used=t}through(t,e){let n,r;const{consume:s,done:o}=r=this.streamer,{emit:a}=n=e.streamer;let l=0,c=()=>s((u,h,p,m)=>t(a,u,h,p,m,l));return c=kv(c,this.items),()=>{r.reset(),n.reset();const u=this.used;for(l=0;!o()&&l<u;)c(),l++;return r.count()}}}class J5t extends Dx{constructor(t,e,n){const r=n.width||1,s=n.history||1;n.width=r,n.height=s,n.depth=1,super(t,e,n,!1),this.width=r,this.history=s,this.samples=r,this.wrap=s>1,this.build(n)}build(t){return super.build(),this.index=0,this.pad=0,this.streamer=this.generate(this.data)}setActive(t){return this.pad=Math.max(0,this.width-t)}fill(){const{callback:t}=this;typeof t.reset=="function"&&t.reset();const{emit:e,count:n,done:r,reset:s}=this.streamer;s();const o=this.samples-this.pad;let a=0;for(;!r()&&a<o&&t(e,a++)!==!1;);return Math.floor(n()/this.items)}write(t){return t==null&&(t=this.samples),t*=this.items,this.texture.write(this.data,0,this.index,t,1),this.dataPointer.set(.5,this.index+.5),this.index=(this.index+this.history-1)%this.history,this.filled=Math.min(this.history,this.filled+1)}through(t,e){let n,r;const{consume:s,done:o}=r=this.streamer,{emit:a}=n=e.streamer;let l=0,c=()=>s((u,h,p,m)=>t(a,u,h,p,m,l));return c=kv(c,this.items),()=>{r.reset(),n.reset();const u=this.samples-this.pad;for(l=0;!o()&&l<u;)c(),l++;return r.count()}}}class Q5t extends fn{constructor(){super(),new fn(this),this.uniforms==null&&(this.uniforms={}),this.groups==null&&(this.groups=[])}_reduce(t,e){let n=!1;for(let r=0;r<t.length;r++){const s=t[r],o=e[r];n&&(t[r]=o),s>1&&(n=!0)}return t.reduce((r,s)=>r*s)}_emitter(t){const e=t=="index"?this.getIndex():this.getAttribute(t),n=e.itemSize,{array:r}=e;let s=0;return[null,function(u){r[s++]=u},function(u,h){r[s++]=u,r[s++]=h},function(u,h,p){r[s++]=u,r[s++]=h,r[s++]=p},function(u,h,p,m){r[s++]=u,r[s++]=h,r[s++]=p,r[s++]=m}][n]}_finalize(){}_offsets(t){this.groups=t}}class Qf extends Q5t{_clipUniforms(){return this.geometryClip=new Vn(1e10,1e10,1e10,1e10),this.geometryResolution=new Vn,this.mapSize=new Vn,this.uniforms==null&&(this.uniforms={}),this.uniforms.geometryClip={type:"v4",value:this.geometryClip},this.uniforms.geometryResolution={type:"v4",value:this.geometryResolution},this.uniforms.mapSize={type:"v4",value:this.mapSize}}_clipGeometry(t,e,n,r){const s=a=>Math.max(0,a-1),o=a=>1/Math.max(1,a-1);return this.geometryClip.set(s(t),s(e),s(n),s(r)),this.geometryResolution.set(o(t),o(e),o(n),o(r))}_clipMap(t,e,n,r){return this.mapSize.set(t,e,n,r)}_clipOffsets(t,e,n,r,s,o,a,l,c){const u=[r,n,e,s],h=[l,a,o,c],p=this._reduce(u,h);return this._offsets([{start:0,count:p*t,materialIndex:0}])}}class t$t extends Qf{constructor(t){let e,n,r,s,o,a,l,c,u,h,p;super(t),this._clipUniforms(),this.sides=c=+t.sides||12,this.samples=l=+t.samples||2,this.strips=u=+t.strips||1,this.ribbons=a=+t.ribbons||1,this.layers=o=+t.layers||1,this.flip=n=t.flip!=null?t.flip:!1,this.closed=r=t.closed!=null?t.closed:!1,this.anchor=e=t.anchor!=null?t.anchor:n||r?0:l-1;const m=u*a*o,v=(c+2)*m,_=c*2*m;this.setIndex(new tn(new Uint32Array(_*3),1)),this.setAttribute("position4",new tn(new Float32Array(v*4),4)),this.setAttribute("arrow",new tn(new Float32Array(v*3),3)),this.setAttribute("attach",new tn(new Float32Array(v*2),2));const b=this._emitter("index"),y=this._emitter("position4"),M=this._emitter("arrow"),S=this._emitter("attach"),E=[];for(s=0,p=c,h=0<=p;h?s<p:s>p;h?s++:s--){const P=s/c*2*Math.PI;E.push([Math.cos(P),Math.sin(P),1])}let A=0;for(let P=0,D=m,V=0<=D;V?P<D:P>D;V?P++:P--){let K,W;const Z=A++,z=Z+c+1;for(s=0,W=c,K=0<=W;K?s<W:s>W;K?s++:s--){const ut=A+s%c,nt=A+(s+1)%c;b(Z),b(ut),b(nt),b(nt),b(ut),b(z)}A+=c+1}const R=n?1:r?l-1:-1,O=n&&!r?l-1:0,L=e;for(let P=0,D=o,V=0<=D;V?P<D:P>D;V?P++:P--)for(let K=0,W=a,Z=0<=W;Z?K<W:K>W;Z?K++:K--)for(let z=0,ut=u,nt=0<=ut;nt?z<ut:z>ut;nt?z++:z--){let Q,St;for(y(L,z,K,P),M(0,0,0),S(R,O),s=0,St=c,Q=0<=St;Q?s<St:s>St;Q?s++:s--){y(L,z,K,P);const Pt=E[s];M(Pt[0],Pt[1],Pt[2]),S(R,O)}y(L,z,K,P),M(0,0,1),S(R,O)}this._finalize(),this.clip()}clip(t,e,n,r){let s;if(t==null&&({samples:t}=this),e==null&&({strips:e}=this),n==null&&({ribbons:n}=this),r==null&&({layers:r}=this),this._clipGeometry(t,e,n,r),t>0){const o=[r,n,e],a=[this.layers,this.ribbons,this.strips];s=this.sides*this._reduce(o,a)}else s=0;return this._offsets([{start:0,count:s*6,materialIndex:0}])}}class ru extends Jf{constructor(t,e,n){super(t,e,n),this.zUnits=n.zUnits!=null?n.zUnits:0}raw(){for(const t of Array.from(this.renders))this._raw(t);return null}depth(t,e){for(const n of Array.from(this.renders))this._depth(n,t,e);return null}polygonOffset(t,e){for(const n of Array.from(this.renders))this._polygonOffset(n,t,e);return null}show(t,e,n){return Array.from(this.renders).map(r=>this._show(r,t,e,n))}hide(){for(const t of Array.from(this.renders))this._hide(t);return null}_injectPreamble(t,e){const n=t+`
`+e;return e.match(/#extension/)?this._hoist(n):n}_hoist(t){const e=t.split(`
`),n=[];for(const r of Array.from(e))r.match(/^\s*#extension/)?n.unshift(r):n.push(r);return n.join(`
`)}_material(t){const e=this.renderer.capabilities.precision,n=`    precision ${e} float;
    precision ${e} int;
uniform mat4 modelMatrix;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 cameraPosition;`,r=`    precision ${e} float;
    precision ${e} int;
uniform mat4 viewMatrix;
uniform vec3 cameraPosition;`,s={};Object.assign(s,t),delete s.attributes,delete s.varyings,delete s.inspect,delete s.vertexGraph,delete s.fragmentGraph;const o=new BE(s);return["vertexGraph","fragmentGraph","inspect"].forEach(a=>o[a]=t[a]),o.vertexShader=this._injectPreamble(n,o.vertexShader),o.fragmentShader=this._injectPreamble(r,o.fragmentShader),o}_raw(t){t.rotationAutoUpdate=!1,t.frustumCulled=!1,t.matrixAutoUpdate=!1,t.material.defaultAttributeValues=void 0}_depth(t,e,n){const r=t.material;return r.depthWrite=e,r.depthTest=n}_polygonOffset(t,e,n){n-=this.zUnits;const r=n!==0,s=t.material;if(s.polygonOffset=r,r)return s.polygonOffsetFactor=e,s.polygonOffsetUnits=n}_show(t,e,n,r){e=!0;const s=t.material;return t.renderOrder=-r,t.visible=!0,s.transparent=e,s.blending=n,null}_hide(t){return t.visible=!1}_vertexColor(t,e){if(!t&&!e)return;const n=this.shaders.shader();return t&&(n.require(t),n.pipe("mesh.vertex.color",this.uniforms)),e&&(n.require(e),n.pipe("mesh.vertex.mask",this.uniforms)),n}_vertexPosition(t,e,n,r,s){let o;const a=this.shaders.shader();return(n||e&&e!==!0)&&(o={},(r>0||s)&&(o.POSITION_MAP=""),r>0&&(o[["POSITION_U","POSITION_UV","POSITION_UVW","POSITION_UVWO"][r-1]]=""),s&&(o.POSITION_STPQ="")),a.require(t),a.pipe("mesh.vertex.position",this.uniforms,o)}_fragmentColor(t,e,n,r,s,o,a,l,c){const u=this.shaders.shader();let h=!1,p=!1;const m={};return o>0&&(m[["POSITION_U","POSITION_UV","POSITION_UVW","POSITION_UVWO"][o-1]]=""),a&&(m.POSITION_STPQ=""),t&&(u.pipe("style.color",this.uniforms),h=!0,(n||s||e)&&((!c||n)&&u.pipe("mesh.gamma.in"),p=!0)),n&&(u.isolate(),u.pipe("mesh.fragment.color",this.uniforms),(!c||h)&&u.pipe("mesh.gamma.in"),u.end(),h&&u.pipe(ha("vec4","*")),c&&h&&u.pipe("mesh.gamma.out"),h=!0,p=!0),s&&(!h&&l&&u.pipe(oC("vec4","vec4(1.0)")),u.isolate(),u.require(s),u.pipe("mesh.fragment.map",this.uniforms,m),c||u.pipe("mesh.gamma.in"),u.end(),l?u.pipe(l):h&&u.pipe(ha("vec4","*")),h=!0,p=!0),e&&(h||u.pipe(oC("vec4","vec4(1.0)")),e===!0?u.pipe("mesh.fragment.shaded",this.uniforms):(u.require(e),u.pipe("mesh.fragment.material",this.uniforms,m)),p=!0),p&&!c&&u.pipe("mesh.gamma.out"),r&&(u.pipe("mesh.fragment.mask",this.uniforms),h&&u.pipe(ha("vec4","*"))),u}}class e$t extends ru{constructor(t,e,n){let r;super(t,e,n);let{uniforms:s}=n;const{material:o,position:a,color:l,mask:c,map:u,combine:h,stpq:p,linear:m}=n;s==null&&(s={});const v=s.styleColor!=null;this.geometry=new t$t({sides:n.sides,samples:n.samples,strips:n.strips,ribbons:n.ribbons,layers:n.layers,anchor:n.anchor,flip:n.flip,closed:n.closed}),this._adopt(s),this._adopt(this.geometry.uniforms);const _={};closed&&(_.ARROW_CLOSED="");const b=e.material(),y=b.vertex;y.pipe(this._vertexColor(l,c)),y.require(this._vertexPosition(a,o,u,1,p)),y.pipe("arrow.position",this.uniforms,_),y.pipe("project.position",this.uniforms),b.fragment=r=this._fragmentColor(v,o,l,c,u,1,p,h,m),r.pipe("fragment.color",this.uniforms);const M=b.link({side:pr});this.material=this._material(M);const S=new fi(this.geometry,this.material);S.frustumCulled=!1,S.matrixAutoUpdate=!1,S.userData=M,this._raw(S),this.renders=[S]}dispose(){return this.geometry.dispose(),this.material.dispose(),this.renders=this.geometry=this.material=null,super.dispose()}}class n$t extends VT{constructor(t,e,n,r,s){super(t,e,n,r,s),this.data=new this.ctor(this.n)}resize(t,e){const n=this.data,r=this.width,s=this.height;this.width=t,this.height=e,this.n=t*e*this.channels,this.data=new this.ctor(this.n);const{gl:o}=this;return this.renderer.state.bindTexture(o.TEXTURE_2D,this.texture),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.texImage2D(o.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,this.data),this.uniforms.dataResolution.value.set(1/t,1/e),this.write(n,0,0,r,s)}write(t,e,n,r,s){let o;const{width:a}=this,l=this.data,{channels:c}=this;let u=0;if(a===r&&e===0){o=n*r*c;const h=r*s*c;for(;u<h;)l[o++]=t[u++]}else{const h=a*c,p=r*c,m=e*c;let v=n;const _=n+s;for(;v<_;){let b=0;for(o=m+v*h;b++<p;)l[o++]=t[u++];v++}}return super.write(t,e,n,r,s)}dispose(){return this.data=null,super.dispose()}}class fU extends Jf{constructor(t,e,n,r){r==null&&(r=!0),super(t,e),this.width==null&&(this.width=n.width||512),this.height==null&&(this.height=n.height||512),this.channels==null&&(this.channels=n.channels||4),this.backed==null&&(this.backed=n.backed||!1),this.samples=this.width*this.height,r&&this.build(n)}shader(t){return t.pipe("map.2d.data",this.uniforms),t.pipe("sample.2d",this.uniforms),this.channels<4&&t.pipe(Do(["0000","x000","xw00","xyz0"][this.channels])),t}build(t){let e;return this.klass=e=this.backed?n$t:VT,this.texture=new e(this.renderer,this.width,this.height,this.channels,t),this.uniforms={dataPointer:{type:"v2",value:new Vt(0,0)}},this._adopt(this.texture.uniforms),this.reset()}reset(){return this.rows=[],this.bottom=0}resize(t,e){if(!this.backed)throw new Error("Cannot resize unbacked texture atlas");return t>2048&&e>2048?console.warn(`Giant text atlas ${t}x${e}.`):console.info(`Resizing text atlas ${t}x${e}.`),this.texture.resize(t,e),this.width=t,this.height=e,this.samples=t*e}collapse(t){let e;const{rows:n}=this;if(n.splice(n.indexOf(t),1),this.bottom=(e=i$t(n[n.length-1],r=>r.bottom))!=null?e:0,this.last===t)return this.last=null}allocate(t,e,n,r){const s=this.width,o=this.height,a=n*2;if(e>s)return this.resize(s*2,o*2),this.last=null,this.allocate(t,e,n,r);let l=this.last;if(l!=null&&l.height>=n&&l.height<a&&l.width+e<=s){l.append(t,e,n,r);return}let c=0,u=-1,h=0;for(let p=0;p<this.rows.length;p++)if(l=this.rows[p],l.top-c>=n&&u<0&&(u=p,h=c),{bottom:c}=l,l.height>=n&&l.height<a&&l.width+e<=s){l.append(t,e,n,r),this.last=l;return}if(u>=0)l=new Lk(h,n),this.rows.splice(u,0,l);else{if(h=c,c+=n,c>=o)return this.resize(s*2,o*2),this.last=null,this.allocate(t,e,n,r);l=new Lk(h,n),this.rows.push(l),this.bottom=c}l.append(t,e,n,r),this.last=l}read(){return this.texture.textureObject}write(t,e,n,r,s){return this.texture.write(t,e,n,r,s)}dispose(){return this.texture.dispose(),this.data=null,super.dispose()}}class Lk{constructor(t,e){this.top=t,this.bottom=t+e,this.width=0,this.height=e,this.alive=0,this.keys=[]}append(t,e,n,r){const s=this.width,o=this.top;return this.alive++,this.width+=e,this.keys.push(t),r(this,s,o)}}function i$t(i,t){return typeof i<"u"&&i!==null?t(i):void 0}class r$t extends ru{constructor(t,e,n){super(t,e,n),this.geometry=new Vf(1,1),this.material=new iu({map:n.map}),this.material.side=pr;const r=new fi(this.geometry,this.material);r.position.x+=n.x||0,r.position.y+=n.y||0,r.frustumCulled=!1,r.scale.set(2,2,2),r.__debug=!0,this.objects=[r]}dispose(){return this.geometry.dispose(),this.material.dispose(),this.objects=this.geometry=this.material=null,super.dispose()}}class s$t extends Qf{constructor(t){let e,n,r,s,o;super(t),this._clipUniforms(),this.items=r=+t.items||2,this.width=o=+t.width||1,this.height=n=+t.height||1,this.depth=e=+t.depth||1,this.sides=s=Math.max(0,r-2);const a=o*n*e,l=r*a,c=s*a;this.setIndex(new tn(new Uint32Array(c*3),1)),this.setAttribute("position4",new tn(new Float32Array(l*4),4));const u=this._emitter("index"),h=this._emitter("position4");let p=0;for(let m=0,v=a,_=0<=v;_?m<v:m>v;_?m++:m--){for(let b=0,y=s,M=0<=y;M?b<y:b>y;M?b++:b--)u(p),u(p+b+1),u(p+b+2);p+=r}for(let m=0,v=e,_=0<=v;_?m<v:m>v;_?m++:m--)for(let b=0,y=n,M=0<=y;M?b<y:b>y;M?b++:b--)for(let S=0,E=o,A=0<=E;A?S<E:S>E;A?S++:S--)for(let R=0,O=r,L=0<=O;L?R<O:R>O;L?R++:R--)h(S,b,m,R);this._finalize(),this.clip()}clip(t,e,n,r){t==null&&({width:t}=this),e==null&&({height:e}=this),n==null&&({depth:n}=this),r==null&&({items:r}=this);const s=Math.max(0,r-2);return this._clipGeometry(t,e,n,r),this._clipOffsets(3,t,e,n,s,this.width,this.height,this.depth,this.sides)}}class o$t extends ru{constructor(t,e,n){let r;super(t,e,n);let{uniforms:s,material:o}=n;const{position:a,color:l,mask:c,map:u,combine:h,stpq:p,linear:m}=n;s==null&&(s={}),o==null&&(o=!0);const v=s.styleColor!=null;this.geometry=new s$t({items:n.items,width:n.width,height:n.height,depth:n.depth}),this._adopt(s),this._adopt(this.geometry.uniforms);const _=e.material(),b=_.vertex;b.pipe(this._vertexColor(l,c)),b.require(this._vertexPosition(a,o,u,2,p)),o||b.pipe("face.position",this.uniforms),o&&b.pipe("face.position.normal",this.uniforms),b.pipe("project.position",this.uniforms),_.fragment=r=this._fragmentColor(v,o,l,c,u,2,p,h,m),r.pipe("fragment.color",this.uniforms);const y=_.link({side:pr});this.material=this._material(y);const M=new fi(this.geometry,this.material);M.userData=y,this._raw(M),this.renders=[M]}dispose(){return this.geometry.dispose(),this.material.dispose(),this.renders=this.geometry=this.material=null,super.dispose()}}class a$t extends Qf{constructor(t){let e,n,r,s,o,a,l,c,u,h,p,m,v,_,b;super(t),this._clipUniforms(),this.closed=e=t.closed||!1,this.samples=u=(+t.samples||2)+(e?1:0),this.strips=p=+t.strips||1,this.ribbons=c=+t.ribbons||1,this.layers=l=+t.layers||1,this.detail=n=+t.detail||1;const y=u-1;this.joints=o=n-1,this.vertices=m=(y-(e?0:1))*o+u,this.segments=h=(y-(e?0:1))*o+y;const M=m*p*c*l*2,E=h*p*c*l*2;this.setIndex(new tn(new Uint32Array(E*3),1)),this.setAttribute("position4",new tn(new Float32Array(M*4),4)),this.setAttribute("line",new tn(new Float32Array(M*1),1)),n>1&&this.setAttribute("joint",new tn(new Float32Array(M),1));const A=this._emitter("index"),R=this._emitter("position4"),O=this._emitter("line");n>1&&(s=this._emitter("joint"));let L=0;for(let D=0,V=c*l,K=0<=V;K?D<V:D>V;K?D++:D--)for(let W=0,Z=p,z=0<=Z;z?W<Z:W>Z;z?W++:W--){for(let ut=0,nt=h,Q=0<=nt;Q?ut<nt:ut>nt;Q?ut++:ut--)A(L),A(L+1),A(L+2),A(L+2),A(L+1),A(L+3),L+=2;L+=2}const P=e?()=>0:function(D){return D===0?-1:D===u-1?1:0};if(n>1){let D,V;for(a=0,V=l,D=0<=V;D?a<V:a>V;D?a++:a--){let K,W;for(b=0,W=c,K=0<=W;K?b<W:b>W;K?b++:b--){let Z,z;for(_=0,z=p,Z=0<=z;Z?_<z:_>z;Z?_++:_--){let ut,nt,Q;for(Q=0,v=Q,nt=u,ut=0<=nt;ut?Q<nt:Q>nt;ut?Q++:Q--,v=Q)if(r=P(v),r!==0)R(v,_,b,a),R(v,_,b,a),O(1),O(-1),s(.5),s(.5);else for(let St=0,Pt=n,dt=0<=Pt;dt?St<Pt:St>Pt;dt?St++:St--)R(v,_,b,a),R(v,_,b,a),O(1),O(-1),s(St/o),s(St/o)}}}}else{let D,V;for(a=0,V=l,D=0<=V;D?a<V:a>V;D?a++:a--){let K,W;for(b=0,W=c,K=0<=W;K?b<W:b>W;K?b++:b--){let Z,z;for(_=0,z=p,Z=0<=z;Z?_<z:_>z;Z?_++:_--){let ut,nt,Q;for(Q=0,v=Q,nt=u,ut=0<=nt;ut?Q<nt:Q>nt;ut?Q++:Q--,v=Q)R(v,_,b,a),R(v,_,b,a),O(1),O(-1)}}}}this._finalize(),this.clip()}clip(t,e,n,r){t==null&&(t=this.samples-this.closed),e==null&&({strips:e}=this),n==null&&({ribbons:n}=this),r==null&&({layers:r}=this);const o=t+(t-(this.closed?0:2))*this.joints-(this.closed?0:1);return t+=this.closed,this._clipGeometry(t,e,n,r),this._clipOffsets(6,o,e,n,r,this.segments,this.strips,this.ribbons,this.layers)}}class l$t extends ru{constructor(t,e,n){let r;super(t,e,n);let{uniforms:s,stroke:o,join:a}=n;const{material:l,position:c,color:u,mask:h,map:p,combine:m,stpq:v,linear:_,clip:b,proximity:y,closed:M}=n;s==null&&(s={}),o=[null,"dotted","dashed"][o];const S=s.styleColor!=null;a=(r=["miter","round","bevel"][a])!=null?r:"miter";const E={miter:1,round:4,bevel:2}[a];this.geometry=new a$t({samples:n.samples,strips:n.strips,ribbons:n.ribbons,layers:n.layers,anchor:n.anchor,closed:n.closed,detail:E}),this._adopt(s),this._adopt(this.geometry.uniforms);const A=e.material(),R={};o&&(R.LINE_STROKE=""),b&&(R.LINE_CLIP=""),y!=null&&(R.LINE_PROXIMITY=""),R["LINE_JOIN_"+a.toUpperCase()]="",E>1&&(R.LINE_JOIN_DETAIL=E),M&&(R.LINE_CLOSED="");const O=A.vertex;O.pipe(this._vertexColor(u,h)),O.require(this._vertexPosition(c,l,p,2,v)),O.pipe("line.position",this.uniforms,R),O.pipe("project.position",this.uniforms);const L=A.fragment;o&&L.pipe(`fragment.clip.${o}`,this.uniforms),b&&L.pipe("fragment.clip.ends",this.uniforms),y!=null&&L.pipe("fragment.clip.proximity",this.uniforms),L.pipe(this._fragmentColor(S,l,u,h,p,2,v,m,_)),L.pipe("fragment.color",this.uniforms);const P=A.link({side:pr});this.material=this._material(P);const D=new fi(this.geometry,this.material);D.userData=P,this._raw(D),this.renders=[D]}dispose(){return this.geometry.dispose(),this.material.dispose(),this.renders=this.geometry=this.material=null,super.dispose()}}class c$t extends Dx{constructor(t,e,n){const r=n.width||1,s=n.height||1,o=n.history||1;n.depth=o,super(t,e,n,!1),this.width=r,this.height=s,this.history=o,this.samples=r*s,this.wrap=o>1,this.build(n)}build(t){return super.build(),this.index=0,this.pad={x:0,y:0},this.streamer=this.generate(this.data)}getFilled(){return this.filled}setActive(t,e){let n;return[this.pad.x,this.pad.y]=Array.from(n=[Math.max(0,this.width-t),Math.max(0,this.height-e)]),n}fill(){let t,e,n;const{callback:r}=this;typeof r.reset=="function"&&r.reset();const{emit:s,skip:o,count:a,done:l,reset:c}=this.streamer;c();const u=this.width,h=this.pad.x,p=this.samples-this.pad.y*u;let m=t=e=0;if(h)for(;!l()&&e<p&&(e++,n=r(s,m,t),++m===u-h&&(o(h),e+=h,m=0,t++),n!==!1););else for(;!l()&&e<p&&(e++,n=r(s,m,t),++m===u&&(m=0,t++),n!==!1););return Math.floor(a()/this.items)}write(t){t==null&&(t=this.samples),t*=this.items;const e=this.width*this.items,n=Math.ceil(t/e);return this.texture.write(this.data,0,this.index*this.height,e,n),this.dataPointer.set(.5,this.index*this.height+.5),this.index=(this.index+this.history-1)%this.history,this.filled=Math.min(this.history,this.filled+1)}through(t,e){let n,r,s;const{consume:o,skip:a,done:l}=s=this.streamer,{emit:c}=n=e.streamer;let u=r=0,h=()=>o((p,m,v,_)=>t(c,p,m,v,_,u,r));return h=kv(h,this.items),()=>{let p;s.reset(),n.reset();const m=this.width,v=this.pad.x,_=this.samples-this.pad.y*m;if(u=r=p=0,v)for(;!l()&&p<_;)p++,h(),++u===m-v&&(a(v),u=0,r++);else for(;!l()&&p<_;)p++,h(),++u===m&&(u=0,r++);return s.count()}}}class u$t{constructor(t,e,n,r,s){this.gl=t,s==null&&(s={}),s.minFilter==null&&(s.minFilter=si),s.magFilter==null&&(s.magFilter=si),s.format==null&&(s.format=Es),s.type==null&&(s.type=lo),this.options=s,this.width=e||1,this.height=n||1,this.frames=r||1,this.buffers=this.frames+1,this.build()}build(){let t;const e=()=>new ba(this.width,this.height,this.options);this.targets=(()=>{let r,s;const o=[];for(t=0,s=this.buffers,r=0<=s;r?t<s:t>s;r?t++:t--)o.push(e());return o})();const n=[];this.targets.forEach(r=>n.push(r.texture)),this.reads=n,this.write=this.targets[this.buffers-1],this.uniforms={dataResolution:{type:"v2",value:new Vt(1/this.width,1/this.height)},dataTexture:{type:"t",value:this.reads[0]},dataTextures:{type:"tv",value:this.reads}}}cycle(){this.targets.unshift(this.targets.pop()),this.write=this.targets[this.buffers-1],this.reads.unshift(this.reads.pop()),this.uniforms.dataTexture.value=this.reads[0]}warmup(t){return(()=>{const e=[];for(let n=0,r=this.buffers,s=0<=r;s?n<r:n>r;s?n++:n--)t(this.write),e.push(this.cycle());return e})()}dispose(){for(const t of Array.from(this.targets))t.dispose();return this.targets=this.reads=this.write=null}}class mU extends Jf{constructor(t,e,n){super(t,e),this.scene=n.scene!=null?n.scene:new Hf,this.camera=n.camera,this.build(n)}shaderRelative(t){return t==null&&(t=this.shaders.shader()),t.pipe("sample.2d",this.uniforms)}shaderAbsolute(t,e,n){if(e==null&&(e=1),n==null&&(n=4),t==null&&(t=this.shaders.shader()),e<=1)return n>2&&t.pipe(rh(n,2)),t.pipe("map.2d.data",this.uniforms),t.pipe("sample.2d",this.uniforms);{const r=Az(Math.min(e,this.target.frames));return n<4&&t.pipe(Ld(n,4)),t.pipe("map.xyzw.2dv"),t.split(),t.pipe("map.2d.data",this.uniforms),t.pass(),t.pipe(r,this.uniforms)}}build(t){return this.camera||(this.camera=new Di,this.camera.position.set(0,0,3),this.camera.lookAt(new Y)),typeof this.scene.inject=="function"&&this.scene.inject(),this.target=new u$t(this.gl,t.width,t.height,t.frames,t),this.target.warmup(e=>this.renderer.setRenderTarget(e)),this.renderer.setRenderTarget(null),this._adopt(this.target.uniforms),this._adopt({dataPointer:{type:"v2",value:new Vt(.5,.5)}}),this.filled=0}adopt(t){return Array.from(t.renders).map(e=>this.scene.add(e))}unadopt(t){return Array.from(t.renders).map(e=>this.scene.remove(e))}render(t){t==null&&({camera:t}=this);const e=this.renderer.getRenderTarget();if(this.renderer.setRenderTarget(this.target.write),this.renderer.render(this.scene.scene!=null?this.scene.scene:this.scene,t),this.renderer.setRenderTarget(e),this.target.cycle(),this.filled<this.target.frames)return this.filled++}read(t){return t==null&&(t=0),this.target.reads[Math.abs(t)]}getFrames(){return this.target.frames}getFilled(){return this.filled}dispose(){return typeof this.scene.unject=="function"&&this.scene.unject(),this.scene=this.camera=null,this.target.dispose(),super.dispose()}}class pC extends mU{constructor(t,e,n){let r,s;const o=n.items||1,a=n.channels||4,l=n.width||1,c=n.height||1,u=n.depth||1;n.format=Es,n.width=s=o*l,n.height=r=c*u,n.frames=1,delete n.items,delete n.depth,delete n.channels,super(t,e,n),this.items==null&&(this.items=o),this.channels==null&&(this.channels=a),this.width==null&&(this.width=l),this._width=s,this.height==null&&(this.height=c),this._height=r,this.depth==null&&(this.depth=u),this._adopt({textureItems:{type:"f",value:this.items},textureHeight:{type:"f",value:this.height}})}shaderAbsolute(t){return t==null&&(t=this.shaders.shader()),t.pipe("map.xyzw.texture",this.uniforms),super.shaderAbsolute(t,1,2)}}class gU extends Qf{constructor(t,e){e==null&&(e=!0),super(),e&&this.construct(t)}construct(t){let e,n,r,s,o,a,l,c;this._clipUniforms(),this.closedX=e=t.closedX||!1,this.closedY=n=t.closedY||!1,this.width=c=(+t.width||2)+(e?1:0),this.height=r=(+t.height||2)+(n?1:0),this.surfaces=l=+t.surfaces||1,this.layers=s=+t.layers||1,this.segmentsX=o=Math.max(0,c-1),this.segmentsY=a=Math.max(0,r-1);const u=c*r*l*s,p=o*a*l*s*2;this.setIndex(new tn(new Uint32Array(p*3),1)),this.setAttribute("position4",new tn(new Float32Array(u*4),4)),this.setAttribute("surface",new tn(new Float32Array(u*2),2));const m=this._emitter("index"),v=this._emitter("position4");let _=0;for(let b=0,y=l*s,M=0<=y;M?b<y:b>y;M?b++:b--){for(let S=0,E=a,A=0<=E;A?S<E:S>E;A?S++:S--){for(let R=0,O=o,L=0<=O;L?R<O:R>O;L?R++:R--)m(_),m(_+1),m(_+c),m(_+c),m(_+1),m(_+c+1),_++;_++}_+=c}for(let b=0,y=s,M=0<=y;M?b<y:b>y;M?b++:b--)for(let S=0,E=l,A=0<=E;A?S<E:S>E;A?S++:S--)for(let R=0,O=R,L=r,P=0<=L;P?R<L:R>L;P?R++:R--,O=R)for(let D=0,V=D,K=c,W=0<=K;W?D<K:D>K;W?D++:D--,V=D)v(V,O,S,b);this._finalize(),this.clip()}clip(t,e,n,r){t==null&&(t=this.width-this.closedX),e==null&&(e=this.height-this.closedY),n==null&&({surfaces:n}=this),r==null&&({layers:r}=this),t+=this.closedX,e+=this.closedY;const s=Math.max(0,t-1),o=Math.max(0,e-1);return this._clipGeometry(t,e,n,r),this._clipOffsets(6,s,o,n,r,this.segmentsX,this.segmentsY,this.surfaces,this.layers)}map(t,e,n,r){return t==null&&({width:t}=this),e==null&&({height:e}=this),n==null&&({surfaces:n}=this),r==null&&({layers:r}=this),this._clipMap(t,e,n,r)}}class h$t extends gU{constructor(t){t.width=Math.max(2,+t.width!=null?+t.width:2),t.height=Math.max(2,+t.height!=null?+t.height:2),super(t,!1),this.uniforms==null&&(this.uniforms={}),this.uniforms.geometryScale={type:"v4",value:new Vn},this.cover(),this.construct(t)}cover(t,e,n,r){t==null&&(t=1),this.scaleX=t,e==null&&(e=1),this.scaleY=e,n==null&&(n=1),this.scaleZ=n,r==null&&(r=1),this.scaleW=r}clip(t,e,n,r){t==null&&({width:t}=this),e==null&&({height:e}=this),n==null&&({surfaces:n}=this),r==null&&({layers:r}=this),super.clip(t,e,n,r);const s=o=>1/Math.max(1,o-1);return this.uniforms.geometryScale.value.set(s(t)*this.scaleX,s(e)*this.scaleY,s(n)*this.scaleZ,s(r)*this.scaleW)}}class vU extends ru{constructor(t,e,n){let r;super(t,e,n);let{uniforms:s}=n;const{map:o,combine:a,stpq:l,linear:c}=n;s==null&&(s={});const u=s.styleColor!=null;this.geometry=new h$t({width:n.width,height:n.height}),this._adopt(s),this._adopt(this.geometry.uniforms);const h=e.material(),p=h.vertex;p.pipe("raw.position.scale",this.uniforms),p.fan(),p.pipe("stpq.xyzw.2d",this.uniforms),p.next(),p.pipe("screen.position",this.uniforms),p.join(),h.fragment=r=this._fragmentColor(u,!1,null,null,o,2,l,a,c),r.pipe("fragment.color",this.uniforms);const m=h.link({side:pr});this.material=this._material(m);const v=new fi(this.geometry,this.material);v.frustumCulled=!1,v.userData=m,this._raw(v),this.renders=[v]}dispose(){return this.geometry.dispose(),this.material.dispose(),this.renders=this.geometry=this.material=null,super.dispose()}}class fC extends vU{constructor(t,e,n){const{items:r,width:s,height:o,depth:a,stpq:l}=n,c=m=>1/Math.max(1,m),u=m=>1/Math.max(1,m-1),h={remapUVScale:{type:"v2",value:new Vt(r*s,o*a)},remapModulus:{type:"v2",value:new Vt(r,o)},remapModulusInv:{type:"v2",value:new Vt(c(r),c(o))},remapSTPQScale:{type:"v4",value:new Vn(u(s),u(o),u(a),u(r))}},p=e.shader();p.pipe("screen.map.xyzw",h),n.map!=null&&(l&&p.pipe("screen.map.stpq",h),p.pipe(n.map)),super(t,e,{map:p,linear:!0}),this.memo=n,this.uniforms=h;for(const m of Array.from(this.renders))m.transparent=!1}cover(t,e,n,r){t==null&&({width:t}=this.memo),e==null&&({height:e}=this.memo),n==null&&({depth:n}=this.memo),r==null&&({items:r}=this.memo);const s=l=>1/Math.max(1,l-1);this.uniforms.remapSTPQScale.value.set(s(t),s(e),s(n),s(r));const o=t/this.memo.width;let a=n/this.memo.depth;return this.memo.depth===1&&(a=e/this.memo.height),this.geometry.cover(o,a)}}class _U extends Qf{constructor(t){let e,n,r,s;super(t),this._clipUniforms(),this.items=r=+t.items||2,this.width=s=+t.width||1,this.height=n=+t.height||1,this.depth=e=+t.depth||1;const o=r*s*n*e,a=o*4,l=o*2;this.setIndex(new tn(new Uint32Array(l*3),1)),this.setAttribute("position4",new tn(new Float32Array(a*4),4)),this.setAttribute("sprite",new tn(new Float32Array(a*2),2));const c=this._emitter("index"),u=this._emitter("position4"),h=this._emitter("sprite"),p=[[-1,-1],[-1,1],[1,-1],[1,1]];let m=0;for(let v=0,_=o,b=0<=_;b?v<_:v>_;b?v++:v--)c(m),c(m+1),c(m+2),c(m+1),c(m+2),c(m+3),m+=4;for(let v=0,_=e,b=0<=_;b?v<_:v>_;b?v++:v--)for(let y=0,M=n,S=0<=M;S?y<M:y>M;S?y++:y--)for(let E=0,A=s,R=0<=A;R?E<A:E>A;R?E++:E--)for(let O=0,L=r,P=0<=L;P?O<L:O>L;P?O++:O--)for(const D of Array.from(p))u(E,y,v,O),h(D[0],D[1]);this._finalize(),this.clip()}clip(t,e,n,r){return t==null&&({width:t}=this),e==null&&({height:e}=this),n==null&&({depth:n}=this),r==null&&({items:r}=this),this._clipGeometry(t,e,n,r),this._clipOffsets(6,t,e,n,r,this.width,this.height,this.depth,this.items)}}class d$t extends ru{constructor(t,e,n){let r,s;super(t,e,n);let{uniforms:o,shape:a,fill:l}=n;const{material:c,position:u,color:h,size:p,mask:m,map:v,combine:_,linear:b,optical:y,stpq:M}=n;o==null&&(o={}),a=+a!=null?+a:0,l==null&&(l=!0);const S=o.styleColor!=null,E=["circle","square","diamond","up","down","left","right"],A=["circle","generic","generic","generic","generic","generic","generic"],R=[1.2,1,1.414,1.16,1.16,1.16,1.16],O=A[a]!=null?A[a]:A[0],L=E[a]!=null?E[a]:E[0],P=(s=y&&R[a])!=null?s:1,D=l?O:`${O}.hollow`;this.geometry=new _U({items:n.items,width:n.width,height:n.height,depth:n.depth}),this._adopt(o),this._adopt(this.geometry.uniforms);const V={POINT_SHAPE_SCALE:+(P+1e-5)},K=e.material(),W=K.vertex;W.pipe(this._vertexColor(h,m)),p?(W.isolate(),W.require(p),W.require("point.size.varying",this.uniforms),W.end()):W.require("point.size.uniform",this.uniforms),W.require(this._vertexPosition(u,c,v,2,M)),W.pipe("point.position",this.uniforms,V),W.pipe("project.position",this.uniforms),K.fragment=r=this._fragmentColor(S,c,h,m,v,2,M,_,b);const Z=e.material();Z.vertex.pipe(W),r=Z.fragment.pipe(K.fragment),r.require(`point.mask.${L}`,this.uniforms),r.require(`point.alpha.${D}`,this.uniforms),r.pipe("point.edge",this.uniforms);const z=e.material();z.vertex.pipe(W),r=z.fragment.pipe(K.fragment),r.require(`point.mask.${L}`,this.uniforms),r.require(`point.alpha.${D}`,this.uniforms),r.pipe("point.fill",this.uniforms);const ut=z.link({side:pr});this.fillMaterial=this._material(ut);const nt=Z.link({side:pr});this.edgeMaterial=this._material(nt),this.fillObject=new fi(this.geometry,this.fillMaterial),this.edgeObject=new fi(this.geometry,this.edgeMaterial),this._raw(this.fillObject),this.fillObject.userData=ut,this._raw(this.edgeObject),this.edgeObject.userData=nt,this.renders=[this.fillObject,this.edgeObject]}show(t,e,n,r){return this._show(this.edgeObject,!0,e,n,r),this._show(this.fillObject,t,e,n,r)}dispose(){return this.geometry.dispose(),this.edgeMaterial.dispose(),this.fillMaterial.dispose(),this.renders=this.edgeObject=this.fillObject=this.geometry=this.edgeMaterial=this.fillMaterial=null,super.dispose()}}class p$t extends pU{constructor(t,e,n){const r=n.width||1,s=n.height||1,o=n.depth||1,a=r*s*o;n.samples||(n.samples=a),super(t,e,n),this.width=r,this.height=s,this.depth=o,this.samples==null&&(this.samples=a),this.build(n)}build(t){return this.data=[],this.data.length=this.samples,this.filled=0,this.pad={x:0,y:0,z:0},this.streamer=this.generate(this.data)}dispose(){return this.data=null,super.dispose()}getFilled(){return this.filled}setActive(t,e,n){let r;return[this.pad.x,this.pad.y,this.pad.z]=Array.from(r=[this.width-t,this.height-e,this.depth-n]),r}read(){return this.data}copy(t){const e=Math.min(t.length,this.samples),n=this.data;return f$t(0,e,!1).map(r=>n[r]=t[r])}fill(){let t,e,n,r;const{callback:s}=this;typeof s.reset=="function"&&s.reset();const{emit:o,skip:a,count:l,done:c,reset:u}=this.streamer;u();const h=this.width,p=this.height,m=this.pad.x,v=this.pad.y,_=this.samples-this.pad.z*h*p;let b=t=e=n=0;if(m>0||v>0)for(;!c()&&n<_&&(n++,r=s(o,b,t,e),++b===h-m&&(a(m),b=0,++t===p-v&&(a(h*v),t=0,e++)),r!==!1););else for(;!c()&&n<_&&(n++,r=s(o,b,t,e),++b===h&&(b=0,++t===p&&(t=0,e++)),r!==!1););return this.filled=1,l()}}function f$t(i,t,e){const n=[],r=i<t,s=e?r?t+1:t-1:t;for(let o=i;r?o<s:o>s;r?o++:o--)n.push(o);return n}class m$t extends Jf{constructor(t,e,n){super(t,e),this.items==null&&(this.items=n.items||1),this.channels==null&&(this.channels=n.channels||4),this.width==null&&(this.width=n.width||1),this.height==null&&(this.height=n.height||1),this.depth==null&&(this.depth=n.depth||1),this.type==null&&(this.type=n.type||Hr),this.stpq==null&&(this.stpq=n.stpq||!1),this.isFloat=this.type===Hr,this.active=this.sampled=this.rect=this.pad=null,this.build(n)}build(t){let e,n,r;const{map:s}=t,{indexer:o}=t,a=o!=null&&!o.empty();let{stpq:l}=this;const{items:c,width:u,height:h,depth:p}=this;let m=s;a&&(this._adopt({indexModulus:{type:"v4",value:new Vn(c,c*u,c*u*h,1)}}),m=this.shaders.shader(),m.require(s),m.require(o),m.pipe("float.index.pack",this.uniforms)),this.isFloat&&this.channels>1&&(this.floatMemo=new pC(this.renderer,this.shaders,{items:c,channels:4,width:u,height:h,depth:p,history:0,type:Hr}),this.floatCompose=new fC(this.renderer,this.shaders,{map:m,items:c,width:u,height:h,depth:p,stpq:l}),this.floatMemo.adopt(this.floatCompose),l=!1,m=this.shaders.shader(),this.floatMemo.shaderAbsolute(m)),this.isFloat?(r=this.channels,e=4):(r=1,e=this.channels),r>1?(n=this.shaders.shader(),n.pipe(Tz(r)),n.require(m),n.pipe("float.stretch"),n.pipe("float.encode"),m=n):this.isFloat&&(n=this.shaders.shader(),n.pipe(m),n.pipe(rh(4,1)),n.pipe("float.encode"),m=n),this.byteMemo=new pC(this.renderer,this.shaders,{items:c*r,channels:e,width:u,height:h,depth:p,history:0,type:lo}),this.byteCompose=new fC(this.renderer,this.shaders,{map:m,items:c*r,width:u,height:h,depth:p,stpq:l}),this.byteMemo.adopt(this.byteCompose);const v=c*u*r,_=h*p;return this.samples=this.width*this.height*this.depth,this.bytes=new Uint8Array(v*_*4),this.isFloat&&(this.floats=new Float32Array(this.bytes.buffer)),this.data=this.isFloat?this.floats:this.bytes,this.streamer=this.generate(this.data),this.active={items:0,width:0,height:0,depth:0},this.sampled={items:0,width:0,height:0,depth:0},this.rect={w:0,h:0},this.pad={x:0,y:0,z:0,w:0},this.stretch=r,this.isIndexed=a,this.setActive(c,u,h,p)}generate(t){return vT(t,this.samples,4,this.items)}setActive(t,e,n,r){let s;if(t===this.active.items&&e===this.active.width&&n===this.active.height&&r===this.active.depth)return;[this.active.items,this.active.width,this.active.height,this.active.depth]=Array.from([t,e,n,r]),this.floatCompose!=null&&this.floatCompose.cover(e,n,r),this.byteCompose!=null&&this.byteCompose.cover(e*this.stretch,n,r),{items:t}=this,{width:e}=this.active,n=this.depth===1?this.active.height:this.height,{depth:r}=this.active;const o=t*e*this.stretch,a=n*r;return[this.sampled.items,this.sampled.width,this.sampled.height,this.sampled.depth]=Array.from([t,e,n,r]),[this.rect.w,this.rect.h]=Array.from([o,a]),[this.pad.x,this.pad.y,this.pad.z,this.pad.w]=Array.from(s=[this.sampled.width-this.active.width,this.sampled.height-this.active.height,this.sampled.depth-this.active.depth,this.sampled.items-this.active.items]),s}update(t){return this.floatMemo!=null&&this.floatMemo.render(t),this.byteMemo!=null?this.byteMemo.render(t):void 0}post(){const t=this.renderer.getRenderTarget();this.renderer.setRenderTarget(this.byteMemo.target.targets[0]),this.gl.readPixels(0,0,this.rect.w,this.rect.h,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.bytes),this.renderer.setRenderTarget(t)}readFloat(t){return this.floatMemo!=null?this.floatMemo.read(t):void 0}readByte(t){return this.byteMemo!=null?this.byteMemo.read(t):void 0}setCallback(t){this.emitter=this.callback(t)}callback(t){if(!this.isIndexed)return t;const e=this.width,n=this.height,r=this.items,s=function(o,a,l,c){let u=c;const h=u%r;u=(u-h)/r;const p=u%e;u=(u-p)/e;const m=u%n;return u=(u-m)/n,t(o,a,l,c,p,m,u,h)};return s.reset=()=>typeof t.reset=="function"?t.reset():void 0,s}iterate(){let t,e,n,r=this.emitter;typeof r.reset=="function"&&r.reset();const{consume:s,skip:o,count:a,done:l,reset:c}=this.streamer;c();const u=this.sampled.width|0;let h=this.sampled.height|0;const p=this.sampled.depth|0,m=this.sampled.items|0,v=this.pad.x|0,_=this.pad.y|0,b=this.pad.z|0,y=this.pad.w|0,M=u*h*m*(p-b);if(!this.isIndexed){const E=r;r=(A,R,O,L)=>E(A,R,O,L,S,t,e,n)}let S=t=e=n=h=0;for(;!l()&&h<M;){h++;const E=s(r);if(++n===m-y&&(o(v),n=0,++S===u-v&&(o(m*v),S=0,++t===h-_&&(o(m*u*_),t=0,e++))),E===!1)break}return Math.floor(a()/m)}dispose(){return this.floatMemo!=null&&this.floatMemo.unadopt(this.floatCompose),this.floatMemo!=null&&this.floatMemo.dispose(),this.floatCompose!=null&&this.floatCompose.dispose(),this.byteMemo!=null&&this.byteMemo.unadopt(this.byteCompose),this.byteMemo!=null&&this.byteMemo.dispose(),this.byteCompose!=null&&this.byteCompose.dispose(),this.floatMemo=this.byteMemo=this.floatCompose=this.byteCompose=null}}class g$t extends ru{constructor(t,e,n){let r;super(t,e,n);let{uniforms:s}=n;const{material:o,position:a,sprite:l,map:c,combine:u,linear:h,color:p,mask:m,stpq:v}=n;s==null&&(s={});const _=s.styleColor!=null;this.geometry=new _U({items:n.items,width:n.width,height:n.height,depth:n.depth}),this._adopt(s),this._adopt(this.geometry.uniforms);const b=e.material(),y=b.vertex;y.pipe(this._vertexColor(p,m)),y.require(this._vertexPosition(a,o,c,2,v)),y.require(l),y.pipe("sprite.position",this.uniforms),y.pipe("project.position",this.uniforms),b.fragment=r=this._fragmentColor(_,o,p,m,c,2,v,u,h);const M=e.material();M.vertex.pipe(y),M.fragment.pipe(r),M.fragment.pipe("fragment.transparent",this.uniforms);const S=e.material();S.vertex.pipe(y),S.fragment.pipe(r),S.fragment.pipe("fragment.solid",this.uniforms);const E=S.link({side:pr});this.fillMaterial=this._material(E);const A=M.link({side:pr});this.edgeMaterial=this._material(A),this.fillObject=new fi(this.geometry,this.fillMaterial),this.edgeObject=new fi(this.geometry,this.edgeMaterial),this._raw(this.fillObject),this.fillObject.userData=E,this._raw(this.edgeObject),this.edgeObject.userData=A,this.renders=[this.fillObject,this.edgeObject]}show(t,e,n,r){return this._show(this.edgeObject,!0,e,n,r),this._show(this.fillObject,t,e,n,r)}dispose(){return this.geometry.dispose(),this.edgeMaterial.dispose(),this.fillMaterial.dispose(),this.renders=this.geometry=this.edgeMaterial=this.fillMaterial=this.edgeObject=this.fillObject=null,super.dispose()}}class v$t extends Qf{constructor(t){let e,n,r,s,o;super(t),this._clipUniforms(),this.items=r=+t.items||2,this.width=o=+t.width||1,this.height=n=+t.height||1,this.depth=e=+t.depth||1,this.sides=s=Math.max(0,r-2);const a=o*n*e,l=r*a,c=s*a;this.setIndex(new tn(new Uint32Array(c*3),1)),this.setAttribute("position4",new tn(new Float32Array(l*4),4)),this.setAttribute("strip",new tn(new Float32Array(l*3),3));const u=this._emitter("index"),h=this._emitter("position4"),p=this._emitter("strip");let m=0;for(let _=0,b=a,y=0<=b;y?_<b:_>b;y?_++:_--){let M=m;for(let S=0,E=s,A=0<=E;A?S<E:S>E;A?S++:S--)S&1?(u(M+1),u(M),u(M+2)):(u(M),u(M+1),u(M+2)),M++;m+=r}const v=r-1;for(let _=0,b=e,y=0<=b;y?_<b:_>b;y?_++:_--)for(let M=0,S=n,E=0<=S;E?M<S:M>S;E?M++:M--)for(let A=0,R=o,O=0<=R;O?A<R:A>R;O?A++:A--){let L=1;h(A,M,_,0),p(1,2,L);for(let P=1,D=v,V=1<=D;V?P<D:P>D;V?P++:P--)h(A,M,_,P),p(P-1,P+1,L=-L);h(A,M,_,v),p(v-2,v-1,-L)}this._finalize(),this.clip()}clip(t,e,n,r){t==null&&({width:t}=this),e==null&&({height:e}=this),n==null&&({depth:n}=this),r==null&&({items:r}=this);const s=Math.max(0,r-2);return this._clipGeometry(t,e,n,r),this._clipOffsets(3,t,e,n,s,this.width,this.height,this.depth,this.sides)}}class _$t extends ru{constructor(t,e,n){let r;super(t,e,n);let{uniforms:s,material:o}=n;const{position:a,color:l,mask:c,map:u,combine:h,linear:p,stpq:m}=n;s==null&&(s={}),o==null&&(o=!0);const v=s.styleColor!=null;this.geometry=new v$t({items:n.items,width:n.width,height:n.height,depth:n.depth}),this._adopt(s),this._adopt(this.geometry.uniforms);const _=e.material(),b=_.vertex;b.pipe(this._vertexColor(l,c)),b.require(this._vertexPosition(a,o,u,2,m)),o||b.pipe("mesh.position",this.uniforms),o&&b.pipe("strip.position.normal",this.uniforms),b.pipe("project.position",this.uniforms),_.fragment=r=this._fragmentColor(v,o,l,c,u,2,m,h,p),r.pipe("fragment.color",this.uniforms);const y=_.link({side:pr});this.material=this._material(y);const M=new fi(this.geometry,this.material);M.userData=y,this._raw(M),this.renders=[M]}dispose(){return this.geometry.dispose(),this.material.dispose(),this.renders=this.geometry=this.material=null,super.dispose()}}class b$t extends ru{constructor(t,e,n){let r;super(t,e,n);let{uniforms:s,material:o}=n;const{position:a,color:l,normal:c,mask:u,map:h,combine:p,linear:m,stpq:v,intUV:_}=n;s==null&&(s={}),o==null&&(o=!0);const b=s.styleColor!=null;this.geometry=new gU({width:n.width,height:n.height,surfaces:n.surfaces,layers:n.layers,closedX:n.closedX,closedY:n.closedY}),this._adopt(s),this._adopt(this.geometry.uniforms);const y={};n.closedX&&(y.SURFACE_CLOSED_X=""),n.closedY&&(y.SURFACE_CLOSED_Y=""),_&&(y.POSITION_UV_INT="");const M=e.material(),S=M.vertex;S.pipe(this._vertexColor(l,u)),S.require(this._vertexPosition(a,o,h,2,v)),c?(S.require(c),S.pipe("surface.position.normal",this.uniforms,y)):(o||S.pipe("surface.position",this.uniforms,y),o&&S.pipe("surface.position.shaded",this.uniforms,y)),S.pipe("project.position",this.uniforms),M.fragment=r=this._fragmentColor(b,o,l,u,h,2,v,p,m),r.pipe("fragment.color",this.uniforms);const E=M.link({side:pr});this.material=this._material(E);const A=new fi(this.geometry,this.material);A.userData=E,this._raw(A),this.renders=[A]}dispose(){return this.geometry.dispose(),this.material.dispose(),this.renders=this.geometry=this.material=null,super.dispose()}}const y$t=512/16;class x$t extends fU{constructor(t,e,n){let r;if(n.width||(n.width=256),n.height||(n.height=256),n.type=lo,n.channels=1,n.backed=!0,super(t,e,n,!1),this.font=n.font!=null?n.font:["sans-serif"],this.size=n.size||24,this.style=n.style!=null?n.style:"normal",this.variant=n.variant!=null?n.variant:"normal",this.weight=n.weight!=null?n.weight:"normal",this.outline=(r=+(n.outline!=null?n.outline:5))!=null?r:0,this.gamma=1,typeof navigator<"u"){const s=navigator.userAgent;s.match(/Chrome/)&&s.match(/OS X/)&&(this.gamma=.5)}this.scratchW=this.scratchH=0,this.build(n)}build(t){super.build(t);let e=16;e=this.size,e+=4+2*Math.min(1,this.outline);const n=y$t*e,r=document.createElement("canvas");r.width=n,r.height=e;const s=h=>`${h.replace(/(['"\\])/g,"\\$1")}`,o=this.font.map(s).join(", "),a=r.getContext("2d",{willReadFrequently:!0});a.font=`${this.style} ${this.variant} ${this.weight} ${this.size}px ${o}`,a.fillStyle="#FF0000",a.textAlign="left",a.textBaseline="bottom",a.lineJoin="round";const l=[],c=this.outline*3;for(let h=0,p=c,m=0<=p;m?h<p:h>p;m?h++:h--){const v=("00"+Math.max(0,-h*8+128-!h*8).toString(16)).slice(-2);l.push("#"+v+v+v)}const u=new Uint8Array(n*e*2);return this.canvas=r,this.context=a,this.lineHeight=e,this.maxWidth=n,this.colors=l,this.scratch=u,this._allocate=this.allocate.bind(this),this._write=this.write.bind(this)}reset(){return super.reset(),this.mapped={}}begin(){return Array.from(this.rows).map(t=>t.alive=0)}end(){const{mapped:t}=this;for(const e of Array.from(this.rows.slice()))if(e.alive===0){for(const n of Array.from(e.keys))delete t[n];this.collapse(e)}}map(t,e){const{mapped:n}=this,r=n[t];if(r!=null)return r.row.alive++,e(r.x,r.y,r.w,r.h);this.draw(t);const s=this.scratch,o=this.scratchW,a=this.scratchH,l=this._allocate,c=this._write;return l(t,o,a,function(u,h,p){return n[t]={x:h,y:p,w:o,h:a,row:u},c(s,h,p,o,a),e(h,p,o,a)})}draw(t){let e,n,r,s=this.width;const o=this.lineHeight,a=this.outline,l=this.context,c=this.scratch,u=this.maxWidth,{colors:h}=this,p=a+1,m=Math.round(o*1.05-1),v=l.measureText(t);if(s=Math.min(u,Math.ceil(v.width+2*p+1)),l.clearRect(0,0,s,o),this.outline===0){let _,b;for(l.fillText(t,p,m),{data:e}=l.getImageData(0,0,s,o),r=3,n=0,b=e.length/4,_=0<=b;_?n<b:n>b;_?n++:n--)c[n]=e[r],r+=4;return this.scratchW=s,this.scratchH=o}else{let _,b,y,M;for(l.globalCompositeOperation="source-over",b=a+1,n=b,_=b<=1;_?n<=1:n>=1;_?n++:n--)r=n>1?n*2-2:n,l.strokeStyle=h[r-1],l.lineWidth=r,l.strokeText(t,p,m);l.globalCompositeOperation="multiply",l.fillText(t,p,m),{data:e}=l.getImageData(0,0,s,o),r=0;const{gamma:S}=this;for(n=0,M=e.length/4,y=0<=M;y?n<M:n>M;y?n++:n--){const E=e[r];let A=E?e[r+1]/E:1;S===.5&&(A=Math.sqrt(A)),A=Math.min(1,Math.max(0,A));const R=256-E,O=R+(E-R)*A;c[n]=Math.max(0,Math.min(255,O+2)),r+=4}return this.scratchW=s,this.scratchH=o}}}class w$t extends Dx{build(t){return super.build(),this.pad={x:0,y:0,z:0},this.streamer=this.generate(this.data)}setActive(t,e,n){let r;return[this.pad.x,this.pad.y,this.pad.z]=Array.from(r=[Math.max(0,this.width-t),Math.max(0,this.height-e),Math.max(0,this.depth-n)]),r}fill(){let t,e,n,r;const{callback:s}=this;typeof s.reset=="function"&&s.reset();const{emit:o,skip:a,count:l,done:c,reset:u}=this.streamer;u();const h=this.width,p=this.height,m=this.pad.x,v=this.pad.y,_=this.samples-this.pad.z*h*p;let b=t=e=n=0;if(m>0||v>0)for(;!c()&&n<_&&(n++,r=s(o,b,t,e),++b===h-m&&(a(m),n+=m,b=0,++t===p-v&&(a(h*v),n+=h*v,t=0,e++)),r!==!1););else for(;!c()&&n<_&&(n++,r=s(o,b,t,e),++b===h&&(b=0,++t===p&&(t=0,e++)),r!==!1););return Math.floor(l()/this.items)}through(t,e){let n,r,s,o;const{consume:a,done:l,skip:c}=o=this.streamer,{emit:u}=n=e.streamer;let h=r=s=0,p=()=>a((m,v,_,b)=>t(u,m,v,_,b,h,r,s));return p=kv(p,this.items),()=>{let m;o.reset(),n.reset();const v=this.width,_=this.height,b=this.pad.x,y=this.pad.y,M=this.samples-this.pad.z*v*_;if(h=r=s=m=0,b>0||y>0)for(;!l()&&m<M;)m++,p(),++h===v-b&&(c(b),h=0,++r===_-y&&(c(v*y),r=0,s++));else for(;!l()&&m<M;)m++,p(),++h===v&&(h=0,++r===_&&(r=0,s++));return o.count()}}}const bU={sprite:g$t,point:d$t,line:l$t,surface:b$t,face:o$t,strip:_$t,arrow:e$t,screen:vU,memoScreen:fC,debug:r$t,dataBuffer:Dx,arrayBuffer:J5t,matrixBuffer:c$t,voxelBuffer:w$t,pushBuffer:p$t,renderToTexture:mU,memo:pC,readback:m$t,atlas:fU,textAtlas:x$t,scene:hU},S$t=Object.freeze(Object.defineProperty({__proto__:null,Classes:bU,Factory:dU,Scene:hU},Symbol.toStringTag,{value:"Module"})),M$t=`uniform float worldUnit;
uniform float lineDepth;
uniform float lineWidth;
uniform float focusDepth;

uniform vec4 geometryClip;
uniform float arrowSize;
uniform float arrowSpace;

attribute vec4 position4;
attribute vec3 arrow;
attribute vec2 attach;

// External
vec3 getPosition(vec4 xyzw, float canonical);

void getArrowGeometry(vec4 xyzw, float near, float mid, float far, out vec3 left, out vec3 right, out vec3 middle, out vec3 start) {
  right  = getPosition(xyzw, 1.0);
  left   = getPosition(vec4(near, xyzw.yzw), 0.0);
  middle = getPosition(vec4(mid,  xyzw.yzw), 0.0);
  start  = getPosition(vec4(far,  xyzw.yzw), 0.0);
}

mat4 getArrowMatrix(vec3 left, vec3 right, vec3 middle, vec3 start) {

  float depth = focusDepth;
  if (lineDepth < 1.0) {
    // Depth blending
    float z = max(0.00001, -right.z);
    depth = mix(z, focusDepth, lineDepth);
  }

  vec3 diff = left - right;
  float l = length(diff);
  if (l == 0.0) {
    return mat4(1.0, 0.0, 0.0, 0.0,
                0.0, 1.0, 0.0, 0.0,
                0.0, 0.0, 1.0, 0.0,
                0.0, 0.0, 0.0, 1.0);
  }

  // Construct TBN matrix around shaft
  vec3 t = normalize(diff);
  vec3 n = normalize(cross(t, t.yzx + vec3(.1, .2, .3)));
  vec3 b = cross(n, t);

  // Shrink arrows when vector gets too small
  // Approach linear scaling with cubic ease the smaller we get
  float size = arrowSize * lineWidth * worldUnit * depth * 1.25;
  l = max(length(right - middle), length(middle - start)) * 2.0 * arrowSpace;
  float mini = clamp(1.0 - l / size * .333, 0.0, 1.0);
  float scale = 1.0 - mini * mini * mini;
  float range = size * scale;

  // Size to 2.5:1 ratio
  float rangeNB = range / 2.5;

  // Anchor at end position
  return mat4(vec4(n * rangeNB,  0),
              vec4(b * rangeNB,  0),
              vec4(t * range, 0),
              vec4(right,  1.0));
}

vec3 getArrowPosition() {
  vec3 left, right, middle, start;

  // Clip arrow position and attachment anchors to data
  vec4 p = min(geometryClip, position4);
  vec3 a = vec3(min(geometryClip.x, p.x + attach.x), geometryClip.x / 2.0, min(geometryClip.x, attach.y));

  getArrowGeometry(p, a.x, a.y, a.z, left, right, middle, start);
  mat4 matrix = getArrowMatrix(left, right, middle, start);

  return (matrix * vec4(arrow.xyz, 1.0)).xyz;

}
`,C$t=`uniform vec4 axisStep;
uniform vec4 axisPosition;

vec4 getAxisPosition(vec4 xyzw, inout vec4 stpq) {
  return axisStep * xyzw.x + axisPosition;
}
`,E$t=`uniform vec4 basisScale;
uniform vec4 basisOffset;
uniform vec4 viewScale;
uniform vec4 viewOffset;

vec4 getCartesian4Position(vec4 position, inout vec4 stpq) {
  return position * basisScale + basisOffset;
}
`,T$t=`uniform mat4 viewMatrix;

vec4 getCartesianPosition(vec4 position, inout vec4 stpq) {
  return viewMatrix * vec4(position.xyz, 1.0);
}
`,A$t=`uniform vec4 clampLimit;

vec4 getClampXYZW(vec4 xyzw) {
  return clamp(xyzw, vec4(0.0), clampLimit);
}
`,P$t=`vec4 opaqueColor(vec4 color) {
  return vec4(color.rgb, 1.0);
}
`,R$t=`uniform vec4 geometryClip;
attribute vec4 position4;

// External
vec3 getPosition(vec4 xyzw, float canonical);

vec3 getFacePosition() {
  vec4 p = min(geometryClip, position4);
  return getPosition(p, 1.0);
}
`,k$t=`attribute vec4 position4;

// External
vec3 getPosition(vec4 xyzw, float canonical);

varying vec3 vNormal;
varying vec3 vLight;
varying vec3 vPosition;

void getFaceGeometry(vec4 xyzw, out vec3 pos, out vec3 normal) {
  vec3 a, b, c;

  a   = getPosition(vec4(xyzw.xyz, 0.0), 0.0);
  b   = getPosition(vec4(xyzw.xyz, 1.0), 0.0);
  c   = getPosition(vec4(xyzw.xyz, 2.0), 0.0);

  pos = getPosition(xyzw, 1.0);
  normal = normalize(cross(c - a, b - a));
}

vec3 getFacePositionNormal() {
  vec3 center, normal;

  getFaceGeometry(position4, center, normal);
  vNormal   = normal;
  vLight    = normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz);
  vPosition = -center;

  return center;
}
`,L$t=`/*
Float encoding technique by
Carlos Scheidegger
https://github.com/cscheid/lux/blob/master/src/shade/bits/encode_float.js

Conversion to GLSL by:
http://concord-consortium.github.io/lab/experiments/webgl-gpgpu/script.js
*/

float shift_right(float v, float amt) { 
  v = floor(v) + 0.5; 
  return floor(v / exp2(amt)); 
}

float shift_left(float v, float amt) { 
  return floor(v * exp2(amt) + 0.5); 
}

float mask_last(float v, float bits) { 
  return mod(v, shift_left(1.0, bits)); 
}

float extract_bits(float num, float from, float to) { 
  from = floor(from + 0.5); to = floor(to + 0.5); 
  return mask_last(shift_right(num, from), to - from); 
}

vec4 encode_float(float val) { 
  if (val == 0.0) return vec4(0, 0, 0, 0); 
  float valuesign = val > 0.0 ? 0.0 : 1.0; 
  val = abs(val); 
  float exponent = floor(log2(val)); 
  float biased_exponent = exponent + 127.0; 
  float fraction = ((val / exp2(exponent)) - 1.0) * 8388608.0; 
  float t = biased_exponent / 2.0; 
  float last_bit_of_biased_exponent = fract(t) * 2.0; 
  float remaining_bits_of_biased_exponent = floor(t); 
  float byte4 = extract_bits(fraction, 0.0, 8.0) / 255.0; 
  float byte3 = extract_bits(fraction, 8.0, 16.0) / 255.0; 
  float byte2 = (last_bit_of_biased_exponent * 128.0 + extract_bits(fraction, 16.0, 23.0)) / 255.0; 
  float byte1 = (valuesign * 128.0 + remaining_bits_of_biased_exponent) / 255.0; 
  return vec4(byte4, byte3, byte2, byte1); 
}
`,O$t=`uniform vec4 indexModulus;

vec4 getSample(vec4 xyzw);
vec4 getIndex(vec4 xyzw);

vec4 floatPackIndex(vec4 xyzw) {
  vec4 value = getSample(xyzw);
  vec4 index = getIndex(xyzw);

  vec4 offset = floor(index + .5) * indexModulus;
  vec2 sum2 = offset.xy + offset.zw;
  float sum = sum2.x + sum2.y;
  return vec4(value.xyz, sum);
}`,D$t=`vec4 getSample(vec4 xyzw);

float floatStretch(vec4 xyzw, float channelIndex) {
  vec4 sample = getSample(xyzw);
  vec2 xy = channelIndex > 1.5 ? sample.zw : sample.xy;
  return mod(channelIndex, 2.0) > .5 ? xy.y : xy.x;
}`,I$t=`varying float vClipStrokeWidth;
varying float vClipStrokeIndex;
varying vec3  vClipStrokeEven;
varying vec3  vClipStrokeOdd;
varying vec3  vClipStrokePosition;

void clipStrokeFragment() {
  bool odd = mod(vClipStrokeIndex, 2.0) >= 1.0;

  vec3 tangent;
  if (odd) {
    tangent = vClipStrokeOdd;
  }
  else {
    tangent = vClipStrokeEven;
  }

  float travel = dot(vClipStrokePosition, normalize(tangent)) / vClipStrokeWidth;
  if (mod(travel, 16.0) > 8.0) {
    discard;
  }
}
`,N$t=`varying float vClipStrokeWidth;
varying float vClipStrokeIndex;
varying vec3  vClipStrokeEven;
varying vec3  vClipStrokeOdd;
varying vec3  vClipStrokePosition;

void clipStrokeFragment() {
  bool odd = mod(vClipStrokeIndex, 2.0) >= 1.0;

  vec3 tangent;
  if (odd) {
    tangent = vClipStrokeOdd;
  }
  else {
    tangent = vClipStrokeEven;
  }

  float travel = dot(vClipStrokePosition, normalize(tangent)) / vClipStrokeWidth;
  if (mod(travel, 4.0) > 2.0) {
    discard;
  }
}
`,z$t=`varying vec2 vClipEnds;

void clipEndsFragment() {
  if (vClipEnds.x < 0.0 || vClipEnds.y < 0.0) discard;
}
`,U$t=`varying float vClipProximity;

void clipProximityFragment() {
  if (vClipProximity >= 0.5) discard;
}`,F$t=`void setFragmentColor(vec4 color) {
  gl_FragColor = color;
}`,V$t=`vec4 fragmentRGBA(vec4 rgba, vec4 stpq) {
  return rgba;
}`,B$t=`void setFragmentColor(vec4 color) {
  if (color.a < 1.0) discard;
  gl_FragColor = color;
}`,H$t=`void setFragmentColor(vec4 color) {
  if (color.a >= 1.0) discard;
  gl_FragColor = color;
}`,$$t=`uniform vec4 gridPosition;
uniform vec4 gridStep;
uniform vec4 gridAxis;

vec4 sampleData(vec2 xy);

vec4 getGridPosition(vec4 xyzw) {
  vec4 onAxis  = gridAxis * sampleData(vec2(xyzw.y, 0.0)).x;
  vec4 offAxis = gridStep * xyzw.x + gridPosition;
  return onAxis + offAxis;
}
`,G$t=`uniform float growScale;
uniform vec4  growMask;
uniform vec4  growAnchor;

vec4 getSample(vec4 xyzw);

vec4 getGrowSample(vec4 xyzw) {
  vec4 anchor = xyzw * growMask + growAnchor;

  vec4 position = getSample(xyzw);
  vec4 center = getSample(anchor);

  return mix(center, position, growScale);
}`,q$t=`uniform float joinStride;
uniform float joinStrideInv;

float getIndex(vec4 xyzw);
vec4 getRest(vec4 xyzw);
vec4 injectIndices(float a, float b);

vec4 getJoinXYZW(vec4 xyzw) {

  float a = getIndex(xyzw);
  float b = a * joinStrideInv;

  float integer  = floor(b);
  float fraction = b - integer;
  
  return injectIndices(fraction * joinStride, integer) + getRest(xyzw);
}
`,W$t=`varying float vPixelSize;

vec4 getLabelAlphaColor(vec4 color, vec4 sample) {
  float mask = clamp(sample.r * 1000.0, 0.0, 1.0);
  float alpha = (sample.r - .5) * vPixelSize + .5;
  float a = mask * alpha * color.a;
  if (a <= 0.0) discard;
  return vec4(color.xyz, a);
}
`,j$t=`vec2 mapUV(vec4 uvwo, vec4 stpq) {
  return uvwo.xy;
}
`,X$t=`uniform float outlineExpand;
uniform float outlineStep;
uniform vec3  outlineColor;

varying float vPixelSize;

const float PIXEL_STEP = 255.0 / 16.0;

vec4 getLabelOutlineColor(vec4 color, vec4 sample) {
  float ps = vPixelSize * PIXEL_STEP;
  float os = outlineStep;

  float sdf = sample.r - .5 + outlineExpand;
  vec2  sdfs = vec2(sdf, sdf + os);
  vec2  alpha = clamp(sdfs * ps + .5, 0.0, 1.0);

  if (alpha.y <= 0.0) {
    discard;
  }

  vec3 blend = color.xyz;
  if (alpha.y > alpha.x) {
    blend = sqrt(mix(outlineColor * outlineColor, blend * blend, alpha.x));
  }
  
  return vec4(blend, alpha.y * color.a);
}
`,Y$t=`uniform vec4 layerScale;
uniform vec4 layerBias;

#define PROJECT_ORTHOGONAL

vec4 layerPosition(vec4 position, inout vec4 stpq) {
  return layerScale * position + layerBias;
}
`,K$t=`// External
vec4 sampleData(vec4 xyzw);

vec4 lerpDepth(vec4 xyzw) {
  float x = xyzw.z;
  float i = floor(x);
  float f = x - i;
    
  vec4 xyzw1 = vec4(xyzw.xy, i, xyzw.w);
  vec4 xyzw2 = vec4(xyzw.xy, i + 1.0, xyzw.w);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, f);
}
`,Z$t=`// External
vec4 sampleData(vec4 xyzw);

vec4 lerpHeight(vec4 xyzw) {
  float x = xyzw.y;
  float i = floor(x);
  float f = x - i;
    
  vec4 xyzw1 = vec4(xyzw.x, i, xyzw.zw);
  vec4 xyzw2 = vec4(xyzw.x, i + 1.0, xyzw.zw);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, f);
}
`,J$t=`// External
vec4 sampleData(vec4 xyzw);

vec4 lerpItems(vec4 xyzw) {
  float x = xyzw.w;
  float i = floor(x);
  float f = x - i;
    
  vec4 xyzw1 = vec4(xyzw.xyz, i);
  vec4 xyzw2 = vec4(xyzw.xyz, i + 1.0);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, f);
}
`,Q$t=`// External
vec4 sampleData(vec4 xyzw);

vec4 lerpWidth(vec4 xyzw) {
  float x = xyzw.x;
  float i = floor(x);
  float f = x - i;
    
  vec4 xyzw1 = vec4(i, xyzw.yzw);
  vec4 xyzw2 = vec4(i + 1.0, xyzw.yzw);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, f);
}
`,tGt=`// Units and calibration
uniform float worldUnit;
uniform float lineWidth;
uniform float lineDepth;
uniform float focusDepth;

// General data index
uniform vec4 geometryClip;
attribute vec4 position4;

// (Top/bottom -1,1)
attribute float line;

// 0...1 for round or bevel joins
#ifdef LINE_JOIN_DETAIL
attribute float joint;
#else
const float joint = 0.0;
#endif

// Knock out excessively long line segments (e.g. for asymtpotes)
#ifdef LINE_PROXIMITY
uniform float lineProximity;
varying float vClipProximity;
#endif

// Ghetto line stroking (local only, not global)
#ifdef LINE_STROKE
varying float vClipStrokeWidth;
varying float vClipStrokeIndex;
varying vec3  vClipStrokeEven;
varying vec3  vClipStrokeOdd;
varying vec3  vClipStrokePosition;
#endif

// External
vec3 getPosition(vec4 xyzw, float canonical);

// Clip line ends for arrows / decoration
#ifdef LINE_CLIP
uniform float clipRange;
uniform vec2  clipStyle;
uniform float clipSpace;

attribute vec2 strip;

varying vec2 vClipEnds;

void clipEnds(vec4 xyzw, vec3 center, vec3 pos) {

  // Sample start of line strip
  vec4 xyzwS = vec4(0.0, xyzw.yzw);
  vec3 start = getPosition(xyzwS, 0.0);

  // Sample middle of line strip
  vec4 xyzwM = vec4(geometryClip.x / 2.0, xyzw.yzw);
  vec3 middle = getPosition(xyzwM, 0.0);

#ifdef LINE_CLOSED
  vec3 end = start;
#else
  // Sample other end of line strip
  vec4 xyzwE = vec4(geometryClip.x, xyzw.yzw);
  vec3 end   = getPosition(xyzwE, 0.0);
#endif

  // Measure length
  float l = max(length(end - middle), length(middle - start)) * clipSpace * 2.0;

  // Arrow length (=2.5x radius)
  float arrowSize = 1.25 * clipRange * lineWidth * worldUnit;

#ifdef LINE_CLOSED
  // Clip around start/end
  end = start;
#endif

  vClipEnds = vec2(1.0);

  if (clipStyle.y > 0.0) {
    // Depth blend end
    float depth = focusDepth;
    if (lineDepth < 1.0) {
      float z = max(0.00001, -end.z);
      depth = mix(z, focusDepth, lineDepth);
    }

    // Absolute arrow length
    float size = arrowSize * depth;

    // Adjust clip range
    // Approach linear scaling with cubic ease the smaller we get
    float mini = clamp(1.0 - l / size * .333, 0.0, 1.0);
    float scale = 1.0 - mini * mini * mini;
    float invrange = 1.0 / (size * scale);

    // Clip end
    vec3 diff = end - center;
    if(diff == vec3(0.0))
      vClipEnds.x = -1.0;
    else {
      diff = normalize(end - center);
      float d = dot(end - pos, diff);
      vClipEnds.x = d * invrange - 1.0;
    }
  }

  if (clipStyle.x > 0.0) {
    // Depth blend start
    float depth = focusDepth;
    if (lineDepth < 1.0) {
      float z = max(0.00001, -start.z);
      depth = mix(z, focusDepth, lineDepth);
    }

    // Absolute arrow length
    float size = arrowSize * depth;

    // Adjust clip range
    // Approach linear scaling with cubic ease the smaller we get
    float mini = clamp(1.0 - l / size * .333, 0.0, 1.0);
    float scale = 1.0 - mini * mini * mini;
    float invrange = 1.0 / (size * scale);

    // Clip start
    vec3 diff = center - start;
    if(diff == vec3(0.0))
      vClipEnds.y = -1.0;
    else {
      diff = normalize(center - start);
      float d = dot(pos - start, diff);
      vClipEnds.y = d * invrange - 1.0;
    }
  }
}
#endif

// Adjust left/center/right to be inside near/far z range
const float epsilon = 1e-5;
void fixCenter(inout vec3 left, inout vec3 center, inout vec3 right) {
  if (center.z >= 0.0) {
    if (left.z < 0.0) {
      float d = (center.z + epsilon) / (center.z - left.z);
      center = mix(center, left, d);
    }
    else if (right.z < 0.0) {
      float d = (center.z + epsilon) / (center.z - right.z);
      center = mix(center, right, d);
    }
  }

  if (left.z >= 0.0) {
    if (center.z < 0.0) {
      float d = (left.z + epsilon) / (left.z - center.z);
      left = mix(left, center, d);
    }
  }

  if (right.z >= 0.0) {
    if (center.z < 0.0) {
      float d = (right.z + epsilon) / (right.z - center.z);
      right = mix(right, center, d);
    }
  }
}

vec4 wrapAround(vec4 xyzw) {
#ifdef LINE_CLOSED
  float gx = geometryClip.x;
  if (xyzw.x < 0.0) xyzw.x += gx;
  if (xyzw.x >= gx) xyzw.x -= gx;
#endif
  return xyzw;
}

// Sample the source data in an edge-aware manner
void getLineGeometry(vec4 xyzw, float edge, out vec3 left, out vec3 center, out vec3 right) {
  vec4 delta = vec4(1.0, 0.0, 0.0, 0.0);

  center = getPosition(xyzw, 1.0);
  left   = (edge > -0.5) ? getPosition(wrapAround(xyzw - delta), 0.0) : center;
  right  = (edge < 0.5)  ? getPosition(wrapAround(xyzw + delta), 0.0) : center;
}

// Calculate the position for a vertex along the line, including joins
vec3 getLineJoin(float edge, bool odd, vec3 left, vec3 center, vec3 right, float width, float offset, float joint) {
  vec2 join = vec2(1.0, 0.0);

  fixCenter(left, center, right);

  vec4 a = vec4(left.xy, right.xy);
  vec4 b = a / vec4(left.zz, right.zz);

  vec2 l = b.xy;
  vec2 r = b.zw;
  vec2 c = center.xy / center.z;

  vec4 d = vec4(l, c) - vec4(c, r);
  float l1 = dot(d.xy, d.xy);
  float l2 = dot(d.zw, d.zw);

  if (l1 + l2 > 0.0) {

    if (edge > 0.5 || l2 == 0.0) {
      vec2 nl = normalize(d.xy);
      vec2 tl = vec2(nl.y, -nl.x);

#ifdef LINE_PROXIMITY
      vClipProximity = 1.0;
#endif

#ifdef LINE_STROKE
      vClipStrokeEven = vClipStrokeOdd = normalize(left - center);
#endif
      join = tl;
    }
    else if (edge < -0.5 || l1 == 0.0) {
      vec2 nr = normalize(d.zw);
      vec2 tr = vec2(nr.y, -nr.x);

#ifdef LINE_PROXIMITY
      vClipProximity = 1.0;
#endif

#ifdef LINE_STROKE
      vClipStrokeEven = vClipStrokeOdd = normalize(center - right);
#endif
      join = tr;
    }
    else {
      // Limit join stretch for tiny segments
      float lmin2 = min(l1, l2) / (width * width);

      // Hide line segment if ratio of leg lengths exceeds promixity threshold
#ifdef LINE_PROXIMITY
      float lr     = l1 / l2;
      float rl     = l2 / l1;
      float ratio  = max(lr, rl);
      float thresh = lineProximity + 1.0;
      vClipProximity = (ratio > thresh * thresh) ? 1.0 : 0.0;
#endif

      // Calculate normals/tangents
      vec2 nl = normalize(d.xy);
      vec2 nr = normalize(d.zw);

      // Calculate tangents
      vec2 tl = vec2(nl.y, -nl.x);
      vec2 tr = vec2(nr.y, -nr.x);

#ifdef LINE_PROXIMITY
      // Mix tangents according to leg lengths
      vec2 tc = normalize(mix(tl, tr, l1/(l1+l2)));
#else
      // Average tangent
      vec2 tc = normalize(tl + tr);
#endif

      // Miter join
      float cosA   = dot(nl, tc);
      float sinA   = max(0.1, abs(dot(tl, tc)));
      float factor = cosA / sinA;
      float scale  = sqrt(1.0 + min(lmin2, factor * factor));

      // Stroke normals
#ifdef LINE_STROKE
      vec3 stroke1 = normalize(left - center);
      vec3 stroke2 = normalize(center - right);

      if (odd) {
        vClipStrokeEven = stroke1;
        vClipStrokeOdd  = stroke2;
      }
      else {
        vClipStrokeEven = stroke2;
        vClipStrokeOdd  = stroke1;
      }
#endif

#ifdef LINE_JOIN_MITER
      // Apply straight up miter
      join = tc * scale;
#endif

#ifdef LINE_JOIN_ROUND
      // Slerp bevel join into circular arc
      float dotProduct = dot(nl, nr);
      float angle = acos(dotProduct);
      float sinT  = sin(angle);
      join = (sin((1.0 - joint) * angle) * tl + sin(joint * angle) * tr) / sinT;
#endif

#ifdef LINE_JOIN_BEVEL
      // Direct bevel join between two flat ends
      float dotProduct = dot(nl, nr);
      join = mix(tl, tr, joint);
#endif

#ifdef LINE_JOIN_DETAIL
      // Check if on inside or outside of joint
      float crossProduct = nl.x * nr.y - nl.y * nr.x;
      if (offset * crossProduct < 0.0) {
        // For near-180-degree bends, correct back to a miter to avoid discontinuities
        float ratio = clamp(-dotProduct * 2.0 - 1.0, 0.0, 1.0);
        // Otherwise collapse the inside vertices into one.
        join = mix(tc * scale, join, ratio * ratio * ratio);
      }
#endif

    }
    return vec3(join, 0.0);
  }
  else {
    return vec3(0.0);
  }

}

// Calculate final line position
vec3 getLinePosition() {
  vec3 left, center, right, join;

  // Up/down along segment
  float offset = line;

  // Clip data
  vec4 p = min(geometryClip, position4);

  // Left/center/right
  float edge = 0.0;
#ifdef LINE_CLOSED
  if (p.x == geometryClip.x) p.x = 0.0;
#else
  if (p.x == geometryClip.x) edge = 1.0;
  if (p.x == 0.0) edge = -1.0;
#endif

  // Get position + adjacent neighbours
  getLineGeometry(p, edge, left, center, right);

#ifdef LINE_STROKE
  // Set parameters for line stroke fragment shader
  vClipStrokePosition = center;
  vClipStrokeIndex = p.x;
  bool odd = mod(p.x, 2.0) >= 1.0;
#else
  bool odd = true;
#endif

  // Divide line width up/down
  float width = lineWidth * 0.5;

  float depth = focusDepth;
  if (lineDepth < 1.0) {
    // Depth blending
    float z = max(0.00001, -center.z);
    depth = mix(z, focusDepth, lineDepth);
  }
  width *= depth;

  // Convert to world units
  width *= worldUnit;

  // Calculate line join
#ifdef LINE_CLOSED
  join = getLineJoin(0.0, odd, left, center, right, width, offset, joint);
#else
  join = getLineJoin(edge, odd, left, center, right, width, offset, joint);
#endif
  vec3 pos = center + join * offset * width;

#ifdef LINE_STROKE
  vClipStrokeWidth = width;
#endif

#ifdef LINE_CLIP
  clipEnds(p, center, pos);
#endif

  return pos;
}
`,eGt=`uniform vec2 dataResolution;
uniform vec2 dataPointer;

vec2 map2DData(vec2 xy) {
  return (xy + dataPointer) * dataResolution;
}
`,nGt=`uniform vec2 dataResolution;
uniform vec2 dataPointer;

vec2 map2DData(vec2 xy) {
  return fract((xy + dataPointer) * dataResolution);
}
`,iGt=`void mapXyzw2DV(vec4 xyzw, out vec2 xy, out float z) {
  xy = xyzw.xy;
  z  = xyzw.z;
}

`,rGt=`vec4 alignXYZW(vec4 xyzw) {
  return floor(xyzw + .5);
}

`,sGt=`uniform float textureItems;
uniform float textureHeight;

vec2 mapXyzwTexture(vec4 xyzw) {
  
  float x = xyzw.x;
  float y = xyzw.y;
  float z = xyzw.z;
  float i = xyzw.w;
  
  return vec2(i, y) + vec2(x, z) * vec2(textureItems, textureHeight);
}

`,oGt=`varying vec4 vColor;

vec4 getColor() {
  if (vColor.a <= 0.0) discard;
  return vColor;
}
`,aGt=`#ifdef POSITION_STPQ
varying vec4 vSTPQ;
#endif
#ifdef POSITION_U
varying float vU;
#endif
#ifdef POSITION_UV
varying vec2 vUV;
#endif
#ifdef POSITION_UVW
varying vec3 vUVW;
#endif
#ifdef POSITION_UVWO
varying vec4 vUVWO;
#endif

vec4 getSample(vec4 uvwo, vec4 stpq);

vec4 getMapColor() {
  #ifdef POSITION_STPQ
  vec4 stpq = vSTPQ;
  #else
  vec4 stpq = vec4(0.0);
  #endif

  #ifdef POSITION_U
  vec4 uvwo = vec4(vU, 0.0, 0.0, 0.0);
  #endif
  #ifdef POSITION_UV
  vec4 uvwo = vec4(vUV, 0.0, 0.0);
  #endif
  #ifdef POSITION_UVW
  vec4 uvwo = vec4(vUVW, 0.0);
  #endif
  #ifdef POSITION_UVWO
  vec4 uvwo = vec4(vUVWO);
  #endif

  return getSample(uvwo, stpq);
}
`,lGt=`varying float vMask;

float ease(float t) {
  t = clamp(t, 0.0, 1.0);
  return t * t * (3.0 - 2.0 * t);
}

vec4 maskColor() {
  if (vMask <= 0.0) discard;
  return vec4(vec3(1.0), ease(vMask));
}
`,cGt=`#ifdef POSITION_STPQ
varying vec4 vSTPQ;
#endif
#ifdef POSITION_U
varying float vU;
#endif
#ifdef POSITION_UV
varying vec2 vUV;
#endif
#ifdef POSITION_UVW
varying vec3 vUVW;
#endif
#ifdef POSITION_UVWO
varying vec4 vUVWO;
#endif

vec4 getSample(vec4 rgba, vec4 stpq);

vec4 getMaterialColor(vec4 rgba) {
  vec4 stpq = vec4(0.0);

  #ifdef POSITION_U
  stpq.x = vU;
  #endif
  #ifdef POSITION_UV
  stpq.xy = vUV;
  #endif
  #ifdef POSITION_UVW
  stpq.xyz = vUVW;
  #endif
  #ifdef POSITION_UVWO
  stpq = vUVWO;
  #endif

  #ifdef POSITION_STPQ
  stpq = vSTPQ;
  #endif

  return getSample(rgba, stpq);
}
`,uGt=`
#extension GL_OES_standard_derivatives : enable
varying vec3 vNormal;
varying vec3 vLight;
varying vec3 vPosition;

vec3 offSpecular(vec3 color) {
  vec3 c = 1.0 - color;
  return 1.0 - c * c;
}

vec4 getShadedColor(vec4 rgba) {
  
  vec3 color = rgba.xyz;
  vec3 color2 = offSpecular(rgba.xyz);

  vec3 normal = normalize(vNormal);
  vec3 light = normalize(vLight);
  vec3 position = normalize(vPosition);
  
  // Workaround to avoid gl_FrontFacing. See https://github.com/unconed/mathbox/pull/26
  vec3 pdx = dFdx(vPosition);
  vec3 pdy = dFdy(vPosition);
  bool frontFacting = dot(vNormal, cross(pdx, pdy)) > 0.0;

  float side = frontFacting ? 1.0 : -1.0;
  float cosine  = side * dot(normal, light);
  float diffuse = mix(max(0.0, cosine), .5 + .5 * cosine, .1);
  
  vec3  halfLight = normalize(light + position);
	float cosineHalf = max(0.0, side * dot(normal, halfLight));
	float specular = pow(cosineHalf, 16.0);
	
	return vec4(color * (diffuse * .9 + .05) + .25 * color2 * specular, rgba.a);
}
`,hGt="",dGt=`vec4 getGammaInColor(vec4 rgba) {
  return vec4(rgba.rgb * rgba.rgb, rgba.a);
}
`,pGt=`vec4 getGammaOutColor(vec4 rgba) {
  return vec4(sqrt(rgba.rgb), rgba.a);
}
`,fGt=`vec4 mapUVWO(vec4 uvwo, vec4 stpq) {
  return uvwo;
}
`,mGt=`uniform vec4 geometryClip;
attribute vec4 position4;

// External
vec3 getPosition(vec4 xyzw, float canonical);

vec3 getMeshPosition() {
  vec4 p = min(geometryClip, position4);
  return getPosition(p, 1.0);
}
`,gGt=`attribute vec4 position4;
uniform vec4 geometryClip;
varying vec4 vColor;

// External
vec4 getSample(vec4 xyzw);

void vertexColor() {
  vec4 p = min(geometryClip, position4);
  vColor = getSample(p);
}
`,vGt=`attribute vec4 position4;
uniform vec4 geometryResolution;
uniform vec4 geometryClip;
varying float vMask;

// External
float getSample(vec4 xyzw);

void maskLevel() {
  vec4 p = min(geometryClip, position4);
  vMask = getSample(p * geometryResolution);
}
`,_Gt=`uniform vec4 geometryResolution;

#ifdef POSITION_STPQ
varying vec4 vSTPQ;
#endif
#ifdef POSITION_U
varying float vU;
#endif
#ifdef POSITION_UV
varying vec2 vUV;
#endif
#ifdef POSITION_UVW
varying vec3 vUVW;
#endif
#ifdef POSITION_UVWO
varying vec4 vUVWO;
#endif

// External
vec3 getPosition(vec4 xyzw, in vec4 stpqIn, out vec4 stpqOut);

vec3 getMeshPosition(vec4 xyzw, float canonical) {
  vec4 stpqOut, stpqIn = xyzw * geometryResolution;
  vec3 xyz = getPosition(xyzw, stpqIn, stpqOut);

  #ifdef POSITION_MAP
  if (canonical > 0.5) {
    #ifdef POSITION_STPQ
    vSTPQ = stpqOut;
    #endif
    #ifdef POSITION_U
    vU = stpqOut.x;
    #endif
    #ifdef POSITION_UV
    vUV = stpqOut.xy;
    #endif
    #ifdef POSITION_UVW
    vUVW = stpqOut.xyz;
    #endif
    #ifdef POSITION_UVWO
    vUVWO = stpqOut;
    #endif
  }
  #endif
  return xyz;
}
`,bGt=`uniform float transitionEnter;
uniform float transitionExit;
uniform vec4  transitionScale;
uniform vec4  transitionBias;
uniform float transitionSkew;
uniform float transitionActive;

uniform vec4  moveFrom;
uniform vec4  moveTo;

float ease(float t) {
  t = clamp(t, 0.0, 1.0);
  return 1.0 - (2.0 - t) * t;
}

vec4 getTransitionPosition(vec4 xyzw, inout vec4 stpq) {
  if (transitionActive < 0.5) return xyzw;

  float enter   = transitionEnter;
  float exit    = transitionExit;
  float skew    = transitionSkew;
  vec4  scale   = transitionScale;
  vec4  bias    = transitionBias;

  float factor  = 1.0 + skew;
  float offset  = dot(vec4(1.0), stpq * scale + bias);

  float a1 = ease(enter * factor - offset);
  float a2 = ease(exit  * factor + offset - skew);

  return xyzw + a1 * moveFrom + a2 * moveTo;
}`,yGt=`vec4 getMask(vec4 xyzw) {
  return vec4(1.0);
}`,xGt=`varying float vPixelSize;

float getDiscAlpha(float mask) {
  // Approximation: 1 - x*x is approximately linear around x = 1 with slope 2
  return vPixelSize * (1.0 - mask);
  //  return vPixelSize * 2.0 * (1.0 - sqrt(mask));
}
`,wGt=`varying float vPixelSize;

float getDiscHollowAlpha(float mask) {
  return vPixelSize * (0.5 - 2.0 * abs(sqrt(mask) - .75));
}
`,SGt=`varying float vPixelSize;

float getGenericAlpha(float mask) {
  return vPixelSize * 2.0 * (1.0 - mask);
}
`,MGt=`varying float vPixelSize;

float getGenericHollowAlpha(float mask) {
  return vPixelSize * (0.5 - 2.0 * abs(mask - .75));
}
`,CGt=`varying vec2 vSprite;

float getSpriteMask(vec2 xy);
float getSpriteAlpha(float mask);

void setFragmentColorFill(vec4 color) {
  float mask = getSpriteMask(vSprite);
  if (mask > 1.0) {
    discard;
  }
  float alpha = getSpriteAlpha(mask);
  if (alpha >= 1.0) {
    discard;
  }
  gl_FragColor = vec4(color.rgb, alpha * color.a);
}
`,EGt=`varying vec2 vSprite;

float getSpriteMask(vec2 xy);
float getSpriteAlpha(float mask);

void setFragmentColorFill(vec4 color) {
  float mask = getSpriteMask(vSprite);
  if (mask > 1.0) {
    discard;
  }
  float alpha = getSpriteAlpha(mask);
  if (alpha < 1.0) {
    discard;
  }
  gl_FragColor = color;
}

`,TGt=`varying float vPixelSize;

float getCircleMask(vec2 uv) {
  return dot(uv, uv);
}
`,AGt=`varying float vPixelSize;

float getDiamondMask(vec2 uv) {
  vec2 a = abs(uv);
  return a.x + a.y;
}
`,PGt=`varying float vPixelSize;

float getTriangleDownMask(vec2 uv) {
  uv.y += .25;
  return max(uv.y, abs(uv.x) * .866 - uv.y * .5 + .6);
}
`,RGt=`varying float vPixelSize;

float getTriangleLeftMask(vec2 uv) {
  uv.x += .25;
  return max(uv.x, abs(uv.y) * .866 - uv.x * .5 + .6);
}
`,kGt=`varying float vPixelSize;

float getTriangleRightMask(vec2 uv) {
  uv.x -= .25;
  return max(-uv.x, abs(uv.y) * .866 + uv.x * .5 + .6);
}
`,LGt=`varying float vPixelSize;

float getSquareMask(vec2 uv) {
  vec2 a = abs(uv);
  return max(a.x, a.y);
}
`,OGt=`varying float vPixelSize;

float getTriangleUpMask(vec2 uv) {
  uv.y -= .25;
  return max(-uv.y, abs(uv.x) * .866 + uv.y * .5 + .6);
}
`,DGt=`uniform float pointDepth;

uniform float pixelUnit;
uniform float renderScale;
uniform float renderScaleInv;
uniform float focusDepth;

uniform vec4 geometryClip;
attribute vec4 position4;
attribute vec2 sprite;

varying vec2 vSprite;
varying float vPixelSize;

const float pointScale = POINT_SHAPE_SCALE;

// External
float getPointSize(vec4 xyzw);
vec3 getPosition(vec4 xyzw, float canonical);

vec3 getPointPosition() {
  // Discard out-of-range points by generating degenerate face
  if (
    position4.x > geometryClip.x ||
    position4.y > geometryClip.y ||
    position4.z > geometryClip.z ||
    position4.w > geometryClip.w
  ) return vec3(0.0, 0.0, 0.0);
  vec4 p = position4;

  vec3 center = getPosition(p, 1.0);

  // Depth blending
  // TODO: orthographic camera
  // Workaround: set depth = 0
  float z = -center.z;
  float depth = mix(z, focusDepth, pointDepth);

  // Match device/unit mapping
  // Sprite goes from -1..1, width = 2.
  float pointSize = getPointSize(p);
  float size = pointScale * pointSize * pixelUnit * .5;
  float depthSize = depth * size;

  // Pad sprite by half a pixel to make the anti-aliasing straddle the pixel edge
  // Note: pixelsize measures radius
  float pixelSize = .5 * (pointDepth > 0.0 ? depthSize / z : size);
  float paddedSize = pixelSize + 0.5;
  float padFactor = paddedSize / pixelSize;

  vPixelSize = paddedSize;
  vSprite    = sprite;

  return center + vec3(sprite * depthSize * renderScaleInv * padFactor, 0.0);
}
`,IGt=`uniform float pointSize;

float getPointSize(vec4 xyzw) {
  return pointSize;
}`,NGt=`uniform float pointSize;

vec4 getSample(vec4 xyzw);

float getPointSize(vec4 xyzw) {
  return pointSize * getSample(xyzw).x;
}`,zGt=`uniform float polarBend;
uniform float polarFocus;
uniform float polarAspect;
uniform float polarHelix;

uniform mat4 viewMatrix;

vec4 getPolarPosition(vec4 position, inout vec4 stpq) {
  if (polarBend > 0.0) {

    if (polarBend < 0.001) {
      // Factor out large addition/subtraction of polarFocus
      // to avoid numerical error
      // sin(x) ~ x
      // cos(x) ~ 1 - x * x / 2
      vec2 pb = position.xy * polarBend;
      float ppbbx = pb.x * pb.x;
      return viewMatrix * vec4(
        position.x * (1.0 - polarBend + (pb.y * polarAspect)),
        position.y * (1.0 - .5 * ppbbx) - (.5 * ppbbx) * polarFocus / polarAspect,
        position.z + position.x * polarHelix * polarBend,
        1.0
      );
    }
    else {
      vec2 xy = position.xy * vec2(polarBend, polarAspect);
      float radius = polarFocus + xy.y;
      return viewMatrix * vec4(
        sin(xy.x) * radius,
        (cos(xy.x) * radius - polarFocus) / polarAspect,
        position.z + position.x * polarHelix * polarBend,
        1.0
      );
    }
  }
  else {
    return viewMatrix * vec4(position.xyz, 1.0);
  }
}`,UGt=`uniform float styleZBias;
uniform float styleZIndex;

void setPosition(vec3 position) {

  #ifdef PROJECT_ORTHOGONAL
  // Orthogonal projection with depth preservation around z = 1
  vec4 pos = projectionMatrix * vec4(position, 1.0);
  pos.xy *= -position.z;
  #else
  // Normal perspective projection
  vec4 pos = projectionMatrix * vec4(position, 1.0);
  #endif

  // Apply relative Z bias
  float bias  = (1.0 - styleZBias / 32768.0);
  pos.z *= bias;

  // Apply large scale Z index changes
  if (styleZIndex > 0.0) {
    float z = pos.z / pos.w;
    pos.z = ((z + 1.0) / (styleZIndex + 1.0) - 1.0) * pos.w;
  }

  gl_Position = pos;
}`,FGt=`// This is three.js' global uniform, missing from fragment shaders.
uniform mat4 projectionMatrix;

vec4 readbackPosition(vec3 position, vec4 stpq) {
  vec4 pos = projectionMatrix * vec4(position, 1.0);
  vec3 final = pos.xyz / pos.w;
  if (final.z < -1.0) {
    return vec4(0.0, 0.0, 0.0, -1.0);
  }
  else {
    return vec4(final, -position.z);
  }
}
`,VGt=`uniform vec4 geometryScale;
attribute vec4 position4;

vec4 getRawPositionScale() {
  return geometryScale * position4;
}
`,BGt=`uniform vec4 repeatModulus;

vec4 getRepeatXYZW(vec4 xyzw) {
  return mod(xyzw + .5, repeatModulus) - .5;
}
`,HGt=`uniform vec4 resampleBias;

vec4 resamplePadding(vec4 xyzw) {
  return xyzw + resampleBias;
}`,$Gt=`uniform vec4 resampleFactor;

vec4 resampleRelative(vec4 xyzw) {
  return xyzw * resampleFactor;
}`,GGt=`uniform float transitionEnter;
uniform float transitionExit;
uniform vec4  transitionScale;
uniform vec4  transitionBias;
uniform float transitionSkew;
uniform float transitionActive;

float getTransitionSDFMask(vec4 stpq) {
  if (transitionActive < 0.5) return 1.0;

  float enter   = transitionEnter;
  float exit    = transitionExit;
  float skew    = transitionSkew;
  vec4  scale   = transitionScale;
  vec4  bias    = transitionBias;

  float factor  = 1.0 + skew;
  float offset  = dot(vec4(1.0), stpq * scale + bias);

  vec2 d = vec2(enter, exit) * factor + vec2(-offset, offset - skew);
  if (exit  == 1.0) return d.x;
  if (enter == 1.0) return d.y;
  return min(d.x, d.y);
}`,qGt=`uniform vec4 reverseScale;
uniform vec4 reverseOffset;

vec4 getReverseOffset(vec4 xyzw) {
  return xyzw * reverseScale + reverseOffset;
}`,WGt=`vec3 getRootPosition(vec4 position, in vec4 stpqIn, out vec4 stpqOut) {
  stpqOut = stpqIn; // avoid inout confusion
  return position.xyz;
}`,jGt=`uniform sampler2D dataTexture;

vec4 sample2D(vec2 uv) {
  return texture2D(dataTexture, uv);
}
`,XGt=`uniform vec4 scaleAxis;
uniform vec4 scaleOffset;

vec4 sampleData(float x);

vec4 getScalePosition(vec4 xyzw) {
  return scaleAxis * sampleData(xyzw.x).x + scaleOffset;
}
`,YGt=`uniform vec4 remapSTPQScale;

vec4 screenMapSTPQ(vec4 xyzw, out vec4 stpq) {
  stpq = xyzw * remapSTPQScale;
  return xyzw;
}
`,KGt=`uniform vec2 remapUVScale;

vec4 screenMapXY(vec4 uvwo, vec4 stpq) {
  return vec4(floor(remapUVScale * uvwo.xy), 0.0, 0.0);
}
`,ZGt=`uniform vec2 remapUVScale;
uniform vec2 remapModulus;
uniform vec2 remapModulusInv;

vec4 screenMapXYZW(vec4 uvwo, vec4 stpq) {
  vec2 st = floor(remapUVScale * uvwo.xy);
  vec2 xy = st * remapModulusInv;
  vec2 ixy = floor(xy);
  vec2 fxy = xy - ixy;
  vec2 zw = fxy * remapModulus;
  return vec4(ixy.x, zw.y, ixy.y, zw.x);
}
`,JGt=`vec2 screenPassUV(vec4 uvwo, vec4 stpq) {
  return uvwo.xy;
}
`,QGt=`void setScreenPosition(vec4 position) {
  gl_Position = vec4(position.xy * 2.0 - 1.0, 0.5, 1.0);
}
`,tqt=`uniform vec4 sliceOffset;

vec4 getSliceOffset(vec4 xyzw) {
  return xyzw + sliceOffset;
}
`,eqt=`uniform float sphericalBend;
uniform float sphericalFocus;
uniform float sphericalAspectX;
uniform float sphericalAspectY;
uniform float sphericalScaleY;

uniform mat4 viewMatrix;

vec4 getSphericalPosition(vec4 position, inout vec4 stpq) {
  if (sphericalBend > 0.0001) {

    vec3 xyz = position.xyz * vec3(sphericalBend, sphericalBend / sphericalAspectY * sphericalScaleY, sphericalAspectX);
    float radius = sphericalFocus + xyz.z;
    float cosine = cos(xyz.y) * radius;

    return viewMatrix * vec4(
      sin(xyz.x) * cosine,
      sin(xyz.y) * radius * sphericalAspectY,
      (cos(xyz.x) * cosine - sphericalFocus) / sphericalAspectX,
      1.0
    );
  }
  else {
    return viewMatrix * vec4(position.xyz, 1.0);
  }
}`,nqt=`uniform float splitStride;

vec2 getIndices(vec4 xyzw);
vec4 getRest(vec4 xyzw);
vec4 injectIndex(float v);

vec4 getSplitXYZW(vec4 xyzw) {
  vec2 uv = getIndices(xyzw);
  float offset = uv.x + uv.y * splitStride;
  return injectIndex(offset) + getRest(xyzw);
}
`,iqt=`uniform vec4 spreadOffset;
uniform mat4 spreadMatrix;

// External
vec4 getSample(vec4 xyzw);

vec4 getSpreadSample(vec4 xyzw) {
  vec4 sample = getSample(xyzw);
  return sample + spreadMatrix * (spreadOffset + xyzw);
}
`,rqt=`varying vec2 vSprite;

vec4 getSample(vec2 xy);

vec4 getSpriteColor() {
  return getSample(vSprite);
}`,sqt=`uniform vec2 spriteOffset;
uniform float spriteScale;
uniform float spriteDepth;
uniform float spriteSnap;

uniform vec2 renderOdd;
uniform float renderScale;
uniform float renderScaleInv;
uniform float pixelUnit;
uniform float focusDepth;

uniform vec4 geometryClip;
attribute vec4 position4;
attribute vec2 sprite;

varying float vPixelSize;

// External
vec3 getPosition(vec4 xyzw, float canonical);
vec4 getSprite(vec4 xyzw);

vec3 getSpritePosition() {
  // Clip points
  vec4 p = min(geometryClip, position4);
  float diff = length(position4 - p);
  if (diff > 0.0) {
    return vec3(0.0, 0.0, 1000.0);
  }

  // Make sprites
  vec3 center = getPosition(p, 1.0);
  vec4 atlas = getSprite(p);

  // Sprite goes from -1..1, width = 2.
  // -1..1 -> -0.5..0.5
  vec2 halfSprite = sprite * .5;
  vec2 halfFlipSprite = vec2(halfSprite.x, -halfSprite.y);

#ifdef POSITION_UV
  // Assign UVs
  vUV = atlas.xy + atlas.zw * (halfFlipSprite + .5);
#endif

  // Depth blending
  // TODO: orthographic camera
  // Workaround: set depth = 0
  float depth = focusDepth, z;
  z = -center.z;
  if (spriteDepth < 1.0) {
    depth = mix(z, focusDepth, spriteDepth);
  }
  
  // Match device/unit mapping 
  float size = pixelUnit * spriteScale;
  float depthSize = depth * size;

  // Calculate pixelSize for anti-aliasing
  float pixelSize = (spriteDepth > 0.0 ? depthSize / z : size);
  vPixelSize = pixelSize;

  // Position sprite
  vec2 atlasOdd = fract(atlas.zw / 2.0);
  vec2 offset = (spriteOffset + halfSprite * atlas.zw) * depthSize;
  if (spriteSnap > 0.5) {
    // Snap to pixel (w/ epsilon shift to avoid jitter)
    return vec3(((floor(center.xy / center.z * renderScale + 0.001) + renderOdd + atlasOdd) * center.z + offset) * renderScaleInv, center.z);
  }
  else {
    // Place directly
    return center + vec3(offset * renderScaleInv, 0.0);
  }

}
`,oqt=`uniform float stereoBend;
uniform vec4 basisScale;
uniform vec4 basisOffset;
uniform mat4 viewMatrix;
uniform vec2 view4D;

vec4 getStereographic4Position(vec4 position, inout vec4 stpq) {
  
  vec4 transformed;
  if (stereoBend > 0.0001) {

    float r = length(position);
    float w = r + position.w;
    vec4 project = vec4(position.xyz / w, r);
    
    transformed = mix(position, project, stereoBend);
  }
  else {
    transformed = position;
  }

  vec4 pos4 = transformed * basisScale - basisOffset;
  vec3 xyz = (viewMatrix * vec4(pos4.xyz, 1.0)).xyz;
  return vec4(xyz, pos4.w * view4D.y + view4D.x);
}
`,aqt=`uniform float stereoBend;

uniform mat4 viewMatrix;

vec4 getStereoPosition(vec4 position, inout vec4 stpq) {
  if (stereoBend > 0.0001) {

    vec3 pos = position.xyz;
    float r = length(pos);
    float z = r + pos.z;
    vec3 project = vec3(pos.xy / z, r);
    
    vec3 lerped = mix(pos, project, stereoBend);

    return viewMatrix * vec4(lerped, 1.0);
  }
  else {
    return viewMatrix * vec4(position.xyz, 1.0);
  }
}`,lqt=`varying vec2 vST;

vec4 getSample(vec2 st);

vec4 getSTSample() {
  return getSample(vST);
}
`,cqt=`varying vec2 vUV;

void setRawUV(vec4 xyzw) {
  vUV = xyzw.xy;
}
`,uqt=`uniform vec4 geometryClip;
attribute vec4 position4;
attribute vec3 strip;

// External
vec3 getPosition(vec4 xyzw, float canonical);

varying vec3 vNormal;
varying vec3 vLight;
varying vec3 vPosition;

void getStripGeometry(vec4 xyzw, vec3 strip, out vec3 pos, out vec3 normal) {
  vec3 a, b, c;

  a   = getPosition(xyzw, 1.0);
  b   = getPosition(vec4(xyzw.xyz, strip.x), 0.0);
  c   = getPosition(vec4(xyzw.xyz, strip.y), 0.0);

  normal = normalize(cross(c - a, b - a)) * strip.z;
  
  pos = a;
}

vec3 getStripPositionNormal() {
  vec3 center, normal;

  vec4 p = min(geometryClip, position4);

  getStripGeometry(p, strip, center, normal);
  vNormal   = normal;
  vLight    = normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz);
  vPosition = -center;

  return center;
}
`,hqt=`uniform vec3 styleColor;
uniform float styleOpacity;

vec4 getStyleColor() {
  return vec4(styleColor, styleOpacity);
}
`,dqt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideDepth(vec4 xyzw) {
  float x = xyzw.z;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  return sampleData(vec4(xyzw.xy, i + g, xyzw.w));
}
`,pqt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideDepthLerp(vec4 xyzw) {
  float x = xyzw.z;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  vec4 xyzw1 = vec4(xyzw.xy, i, xyzw.w);
  vec4 xyzw2 = vec4(xyzw.xy, i + 1.0, xyzw.w);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, g);
}
`,fqt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideHeight(vec4 xyzw) {
  float x = xyzw.y;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  return sampleData(vec4(xyzw.x, i + g, xyzw.zw));
}
`,mqt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideHeightLerp(vec4 xyzw) {
  float x = xyzw.y;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  vec4 xyzw1 = vec4(xyzw.x, i, xyzw.zw);
  vec4 xyzw2 = vec4(xyzw.x, i + 1.0, xyzw.zw);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, g);
}
`,gqt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideItems(vec4 xyzw) {
  float x = xyzw.w;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  return sampleData(vec4(xyzw.xyz, i + g));
}
`,vqt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideItemsLerp(vec4 xyzw) {
  float x = xyzw.w;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  vec4 xyzw1 = vec4(xyzw.xyz, i);
  vec4 xyzw2 = vec4(xyzw.xyz, i + 1.0);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, g);
}
`,_qt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideWidth(vec4 xyzw) {
  float x = xyzw.x;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  return sampleData(vec4(i + g, xyzw.yzw));
}
`,bqt=`uniform float subdivideBevel;

// External
vec4 sampleData(vec4 xyzw);

vec4 subdivideWidthLerp(vec4 xyzw) {
  float x = xyzw.x;
  float i = floor(x);
  float f = x - i;

  float minf = subdivideBevel * min(f, 1.0 - f);
  float g = (f > 0.5) ? 1.0 - minf : (f < 0.5) ? minf : 0.5;

  vec4 xyzw1 = vec4(i, xyzw.yzw);
  vec4 xyzw2 = vec4(i + 1.0, xyzw.yzw);
  
  vec4 a = sampleData(xyzw1);
  vec4 b = sampleData(xyzw2);

  return mix(a, b, g);
}
`,yqt=`attribute vec4 position4;

float getSurfaceHollowMask(vec4 xyzw) {
  vec4 df = abs(fract(position4) - .5);
  vec2 df2 = min(df.xy, df.zw);
  float df3 = min(df2.x, df2.y);
  return df3;
}`,xqt=`uniform vec4 geometryClip;
uniform vec4 geometryResolution;
uniform vec4 mapSize;

attribute vec4 position4;

// External
vec3 getPosition(vec4 xyzw, float canonical);

vec3 getSurfacePosition() {
  vec4 p = min(geometryClip, position4);

#ifdef SURFACE_CLOSED_X
  if (p.x == geometryClip.x) p.x = 0.0;
#endif
#ifdef SURFACE_CLOSED_Y
  if (p.y == geometryClip.y) p.y = 0.0;
#endif

  vec3 xyz = getPosition(p, 1.0);

  // Overwrite UVs
#ifdef POSITION_UV
#ifdef POSITION_UV_INT
  vUV = -.5 + (position4.xy * geometryResolution.xy) * mapSize.xy;
#else
  vUV = position4.xy * geometryResolution.xy;
#endif
#endif

  return xyz;
}
`,wqt=`uniform vec4 mapSize;
uniform vec4 geometryResolution;
uniform vec4 geometryClip;
attribute vec4 position4;

// External
vec3 getPosition(vec4 xyzw, float canonical);
vec3 getNormal(vec4 xyzw);

varying vec3 vNormal;
varying vec3 vLight;
varying vec3 vPosition;

vec3 getSurfacePositionNormal() {

  vec4 p = min(geometryClip, position4);
#ifdef SURFACE_CLOSED_X
  if (p.x == geometryClip.x) p.x = 0.0;
#endif
#ifdef SURFACE_CLOSED_Y
  if (p.y == geometryClip.y) p.y = 0.0;
#endif

  vec3 center = getPosition(p, 1.0);
  vNormal     = normalMatrix * normalize(getNormal(p));
  vLight      = normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz); // hardcoded directional light
  vPosition   = -center;

#ifdef POSITION_UV
#ifdef POSITION_UV_INT
  vUV = -.5 + (position4.xy * geometryResolution.xy) * mapSize.xy;
#else
  vUV = position4.xy * geometryResolution.xy;
#endif
#endif

  return center;
}
`,Sqt=`uniform vec4 mapSize;
uniform vec4 geometryResolution;
uniform vec4 geometryClip;
attribute vec4 position4;

// External
vec3 getPosition(vec4 xyzw, float canonical);

vec4 wrapAround(vec4 xyzw) {
#ifdef SURFACE_CLOSED_X
  float gx = geometryClip.x;
  if (xyzw.x < 0.0) xyzw.x += gx;
  if (xyzw.x >= gx) xyzw.x -= gx;
#endif
#ifdef SURFACE_CLOSED_Y
  float gy = geometryClip.y;
  if (xyzw.y < 0.0) xyzw.y += gy;
  if (xyzw.y >= gy) xyzw.y -= gy;
#endif
  return xyzw;
}

void getSurfaceGeometry(vec4 xyzw, float edgeX, float edgeY, out vec3 left, out vec3 center, out vec3 right, out vec3 up, out vec3 down) {
  vec4 deltaX = vec4(1.0, 0.0, 0.0, 0.0);
  vec4 deltaY = vec4(0.0, 1.0, 0.0, 0.0);

  center =                  getPosition(xyzw, 1.0);
  left   =                  center;
  down   =                  center;
  right  = (edgeX < 0.5)  ? getPosition(wrapAround(xyzw + deltaX), 0.0) : (2.0 * center - getPosition(xyzw - deltaX, 0.0));
  up     = (edgeY < 0.5)  ? getPosition(wrapAround(xyzw + deltaY), 0.0) : (2.0 * center - getPosition(xyzw - deltaY, 0.0));
}

vec3 getSurfaceNormal(vec3 left, vec3 center, vec3 right, vec3 up, vec3 down) {
  vec3 dx = right - left;
  vec3 dy = up    - down;
  vec3 n = cross(dy, dx);
  if (length(n) > 0.0) {
    return normalize(n);
  }
  return vec3(0.0, 1.0, 0.0);
}

varying vec3 vNormal;
varying vec3 vLight;
varying vec3 vPosition;

vec3 getSurfacePositionShaded() {
  vec3 left, center, right, up, down;

  vec4 p = min(geometryClip, position4);
  vec2 surface = vec2(0.0);
#ifdef SURFACE_CLOSED_X
  if (p.x == geometryClip.x) p.x = 0.0;
#else
  if (p.x == geometryClip.x) surface.x = 1.0;
  //if (p.x == 0.0) surface.x = -1.0;
#endif
#ifdef SURFACE_CLOSED_Y
  if (p.y == geometryClip.y) p.y = 0.0;
#else
  if (p.y == geometryClip.y) surface.y = 1.0;
  //if (p.y == 0.0) surface.y = -1.0;
#endif

  getSurfaceGeometry(p, surface.x, surface.y, left, center, right, up, down);
  vNormal   = getSurfaceNormal(left, center, right, up, down);
  vLight    = normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz); // hardcoded directional light
  vPosition = -center;

#ifdef POSITION_UV
#ifdef POSITION_UV_INT
  vUV = -.5 + (position4.xy * geometryResolution.xy) * mapSize.xy;
#else
  vUV = position4.xy * geometryResolution.xy;
#endif
#endif

  return center;
}
`,Mqt=`uniform float worldUnit;
uniform float focusDepth;
uniform float tickSize;
uniform float tickEpsilon;
uniform vec3  tickNormal;
uniform vec2  tickStrip;

vec4 getSample(vec4 xyzw);

vec3 transformPosition(vec4 position, in vec4 stpqIn, out vec4 stpqOut);

vec3 getTickPosition(vec4 xyzw, in vec4 stpqIn, out vec4 stpqOut) {
  float epsilon = tickEpsilon;

  // determine tick direction
  float leftX  = max(tickStrip.x, xyzw.y - 1.0);
  float rightX = min(tickStrip.y, xyzw.y + 1.0);
  
  vec4 left    = getSample(vec4(leftX,  xyzw.zw, 0.0));
  vec4 right   = getSample(vec4(rightX, xyzw.zw, 0.0));
  vec4 diff    = right - left;

  vec3 normal  = cross(normalize(diff.xyz + vec3(diff.w)), tickNormal);
  float bias   = max(0.0, 1.0 - length(normal) * 2.0);
       normal  = mix(normal, tickNormal.yzx, bias * bias);
  
  // transform (point) and (point + delta)
  vec4 center  = getSample(vec4(xyzw.yzw, 0.0));
  vec4 delta   = vec4(normal, 0.0) * epsilon;

  vec4 a = center;
  vec4 b = center + delta;

  vec4 _;
  vec3 c = transformPosition(a, stpqIn, stpqOut);
  vec3 d = transformPosition(b, stpqIn, _);
  
  // sample on either side to create line
  float line = xyzw.x - .5;
  vec3  mid  = c;
  vec3  side = normalize(d - c);

  return mid + side * line * tickSize * worldUnit * focusDepth;
}
`,Cqt=`uniform mat4 transformMatrix;

vec4 transformPosition(vec4 position, inout vec4 stpq) {
  return transformMatrix * vec4(position.xyz, 1.0);
}
`,Eqt=`uniform mat4 transformMatrix;
uniform vec4 transformOffset;

vec4 transformPosition(vec4 position, inout vec4 stpq) {
  return transformMatrix * position + transformOffset;
}
`,Tqt=`// Implicit three.js uniform
// uniform mat4 viewMatrix;

vec4 getViewPosition(vec4 position, inout vec4 stpq) {
  return (viewMatrix * vec4(position.xyz, 1.0));
}
`;let Us=class mC{static initClass(){this.index=0,this.IN=0,this.OUT=1}static id(t){return++mC.index}constructor(t,e=null){this.parent=e,this.id=mC.id(),this.nodes=[],t&&this.add(t)}inputs(){const t=[];for(const e of Array.from(this.nodes))for(const n of Array.from(e.inputs))n.input===null&&t.push(n);return t}outputs(){const t=[];for(const e of Array.from(this.nodes))for(const n of Array.from(e.outputs))n.output.length===0&&t.push(n);return t}getIn(t){return Array.from(this.inputs()).filter(e=>e.name===t)[0]}getOut(t){return Array.from(this.outputs()).filter(e=>e.name===t)[0]}add(t,e){if(t.length){for(const n of Array.from(t))this.add(n);return}if(t.graph&&!e)throw new Error("Adding node to two graphs at once");t.graph=this,this.nodes.push(t)}remove(t,e){if(t.length){for(const n of Array.from(t))this.remove(n);return}if(t.graph!==this)throw new Error("Removing node from wrong graph.");e||t.disconnect(),this.nodes.splice(this.nodes.indexOf(t),1),t.graph=null}adopt(t){if(t.length){for(const e of Array.from(t))this.adopt(e);return}t.graph.remove(t,!0),this.add(t,!0)}};Us.initClass();class ko{static initClass(){this.index=0}static make(t,e){e==null&&(e={});const n=e;if(t.meta!=null)for(const r in t.meta){const s=t.meta[r];n[r]=s}return new ko(t.inout,t.name,t.hint,t.type,n)}static id(t){return`_io_${++ko.index}_${t}`}static hint(t){return t=t.replace(/^_io_[0-9]+_/,""),t=t.replace(/_i_o$/,""),t=t.replace(/(In|Out|Inout|InOut)$/,"")}constructor(t,e,n,r,s,o){this.inout=t,this.name=e,this.hint=n,this.type=r,s==null&&(s={}),this.meta=s,this.id=o,this.hint==null&&(this.hint=ko.hint(this.name)),this.node=null,this.input=null,this.output=[],this.id==null&&(this.id=ko.id(this.hint))}morph(t){return this.inout=t.inout,this.name=t.name,this.hint=t.hint,this.type=t.type,this.meta=t.meta}dupe(t){t==null&&(t=this.id);const e=ko.make(this);return e.name=t,e}connect(t){if(this.inout===Us.IN&&t.inout===Us.OUT)return t.connect(this);if(this.inout!==Us.OUT||t.inout!==Us.IN)throw new Error("Can only connect out to in.");if(t.input!==this)return t.disconnect(),t.input=this,this.output.push(t)}disconnect(t){if(this.input&&this.input.disconnect(this),this.output.length)if(t){const e=this.output.indexOf(t);if(e>=0)return this.output.splice(e,1),t.input=null}else{for(t of Array.from(this.output))t.input=null;return this.output=[]}}}ko.initClass();let BT=class gC{static initClass(){this.index=0}static id(t){return++gC.index}constructor(t,e){this.owner=t,this.graph=null,this.inputs=[],this.outputs=[],this.all=[],this.outlets=null,this.id=gC.id(),this.setOutlets(e)}getIn(t){return Array.from(this.inputs).filter(e=>e.name===t)[0]}getOut(t){return Array.from(this.outputs).filter(e=>e.name===t)[0]}get(t){return this.getIn(t)||this.getOut(t)}setOutlets(t){if(t!=null){let e;if(this.outlets==null){this.outlets={};for(e of Array.from(t))e instanceof ko||(e=ko.make(e)),this._add(e);return}const n=s=>[s.name,s.inout,s.type].join("-"),r={};for(e of Array.from(t))r[n(e)]=!0;for(let s in this.outlets)e=this.outlets[s],s=n(e),r[s]?r[s]=e:this._remove(e);for(e of Array.from(t)){const s=r[n(e)];s instanceof ko?this._morph(s,e):(e instanceof ko||(e=ko.make(e)),this._add(e))}}return this.outlets}connect(t,e,n){let r,s,o,a,l;const c={},u={},h=m=>l+"/"+m.hint;for(r of Array.from(t.inputs)){let m;!n&&r.input||({type:l}=r,o=h(r),u[o]||(u[o]=r),c[l]=m=c[l]||[],m.push(r))}let p=this.outputs;p=p.filter(m=>!(e&&m.output.length));for(a of Array.from(p.slice()))({type:l}=a),o=h(a),s=c[l],(r=u[o])&&(a.connect(r),delete u[o],s.splice(s.indexOf(r),1),p.splice(p.indexOf(a),1));if(!p.length)return this;for(a of Array.from(p.slice()))({type:l}=a),s=c[l],s&&s.length&&a.connect(s.shift());return this}disconnect(t){let e;for(e of Array.from(this.inputs))e.disconnect();for(e of Array.from(this.outputs))e.disconnect();return this}_key(t){return[t.name,t.inout].join("-")}_add(t){const e=this._key(t);if(t.node)throw new Error("Adding outlet to two nodes at once.");if(this.outlets[e])throw new Error(`Adding two identical outlets to same node. (${e})`);return t.node=this,t.inout===Us.IN&&this.inputs.push(t),t.inout===Us.OUT&&this.outputs.push(t),this.all.push(t),this.outlets[e]=t}_morph(t,e){let n=this._key(e);return delete this.outlets[n],t.morph(e),n=this._key(e),this.outlets[n]=e}_remove(t){const e=this._key(t);if(t.node!==this)throw new Error("Removing outlet from wrong node.");return t.disconnect(),t.node=null,delete this.outlets[e],t.inout===Us.IN&&this.inputs.splice(this.inputs.indexOf(t),1),t.inout===Us.OUT&&this.outputs.splice(this.outputs.indexOf(t),1),this.all.splice(this.all.indexOf(t),1),this}};BT.initClass();const{IN:iv,OUT:HT}=Us,Aqt=Object.freeze(Object.defineProperty({__proto__:null,Graph:Us,IN:iv,Node:BT,OUT:HT,Outlet:ko},Symbol.toStringTag,{value:"Module"}));let Iv=class mg{static initClass(){this.index=0}static namespace(){return`_sn_${++mg.index}_`}static load(t,e,n){const r=t.parse(e,n),[s,o]=Array.from(t.compile(r));return new mg(t,s,o,e,n)}constructor(t,e,n,r,s){this.language=t,this._signatures=e,this._compiler=n,this._name=r,this._original=s,this.namespace=null,this.code=null,this.main=null,this.entry=null,this.uniforms=null,this.externals=null,this.symbols=null,this.attributes=null,this.varyings=null,this.language||delete this.language,this._signatures||delete this._signatures,this._compiler||delete this._compiler,this._original||delete this._original,this._name||(this._name=this._signatures!=null?this._signatures.main.name:void 0)}clone(){return new mg(this.language,this._signatures,this._compiler,this._name,this._original)}bind(t,e,n,r){let s,o,a;e===""+e?[n,e,r]=Array.from([e,n??{},r??{}]):n!==""+n&&([r,n]=Array.from([n??{},void 0])),this.main=this._signatures.main,this.namespace=(o=n??this.namespace)!=null?o:mg.namespace(),this.entry=this.namespace+this.main.name,this.uniforms={},this.varyings={},this.attributes={},this.externals={},this.symbols=[];const l={},c={},u=function(A){return c[A]=!0,A},h=A=>this.namespace+A;if(t.globals)for(const A of Array.from(t.globals))u(A);const p=t.globalUniforms?u:h,m=t.globalVaryings?u:h,v=t.globalAttributes?u:h,_=h,b=A=>l[A.name]=!0,y=(A,R)=>this.uniforms[p(R??A.name)]=A;a=A=>this.varyings[m(A.name)]=A;const M=A=>this.attributes[v(A.name)]=A,S=A=>{const R=_(A.name);return this.externals[R]=A,this.symbols.push(R)},E=A=>({type:A.type,name:A.name,value:A.value});for(s of Array.from(this._signatures.uniform))b(s);for(s of Array.from(this._signatures.uniform))y(E(s));for(s of Array.from(this._signatures.varying))a(E(s));for(s of Array.from(this._signatures.external))S(s);for(s of Array.from(this._signatures.attribute))M(E(s));for(const A in e)s=e[A],l[A]&&y(s,A);if(this.body=this.code=this._compiler(this.namespace,c,r),r){const A=(()=>{const R=[];for(const O in r)a=r[O],R.push(`#define ${O} ${a}`);return R})().join(`
`);A.length&&(this._original=[A,"//----------------------------------------",this._original].join(`
`))}return null}};Iv.initClass();var Gl={};(function(i){i.make=function(t){return t==null&&(t=[]),t instanceof Array||(t=[+t!=null?+t:0]),t},i.nest=(t,e)=>t.concat(e),i.compare=function(t,e){const n=Math.min(t.length,e.length);for(let r=0,s=n,o=0<=s;o?r<s:r>s;o?r++:r--){const a=t[r],l=e[r];if(a>l)return-1;if(a<l)return 1}return t=t.length,e=e.length,t>e?-1:t<e?1:0},i.max=function(t,e){return i.compare(t,e)>0?e:t}})(Gl);const yU=function(i,t,e,n){const r=i,s={},o=[],a={},l={},c={},u={},h=function(){let M,S;for(S in n){const L=n[S];_(L.node,L.module)}[M,e]=Array.from(p(e)),t!=null&&(M.entry=t);const E=r.build(M,e),R=(()=>{const L=[];for(S in u){const P=u[S];L.push(P)}return L})().sort((L,P)=>Gl.compare(L.priority,P.priority)).map(L=>L.code);R.push(E.code);const O=r.lines(R);return{namespace:E.name,library:u,body:E.code,code:O,main:E,entry:E.name,symbols:o,externals:s,uniforms:a,varyings:l,attributes:c}},p=M=>{let S;M=(()=>{const R=[];for(const O in M)S=M[O],R.push(S);return R})(),M.sort((R,O)=>O.priority-R.priority);const E=(R,O,L)=>{v(R,O,L);const{main:P}=O,{entry:D}=O,V=W=>y(R,W),K=W=>b(R,W);return r.call(V,K,D,P.signature,A)},A=r.body();for(S of Array.from(M))E(S.node,S.module,S.priority);return[A,M]},m=function(M,S,E){const A=u[M];return A!=null?A.priority=Gl.max(A.priority,E):u[M]={code:S,priority:E}},v=function(M,S,E){let A,R;E=Gl.make(E);for(const O in S.library){const L=S.library[O];m(O,L.code,Gl.nest(E,L.priority))}m(S.namespace,S.body,E);for(R in S.uniforms)A=S.uniforms[R],a[R]=A;for(R in S.varyings)A=S.varyings[R],l[R]=A;for(R in S.attributes)A=S.attributes[R],c[R]=A;return _(M,S)},_=(M,S)=>(()=>{const E=[];for(const A of Array.from(S.symbols)){const R=S.externals[A];if(b(M,R.name)){const O={};for(const L in R){const P=R[L];O[L]=P}O.name=y(M,R.name),s[A]=O,E.push(o.push(A))}else E.push(void 0)}return E})(),b=function(M,S){const E=M.get(S);if(E.inout===iv)return E.input===null;if(E.inout===HT)return E.output.length===0},y=function(M,S){let E=M.get(S);return E?(E.input&&(E=E.input),{name:S}=E,E.id):null};return h()};class Xu{static initClass(){this.index=0}static entry(){return`_pg_${++Xu.index}_`}constructor(t,e,n){this.language=t,this.namespace=e,this.graph=n,this.calls={},this.requires={}}call(t,e,n){let r;const s=e.namespace;return(r=this.calls[s])?r.priority=Math.max(r.priority,n):this.calls[s]={node:t,module:e,priority:n},this}require(t,e){const n=e.namespace;return this.requires[n]={node:t,module:e}}assemble(){const t=yU(this.language,this.namespace!=null?this.namespace:Xu.entry,this.calls,this.requires),e=new Iv;for(const n in t)e[n]=t[n];return e.graph=this.graph,e}}Xu.initClass();const xU=function(i,t,e,n){const r=i;let s=[];const o=[],a={},l={},c={},u={},h={},p=function(){const b=r.links(t),y=[];b.defs!=null&&y.push(b.defs),b.bodies!=null&&y.push(b.bodies);for(const A of Array.from(e))v(A.node,A.module,A.priority);s=(()=>{const A=[];for(const R in h){const O=h[R];A.push(O)}return A})().sort((A,R)=>Gl.compare(A.priority,R.priority)).map(A=>A.code);let S=r.lines(s);S=r.defuse(S),y.length&&(S=[r.lines(y),S].join(`
`)),S=r.hoist(S),S=r.dedupe(S);const E=n;return{namespace:E.main.name,code:S,main:E.main,entry:E.main.name,externals:a,uniforms:l,attributes:c,varyings:u}},m=function(b,y,M){const S=h[b];return S!=null?S.priority=Gl.max(S.priority,M):h[b]={code:y,priority:M}},v=function(b,y,M){let S,E;M=Gl.make(M);for(const A in y.library){const R=y.library[A];m(A,R.code,Gl.nest(M,R.priority))}m(y.namespace,y.body,M);for(E in y.uniforms)S=y.uniforms[E],l[E]=S;for(E in y.varyings)S=y.varyings[E],u[E]=S;for(E in y.attributes)S=y.attributes[E],c[E]=S;return(()=>{const A=[];for(E of Array.from(y.symbols)){const R=y.externals[E];_(b,R.name)?(a[E]=R,A.push(o.push(E))):A.push(void 0)}return A})()},_=function(b,y){const M=b.get(y);if(!M){const S=(b.owner.snippet!=null?b.owner.snippet._name:void 0)!=null?b.owner.snippet!=null?b.owner.snippet._name:void 0:b.owner.namespace;throw new Error(`Unable to link program. Unlinked callback \`${y}\` on \`${S}\``)}if(M.inout===iv)return M.input===null;if(M.inout===HT)return M.output.length===0};return p()};class wU{constructor(t,e){this.language=t,this.graph=e,this.links=[],this.includes=[],this.modules={},this.visits={}}callback(t,e,n,r,s){return this.links.push({node:t,module:e,priority:n,name:r,external:s})}include(t,e,n){let r;return(r=this.modules[e.namespace])!=null?r.priority=Math.max(n,r.priority):(this.modules[e.namespace]=!0,this.includes.push({node:t,module:e,priority:n}))}visit(t){return this.visits[t]?!1:this.visits[t]=!0}link(t){const e=xU(this.language,this.links,this.includes,t),n=new Iv;for(const r in e)n[r]=e[r];return n.graph=this.graph,n}}const{load:Pqt}=Iv,SU=ZC({__proto__:null,Layout:wU,Program:Xu,Snippet:Iv,assemble:yU,link:xU,load:Pqt},[Gl]);class ql{static previous(t){return t.input!=null?t.input.node.owner:void 0}constructor(t){t==null&&(t=!1),t||this.construct()}construct(){let t;return this.namespace==null&&(this.namespace=Xu.entry()),this.node=new BT(this,(t=typeof this.makeOutlets=="function"?this.makeOutlets():void 0)!=null?t:{})}refresh(){let t;return this.node.setOutlets((t=typeof this.makeOutlets=="function"?this.makeOutlets():void 0)!=null?t:{})}clone(){return new ql}compile(t,e){const n=new Xu(t,e??Xu.entry(),this.node.graph);return this.call(n,0),n.assemble()}link(t,e){const n=this.compile(t,e),r=new wU(t,this.node.graph);return this._include(n,r,0),this.export(r,0),r.link(n)}call(t,e){}callback(t,e,n,r,s){}export(t,e){}_info(t){let e=(this.node.owner.snippet!=null?this.node.owner.snippet._name:void 0)!=null?this.node.owner.snippet!=null?this.node.owner.snippet._name:void 0:this.node.owner.namespace;if(t!=null)return e+="."+t}_outlet(t,e){const n=ko.make(t,e);return n.meta.def=t,n}_call(t,e,n){return e.call(this.node,t,n)}_require(t,e){return e.require(this.node,t)}_inputs(t,e,n){return(()=>{const r=[];for(const s of Array.from(t.main.signature)){const o=this.node.get(s.name);r.push(Ok(ql.previous(o),a=>a.call(e,n+1)))}return r})()}_callback(t,e,n,r,s,o){return e.callback(this.node,t,n,r,s,o)}_include(t,e,n){return e.include(this.node,t,n)}_link(t,e,n){return(()=>{const r=[];for(const s of Array.from(t.symbols)){const o=t.externals[s];let a=this.node.get(o.name);if(!a)throw new vC(`External not found on ${this._info(o.name)}`);if(a.meta.child!=null)continue;let l=a,c;for(;!c&&l;)[l,a]=Array.from([a.meta.parent,l]);if(c=ql.previous(a),!c)throw new vC(`Missing connection on ${this._info(o.name)}`);c.callback(e,n+1,s,o,a.input),r.push(c!=null?c.export(e,n+1):void 0)}return r})()}_trace(t,e,n){return(()=>{const r=[];for(const s of Array.from(t.main.signature)){const o=this.node.get(s.name);r.push(Ok(ql.previous(o),a=>a.export(e,n+1)))}return r})()}}const vC=function(i){const t=new Error(i);return t.name="OutletError",t};vC.prototype=new Error;function Ok(i,t){return typeof i<"u"&&i!==null?t(i):void 0}class Ix extends ql{constructor(t){super(!0),this.snippet=t,this.namespace=t.namespace,this.construct()}clone(){return new Ix(this.snippet)}makeOutlets(){const t=this.snippet.main.signature,{externals:e}=this.snippet,{symbols:n}=this.snippet,r=Array.from(t).map(o=>this._outlet(o,{callback:!1})),s=Array.from(n).map(o=>this._outlet(e[o],{callback:!0}));return r.concat(s)}call(t,e){return this._call(this.snippet,t,e),this._inputs(this.snippet,t,e)}export(t,e){if(t.visit(this.namespace,e))return this._link(this.snippet,t,e),this._trace(this.snippet,t,e)}}class rv extends ql{constructor(t){super(!0),this.graph=t,this.construct()}refresh(){return super.refresh(),delete this.subroutine}clone(){return new rv(this.graph)}makeOutlets(){let t;this.make();const e=[];let n=[],r=[];const s=(a,l)=>{if(a.meta.callback){if(a.inout===Us.IN){const c=a.dupe();return c.meta.child==null&&(c.meta.child=a),a.meta.parent=c,e.push(c)}}else return l.push(a.type)};for(t of Array.from(this.graph.inputs()))s(t,n);for(t of Array.from(this.graph.outputs()))s(t,r);n=n.join(","),r=r.join(",");const o=`(${n})(${r})`;return e.push({name:"callback",type:o,inout:Us.OUT,meta:{callback:!0,def:this.subroutine.main}}),e}make(){return this.subroutine=this.graph.compile(this.namespace)}export(t,e){if(t.visit(this.namespace,e))return this._link(this.subroutine,t,e),this.graph.export(t,e)}call(t,e){return this._require(this.subroutine,t,e)}callback(t,e,n,r,s){return this._include(this.subroutine,t,e),this._callback(this.subroutine,t,e,n,r,s)}}class sv extends ql{constructor(t){super(!0),this.graph=t,this.construct()}refresh(){return super.refresh(),delete this.subroutine}clone(){return new sv(this.graph)}makeOutlets(){this.make();const t=[],e={},n={};for(const r of["inputs","outputs"])for(const s of Array.from(this.graph[r]())){let o;["return","callback"].includes(s.hint)&&s.inout===Us.OUT&&(o=s.hint),e[o]!=null&&(o=void 0);const a=s.dupe(o);a.meta.child==null&&(a.meta.child=s),s.meta.parent=a,o!=null&&(e[o]=!0),n[s.name]=a,t.push(a)}return t}make(){return this.subroutine=this.graph.compile(this.namespace)}call(t,e){return this._call(this.subroutine,t,e),this._inputs(this.subroutine,t,e)}export(t,e){if(t.visit(this.namespace,e))return this._link(this.subroutine,t,e),this._trace(this.subroutine,t,e),this.graph.export(t,e)}callback(t,e,n,r,s){return s=s.meta.child,s.node.owner.callback(t,e,n,r,s)}}class Nx extends ql{constructor(t){super(!0),this.nodes=t,this.construct()}clone(){return new Nx(this.nodes)}makeOutlets(){return[]}call(t,e){return(()=>{const n=[];for(const r of Array.from(this.nodes)){const s=r.owner;n.push(s.call(t,e))}return n})()}export(t,e){return(()=>{const n=[];for(const r of Array.from(this.nodes)){const s=r.owner;n.push(s.export(t,e))}return n})()}}const Fb=function(i){const t=[],e=[];for(const n of Array.from(i.nodes)){let r;const s={id:n.id,name:null,type:null,depth:null,graph:null,inputs:[],outputs:[]};t.push(s);const{inputs:o}=s,{outputs:a}=s,l=n.owner;l instanceof Ix?(s.name=l.snippet._name,s.type="call",s.code=l.snippet._original):l instanceof rv?(s.name="Callback",s.type="callback",s.graph=Fb(l.graph)):l instanceof sv?(s.name="Isolate",s.type="isolate",s.graph=Fb(l.graph)):l instanceof Nx?(s.name="Join",s.type="join"):l!=null&&(s.name==null&&(s.name=l.name!=null?l.name:l.type),s.type==null&&(s.type=l.type),s.code==null&&(s.code=l.code),l.graph!=null&&(s.graph=Fb(l.graph)));const c=function(u){return u=u.replace(")(",")("),u=u.replace("()","")};for(r of Array.from(n.inputs))o.push({id:r.id,name:r.name,type:c(r.type),open:r.input==null});for(r of Array.from(n.outputs)){a.push({id:r.id,name:r.name,type:c(r.type),open:!r.output.length});for(const u of Array.from(r.output))e.push({from:n.id,out:r.id,to:u.node.id,in:u.id,type:c(r.type)})}}return{nodes:t,links:e}},Rqt=3432918353,kqt=461845907,Lqt=3864292196,Oqt=2246822507,Dqt=3266489909;let Xp=function(i,t){const e=i>>>16&65535,n=i&65535,r=t>>>16&65535,s=t&65535;return n*s+(e*s+n*r<<16>>>0)|0};Math.imul!=null&&Math.imul(4294967295,5)===-5&&({imul:Xp}=Math);const $T=function(i){let t;const e=i.length;let n=Math.floor(e/2),r=t=0;const s=()=>i.charCodeAt(r++),o=function(a,l){let c=a|l<<16;return c^=c<<9,c=Xp(c,Rqt),c=c<<15|c>>>17,c=Xp(c,kqt),t^=c,t=t<<13|t>>>19,t=Xp(t,5),t=t+Lqt|0};for(;n--;)o(s(),s());return e&1&&o(s(),0),t^=e,t^=t>>>16,t=Xp(t,Oqt),t^=t>>>13,t=Xp(t,Dqt),t^=t>>>16},Iqt=i=>(""+i).replace(/^\s+|\s+$/g,""),Nqt=(i,t,e,n)=>"rgba("+[i,t,e,n].join(", ")+")",Dk=function(i,t){t==null&&(t=1);const e=$T(i)^1193046;let n=e&255,r=e>>>8&255,s=e>>>16&255;const o=Math.max(n,r,s),a=140/o,l=Math.round(o/3);return n=Math.min(255,Math.round(a*Math.max(n,l))),r=Math.min(255,Math.round(a*Math.max(r,l))),s=Math.min(255,Math.round(a*Math.max(s,l))),Nqt(n,r,s,t)},rb=function(i){return i=i??"",i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},zqt=function(i){const t=[],e=MU(i,t);return e.update=()=>Bqt(e,t),Uqt(e),e},Uqt=function(i){const t=i.querySelectorAll(".shadergraph-code");return Array.from(t).map(e=>function(){const n=e;return n.parentNode.classList.add("shadergraph-has-code"),n.parentNode.addEventListener("click",r=>n.style.display={block:"none",none:"block"}[n.style.display||"none"])}())},Fqt=function(i){let t,e;const n={},r={};for(e of Array.from(i.nodes))n[e.id]=e;for(t of Array.from(i.links))r[t.from]==null&&(r[t.from]=[]),r[t.from].push(t);const s=function(o,a){let l;if(a==null&&(a=0),o.depth=Math.max(o.depth!=null?o.depth:0,a),l=r[o.id])for(t of Array.from(l))s(n[t.to],a+1);return null};for(e of Array.from(i.nodes))e.depth==null&&s(e);return null},MU=function(i,t){let e;Fqt(i);const n=document.createElement("div");n.classList.add("shadergraph-graph");const r=[],s={};for(const o of Array.from(i.nodes)){let a;const l=document.createElement("div");l.classList.add("shadergraph-node"),l.classList.add(`shadergraph-node-${o.type}`),l.innerHTML=`<div class="shadergraph-header">${rb(o.name)}</div>`;const c=function(u,h){const p=Dk(u.type),m=document.createElement("div");return m.classList.add("shadergraph-outlet"),m.classList.add(`shadergraph-outlet-${h}`),m.innerHTML=`<div class="shadergraph-point" style="background: ${p}"></div>
<div class="shadergraph-type" style="color: ${p}">${rb(u.type)}</div>
<div class="shadergraph-name">${rb(u.name)}</div>`,l.appendChild(m),s[u.id]=m.querySelector(".shadergraph-point")};for(a of Array.from(o.inputs))c(a,"in");for(a of Array.from(o.outputs))c(a,"out");if(o.graph!=null)l.appendChild(MU(o.graph,t));else{const u=document.createElement("div");u.classList.add("shadergraph-clear"),l.appendChild(u)}if(o.code!=null){const u=document.createElement("div");u.classList.add("shadergraph-code"),u.innerHTML=rb(Iqt(o.code)),l.appendChild(u)}e=r[o.depth],e==null&&(e=document.createElement("div"),e.classList.add("shadergraph-column"),r[o.depth]=e),e.appendChild(l)}for(e of Array.from(r))e!=null&&n.appendChild(e);for(const o of Array.from(i.links)){const a=Dk(o.type);t.push({color:a,out:s[o.out],in:s[o.in]})}return n},Ik=i=>i*i,Vqt=function(i,t,e,n){let r;const s=e-i,o=n-t,a=Math.sqrt(Ik(s)+Ik(o));if(Math.abs(o)>Math.abs(s)){const c=(i+e)/2,u=(t+n)/2,h=o>0?.3:-.3;return r=Math.min(Math.abs(s)/2,20+a/8),["M",i,t,"C",i+r,t+",",c,u-a*h,c,u,"C",c,u+a*h,e-r,n+",",e,n].join(" ")}else return r=Math.min(Math.abs(s)/2.5,20+a/4),["M",i,t,"C",i+r,t+",",e-r,n+",",e,n].join(" ")},Nk=function(i){return i==null&&(i="svg"),document.createElementNS("http://www.w3.org/2000/svg",i)},Bqt=function(i,t){let e;if(i.parentNode==null)return;const n=i.getBoundingClientRect();for(e of Array.from(t)){const o=e.out.getBoundingClientRect(),a=e.in.getBoundingClientRect();e.coords={x1:(o.left+o.right)/2-n.left,y1:(o.top+o.bottom)/2-n.top,x2:(a.left+a.right)/2-n.left,y2:(a.top+a.bottom)/2-n.top}}let r=i.querySelector("svg");r!=null&&i.removeChild(r);let s=i;for(;s.parentNode&&s.offsetHeight===0;)s=s.parentNode;r=Nk(),r.setAttribute("width",s.offsetWidth),r.setAttribute("height",s.offsetHeight);for(e of Array.from(t)){const o=e.coords,a=Nk("path");a.setAttribute("d",Vqt(o.x1,o.y1,o.x2,o.y2)),a.setAttribute("stroke",e.color),a.setAttribute("stroke-width",3),a.setAttribute("fill","transparent"),r.appendChild(a)}return i.appendChild(r)},Hqt=function(i){const t=document.createElement("div");t.setAttribute("class","shadergraph-overlay");const e=document.createElement("div");e.setAttribute("class","shadergraph-close"),e.innerHTML="&times;";const n=document.createElement("div");n.setAttribute("class","shadergraph-view");const r=document.createElement("div");return r.setAttribute("class","shadergraph-inside"),r.appendChild(i),n.appendChild(r),t.appendChild(n),t.appendChild(e),e.addEventListener("click",()=>t.parentNode.removeChild(t)),t},zk=function(i){if(i instanceof Node)return i;const t=document.createElement("span");return t.innerText=i??"",t},$qt=function(i){if(i.length!==1){let t;const e=document.createElement("div");for(t of Array.from(i))e.appendChild(zk(t));return e.update=()=>(()=>{const n=[];for(t of Array.from(i))n.push(typeof t.update=="function"?t.update():void 0);return n})(),e}else return zk(i[0])},Gqt=Object.freeze(Object.defineProperty({__proto__:null,merge:$qt,overlay:Hqt,process:zqt},Symbol.toStringTag,{value:"Module"})),GT=Fb,zx=Gqt,qqt=function(i){if(!i)return;if(!i.nodes)return i;const t=GT(i);return zx.process(t)},Vb=function(i){return i==null?i:i instanceof Array?i.map(Vb):i.vertex!=null&&i.fragment!=null?[Vb(i.vertex,Vb(i.fragment))]:i._graph!=null?i._graph:i.graph!=null?i.graph:i},CU=function(i){let t=[];for(const e of Array.from(i))e instanceof Array?t=t.concat(CU(e)):e!=null&&t.push(e);return t},EU=function(){const i=CU(Vb([].slice.call(arguments)));return zx.merge(Array.from(i).filter(t=>t).map(t=>qqt(t)))},zu=function(){const i=EU.apply(null,arguments),t=zx.overlay(i);for(const e of Array.from(document.querySelectorAll(".shadergraph-overlay")))e.remove();return document.body.appendChild(t),i.update(),t},TU=Object.freeze(Object.defineProperty({__proto__:null,inspect:zu,markup:zx,serialize:GT,visualize:EU},Symbol.toStringTag,{value:"Module"}));let AU=class _C{constructor(t,e,n){this.language=t,this.fetch=e,this.config=n,this.graph()}pipe(t,e,n,r){return t instanceof _C?this._concat(t):t!=null&&this._call(t,e,n,r),this}call(t,e,n,r){return this.pipe(t,e,n,r)}require(t,e,n,r){return t instanceof _C?this._import(t):t!=null&&(this.callback(),this._call(t,e,n,r),this.end()),this}import(t,e,n,r){return this.require(t,e,n,r)}split(){return this._group("_combine",!0),this}fan(){return this._group("_combine",!1),this}isolate(){return this._group("_isolate"),this}callback(){return this._group("_callback"),this}next(){return this._next(),this}pass(){const t=this._stack[2].end;return this.end(),this._state.end=this._state.end.concat(t),this}end(){const[t,e]=Array.from(this._exit()),{op:n}=t;return this[n]&&this[n](t,e),this}join(){return this.end()}graph(){for(;(this._stack!=null?this._stack.length:void 0)>1;)this.end();this._graph&&this._tail(this._state,this._graph);const t=this._graph;return this._graph=new Us,this._state=new sb,this._stack=[this._state],t}compile(t){return t==null&&(t="main"),this.graph().compile(t)}link(t){return t==null&&(t="main"),this.graph().link(t)}serialize(){return GT(this._graph)}empty(){return this._graph.nodes.length===0}_concat(t){let e;if(t._state.nodes.length===0)return this;this._tail(t._state,t._graph);try{e=new sv(t._graph)}catch(n){throw this.config.autoInspect&&zu(n,this._graph,t),n}return this._auto(e),this}_import(t){let e;if(t._state.nodes.length===0)throw"Can't import empty callback";this._tail(t._state,t._graph);try{e=new rv(t._graph)}catch(n){throw this.config.autoInspect&&zu(n,this._graph,t),n}return this._auto(e),this}_combine(t,e){for(const n of Array.from(t.start))for(const r of Array.from(e.end))r.connect(n,t.multi);return e.end=t.end,e.nodes=e.nodes.concat(t.nodes)}_isolate(t,e){if(t.nodes.length){let n;const r=this._subgraph(t);this._tail(t,r);try{n=new sv(r)}catch(s){throw this.config.autoInspect&&zu(s,this._graph,r),s}return this._auto(n)}}_callback(t,e){if(t.nodes.length){let n;const r=this._subgraph(t);this._tail(t,r);try{n=new rv(r)}catch(s){throw this.config.autoInspect&&zu(s,this._graph,r),s}return this._auto(n)}}_call(t,e,n,r){const s=this.fetch(t);s.bind(this.config,e,n,r);const o=new Ix(s);return this._auto(o)}_subgraph(t){const e=new Us(null,this._graph);return e.adopt(t.nodes),e}_tail(t,e){let n=t.end.concat(t.tail);if(n=n.filter((r,s)=>n.indexOf(r)===s),n.length>1&&(n=new Nx(n),n=[n.node],this._graph.add(n)),e.tail=n[0],t.end=n,t.tail=[],!e.tail)throw new Error("Cannot finalize empty graph");return e.compile=r=>{r==null&&(r="main");try{return e.tail.owner.compile(this.language,r)}catch(s){throw this.config.autoInspect&&e.inspect(s),s}},e.link=r=>{r==null&&(r="main");try{return e.tail.owner.link(this.language,r)}catch(s){throw this.config.autoInspect&&e.inspect(s),s}},e.export=(r,s)=>e.tail.owner.export(r,s),e.inspect=(r=null)=>zu(r,e)}_group(t,e){return this._push(t,e),this._push(),this}_next(){const t=this._pop();return this._state.start=this._state.start.concat(t.start),this._state.end=this._state.end.concat(t.end),this._state.nodes=this._state.nodes.concat(t.nodes),this._state.tail=this._state.tail.concat(t.tail),this._push()}_exit(){return this._next(),this._pop(),[this._pop(),this._state]}_push(t,e){return this._stack.unshift(new sb(t,e)),this._state=this._stack[0]}_pop(){let t;return this._state=this._stack[1],this._state==null&&(this._state=new sb),(t=this._stack.shift())!=null?t:new sb}_auto(t){return t.node.inputs.length?this._append(t):this._insert(t)}_append(t){let e;const{node:n}=t;this._graph.add(n);for(e of Array.from(this._state.end))e.connect(n);this._state.start.length||(this._state.start=[n]),this._state.end=[n],this._state.nodes.push(n),n.outputs.length||this._state.tail.push(n)}_prepend(t){let e;const{node:n}=t;this._graph.add(n);for(e of Array.from(this._state.start))n.connect(e);this._state.end.length||(this._state.end=[n]),this._state.start=[n],this._state.nodes.push(n),n.outputs.length||this._state.tail.push(n)}_insert(t){const{node:e}=t;if(this._graph.add(e),this._state.start.push(e),this._state.end.push(e),this._state.nodes.push(e),!e.outputs.length)return this._state.tail.push(e)}};class sb{constructor(t=null,e,n,r,s,o){this.op=t,e==null&&(e=!1),this.multi=e,n==null&&(n=[]),this.start=n,r==null&&(r=[]),this.end=r,s==null&&(s=[]),this.nodes=s,o==null&&(o=[]),this.tail=o}}class PU{constructor(t,e){this.vertex=t,this.fragment=e}build(t){return this.link(t)}link(t){t==null&&(t={});const e={},n={},r={},s=this.vertex.link("main"),o=this.fragment.link("main");for(const a of[s,o]){for(const l in a.uniforms){const c=a.uniforms[l];e[l]=c}for(const l in a.varyings){const c=a.varyings[l];n[l]=c}for(const l in a.attributes){const c=a.attributes[l];r[l]=c}}return t.vertexShader=s.code,t.vertexGraph=s.graph,t.fragmentShader=o.code,t.fragmentGraph=o.graph,t.attributes=r,t.uniforms=e,t.varyings=n,t.inspect=()=>zu("Vertex Shader",s,"Fragment Shader",o.graph),t}inspect(){return zu("Vertex Shader",this.vertex,"Fragment Shader",this.fragment.graph)}}const Wqt=function(i,t,e){let n=null,r={};t!=null&&(typeof t=="function"?n=a=>e(i,a,t(a)):typeof t=="object"&&(n=function(a){if(t[a]==null)throw new Error(`Unknown snippet \`${a}\``);return e(i,a,t[a])}));const s=a=>e(i,"",a);if(n==null)return s;const o=function(a){return a.match(/[{;]/)?s(a):(r[a]=!0,n(a))};return o.used=function(a){return a==null&&(a=r),r=a},o},RU=function(i){i==null&&(i=100);const t={};let e=null,n=null,r=0;const s=function(a){if(a.prev=null,a.next=e,e!=null&&(e.prev=a),e=a,n==null)return n=a},o=function(a){const{prev:l}=a,{next:c}=a;if(l!=null&&(l.next=c),c!=null&&(c.prev=l),e===a&&(e=c),n===a)return n=l};return function(a){let l,c;return(c=t[a])&&c!==e?(o(c),s(c)):(r===i?(l=n.key,o(n),delete t[l]):r++,c={next:e,prev:null,key:a},s(c),t[a]=c),l}},jqt=function(i){const t={},e=RU(100);return function(n){const r=n.length>32?"##"+$T(n).toString(16):n,s=e(r);return s!=null&&delete t[s],t[r]==null&&(t[r]=i(n)),t[r].clone()}},kU=Object.freeze(Object.defineProperty({__proto__:null,Factory:AU,Material:PU,cache:jqt,hash:$T,library:Wqt,queue:RU},Symbol.toStringTag,{value:"Module"})),Xqt=function(i){const{code:t,signatures:e}=i,n=Yqt(e),r=Kqt(t,n);return[e,r]},Yqt=function(i){const t={},e=n=>t[n.name]=!0;e(i.main);for(const n of["external","internal","varying","uniform","attribute"])for(const r of i[n])e(r);return t},Kqt=function(i,t){let e;const n=new RegExp("\\b("+(()=>{const r=[];for(e in t)r.push(e);return r})().join("|")+")\\b","g");return i=i.replace(/\/\/[^\n]*/g,""),i=i.replace(/\/\*([^*]|\*[^/])*\*\//g,""),function(r,s,o){let a;r==null&&(r=""),s==null&&(s={}),o==null&&(o={});const l={};for(a in t)l[a]=s[a]!=null?a:r+a;const c=i.replace(n,h=>l[h]),u=(()=>{const h=[];for(a in o){const p=o[a];h.push(`#define ${a} ${p}`)}return h})();return u.length&&u.push(""),u.join(`
`)+c}};var LU=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"],Zqt=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"],OU=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],Jqt=LU,Qqt=Jqt.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),bC=OU;bC=bC.slice().filter(function(i){return!/^(gl\_|texture)/.test(i)});var tWt=bC.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),eWt=hWt,nWt=LU,Uk=Zqt,iWt=OU,rWt=Qqt,sWt=tWt,hl=999,Fk=9999,CS=0,ES=1,Vk=2,Bk=3,Hk=4,Km=5,oWt=6,aWt=7,lWt=8,$k=9,cWt=10,Gk=11,uWt=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function hWt(i){var t=0,e=0,n=hl,r,s,o=[],a=[],l=1,c=0,u=0,h=!1,p=!1,m="",v;i=i||{};var _=iWt,b=nWt;i.version==="300 es"&&(_=sWt,b=rWt);for(var y={},M={},t=0;t<_.length;t++)y[_[t]]=!0;for(var t=0;t<b.length;t++)M[b[t]]=!0;return function(nt){return a=[],nt!==null?E(nt):A()};function S(nt){nt.length&&a.push({type:uWt[n],data:nt,position:u,line:l,column:c})}function E(nt){t=0,nt.toString&&(nt=nt.toString()),m+=nt.replace(/\r\n/g,`
`),v=m.length;for(var Q;r=m[t],t<v;){switch(Q=t,n){case CS:t=D();break;case ES:t=P();break;case Vk:t=L();break;case Bk:t=V();break;case Hk:t=Z();break;case Gk:t=W();break;case Km:t=z();break;case Fk:t=ut();break;case $k:t=O();break;case hl:t=R();break}if(Q!==t)switch(m[Q]){case`
`:c=0,++l;break;default:++c;break}}return e+=t,m=m.slice(t),a}function A(nt){return o.length&&S(o.join("")),n=cWt,S("(eof)"),a}function R(){return o=o.length?[]:o,s==="/"&&r==="*"?(u=e+t-1,n=CS,s=r,t+1):s==="/"&&r==="/"?(u=e+t-1,n=ES,s=r,t+1):r==="#"?(n=Vk,u=e+t,t):/\s/.test(r)?(n=$k,u=e+t,t):(h=/\d/.test(r),p=/[^\w_]/.test(r),u=e+t,n=h?Hk:p?Bk:Fk,t)}function O(){return/[^\s]/g.test(r)?(S(o.join("")),n=hl,t):(o.push(r),s=r,t+1)}function L(){return(r==="\r"||r===`
`)&&s!=="\\"?(S(o.join("")),n=hl,t):(o.push(r),s=r,t+1)}function P(){return L()}function D(){return r==="/"&&s==="*"?(o.push(r),S(o.join("")),n=hl,t+1):(o.push(r),s=r,t+1)}function V(){if(s==="."&&/\d/.test(r))return n=Km,t;if(s==="/"&&r==="*")return n=CS,t;if(s==="/"&&r==="/")return n=ES,t;if(r==="."&&o.length){for(;K(o););return n=Km,t}if(r===";"||r===")"||r==="("){if(o.length)for(;K(o););return S(r),n=hl,t+1}var nt=o.length===2&&r!=="=";if(/[\w_\d\s]/.test(r)||nt){for(;K(o););return n=hl,t}return o.push(r),s=r,t+1}function K(nt){var Q=0,St,Pt;do{if(St=Uk.indexOf(nt.slice(0,nt.length+Q).join("")),Pt=Uk[St],St===-1){if(Q--+nt.length>0)continue;Pt=nt.slice(0,1).join("")}return S(Pt),u+=Pt.length,o=o.slice(Pt.length),o.length}while(1)}function W(){return/[^a-fA-F0-9]/.test(r)?(S(o.join("")),n=hl,t):(o.push(r),s=r,t+1)}function Z(){return r==="."||/[eE]/.test(r)?(o.push(r),n=Km,s=r,t+1):r==="x"&&o.length===1&&o[0]==="0"?(n=Gk,o.push(r),s=r,t+1):/[^\d]/.test(r)?(S(o.join("")),n=hl,t):(o.push(r),s=r,t+1)}function z(){return r==="f"&&(o.push(r),s=r,t+=1),/[eE]/.test(r)||(r==="-"||r==="+")&&/[eE]/.test(s)?(o.push(r),s=r,t+1):/[^\d]/.test(r)?(S(o.join("")),n=hl,t):(o.push(r),s=r,t+1)}function ut(){if(/[^\d\w_]/.test(r)){var nt=o.join("");return M[nt]?n=lWt:y[nt]?n=aWt:n=oWt,S(o.join("")),n=hl,t}return o.push(r),s=r,t+1}}var dWt=eWt,pWt=fWt;function fWt(i,t){var e=dWt(t),n=[];return n=n.concat(e(i)),n=n.concat(e(null)),n}const mWt=zd(pWt);let fl,Va,Pg,ly;const gWt={nud:function(){return this.children&&this.children.length?this:qk("unexpected")()},led:qk("missing operator")},dd={};function Nv(){return this}fo("(ident)").nud=Nv;fo("(keyword)").nud=Nv;fo("(builtin)").nud=Nv;fo("(literal)").nud=Nv;fo("(end)");fo(":");fo(";");fo(",");fo(")");fo("]");fo("}");qT("&&",30);qT("||",30);Gr("|",43);Gr("^",44);Gr("&",45);Gr("==",46);Gr("!=",46);Gr("<",47);Gr("<=",47);Gr(">",47);Gr(">=",47);Gr(">>",48);Gr("<<",48);Gr("+",50);Gr("-",50);Gr("*",60);Gr("/",60);Gr("%",60);Gr("?",20,function(i){return this.children=[i,ec(0),(Qc(":"),ec(0))],this.type="ternary",this});Gr(".",80,function(i){return Va.type="literal",fl.fake(Va),this.children=[i,Va],Qc(),this});Gr("[",80,function(i){return this.children=[i,ec(0)],this.type="binary",Qc("]"),this});Gr("(",80,function(i){if(this.children=[i],this.type="call",Va.data!==")")for(;this.children.push(ec(0)),Va.data===",";)Qc(",");return Qc(")"),this});bh("-");bh("+");bh("!");bh("~");bh("defined");bh("(",function(){return this.type="group",this.children=[ec(0)],Qc(")"),this});bh("++");bh("--");DU("++");DU("--");Cl("=");Cl("+=");Cl("-=");Cl("*=");Cl("/=");Cl("%=");Cl("&=");Cl("|=");Cl("^=");Cl(">>=");Cl("<<=");var vWt=function(i,t){fl=i,Pg=t,ly=0;let e;if(!Pg.length)return;if(Qc(),e=ec(0),e.parent=fl[0],n(e),ly<Pg.length)throw new Error("did not use all tokens");e.parent.children=[e];function n(r){fl.unshift(r,!1);for(let s=0,o=r.children.length;s<o;++s)n(r.children[s]);fl.shift()}};function fo(i,t){let e=dd[i];return t=t||0,e?t>e.lbp&&(e.lbp=t):(e=Object.create(gWt),e.id=i,e.lbp=t,dd[i]=e),e}function ec(i){let t,e=Va;for(Qc(),t=e.nud();i<Va.lbp;)e=Va,Qc(),t=e.led(t);return t}function Gr(i,t,e){const n=fo(i,t);n.led=e||function(r){return this.children=[r,ec(t)],this.type="binary",this}}function qT(i,t,e){const n=fo(i,t);return n.led=e||function(r){return this.children=[r,ec(t-1)],this.type="binary",this},n}function bh(i,t){const e=fo(i);return e.nud=t||function(){return this.children=[ec(70)],this.type="unary",this},e}function DU(i){const t=fo(i,150);t.led=function(e){return this.children=[e],this.type="suffix",this}}function Cl(i){return qT(i,10,function(t){return this.children=[t,ec(9)],this.assignment=!0,this.type="assign",this})}function Qc(i){let t,e,n,r;if(i&&Va.data!==i)return fl.unexpected("expected `"+i+"`, got `"+Va.data+"`");if(ly>=Pg.length){Va=dd["(end)"];return}if(t=Pg[ly++],e=t.data,n=t.type,n==="ident")r=fl.scope.find(e)||fl.create_node(),n=r.type;else if(n==="builtin")r=dd["(builtin)"];else if(n==="keyword")r=dd["(keyword)"];else if(n==="operator"){if(r=dd[e],!r)return fl.unexpected("unknown operator `"+e+"`")}else if(n==="float"||n==="integer")n="literal",r=dd["(literal)"];else return fl.unexpected("unexpected token.");return r&&(r.nud||(r.nud=Nv),r.children||(r.children=[])),r=Object.create(r),r.token=t,r.type=n,r.data||(r.data=e),Va=r}function qk(i){return function(){return fl.unexpected(i)}}var _Wt=cy;function cy(i){if(this.constructor!==cy)return new cy(i);this.state=i,this.scopes=[],this.current=null}const bWt=cy,Ux=bWt.prototype;Ux.enter=function(i){this.scopes.push(this.current=this.state[0].scope=i||{})};Ux.exit=function(){this.scopes.pop(),this.current=this.scopes[this.scopes.length-1]};Ux.define=function(i){this.current[i]=this.state[0]};Ux.find=function(i,t){for(let e=this.scopes.length-1;e>-1;--e)if(this.scopes[e].hasOwnProperty(i))return this.scopes[e][i];return null};var yWt=IWt;const xWt=vWt,wWt=_Wt,_n=new Object;let Ii=0,Zm=Ii++,Wk=Ii++,TS=Ii++,jk=Ii++,AS=Ii++,Xk=Ii++,Yk=Ii++,Kk=Ii++,Zk=Ii++,Jk=Ii++,Qk=Ii++,tL=Ii++,eL=Ii++,nL=Ii++,SWt=Ii++,PS=Ii++,MWt=Ii++,iL=Ii++,CWt=Ii++,EWt=Ii++,TWt=Ii++,rL=Ii++,ob=Ii++,sL=Ii++;const WT=1,yC=2,AWt=4,jT=8,IU=16,NU=32,zU=64,rf=255,PWt=rf&~(WT|yC|NU|jT|AWt),RWt=rf&~(WT|jT|IU|zU),kWt=!1,LWt=!1,OWt={"block-comment":nL,"line-comment":nL,preprocessor:SWt},DWt=Ii=["ident","stmt","stmtlist","struct","function","functionargs","decl","decllist","forloop","whileloop","if","expr","precision","comment","preprocessor","keyword","keyword_or_ident","return","break","continue","discard","do-while","placeholder","quantifier"];function IWt(){const i=J(TS),t=J(Wk),e=J(Kk),n=J(eL),r=J(Zm),s=J(AS),o=J(Xk),a=J(Zk),l=J(Qk),c=J(Jk),u=J(iL),h=J(rL),p=J(sL);let m,v,_,b,y,M,S,E,A,R,O=arguments.length?[].slice.call(arguments):[],L=!1,P=[],D=[],V=[],K=[],W=!1,Z,z,ut;return P.shift=Jt,P.unshift=Rt,P.fake=dt,P.unexpected=qt,P.scope=new wWt(P),P.create_node=function(){const ht=io(Zm,z);return ht.parent=nt.program,ht},we(),ut=i(),ut.expecting="(eof)",ut.mode=TS,ut.token={type:"(program)",data:"(program)"},Z=ut,nt.program=Z,nt.scope=function(ht){return arguments.length===1&&(P.scope=ht),P.scope},P.unshift(ut),nt;function nt(ht){return ht===null?(St(),Z):(D=[],Q(ht),D)}function Q(ht){if(ht.type==="whitespace"||ht.type==="line-comment"||ht.type==="block-comment"){K.push(ht);return}for(V.push(ht),z=z||V[0],z&&K.length&&(z.preceding=z.preceding||[],z.preceding=z.preceding.concat(K),K=[]);Pt();)switch(P[0].mode){case Wk:Wt();break;case TS:Bt();break;case Yk:re();break;case Kk:It();break;case tL:Gt();break;case jk:m(!0,!0);break;case eL:v();break;case Zm:ne();break;case PS:ce();break;case MWt:ye();break;case AS:A();break;case Xk:R();break;case Zk:b();break;case Jk:S();break;case rL:E();break;case iL:M();break;case Qk:y();break;case sL:_();break}}function St(ht){if(arguments.length&&Q(ht),P.length>1){qt("unexpected EOF");return}}function Pt(){return W||!P.length?!1:z=V[0]}function dt(ht){P.unshift(ht),P.shift()}function Rt(ht,mt){ht.parent=P[0];const tt=[].unshift.call(this,ht);return mt=mt===void 0?!0:mt,mt&&ut!==ht&&ut.children.push(ht),ut=ht,tt}function Jt(){let ht=[].shift.call(this),mt=O[this.length],tt=!1;return O.length?typeof O[0]=="function"?tt=O[0](ht):mt!==void 0&&(tt=mt.test?mt.test(ht.type):mt===ht.type):tt=!0,tt&&!W&&D.push(ht),ut=ht.parent,ht}function Bt(){return _t(function(){return P.scope.enter(),_n},ht)();function ht(){if(z.data===P[0].expecting)return P.scope.exit(),P.shift();switch(z.type){case"preprocessor":P.fake($t()),V.shift();return;default:P.unshift(t());return}}}function Wt(){if(P[0].brace)return z.data!=="}"?qt("expected `}`, got "+z.data):(P[0].brace=!1,V.shift(),P.shift());switch(z.type){case"eof":return be();case"keyword":switch(z.data){case"for":return P.unshift(a());case"if":return P.unshift(l());case"while":return P.unshift(c());case"do":return P.unshift(h());case"break":return P.fake(io(CWt,z)),V.shift();case"continue":return P.fake(io(EWt,z)),V.shift();case"discard":return P.fake(io(TWt,z)),V.shift();case"return":return P.unshift(u());case"precision":return P.unshift(n())}return P.unshift(et(rf));case"ident":var ht;if(ht=P.scope.find(z.data))return ht.parent.type==="struct"?P.unshift(et(rf)):P.unshift(kt(";"));case"operator":if(z.data==="{"){P[0].brace=!0;const mt=i();return mt.expecting="}",V.shift(),P.unshift(mt)}if(z.data===";")return V.shift(),P.shift();default:return P.unshift(kt(";"))}}function be(){return L&&(W=!0),L=!0,P.shift()}function re(){const ht=P[0];return _t(mt,tt,Ut,oe,ue,ae,xe,Ze,pt)();function mt(){return z.data==="invariant"?ht.flags&jT?(P.unshift(Qt()),_n):qt("`invariant` is not allowed here"):(P.fake(io(ob,{data:"",position:z.position})),_n)}function tt(){return NWt(z)?ht.flags&IU?(P.unshift(Qt()),_n):qt("storage is not allowed here"):(P.fake(io(ob,{data:"",position:z.position})),_n)}function Ut(){return zWt(z)?ht.flags&NU?qt("parameter is not allowed here"):(P.unshift(Qt()),_n):(P.fake(io(ob,{data:"",position:z.position})),_n)}function oe(){return UWt(z)?(P.unshift(Qt()),_n):(P.fake(io(ob,{data:"",position:z.position})),_n)}function ue(){if(z.data==="struct")return ht.flags&zU?(P.unshift(ft()),_n):qt("cannot nest structs");if(z.type==="keyword")return P.unshift(Qt()),_n;const ee=P.scope.find(z.data);return ee?(P.fake(Object.create(ee)),V.shift(),_n):qt("expected user defined type, struct or keyword, got "+z.data)}function ae(){if(z.data===","&&!(ht.flags&yC))return P.shift();if(z.data==="["){P.unshift(p());return}return z.data===")"?P.shift():z.data===";"?ht.stage+3:z.type!=="ident"&&z.type!=="builtin"?qt("expected identifier, got "+z.data):(ht.collected_name=V.shift(),_n)}function xe(){return z.data==="("?(V.unshift(ht.collected_name),delete ht.collected_name,P.unshift(s()),ht.stage+2):_n}function Ze(){return V.unshift(ht.collected_name),delete ht.collected_name,P.unshift(e()),_n}function pt(){return P.shift()}}function It(){if(z.type==="ident"||z.type==="builtin"){const ht=z.data;P.unshift(r()),P.scope.define(ht);return}if(z.type==="operator"){if(z.data===",")return P[1].flags&yC?V.shift():P.shift();if(z.data==="="){if(!(P[1].flags&WT))return qt("`=` is not allowed here.");V.shift(),P.unshift(kt(",",";"));return}else if(z.data==="["){P.unshift(p());return}}return P.shift()}function ye(){if(z.type==="keyword"){P[0].type="keyword",P[0].mode=PS;return}if(z.type==="ident"){P[0].type="ident",P[0].mode=Zm;return}return qt("expected keyword or user-defined name, got "+z.data)}function ce(){return z.type!=="keyword"?qt("expected keyword, got "+z.data):(P.shift(),V.shift())}function ne(){return z.type!=="ident"&&z.type!=="builtin"?qt("expected user-defined name, got "+z.data):(P[0].data=z.data,P.shift(),V.shift())}function Gt(){const ht=P[0].expecting;if(P[0].tokens=P[0].tokens||[],P[0].parenlevel===void 0&&(P[0].parenlevel=0,P[0].bracelevel=0),P[0].parenlevel<1&&ht.indexOf(z.data)>-1)return mt(P[0].tokens);switch(z.data==="("?++P[0].parenlevel:z.data===")"&&--P[0].parenlevel,z.data){case"{":++P[0].bracelevel;break;case"}":--P[0].bracelevel;break;case"(":++P[0].parenlevel;break;case")":--P[0].parenlevel;break}if(P[0].parenlevel<0)return qt("unexpected `)`");if(P[0].bracelevel<0)return qt("unexpected `}`");P[0].tokens.push(V.shift());return;function mt(tt){try{xWt(P,tt)}catch(Ut){throw W=!0,Ut}return P.shift()}}function J(ht){return function(){return io(ht,z)}}function $t(){return io(OWt[z.type],z)}function et(ht){const mt=io(Yk,z);return mt.flags=ht,mt}function ft(ht,mt){const tt=io(jk,z);return tt.allow_assign=ht===void 0?!0:ht,tt.allow_comma=mt===void 0?!0:mt,tt}function kt(){const ht=io(tL,z);return ht.expecting=[].slice.call(arguments),ht}function Qt(ht){let mt=z;return ht&&(mt={type:"(implied)",data:"(default)",position:mt.position}),io(PS,mt)}function qt(ht){throw W=!0,new Error((ht||"unexpected "+P)+" at line "+P[0].token.line)}function ot(ht,mt){return st(ht,z.type)&&st(mt,z.data)}function st(ht,mt){switch(typeof ht){case"string":return mt!==ht&&qt("expected `"+ht+"`, got "+mt+`
`+z.data),!W;case"object":return ht&&ht.indexOf(mt)===-1&&qt("expected one of `"+ht.join("`, `")+"`, got "+mt),!W}return!0}function _t(){let ht=[].slice.call(arguments),mt,tt;return function(){const Ut=P[0];if(Ut.stage||(Ut.stage=0),mt=ht[Ut.stage],!mt)return qt("parser in undefined state!");if(tt=mt(),tt===_n)return++Ut.stage;tt!==void 0&&(Ut.stage=tt)}}function $(ht,mt){return mt=mt||"operator",function(){if(!ot(mt,ht))return;const tt=V.shift(),Ut=P[0].children,oe=Ut[Ut.length-1];return oe&&oe.token&&tt.preceding&&(oe.token.succeeding=oe.token.succeeding||[],oe.token.succeeding=oe.token.succeeding.concat(tt.preceding)),_n}}function B(ht){return function(){return P.unshift(kt(ht)),_n}}function Lt(ht){return ht?function(){const mt=z.data;return ot("ident")&&(P.unshift(r()),P.scope.define(mt),_n)}:function(){if(!ot("ident"))return;const mt=Object.create(P.scope.find(z.data));return mt.token=z,V.shift(),_n}}function jt(){return function(){const ht=i();return ht.expecting="}",P.unshift(ht),_n}}function Kt(ht){return function(){const mt=P[0].stage;return z.data!=="{"?(P.unshift(t()),mt+ht):(V.shift(),_n)}}function se(){return function(){return P.shift(),P.shift()}}function we(){m=_t($("struct","keyword"),function(){return z.data==="{"?(P.fake(io(Zm,{data:"",position:z.position,type:"ident"})),_n):Lt(!0)()},function(){return P.scope.enter(),_n},$("{"),function(){if(z.type==="preprocessor"){P.fake($t()),V.shift();return}if(z.data==="}")return P.scope.exit(),V.shift(),P.shift();if(z.data===";"){V.shift();return}P.unshift(et(RWt))}),v=_t(function(){return V.shift(),_n},function(){return ot("keyword",["lowp","mediump","highp"])&&(P.unshift(Qt()),_n)},function(){return P.unshift(Qt()),_n},function(){return P.shift()}),_=_t($("["),B("]"),$("]"),function(){return P.shift()}),b=_t($("for","keyword"),$("("),function(){let ht;if(z.type==="ident"){if((ht=P.scope.find(z.data))||(ht=P.create_node()),ht.parent.type==="struct")return P.unshift(et(rf)),_n}else if(z.type==="builtin"||z.type==="keyword")return P.unshift(et(rf)),_n;return B(";")()},$(";"),B(";"),$(";"),B(")"),$(")"),Kt(3),jt(),$("}"),se()),y=_t($("if","keyword"),$("("),B(")"),$(")"),Kt(3),jt(),$("}"),function(){return z.data==="else"?(V.shift(),P.unshift(t()),_n):se()()},se()),M=_t($("return","keyword"),function(){return z.data===";"||P.unshift(kt(";")),_n},function(){V.shift(),se()()}),S=_t($("while","keyword"),$("("),B(")"),$(")"),Kt(3),jt(),$("}"),se()),E=_t($("do","keyword"),Kt(3),jt(),$("}"),$("while","keyword"),$("("),B(")"),$(")"),se()),A=_t(function(){for(let ht=1,mt=P.length;ht<mt;++ht)if(P[ht].mode===AS)return qt("function definition is not allowed within another function");return _n},function(){if(!ot("ident"))return;const ht=z.data,mt=P.scope.find(ht);return P.unshift(r()),P.scope.define(ht),P.scope.enter(mt?mt.scope:null),_n},$("("),function(){return P.unshift(o()),_n},$(")"),function(){return z.data===";"?(P.scope.exit(),P.shift(),P.shift()):_n},$("{"),jt(),$("}"),function(){return P.scope.exit(),_n},function(){return P.shift(),P.shift(),P.shift()}),R=_t(function(){if(z.data==="void")return P.fake(Qt()),V.shift(),_n;if(z.data===")"){P.shift();return}return z.data==="struct"?(P.unshift(ft(kWt,LWt)),_n):(P.unshift(et(PWt)),_n)},function(){if(z.data===",")return V.shift(),0;if(z.data===")"){P.shift();return}qt("expected one of `,` or `)`, got "+z.data)})}}function io(i,t){return{mode:i,token:t,children:[],type:DWt[i],id:(Math.random()*4294967295).toString(16)}}function NWt(i){return i.data==="const"||i.data==="attribute"||i.data==="uniform"||i.data==="varying"}function zWt(i){return i.data==="in"||i.data==="inout"||i.data==="out"}function UWt(i){return i.data==="highp"||i.data==="mediump"||i.data==="lowp"}var FWt=yWt,VWt=BWt;function BWt(i){for(var t=FWt(),e=0;e<i.length;e++)t(i[e]);return t(null)}const HWt=zd(VWt);function XT(i,t,e){return Math.max(t,Math.min(e,i))}class YT{constructor(t=0,e=0){YT.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(XT(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),s=this.x-t.x,o=this.y-t.y;return this.x=s*n-o*r+t.x,this.y=s*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class $Wt{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const p=s[o+0],m=s[o+1],v=s[o+2],_=s[o+3];if(a===0){t[e+0]=l,t[e+1]=c,t[e+2]=u,t[e+3]=h;return}if(a===1){t[e+0]=p,t[e+1]=m,t[e+2]=v,t[e+3]=_;return}if(h!==_||l!==p||c!==m||u!==v){let b=1-a;const y=l*p+c*m+u*v+h*_,M=y>=0?1:-1,S=1-y*y;if(S>Number.EPSILON){const A=Math.sqrt(S),R=Math.atan2(A,y*M);b=Math.sin(b*R)/A,a=Math.sin(a*R)/A}const E=a*M;if(l=l*b+p*E,c=c*b+m*E,u=u*b+v*E,h=h*b+_*E,b===1-a){const A=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=A,c*=A,u*=A,h*=A}}t[e]=l,t[e+1]=c,t[e+2]=u,t[e+3]=h}static multiplyQuaternionsFlat(t,e,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],p=s[o+1],m=s[o+2],v=s[o+3];return t[e]=a*v+u*h+l*m-c*p,t[e+1]=l*v+u*p+c*h-a*m,t[e+2]=c*v+u*m+a*p-l*h,t[e+3]=u*v-a*h-l*p-c*m,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const n=t._x,r=t._y,s=t._z,o=t._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),p=l(n/2),m=l(r/2),v=l(s/2);switch(o){case"XYZ":this._x=p*u*h+c*m*v,this._y=c*m*h-p*u*v,this._z=c*u*v+p*m*h,this._w=c*u*h-p*m*v;break;case"YXZ":this._x=p*u*h+c*m*v,this._y=c*m*h-p*u*v,this._z=c*u*v-p*m*h,this._w=c*u*h+p*m*v;break;case"ZXY":this._x=p*u*h-c*m*v,this._y=c*m*h+p*u*v,this._z=c*u*v+p*m*h,this._w=c*u*h-p*m*v;break;case"ZYX":this._x=p*u*h-c*m*v,this._y=c*m*h+p*u*v,this._z=c*u*v-p*m*h,this._w=c*u*h+p*m*v;break;case"YZX":this._x=p*u*h+c*m*v,this._y=c*m*h+p*u*v,this._z=c*u*v-p*m*h,this._w=c*u*h-p*m*v;break;case"XZY":this._x=p*u*h-c*m*v,this._y=c*m*h-p*u*v,this._z=c*u*v+p*m*h,this._w=c*u*h+p*m*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],s=e[8],o=e[1],a=e[5],l=e[9],c=e[2],u=e[6],h=e[10],p=n+a+h;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-c)*m,this._z=(o-r)*m}else if(n>a&&n>h){const m=2*Math.sqrt(1+n-a-h);this._w=(u-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+c)/m}else if(a>h){const m=2*Math.sqrt(1+a-n-h);this._w=(s-c)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+h-n-a);this._w=(o-r)/m,this._x=(s+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(XT(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,s=t._z,o=t._w,a=e._x,l=e._y,c=e._z,u=e._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+s*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*n+e*this._x,this._y=m*r+e*this._y,this._z=m*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-e)*u)/c,p=Math.sin(e*u)/c;return this._w=o*h+this._w*p,this._x=n*h+this._x*p,this._y=r*h+this._y*p,this._z=s*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(s),n*Math.cos(s),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class lc{constructor(t=0,e=0,n=0){lc.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(oL.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(oL.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[3]*n+s[6]*r,this.y=s[1]*e+s[4]*n+s[7]*r,this.z=s[2]*e+s[5]*n+s[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,s=t.elements,o=1/(s[3]*e+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*e+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*e+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*e+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,s=t.x,o=t.y,a=t.z,l=t.w,c=l*e+o*r-a*n,u=l*n+a*e-s*r,h=l*r+s*n-o*e,p=-s*e-o*n-a*r;return this.x=c*l+p*-s+u*-a-h*-o,this.y=u*l+p*-o+h*-s-c*-a,this.z=h*l+p*-a+c*-o-u*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r,this.y=s[1]*e+s[5]*n+s[9]*r,this.z=s[2]*e+s[6]*n+s[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,s=t.z,o=e.x,a=e.y,l=e.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return RS.copy(this).projectOnVector(t),this.sub(RS)}reflect(t){return this.sub(RS.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(XT(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const RS=new lc,oL=new $Wt;class KT{constructor(t=0,e=0,n=0,r=1){KT.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,s=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,s;const l=t.elements,c=l[0],u=l[4],h=l[8],p=l[1],m=l[5],v=l[9],_=l[2],b=l[6],y=l[10];if(Math.abs(u-p)<.01&&Math.abs(h-_)<.01&&Math.abs(v-b)<.01){if(Math.abs(u+p)<.1&&Math.abs(h+_)<.1&&Math.abs(v+b)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const S=(c+1)/2,E=(m+1)/2,A=(y+1)/2,R=(u+p)/4,O=(h+_)/4,L=(v+b)/4;return S>E&&S>A?S<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(S),r=R/n,s=O/n):E>A?E<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(E),n=R/r,s=L/r):A<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(A),n=O/s,r=L/s),this.set(n,r,s,e),this}let M=Math.sqrt((b-v)*(b-v)+(h-_)*(h-_)+(p-u)*(p-u));return Math.abs(M)<.001&&(M=1),this.x=(b-v)/M,this.y=(h-_)/M,this.z=(p-u)/M,this.w=Math.acos((c+m+y-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Fx{constructor(t,e,n,r,s,o,a,l,c){Fx.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,n,r,s,o,a,l,c)}set(t,e,n,r,s,o,a,l,c){const u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],p=n[2],m=n[5],v=n[8],_=r[0],b=r[3],y=r[6],M=r[1],S=r[4],E=r[7],A=r[2],R=r[5],O=r[8];return s[0]=o*_+a*M+l*A,s[3]=o*b+a*S+l*R,s[6]=o*y+a*E+l*O,s[1]=c*_+u*M+h*A,s[4]=c*b+u*S+h*R,s[7]=c*y+u*E+h*O,s[2]=p*_+m*M+v*A,s[5]=p*b+m*S+v*R,s[8]=p*y+m*E+v*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e*o*u-e*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*o-a*c,p=a*l-u*s,m=c*s-o*l,v=e*h+n*p+r*m;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/v;return t[0]=h*_,t[1]=(r*c-u*n)*_,t[2]=(a*n-r*o)*_,t[3]=p*_,t[4]=(u*e-r*l)*_,t[5]=(r*s-a*e)*_,t[6]=m*_,t[7]=(n*l-c*e)*_,t[8]=(o*e-n*s)*_,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+t,-r*c,r*l,-r*(-c*o+l*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(kS.makeScale(t,e)),this}rotate(t){return this.premultiply(kS.makeRotation(-t)),this}translate(t,e){return this.premultiply(kS.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const kS=new Fx,ab=2e3,aL=2001;class ov{constructor(t,e,n,r,s,o,a,l,c,u,h,p,m,v,_,b){ov.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,n,r,s,o,a,l,c,u,h,p,m,v,_,b)}set(t,e,n,r,s,o,a,l,c,u,h,p,m,v,_,b){const y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=h,y[14]=p,y[3]=m,y[7]=v,y[11]=_,y[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ov().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/$p.setFromMatrixColumn(t,0).length(),s=1/$p.setFromMatrixColumn(t,1).length(),o=1/$p.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,s=t.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(t.order==="XYZ"){const p=o*u,m=o*h,v=a*u,_=a*h;e[0]=l*u,e[4]=-l*h,e[8]=c,e[1]=m+v*c,e[5]=p-_*c,e[9]=-a*l,e[2]=_-p*c,e[6]=v+m*c,e[10]=o*l}else if(t.order==="YXZ"){const p=l*u,m=l*h,v=c*u,_=c*h;e[0]=p+_*a,e[4]=v*a-m,e[8]=o*c,e[1]=o*h,e[5]=o*u,e[9]=-a,e[2]=m*a-v,e[6]=_+p*a,e[10]=o*l}else if(t.order==="ZXY"){const p=l*u,m=l*h,v=c*u,_=c*h;e[0]=p-_*a,e[4]=-o*h,e[8]=v+m*a,e[1]=m+v*a,e[5]=o*u,e[9]=_-p*a,e[2]=-o*c,e[6]=a,e[10]=o*l}else if(t.order==="ZYX"){const p=o*u,m=o*h,v=a*u,_=a*h;e[0]=l*u,e[4]=v*c-m,e[8]=p*c+_,e[1]=l*h,e[5]=_*c+p,e[9]=m*c-v,e[2]=-c,e[6]=a*l,e[10]=o*l}else if(t.order==="YZX"){const p=o*l,m=o*c,v=a*l,_=a*c;e[0]=l*u,e[4]=_-p*h,e[8]=v*h+m,e[1]=h,e[5]=o*u,e[9]=-a*u,e[2]=-c*u,e[6]=m*h+v,e[10]=p-_*h}else if(t.order==="XZY"){const p=o*l,m=o*c,v=a*l,_=a*c;e[0]=l*u,e[4]=-h,e[8]=c*u,e[1]=p*h+_,e[5]=o*u,e[9]=m*h-v,e[2]=v*h-m,e[6]=a*u,e[10]=_*h+p}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(GWt,t,qWt)}lookAt(t,e,n){const r=this.elements;return sa.subVectors(t,e),sa.lengthSq()===0&&(sa.z=1),sa.normalize(),Lu.crossVectors(n,sa),Lu.lengthSq()===0&&(Math.abs(n.z)===1?sa.x+=1e-4:sa.z+=1e-4,sa.normalize(),Lu.crossVectors(n,sa)),Lu.normalize(),lb.crossVectors(sa,Lu),r[0]=Lu.x,r[4]=lb.x,r[8]=sa.x,r[1]=Lu.y,r[5]=lb.y,r[9]=sa.y,r[2]=Lu.z,r[6]=lb.z,r[10]=sa.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],p=n[9],m=n[13],v=n[2],_=n[6],b=n[10],y=n[14],M=n[3],S=n[7],E=n[11],A=n[15],R=r[0],O=r[4],L=r[8],P=r[12],D=r[1],V=r[5],K=r[9],W=r[13],Z=r[2],z=r[6],ut=r[10],nt=r[14],Q=r[3],St=r[7],Pt=r[11],dt=r[15];return s[0]=o*R+a*D+l*Z+c*Q,s[4]=o*O+a*V+l*z+c*St,s[8]=o*L+a*K+l*ut+c*Pt,s[12]=o*P+a*W+l*nt+c*dt,s[1]=u*R+h*D+p*Z+m*Q,s[5]=u*O+h*V+p*z+m*St,s[9]=u*L+h*K+p*ut+m*Pt,s[13]=u*P+h*W+p*nt+m*dt,s[2]=v*R+_*D+b*Z+y*Q,s[6]=v*O+_*V+b*z+y*St,s[10]=v*L+_*K+b*ut+y*Pt,s[14]=v*P+_*W+b*nt+y*dt,s[3]=M*R+S*D+E*Z+A*Q,s[7]=M*O+S*V+E*z+A*St,s[11]=M*L+S*K+E*ut+A*Pt,s[15]=M*P+S*W+E*nt+A*dt,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],s=t[12],o=t[1],a=t[5],l=t[9],c=t[13],u=t[2],h=t[6],p=t[10],m=t[14],v=t[3],_=t[7],b=t[11],y=t[15];return v*(+s*l*h-r*c*h-s*a*p+n*c*p+r*a*m-n*l*m)+_*(+e*l*m-e*c*p+s*o*p-r*o*m+r*c*u-s*l*u)+b*(+e*c*h-e*a*m-s*o*h+n*o*m+s*a*u-n*c*u)+y*(-r*a*u-e*l*h+e*a*p+r*o*h-n*o*p+n*l*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],p=t[10],m=t[11],v=t[12],_=t[13],b=t[14],y=t[15],M=h*b*c-_*p*c+_*l*m-a*b*m-h*l*y+a*p*y,S=v*p*c-u*b*c-v*l*m+o*b*m+u*l*y-o*p*y,E=u*_*c-v*h*c+v*a*m-o*_*m-u*a*y+o*h*y,A=v*h*l-u*_*l-v*a*p+o*_*p+u*a*b-o*h*b,R=e*M+n*S+r*E+s*A;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const O=1/R;return t[0]=M*O,t[1]=(_*p*s-h*b*s-_*r*m+n*b*m+h*r*y-n*p*y)*O,t[2]=(a*b*s-_*l*s+_*r*c-n*b*c-a*r*y+n*l*y)*O,t[3]=(h*l*s-a*p*s-h*r*c+n*p*c+a*r*m-n*l*m)*O,t[4]=S*O,t[5]=(u*b*s-v*p*s+v*r*m-e*b*m-u*r*y+e*p*y)*O,t[6]=(v*l*s-o*b*s-v*r*c+e*b*c+o*r*y-e*l*y)*O,t[7]=(o*p*s-u*l*s+u*r*c-e*p*c-o*r*m+e*l*m)*O,t[8]=E*O,t[9]=(v*h*s-u*_*s-v*n*m+e*_*m+u*n*y-e*h*y)*O,t[10]=(o*_*s-v*a*s+v*n*c-e*_*c-o*n*y+e*a*y)*O,t[11]=(u*a*s-o*h*s-u*n*c+e*h*c+o*n*m-e*a*m)*O,t[12]=A*O,t[13]=(u*_*r-v*h*r+v*n*p-e*_*p-u*n*b+e*h*b)*O,t[14]=(v*a*r-o*_*r-v*n*l+e*_*l+o*n*b-e*a*b)*O,t[15]=(o*h*r-u*a*r+u*n*l-e*h*l-o*n*p+e*a*p)*O,this}scale(t){const e=this.elements,n=t.x,r=t.y,s=t.z;return e[0]*=n,e[4]*=r,e[8]*=s,e[1]*=n,e[5]*=r,e[9]*=s,e[2]*=n,e[6]*=r,e[10]*=s,e[3]*=n,e[7]*=r,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),s=1-n,o=t.x,a=t.y,l=t.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,s,o){return this.set(1,n,s,0,t,1,o,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,s=e._x,o=e._y,a=e._z,l=e._w,c=s+s,u=o+o,h=a+a,p=s*c,m=s*u,v=s*h,_=o*u,b=o*h,y=a*h,M=l*c,S=l*u,E=l*h,A=n.x,R=n.y,O=n.z;return r[0]=(1-(_+y))*A,r[1]=(m+E)*A,r[2]=(v-S)*A,r[3]=0,r[4]=(m-E)*R,r[5]=(1-(p+y))*R,r[6]=(b+M)*R,r[7]=0,r[8]=(v+S)*O,r[9]=(b-M)*O,r[10]=(1-(p+_))*O,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let s=$p.set(r[0],r[1],r[2]).length();const o=$p.set(r[4],r[5],r[6]).length(),a=$p.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),t.x=r[12],t.y=r[13],t.z=r[14],dl.copy(this);const c=1/s,u=1/o,h=1/a;return dl.elements[0]*=c,dl.elements[1]*=c,dl.elements[2]*=c,dl.elements[4]*=u,dl.elements[5]*=u,dl.elements[6]*=u,dl.elements[8]*=h,dl.elements[9]*=h,dl.elements[10]*=h,e.setFromRotationMatrix(dl),n.x=s,n.y=o,n.z=a,this}makePerspective(t,e,n,r,s,o,a=ab){const l=this.elements,c=2*s/(e-t),u=2*s/(n-r),h=(e+t)/(e-t),p=(n+r)/(n-r);let m,v;if(a===ab)m=-(o+s)/(o-s),v=-2*o*s/(o-s);else if(a===aL)m=-o/(o-s),v=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,e,n,r,s,o,a=ab){const l=this.elements,c=1/(e-t),u=1/(n-r),h=1/(o-s),p=(e+t)*c,m=(n+r)*u;let v,_;if(a===ab)v=(o+s)*h,_=-2*h;else if(a===aL)v=s*h,_=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=_,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const $p=new lc,dl=new ov,GWt=new lc(0,0,0),qWt=new lc(1,1,1),Lu=new lc,lb=new lc,sa=new lc,pi={};pi.in=0;pi.out=1;pi.inout=2;const Wl=i=>i.token.data;pi.node=function(i){if((i.children[5]!=null?i.children[5].type:void 0)==="function")return pi.function(i);if((i.token!=null?i.token.type:void 0)==="keyword")return pi.external(i)};pi.external=function(i){let t=i.children,e=Wl(t[1]);const n=Wl(t[4]),r=t[5];["attribute","uniform","varying"].includes(e)||(e="global");const s=[];for(let o=0;o<r.children.length;o++)if(t=r.children[o],t.type==="ident"){const a=Wl(t),l=r.children[o+1],c=(l!=null?l.type:void 0)==="quantifier";s.push({decl:"external",storage:e,type:n,ident:a,quant:!!c,count:c})}return s};pi.function=function(i){const t=i.children,e=Wl(t[1]),n=Wl(t[4]),r=t[5],s=Wl(r.children[0]),o=r.children[1],a=r.children[2],l=Array.from(o.children).map(c=>pi.argument(c));return[{decl:"function",storage:e,type:n,ident:s,body:!!a,args:l}]};pi.argument=function(i){const t=i.children,e=Wl(t[1]),n=Wl(t[2]),r=Wl(t[4]),s=t[5],o=Wl(s.children[0]),a=s.children[1],l=a?a.children[0].token.data:void 0;return{decl:"argument",storage:e,inout:n,type:r,ident:o,quant:!!a,count:l}};pi.param=function(i,t,e,n,r){let s=[];t!=null&&s.push(t),e!=null&&s.push(e),s.push(""),s=s.join(" ");const o=n?"["+r+"]":"";i!==""&&(i+=" ");const a=(l,c)=>(c?i:"")+`${s}${l}${o}`;return a.split=l=>pi.param(l,t,e,n,r),a};const WWt=typeof window<"u",Jm=WWt&&!!window.THREE,jWt={int:0,float:0,vec2:Jm?YT:null,vec3:Jm?lc:null,vec4:Jm?KT:null,mat2:null,mat3:Jm?Fx:null,mat4:Jm?ov:null,sampler2D:0,samplerCube:0},XWt={int:"i",float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat2:"m2",mat3:"m3",mat4:"m4",sampler2D:"t",samplerCube:"t"};pi.type=function(i,t,e,n,r,s){const o={in:pi.in,out:pi.out,inout:pi.inout},a={const:"const"};let l=XWt[t];e&&(l+="v");let c=jWt[t];c!=null&&c.call&&(c=new c),e&&(c=[c]);const u=o[r]!=null?o[r]:o.in;s=a[s];const h=pi.param(r,s,t,e,n);return new uy(i,l,t,h,c,u)};class uy{constructor(t,e,n,r,s,o,a){this.name=t,this.type=e,this.spec=n,this.param=r,this.value=s,this.inout=o,this.meta=a}split(){const t=this.meta.shadowed!=null,e=t?"in":"out",n=t?pi.in:pi.out,r=this.param.split(e);return new uy(this.name,this.type,this.spec,r,this.value,n)}copy(t,e){return new uy(t??this.name,this.type,this.spec,this.param,this.value,this.inout,e)}}const ZT="_i_o",Od="return";let Ef=!1;const YWt=function(i,t){const e=KWt(i,t);return ZWt(e,t)},KWt=function(i,t){let e,n,r=[];Ef&&(n=UU());try{const o=mWt(t);e=HWt(o)}catch(o){r=[{message:o}]}Ef&&n("GLSL Tokenize & Parse");const s=function(o){o=o.split(`
`);const a=(""+o.length).length,l=function(c){return(c=""+c).length<a?("       "+c).slice(-a):c};return o.map((c,u)=>`${l(u+1)}: ${c}`).join(`
`)};if(!e||r.length){i||(i="(inline code)"),console.warn(s(t));for(const o of r)console.error(`${i} -`,o.message);throw new Error("GLSL parse error")}return e},ZWt=function(i,t){let e;Ef&&(e=UU());const n=[];JT(JWt,QWt(n),i,"");const[r,s,o]=Array.from(tjt(n)),a=ejt(r,s,o);return Ef&&e("GLSL AST"),{ast:i,code:t,signatures:a}},JWt=function(i,t){switch(i.type){case"decl":return t(pi.node(i)),!1}return!0},QWt=i=>function(t){t!=null&&Array.from(t).map(e=>i.push(e))},tjt=function(i){let t=null;const e=[];let n=[];const r={};let s=!1;for(const o of Array.from(i))o.body?(r[o.ident]&&(n=Array.from(n).filter(a=>a.ident!==o.ident),delete r[o.ident]),e.push(o),o.ident==="main"?(t=o,s=!0):s||(t=o)):o.storage==="global"?e.push(o):(n.push(o),r[o.ident]=!0);return[t,e,n]},ejt=function(i,t,e){let n;const r={uniform:[],attribute:[],varying:[],external:[],internal:[],global:[],main:null},s=a=>pi.type(a.ident,a.type,a.quant,a.count,a.inout,a.storage),o=function(a,l){let c;const u=Array.from(a.args).map(v=>s(v));for(c of Array.from(u))if(c.inout===pi.inout){const v=c,_=c.copy();v.inout=pi.in,_.inout=pi.out,_.meta={shadow:v.name},_.name+=ZT,v.meta={shadowed:_.name},u.push(_)}a.type!=="void"&&u.unshift(pi.type(Od,a.type,!1,"","out"));const h=(()=>{const v=[];for(c of Array.from(u))c.inout===pi.in&&v.push(c.type);return v})().join(","),p=(()=>{const v=[];for(c of Array.from(u))c.inout===pi.out&&v.push(c.type);return v})().join(","),m=`(${h})(${p})`;return{name:a.ident,type:m,signature:u,inout:l,spec:a.type}};r.main=o(i,pi.out);for(n of Array.from(t))r.internal.push({name:n.ident});for(n of Array.from(e)){let a;switch(n.decl){case"external":a=s(n),r[n.storage].push(a);break;case"function":a=o(n,pi.in),r.external.push(a);break}}return r};Ef=!1;const JT=function(i,t,e,n){if(Ef&&console.log(n,e.type,e.token!=null?e.token.data:void 0,e.token!=null?e.token.type:void 0),i(e,t))for(let s=0;s<e.children.length;s++){const o=e.children[s];JT(i,t,o,n+"  ")}return null},UU=function(){const i=+new Date;return function(t){const e=+new Date-i;return console.log(t,e+" ms"),e}};function njt(i){const t=i.replace(ZT,"");return t!==i?t:null}function FU(i){return i.join(`
`)}function QT(i){return i.join(", ")}function hy(i){return i.join(`;
`)}function xC(i){return{entry:i,type:"void",params:[],signature:[],return:"",vars:{},calls:[],post:[],chain:{}}}function tA(i,t){return`#define ${i} ${t}`}function VU(i,t,e,n,r){return`${i} ${t}(${e}) {
${n}${r}}`}function BU(i,t,e){return i=i?`${i} = `:"",e=QT(e),`  ${i}${t}(${e})`}function eA(i,t){for(let e=0;e<i.length;e++){const n=i[e],r=t[e];if(!r||n.type!==r.type||n.name===Od!=(r.name===Od))return!1}return!0}function wC(i,t,e,n,r){const s=[];let o="";for(let a of Array.from(n)){let l,c;const{name:u}=a;let h=l=i(u),p=null,m=null,v=!1;const _=u===Od;if((c=a.meta!=null?a.meta.shadowed:void 0)&&(p=i(c),p&&(r.vars[p]="  "+a.param(p),r.calls.push(`  ${p} = ${l}`),t(c)?m={shadowed:p}:a=a.split())),(c=a.meta!=null?a.meta.shadow:void 0)&&(p=i(c),p))if(!t(c))a=a.split(),v=!0;else{m={shadow:p};continue}if(_?o=l:v||s.push(p??l),t(u)){let b="push";_?r.return===""?(b="unshift",h=u,r.type=a.spec,r.return=`  return ${l}`,r.vars[l]="  "+a.param(l)):(r.vars[l]="  "+a.param(l),r.params.push(a.param(l,!0))):r.params.push(a.param(l,!0)),a=a.copy(h,m),r.signature[b](a)}else r.vars[l]="  "+a.param(l)}return r.calls.push(BU(o,e,s))}function SC(i,t){const{entry:e}=i;let n=null;if(t&&t.length===1&&e!=="main"){const r=t[0].module;eA(i.signature,r.main.signature)&&(n=tA(e,r.entry))}if(n==null){let r=(()=>{const c=[];for(const u in i.vars){const h=i.vars[u];c.push(h)}return c})();({calls:t}=i);const{post:s}=i;let{params:o}=i;const{type:a}=i,l=i.return;t=t.concat(s),l!==""&&t.push(l),t.push(""),r.length?(r.push(""),r=hy(r)+`
`):r="",t=hy(t),o=QT(o),n=VU(a,e,o,r,t)}return{signature:i.signature,code:n,name:e}}function ijt(i){const t={defs:[],bodies:[]};for(const e of Array.from(i))HU(e,t);return t.defs=FU(t.defs),t.bodies=hy(t.bodies),t.defs===""&&delete t.defs,t.bodies===""&&delete t.bodies,t}const HU=(i,t)=>{let e,n;const{module:r,name:s,external:o}=i,{main:a}=r,{entry:l}=r;if(eA(a.signature,o.signature))return t.defs.push(tA(s,l));const c=[],u=[];let h={};const p=[r.namespace,Od].join("");for(e of Array.from(o.signature))n=e.inout===iv?c:u,n.push(e);for(e of Array.from(a.signature)){n=e.inout===iv?c:u;let M=n.shift().name;M===Od&&(M=p),h[e.name]=M}let m=y=>h[y];const v=()=>!0,_=xC();wC(m,v,l,a.signature,_),_.entry=l,h={return:p},m=y=>h[y]!=null?h[y]:y;const b=xC();return wC(m,v,l,o.signature,b),b.calls=_.calls,b.entry=s,t.bodies.push(SC(_).code.split(" {")[0]),t.bodies.push(SC(b).code)};function rjt(i){const t=/([A-Za-z0-9_]+\s+)?[A-Za-z0-9_]+\s+[A-Za-z0-9_]+\s*\([^)]*\)\s*;\s*/gm,e=s=>s.replace(t,o=>""),n=i.split(/(?=[{}])/g);let r=0;for(let s=0;s<n.length;s++){const o=n[s];switch(o[0]){case"{":r++;break;case"}":r--;break}if(r===0){const a=o.split(/^[ \t]*#/m);for(let l=0;l<a.length;l++){let c=a[l];if(l>0){c=c.split(/\n/);const u=c.shift(),h=c.join(`
`);a[l]=[u,e(h)].join(`
`)}else a[l]=e(c)}n[s]=a.join("#")}}return i=n.join("")}function sjt(i){const t={},e=/((attribute|uniform|varying)\s+)[A-Za-z0-9_]+\s+([A-Za-z0-9_]+)\s*(\[[^\]]*\]\s*)?;\s*/gm;return i.replace(e,function(n,r,s,o,a){return t[o]?"":(t[o]=!0,n)})}function ojt(i){const t=function(n,r){const s=[],o=[];for(const a of Array.from(n))(a.match(r)?s:o).push(a);return s.concat(o)};let e=i.split(`
`);return e=t(e,/^#define ([^ ]+ _pg_[0-9]+_|_pg_[0-9]+_ [^ ]+)$/),e=t(e,/^#extension/),e.join(`
`)}const MC=Object.freeze(Object.defineProperty({__proto__:null,RETURN_ARG:Od,SHADOW_ARG:ZT,body:xC,build:SC,call:wC,compile:Xqt,dedupe:sjt,define:tA,defuse:rjt,fn:VU,hoist:ojt,invoke:BU,lines:FU,link:HU,links:ijt,list:QT,parse:YWt,same:eA,statements:hy,unshadow:njt,walk:JT},Symbol.toStringTag,{value:"Module"})),{library:ajt,cache:ljt}=kU,{visualize:cjt,inspect:$U}=TU,{Snippet:ujt}=SU,lL=function(i,t={}){const e={};for(let n in i)e[n]=t[n]||i[n];return e};class nc{constructor(t,e){const n={globalUniforms:!1,globalVaryings:!0,globalAttributes:!0,globals:[],autoInspect:!1};this.config=lL(n,e),this.fetch=ljt(ajt(MC,t,ujt.load))}shader(t){t==null&&(t={});const e=lL(this.config,t);return new AU(MC,this.fetch,e)}material(t){return new PU(this.shader(t),this.shader(t))}inspect(t){return nc.inspect(t)}visualize(t){return nc.visualize(t)}static inspect(t){return $U(t)}static visualize(t){return cjt(t)}}nc.Block=ql;nc.Factory=kU;nc.GLSL=MC;nc.Graph=Aqt;nc.Linker=SU;nc.Visualize=TU;function hjt(i,t={}){return new nc(i,t)}const GU=function(i){function t(e){const n=i[e];if(n!=null)return n;const s=["#",".",":","["].includes(e[0])?e:`#${e}`,o=document.querySelector(s);if(o!=null&&o.tagName==="SCRIPT")return o.textContent||o.innerText;throw new Error(`Unknown shader \`${e}\``)}return hjt(t,{autoInspect:!0})},qU={"arrow.position":M$t,"axis.position":C$t,"cartesian.position":T$t,"cartesian4.position":E$t,"clamp.position":A$t,"color.opaque":P$t,"face.position":R$t,"face.position.normal":k$t,"float.encode":L$t,"float.index.pack":O$t,"float.stretch":D$t,"fragment.clip.dashed":I$t,"fragment.clip.dotted":N$t,"fragment.clip.ends":z$t,"fragment.clip.proximity":U$t,"fragment.color":F$t,"fragment.map.rgba":V$t,"fragment.solid":B$t,"fragment.transparent":H$t,"grid.position":$$t,"grow.position":G$t,"join.position":q$t,"label.alpha":W$t,"label.map":j$t,"label.outline":X$t,"layer.position":Y$t,"lerp.depth":K$t,"lerp.height":Z$t,"lerp.items":J$t,"lerp.width":Q$t,"line.position":tGt,"map.2d.data":eGt,"map.2d.data.wrap":nGt,"map.xyzw.2dv":iGt,"map.xyzw.align":rGt,"map.xyzw.texture":sGt,"mesh.fragment.color":oGt,"mesh.fragment.map":aGt,"mesh.fragment.mask":lGt,"mesh.fragment.material":cGt,"mesh.fragment.shaded":uGt,"mesh.fragment.texture":hGt,"mesh.gamma.in":dGt,"mesh.gamma.out":pGt,"mesh.map.uvwo":fGt,"mesh.position":mGt,"mesh.vertex.color":gGt,"mesh.vertex.mask":vGt,"mesh.vertex.position":_Gt,"move.position":bGt,"object.mask.default":yGt,"point.alpha.circle":xGt,"point.alpha.circle.hollow":wGt,"point.alpha.generic":SGt,"point.alpha.generic.hollow":MGt,"point.edge":CGt,"point.fill":EGt,"point.mask.circle":TGt,"point.mask.diamond":AGt,"point.mask.down":PGt,"point.mask.left":RGt,"point.mask.right":kGt,"point.mask.square":LGt,"point.mask.up":OGt,"point.position":DGt,"point.size.uniform":IGt,"point.size.varying":NGt,"polar.position":zGt,"project.position":UGt,"project.readback":FGt,"raw.position.scale":VGt,"repeat.position":BGt,"resample.padding":HGt,"resample.relative":$Gt,"reveal.mask":GGt,"reverse.position":qGt,"root.position":WGt,"sample.2d":jGt,"scale.position":XGt,"screen.map.stpq":YGt,"screen.map.xy":KGt,"screen.map.xyzw":ZGt,"screen.pass.uv":JGt,"screen.position":QGt,"slice.position":tqt,"spherical.position":eqt,"split.position":nqt,"spread.position":iqt,"sprite.fragment":rqt,"sprite.position":sqt,"stereographic.position":aqt,"stereographic4.position":oqt,"stpq.sample.2d":lqt,"stpq.xyzw.2d":cqt,"strip.position.normal":uqt,"style.color":hqt,"subdivide.depth":dqt,"subdivide.depth.lerp":pqt,"subdivide.height":fqt,"subdivide.height.lerp":mqt,"subdivide.items":gqt,"subdivide.items.lerp":vqt,"subdivide.width":_qt,"subdivide.width.lerp":bqt,"surface.mask.hollow":yqt,"surface.position":xqt,"surface.position.normal":wqt,"surface.position.shaded":Sqt,"ticks.position":Mqt,"transform3.position":Cqt,"transform4.position":Eqt,"view.position":Tqt},djt=Object.freeze(Object.defineProperty({__proto__:null,Factory:GU,Snippets:qU},Symbol.toStringTag,{value:"Module"}));class WU{constructor(t){this.context=t,this.anims=[]}make(t,e){const n=new pjt(this,this.context.time,t,e);return this.anims.push(n),n}unmake(t){return this.anims=Array.from(this.anims).filter(e=>e!==t)}update(){const{time:t}=this.context;return this.anims=(()=>{const e=[];for(const n of Array.from(this.anims))n.update(t)!==!1&&e.push(n);return e})()}lerp(t,e,n,r,s){if(s==null&&(s=t.make()),t.lerp)s=t.lerp(e,n,s,r);else if(t.emitter){const o=e.emitterFrom,a=n.emitterTo;if(o!=null&&a!=null&&o===a)return o.lerp(r),o;{const l=t.emitter(e,n);return e.emitterFrom=l,n.emitterTo=l,l.lerp(r),l}}else if(t.op){const o=function(a,l){return a===+a&&l===+l?a+(l-a)*r:r>.5?l:a};s=t.op(e,n,s,o)}else s=r>.5?n:e;return s}}let pjt=class{constructor(t,e,n,r){this.animator=t,this.time=e,this.type=n,this.options=r,this.value=this.type.make(),this.target=this.type.make(),this.queue=[]}dispose(){return this.animator.unmake(this)}set(){let{target:t}=this,e=arguments.length>1?[].slice.call(arguments):arguments[0],n=!1;return e=this.type.validate(e,t,()=>n=!0),n||(t=e),this.cancel(),this.target=this.value,this.value=t,this.notify()}getTime(){const{clock:t}=this.options,e=t?t.getTime():this.time;return this.options.realtime?e.time:e.clock}cancel(t){let e;t==null&&(t=this.getTime());const{queue:n}=this,r=(()=>{const s=[];for(e of Array.from(n))e.end>=t&&s.push(e);return s})();this.queue=(()=>{const s=[];for(e of Array.from(n))e.end<t&&s.push(e);return s})();for(e of Array.from(r))typeof e.complete=="function"&&e.complete(!1);typeof this.options.complete=="function"&&this.options.complete(!1)}notify(){return typeof this.options.step=="function"?this.options.step(this.value):void 0}immediate(t,e){const{duration:n,delay:r,ease:s,step:o,complete:a}=e,c=this.getTime()+r,u=c+n;let h=!1,p=this.type.make();return t=this.type.validate(t,p,function(){return h=!0,null}),t!==void 0&&!h&&(p=t),this.cancel(c),this.queue.push({from:null,to:p,start:c,end:u,ease:s,step:o,complete:a})}update(t){if(this.time=t,this.queue.length===0)return!0;const e=this.getTime();let{value:n}=this;const{queue:r}=this;let s=!1;for(;!s;){const o=r[0];let{from:a}=o;const{to:l,start:c,end:u,step:h,complete:p,ease:m}=o;a==null&&(a=o.from=this.type.clone(this.value));let v=Ox((e-c)/Math.max(1e-5,u-c)||0,0,1);if(v===0)return;const _=(()=>{switch(m){case"linear":case 0:return null;case"cosine":case 1:return nv;case"binary":case 2:return zT;case"hold":case 3:return UT;default:return nv}})();if(_!=null&&(v=_(v)),s=v<1,n=s?this.animator.lerp(this.type,a,l,v,n):l,typeof h=="function"&&h(n),!s&&(typeof p=="function"&&p(!0),typeof this.options.complete=="function"&&this.options.complete(!0),r.shift(),r.length===0))break}return this.value=n,this.notify()}};class Vx{v2(){return this}constructor(t,e,n){this._context=t,this._up=e,this._targets=n;const r=this._context.controller.getRoot();this._targets==null&&(this._targets=[r]),this.isRoot=this._targets.length===1&&this._targets[0]===r,this.isLeaf=this._targets.length===1&&this._targets[0].children==null;for(let s=0;s<this._targets.length;s++){const o=this._targets[s];this[s]=o}this.length=this._targets.length;for(const s of Array.from(this._context.controller.getTypes()))["root"].includes(s)||(this[s]=(o,a)=>this.add(s,o,a))}select(t){const e=this._context.model.select(t,this.isRoot?null:this._targets);return this._push(e)}eq(t){return this._targets.length>t?this._push([this._targets[t]]):this._push([])}filter(t){if(typeof t=="string"){const e=this._context.model._matcher(t);t=n=>e(n)}return this._push(this._targets.filter(t))}map(t){return fjt(0,this.length,!1).map(e=>t(this[e],e,this))}each(t){for(let e=0,n=this.length,r=0<=n;r?e<n:e>n;r?e++:e--)t(this[e],e,this);return this}add(t,e,n){const{controller:r}=this._context;if(this.isLeaf)return this._pop().add(t,e,n);const s=[];for(const o of this._targets){const a=r.make(t,e,n);r.add(a,o),s.push(a)}return this._push(s)}remove(t){if(t)return this.select(t).remove();for(const e of Array.from(this._targets.slice().reverse()))this._context.controller.remove(e);return this._pop()}set(t,e){for(const n of Array.from(this._targets))this._context.controller.set(n,t,e);return this}getAll(t){return Array.from(this._targets).map(e=>this._context.controller.get(e,t))}get(t){return this._targets[0]!=null?this._targets[0].get(t):void 0}evaluate(t,e){return this._targets[0]!=null?this._targets[0].evaluate(t,e):void 0}bind(t,e){for(const n of Array.from(this._targets))this._context.controller.bind(n,t,e);return this}unbind(t){for(const e of Array.from(this._targets))this._context.controller.unbind(e,t);return this}end(){return(this.isLeaf?this._pop():this)._pop()}_push(t){return new Vx(this._context,this,t)}_pop(){return this._up!=null?this._up:this}_reset(){let t;return(t=this._up!=null?this._up.reset():void 0)!=null?t:this}map(t){return this._targets.map(t)}on(){const t=arguments;return this._targets.map(e=>e.on.apply(e,t)),this}off(){const t=arguments;return this._targets.map(e=>e.off.apply(e,t)),this}toString(){const t=this._targets.map(e=>e.toString());return this._targets.length>1?`[${t.join(", ")}]`:t[0]}toMarkup(){return this._targets.map(e=>e.toMarkup()).join(`

`)}print(){return iT(this._targets.map(t=>t.toMarkup()).join(`

`)),this}debug(){const t=this.inspect();console.log("Renderables: ",t.renderables),console.log("Renders: ",t.renders),console.log("Shaders: ",t.shaders);const e=r=>r.constructor.name,n=[];for(const r of Array.from(t.shaders)){const s=e(r.owner);n.push(`${s} - Vertex`),n.push(r.vertex),n.push(`${s} - Fragment`),n.push(r.fragment)}return $U(n)}inspect(t,e,n){let r;typeof e=="boolean"&&(n=e,e=null),n==null&&(n=!0);const s=u=>(u.controller!=null?u.controller.objects:void 0)!=null?u.controller!=null?u.controller.objects:void 0:[],o=r=function(u,h){if(h==null&&(h=[]),(!e||u.traits.hash[e])&&h.push(s(u)),u.children!=null)for(const p of Array.from(u.children))r(p,h);return h},a=function(u){return u=u.reduce((h,p)=>h.concat(p),[]),u=u.filter((h,p)=>h!=null&&u.indexOf(h)===p)},l=function(u,h){const p={};return p.owner=u,p.geometry=h.geometry,p.material=h.material,p.vertex=h.userData.vertexGraph,p.fragment=h.userData.fragmentGraph,p},c={nodes:this._targets.slice(),renderables:[],renders:[],shaders:[]};for(const u of Array.from(this._targets)){let h;n&&u.print(t,"info");const p={renderables:h=a(o(u)),renders:a(h.map(m=>m.renders)),shaders:a(h.map(m=>m.renders!=null?m.renders.map(v=>l(m,v)):void 0))};for(const m in p)c[m]=c[m].concat(p[m])}return c}}function fjt(i,t,e){const n=[],r=i<t,s=e?r?t+1:t-1:t;for(let o=i;r?o<s:o>s;r?o++:o--)n.push(o);return n}class jU{constructor(t,e){this.model=t,this.primitives=e}getRoot(){return this.model.getRoot()}getTypes(){return this.primitives.getTypes()}make(t,e,n){return this.primitives.make(t,e,n)}get(t,e){return t.get(e)}set(t,e,n){try{return t.set(e,n)}catch(r){return t.print(null,"warn"),console.error(r)}}bind(t,e,n){try{return t.bind(e,n)}catch(r){return t.print(null,"warn"),console.error(r)}}unbind(t,e){try{return t.unbind(e)}catch(n){return t.print(null,"warn"),console.error(n)}}add(t,e){return e==null&&(e=this.model.getRoot()),e.add(t)}remove(t){const e=t.parent;if(e)return e.remove(t)}}const mjt=Object.freeze(Object.defineProperty({__proto__:null,API:Vx,Animator:WU,Controller:jU},Symbol.toStringTag,{value:"Module"})),gjt=P5t,vjt=WIt,_jt=D5t,bjt=XIt,yjt=k5t,xjt=p7,wjt=qIt,Sjt=W5t,XU=HIt,Mjt=Object.freeze(Object.defineProperty({__proto__:null,Axis:gjt,Data:vjt,Ease:_jt,GLSL:bjt,JS:yjt,Pretty:xjt,Three:wjt,Ticks:Sjt,VDOM:XU},Symbol.toStringTag,{value:"Module"}));let nA=class{static initClass(){this.Namespace={Model:NIt,Overlay:$It,Primitives:K5t,Render:S$t,Shaders:djt,Stage:mjt,Util:Mjt,DOM:XU},this.Version="2.3.1"}constructor(t,e=null,n=null){let r;this.canvas=r=t.domElement,this.element=null,this.shaders=GU(qU),this.renderables=new dU(bU,t,this.shaders),this.overlays=new uz(gz,r),this.scene=this.renderables.make("scene",{scene:e}),this.camera=this.defaultCamera=n??new Di,this.attributes=new lN(dC,this),this.primitives=new uU(dC,this),this.root=this.primitives.make("root"),this.model=new cz(this.root),this.guard=new pN,this.controller=new jU(this.model,this.primitives),this.animator=new WU(this),this.api=new Vx(this),this.speed=1,this.time={now:+new Date/1e3,time:0,delta:0,clock:0,step:0}}init(){return this.scene.inject(),this.overlays.inject(),this}destroy(){return this.scene.unject(),this.overlays.unject(),this}resize(t){return t==null&&(t={}),t.renderWidth==null&&(t.renderWidth=t.viewWidth!=null?t.viewWidth:t.viewWidth=1280),t.renderHeight==null&&(t.renderHeight=t.viewHeight!=null?t.viewHeight:t.viewHeight=720),t.pixelRatio==null&&(t.pixelRatio=t.renderWidth/Math.max(1e-6,t.viewWidth)),t.aspect==null&&(t.aspect=t.viewWidth/Math.max(1e-6,t.viewHeight)),this.root.controller.resize(t),this}frame(t){return this.pre(t),this.update(),this.render(),this.post(),this}pre(t){return t||(t={now:+new Date/1e3,time:0,delta:0,clock:0,step:0},t.delta=this.time.now!=null?t.now-this.time.now:0,t.delta>1&&(t.delta=1/60),t.step=t.delta*this.speed,t.time=this.time.time+t.delta,t.clock=this.time.clock+t.step),this.time=t,typeof this.root.controller.pre=="function"&&this.root.controller.pre(),this}update(){return this.animator.update(),this.attributes.compute(),this.guard.iterate({step:()=>{let t=this.attributes.digest();return t||(t=this.model.digest())},last(){return{attribute:this.attributes.getLastTrigger(),model:this.model.getLastTrigger()}}}),typeof this.root.controller.update=="function"&&this.root.controller.update(),this.camera=this.root.controller.getCamera(),this.speed=this.root.controller.getSpeed(),this}render(){return typeof this.root.controller.render=="function"&&this.root.controller.render(),this.scene.render(),this}post(){return typeof this.root.controller.post=="function"&&this.root.controller.post(),this}setWarmup(t){return this.scene.warmup(t),this}getPending(){return this.scene.pending.length}};nA.initClass();const YU=Math.PI,Cjt=YU*2,KU=nA,cL=nA.Version;Kn.registerPlugin("mathbox",{defaults:{init:!0,warmup:2,inspect:!0,splash:!0},listen:["ready","pre","update","post","resize"],install(i){let t=!1;return this.first=!0,i.MathBox={init:e=>{if(t)return;t=!0;const n=(e!=null?e.scene:void 0)||this.options.scene||i.scene,r=(e!=null?e.camera:void 0)||this.options.camera||i.camera;this.context=new KU(i.renderer,n,r),this.context.api.three=i.three=i,this.context.api.mathbox=i.mathbox=this.context.api,this.context.api.start=()=>i.Loop.start(),this.context.api.stop=()=>i.Loop.stop(),this.context.init(),this.context.resize(i.Size),this.context.setWarmup(this.options.warmup),this.pending=0,this.warm=!this.options.warmup,console.log("MathBox",cL),i.trigger({type:"mathbox/init",version:cL,context:this.context})},destroy:()=>{t&&(t=!1,i.trigger({type:"mathbox/destroy",context:this.context}),this.context.destroy(),delete i.mathbox,delete this.context.api.three,delete this.context)},object:()=>this.context!=null?this.context.scene.root:void 0}},uninstall(i){i.MathBox.destroy(),delete i.MathBox},ready(i,t){if(this.options.init)return t.MathBox.init(),setTimeout(()=>{if(this.options.inspect&&t.MathBox)return this.inspect(t)})},inspect(i){if(this.context.api.inspect(),!this.options.warmup)return this.info(i)},info(i){const t=function(n){const r=[];for(;n>=1e3;)r.unshift(("000"+n%1e3).slice(-3)),n=Math.floor(n/1e3);return r.unshift(n),r.join(",")},e=i.renderer.info.render;console.log("Geometry  ",t(e.triangles)+" triangles  ",t(e.points)+" points  ",t(e.lines)+" lines  ",t(e.calls)+" draw calls  ")},resize(i,t){return this.context!=null?this.context.resize(t.Size):void 0},pre(i,t){return this.context!=null?this.context.pre(t.Time):void 0},update(i,t){let e;return this.context!=null&&this.context.update(),(e=this.context!=null?this.context.camera:void 0)&&e!==t.camera&&(t.camera=e),t.Time.set({speed:this.context.speed}),this.progress(this.context.getPending(),t),this.context!=null?this.context.render():void 0},post(i,t){return this.context!=null?this.context.post():void 0},progress(i,t){if(!i&&!this.pending)return;let e=Math.max(i+this.options.warmup,this.pending);const n=e-i,r=e;t.trigger({type:"mathbox/progress",current:e-i,total:e}),i===0&&(e=0),this.pending=e,n===r&&!this.warm&&(this.warm=!0,this.options.inspect&&this.info(t))}});var CC={exports:{}};/*! Tweakpane 3.1.10 (c) 2016 cocopon, licensed under the MIT license. */(function(i,t){(function(e,n){n(t)})(zt,function(e){class n{constructor(f){const[x,T]=f.split("-"),I=x.split(".");this.major=parseInt(I[0],10),this.minor=parseInt(I[1],10),this.patch=parseInt(I[2],10),this.prerelease=T??null}toString(){const f=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[f,this.prerelease].join("-"):f}}class r{constructor(f){this.controller_=f}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(f){this.controller_.viewProps.set("disabled",f)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(f){this.controller_.viewProps.set("hidden",f)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class s{constructor(f){this.target=f}}class o extends s{constructor(f,x,T,I){super(f),this.value=x,this.presetKey=T,this.last=I??!0}}class a extends s{constructor(f,x,T){super(f),this.value=x,this.presetKey=T}}class l extends s{constructor(f,x){super(f),this.expanded=x}}class c extends s{constructor(f,x){super(f),this.index=x}}function u(w){return w}function h(w){return w==null}function p(w,f){if(w.length!==f.length)return!1;for(let x=0;x<w.length;x++)if(w[x]!==f[x])return!1;return!0}function m(w,f){let x=w;do{const T=Object.getOwnPropertyDescriptor(x,f);if(T&&(T.set!==void 0||T.writable===!0))return!0;x=Object.getPrototypeOf(x)}while(x!==null);return!1}const v={alreadydisposed:()=>"View has been already disposed",invalidparams:w=>`Invalid parameters for '${w.name}'`,nomatchingcontroller:w=>`No matching controller for '${w.key}'`,nomatchingview:w=>`No matching view for '${JSON.stringify(w.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:w=>`Property '${w.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class _{static alreadyDisposed(){return new _({type:"alreadydisposed"})}static notBindable(){return new _({type:"notbindable"})}static propertyNotFound(f){return new _({type:"propertynotfound",context:{name:f}})}static shouldNeverHappen(){return new _({type:"shouldneverhappen"})}constructor(f){var x;this.message=(x=v[f.type](f.context))!==null&&x!==void 0?x:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=f.type}}class b{constructor(f,x,T){this.obj_=f,this.key_=x,this.presetKey_=T??x}static isBindable(f){return!(f===null||typeof f!="object"&&typeof f!="function")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(f){this.obj_[this.key_]=f}writeProperty(f,x){const T=this.read();if(!b.isBindable(T))throw _.notBindable();if(!(f in T))throw _.propertyNotFound(f);T[f]=x}}class y extends r{get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get title(){var f;return(f=this.controller_.valueController.props.get("title"))!==null&&f!==void 0?f:""}set title(f){this.controller_.valueController.props.set("title",f)}on(f,x){const T=x.bind(this);return this.controller_.valueController.emitter.on(f,()=>{T(new s(this))}),this}}class M{constructor(){this.observers_={}}on(f,x){let T=this.observers_[f];return T||(T=this.observers_[f]=[]),T.push({handler:x}),this}off(f,x){const T=this.observers_[f];return T&&(this.observers_[f]=T.filter(I=>I.handler!==x)),this}emit(f,x){const T=this.observers_[f];T&&T.forEach(I=>{I.handler(x)})}}const S="tp";function E(w){return(x,T)=>[S,"-",w,"v",x?`_${x}`:"",T?`-${T}`:""].join("")}function A(w,f){return x=>f(w(x))}function R(w){return w.rawValue}function O(w,f){w.emitter.on("change",A(R,f)),f(w.rawValue)}function L(w,f,x){O(w.value(f),x)}function P(w,f,x){x?w.classList.add(f):w.classList.remove(f)}function D(w,f){return x=>{P(w,f,x)}}function V(w,f){O(w,x=>{f.textContent=x??""})}const K=E("btn");class W{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(K()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("button");T.classList.add(K("b")),x.viewProps.bindDisabled(T),this.element.appendChild(T),this.buttonElement=T;const I=f.createElement("div");I.classList.add(K("t")),V(x.props.value("title"),I),this.buttonElement.appendChild(I)}}class Z{constructor(f,x){this.emitter=new M,this.onClick_=this.onClick_.bind(this),this.props=x.props,this.viewProps=x.viewProps,this.view=new W(f,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class z{constructor(f,x){var T;this.constraint_=x==null?void 0:x.constraint,this.equals_=(T=x==null?void 0:x.equals)!==null&&T!==void 0?T:(I,it)=>I===it,this.emitter=new M,this.rawValue_=f}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(f){this.setRawValue(f,{forceEmit:!1,last:!0})}setRawValue(f,x){const T=x??{forceEmit:!1,last:!0},I=this.constraint_?this.constraint_.constrain(f):f,it=this.rawValue_;this.equals_(it,I)&&!T.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=I,this.emitter.emit("change",{options:T,previousRawValue:it,rawValue:I,sender:this}))}}class ut{constructor(f){this.emitter=new M,this.value_=f}get rawValue(){return this.value_}set rawValue(f){this.setRawValue(f,{forceEmit:!1,last:!0})}setRawValue(f,x){const T=x??{forceEmit:!1,last:!0},I=this.value_;I===f&&!T.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=f,this.emitter.emit("change",{options:T,previousRawValue:I,rawValue:this.value_,sender:this}))}}function nt(w,f){const x=f==null?void 0:f.constraint,T=f==null?void 0:f.equals;return!x&&!T?new ut(w):new z(w,f)}class Q{constructor(f){this.emitter=new M,this.valMap_=f;for(const x in this.valMap_)this.valMap_[x].emitter.on("change",()=>{this.emitter.emit("change",{key:x,sender:this})})}static createCore(f){return Object.keys(f).reduce((T,I)=>Object.assign(T,{[I]:nt(f[I])}),{})}static fromObject(f){const x=this.createCore(f);return new Q(x)}get(f){return this.valMap_[f].rawValue}set(f,x){this.valMap_[f].rawValue=x}value(f){return this.valMap_[f]}}function St(w,f){const T=Object.keys(f).reduce((I,it)=>{if(I===void 0)return;const xt=f[it],Zt=xt(w[it]);return Zt.succeeded?Object.assign(Object.assign({},I),{[it]:Zt.value}):void 0},{});return T}function Pt(w,f){return w.reduce((x,T)=>{if(x===void 0)return;const I=f(T);if(!(!I.succeeded||I.value===void 0))return[...x,I.value]},[])}function dt(w){return w===null?!1:typeof w=="object"}function Rt(w){return f=>x=>{if(!f&&x===void 0)return{succeeded:!1,value:void 0};if(f&&x===void 0)return{succeeded:!0,value:void 0};const T=w(x);return T!==void 0?{succeeded:!0,value:T}:{succeeded:!1,value:void 0}}}function Jt(w){return{custom:f=>Rt(f)(w),boolean:Rt(f=>typeof f=="boolean"?f:void 0)(w),number:Rt(f=>typeof f=="number"?f:void 0)(w),string:Rt(f=>typeof f=="string"?f:void 0)(w),function:Rt(f=>typeof f=="function"?f:void 0)(w),constant:f=>Rt(x=>x===f?f:void 0)(w),raw:Rt(f=>f)(w),object:f=>Rt(x=>{if(dt(x))return St(x,f)})(w),array:f=>Rt(x=>{if(Array.isArray(x))return Pt(x,f)})(w)}}const Bt={optional:Jt(!0),required:Jt(!1)};function Wt(w,f){const x=Bt.required.object(f)(w);return x.succeeded?x.value:void 0}function be(w){console.warn([`Missing '${w.key}' of ${w.target} in ${w.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function re(w){return w&&w.parentElement&&w.parentElement.removeChild(w),null}class It{constructor(f){this.value_=f}static create(f){return[new It(f),(x,T)=>{f.setRawValue(x,T)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const ye=E("");function ce(w,f){return D(w,ye(void 0,f))}class ne extends Q{constructor(f){var x;super(f),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=It.create(nt(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(x=this.get("parent"))===null||x===void 0||x.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(f){var x,T,I;const it=f??{};return new ne(Q.createCore({disabled:(x=it.disabled)!==null&&x!==void 0?x:!1,disposed:!1,hidden:(T=it.hidden)!==null&&T!==void 0?T:!1,parent:(I=it.parent)!==null&&I!==void 0?I:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(f){O(this.globalDisabled_,ce(f,"disabled")),L(this,"hidden",ce(f,"hidden"))}bindDisabled(f){O(this.globalDisabled_,x=>{f.disabled=x})}bindTabIndex(f){O(this.globalDisabled_,x=>{f.tabIndex=x?-1:0})}handleDispose(f){this.value("disposed").emitter.on("change",x=>{x&&f()})}getGlobalDisabled_(){const f=this.get("parent");return(f?f.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(f){var x;const T=f.previousRawValue;T==null||T.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(x=this.get("parent"))===null||x===void 0||x.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function Gt(){return["veryfirst","first","last","verylast"]}const J=E(""),$t={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class et{constructor(f){this.parent_=null,this.blade=f.blade,this.view=f.view,this.viewProps=f.viewProps;const x=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Gt().forEach(T=>{x.classList.remove(J(void 0,$t[T]))}),this.blade.get("positions").forEach(T=>{x.classList.add(J(void 0,$t[T]))})}),this.viewProps.handleDispose(()=>{re(x)})}get parent(){return this.parent_}set parent(f){if(this.parent_=f,!("parent"in this.viewProps.valMap_)){be({key:"parent",target:ne.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const ft="http://www.w3.org/2000/svg";function kt(w){w.offsetHeight}function Qt(w,f){const x=w.style.transition;w.style.transition="none",f(),w.style.transition=x}function qt(w){return w.ontouchstart!==void 0}function ot(){return globalThis}function st(){return ot().document}function _t(w){const f=w.ownerDocument.defaultView;return f&&"document"in f?w.getContext("2d",{willReadFrequently:!0}):null}const $={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function B(w,f){const x=w.createElementNS(ft,"svg");return x.innerHTML=$[f],x}function Lt(w,f,x){w.insertBefore(f,w.children[x])}function jt(w){w.parentElement&&w.parentElement.removeChild(w)}function Kt(w){for(;w.children.length>0;)w.removeChild(w.children[0])}function se(w){for(;w.childNodes.length>0;)w.removeChild(w.childNodes[0])}function we(w){return w.relatedTarget?w.relatedTarget:"explicitOriginalTarget"in w?w.explicitOriginalTarget:null}const ht=E("lbl");function mt(w,f){const x=w.createDocumentFragment();return f.split(`
`).map(I=>w.createTextNode(I)).forEach((I,it)=>{it>0&&x.appendChild(w.createElement("br")),x.appendChild(I)}),x}class tt{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(ht()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("div");T.classList.add(ht("l")),L(x.props,"label",it=>{h(it)?this.element.classList.add(ht(void 0,"nol")):(this.element.classList.remove(ht(void 0,"nol")),se(T),T.appendChild(mt(f,it)))}),this.element.appendChild(T),this.labelElement=T;const I=f.createElement("div");I.classList.add(ht("v")),this.element.appendChild(I),this.valueElement=I}}class Ut extends et{constructor(f,x){const T=x.valueController.viewProps;super(Object.assign(Object.assign({},x),{view:new tt(f,{props:x.props,viewProps:T}),viewProps:T})),this.props=x.props,this.valueController=x.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const oe={id:"button",type:"blade",accept(w){const f=Bt,x=Wt(w,{title:f.required.string,view:f.required.constant("button"),label:f.optional.string});return x?{params:x}:null},controller(w){return new Ut(w.document,{blade:w.blade,props:Q.fromObject({label:w.params.label}),valueController:new Z(w.document,{props:Q.fromObject({title:w.params.title}),viewProps:w.viewProps})})},api(w){return!(w.controller instanceof Ut)||!(w.controller.valueController instanceof Z)?null:new y(w.controller)}};class ue extends et{constructor(f){super(f),this.value=f.value}}function ae(){return new Q({positions:nt([],{equals:p})})}class xe extends Q{constructor(f){super(f)}static create(f){const x={completed:!0,expanded:f,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},T=Q.createCore(x);return new xe(T)}get styleExpanded(){var f;return(f=this.get("temporaryExpanded"))!==null&&f!==void 0?f:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const f=this.get("expandedHeight");return this.get("shouldFixHeight")&&!h(f)?`${f}px`:"auto"}bindExpandedClass(f,x){const T=()=>{this.styleExpanded?f.classList.add(x):f.classList.remove(x)};L(this,"expanded",T),L(this,"temporaryExpanded",T)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Ze(w,f){let x=0;return Qt(f,()=>{w.set("expandedHeight",null),w.set("temporaryExpanded",!0),kt(f),x=f.clientHeight,w.set("temporaryExpanded",null),kt(f)}),x}function pt(w,f){f.style.height=w.styleHeight}function ee(w,f){w.value("expanded").emitter.on("beforechange",()=>{if(w.set("completed",!1),h(w.get("expandedHeight"))){const x=Ze(w,f);x>0&&w.set("expandedHeight",x)}w.set("shouldFixHeight",!0),kt(f)}),w.emitter.on("change",()=>{pt(w,f)}),pt(w,f),f.addEventListener("transitionend",x=>{x.propertyName==="height"&&w.cleanUpTransition()})}class Mt extends r{constructor(f,x){super(f),this.rackApi_=x}}function ie(w,f){return w.addBlade(Object.assign(Object.assign({},f),{view:"button"}))}function le(w,f){return w.addBlade(Object.assign(Object.assign({},f),{view:"folder"}))}function Xe(w,f){const x=f??{};return w.addBlade(Object.assign(Object.assign({},x),{view:"separator"}))}function Rn(w,f){return w.addBlade(Object.assign(Object.assign({},f),{view:"tab"}))}class Zn{constructor(f){this.emitter=new M,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=f}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(f){for(const x of this.allItems())if(f(x))return x;return null}includes(f){return this.cache_.has(f)}add(f,x){if(this.includes(f))throw _.shouldNeverHappen();const T=x!==void 0?x:this.items_.length;this.items_.splice(T,0,f),this.cache_.add(f);const I=this.extract_(f);I&&(I.emitter.on("add",this.onSubListAdd_),I.emitter.on("remove",this.onSubListRemove_),I.allItems().forEach(it=>{this.cache_.add(it)})),this.emitter.emit("add",{index:T,item:f,root:this,target:this})}remove(f){const x=this.items_.indexOf(f);if(x<0)return;this.items_.splice(x,1),this.cache_.delete(f);const T=this.extract_(f);T&&(T.emitter.off("add",this.onSubListAdd_),T.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:x,item:f,root:this,target:this})}onSubListAdd_(f){this.cache_.add(f.item),this.emitter.emit("add",{index:f.index,item:f.item,root:this,target:f.target})}onSubListRemove_(f){this.cache_.delete(f.item),this.emitter.emit("remove",{index:f.index,item:f.item,root:this,target:f.target})}}class Wr extends r{constructor(f){super(f),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new M,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(f){const x=f.sender.target.read();this.emitter_.emit("change",{event:new o(this,x,this.controller_.binding.target.presetKey,f.options.last)})}}class mn extends Ut{constructor(f,x){super(f,x),this.binding=x.binding}}class jr extends r{constructor(f){super(f),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new M,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(f){const x=f.sender.target.read();this.emitter_.emit("update",{event:new a(this,x,this.controller_.binding.target.presetKey)})}}class Jn extends Ut{constructor(f,x){super(f,x),this.binding=x.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function Xr(w){return w instanceof As?w.apiSet_:w instanceof Mt?w.rackApi_.apiSet_:null}function qo(w,f){const x=w.find(T=>T.controller_===f);if(!x)throw _.shouldNeverHappen();return x}function xa(w,f,x){if(!b.isBindable(w))throw _.notBindable();return new b(w,f,x)}class As extends r{constructor(f,x){super(f),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new M,this.apiSet_=new Zn(Xr),this.pool_=x;const T=this.controller_.rack;T.emitter.on("add",this.onRackAdd_),T.emitter.on("remove",this.onRackRemove_),T.emitter.on("inputchange",this.onRackInputChange_),T.emitter.on("monitorupdate",this.onRackMonitorUpdate_),T.children.forEach(I=>{this.setUpApi_(I)})}get children(){return this.controller_.rack.children.map(f=>qo(this.apiSet_,f))}addInput(f,x,T){const I=T??{},it=this.controller_.view.element.ownerDocument,xt=this.pool_.createInput(it,xa(f,x,I.presetKey),I),Zt=new Wr(xt);return this.add(Zt,I.index)}addMonitor(f,x,T){const I=T??{},it=this.controller_.view.element.ownerDocument,xt=this.pool_.createMonitor(it,xa(f,x),I),Zt=new jr(xt);return this.add(Zt,I.index)}addFolder(f){return le(this,f)}addButton(f){return ie(this,f)}addSeparator(f){return Xe(this,f)}addTab(f){return Rn(this,f)}add(f,x){this.controller_.rack.add(f.controller_,x);const T=this.apiSet_.find(I=>I.controller_===f.controller_);return T&&this.apiSet_.remove(T),this.apiSet_.add(f),f}remove(f){this.controller_.rack.remove(f.controller_)}addBlade(f){const x=this.controller_.view.element.ownerDocument,T=this.pool_.createBlade(x,f),I=this.pool_.createBladeApi(T);return this.add(I,f.index)}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}setUpApi_(f){this.apiSet_.find(T=>T.controller_===f)||this.apiSet_.add(this.pool_.createBladeApi(f))}onRackAdd_(f){this.setUpApi_(f.bladeController)}onRackRemove_(f){if(f.isRoot){const x=qo(this.apiSet_,f.bladeController);this.apiSet_.remove(x)}}onRackInputChange_(f){const x=f.bladeController;if(x instanceof mn){const T=qo(this.apiSet_,x),I=x.binding;this.emitter_.emit("change",{event:new o(T,I.target.read(),I.target.presetKey,f.options.last)})}else if(x instanceof ue){const T=qo(this.apiSet_,x);this.emitter_.emit("change",{event:new o(T,x.value.rawValue,void 0,f.options.last)})}}onRackMonitorUpdate_(f){if(!(f.bladeController instanceof Jn))throw _.shouldNeverHappen();const x=qo(this.apiSet_,f.bladeController),T=f.bladeController.binding;this.emitter_.emit("update",{event:new a(x,T.target.read(),T.target.presetKey)})}}class Wo extends Mt{constructor(f,x){super(f,new As(f.rackController,x)),this.emitter_=new M,this.controller_.foldable.value("expanded").emitter.on("change",T=>{this.emitter_.emit("fold",{event:new l(this,T.sender.rawValue)})}),this.rackApi_.on("change",T=>{this.emitter_.emit("change",{event:T})}),this.rackApi_.on("update",T=>{this.emitter_.emit("update",{event:T})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(f){this.controller_.foldable.set("expanded",f)}get title(){return this.controller_.props.get("title")}set title(f){this.controller_.props.set("title",f)}get children(){return this.rackApi_.children}addInput(f,x,T){return this.rackApi_.addInput(f,x,T)}addMonitor(f,x,T){return this.rackApi_.addMonitor(f,x,T)}addFolder(f){return this.rackApi_.addFolder(f)}addButton(f){return this.rackApi_.addButton(f)}addSeparator(f){return this.rackApi_.addSeparator(f)}addTab(f){return this.rackApi_.addTab(f)}add(f,x){return this.rackApi_.add(f,x)}remove(f){this.rackApi_.remove(f)}addBlade(f){return this.rackApi_.addBlade(f)}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}}class ja extends et{constructor(f){super({blade:f.blade,view:f.view,viewProps:f.rackController.viewProps}),this.rackController=f.rackController}}class Tl{constructor(f,x){const T=E(x.viewName);this.element=f.createElement("div"),this.element.classList.add(T()),x.viewProps.bindClassModifiers(this.element)}}function uu(w,f){for(let x=0;x<w.length;x++){const T=w[x];if(T instanceof mn&&T.binding===f)return T}return null}function Ws(w,f){for(let x=0;x<w.length;x++){const T=w[x];if(T instanceof Jn&&T.binding===f)return T}return null}function Al(w,f){for(let x=0;x<w.length;x++){const T=w[x];if(T instanceof ue&&T.value===f)return T}return null}function vr(w){return w instanceof Nt?w.rack:w instanceof ja?w.rackController.rack:null}function X(w){const f=vr(w);return f?f.bcSet_:null}class At{constructor(f){var x,T;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new M,this.blade_=(x=f.blade)!==null&&x!==void 0?x:null,(T=this.blade_)===null||T===void 0||T.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=f.viewProps,this.bcSet_=new Zn(X),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(f,x){var T;(T=f.parent)===null||T===void 0||T.remove(f),m(f,"parent")?f.parent=this:(f.parent_=this,be({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(f,x)}remove(f){m(f,"parent")?f.parent=null:(f.parent_=null,be({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(f)}find(f){return this.bcSet_.allItems().filter(x=>x instanceof f)}onSetAdd_(f){this.updatePositions_();const x=f.target===f.root;if(this.emitter.emit("add",{bladeController:f.item,index:f.index,isRoot:x,sender:this}),!x)return;const T=f.item;if(T.viewProps.emitter.on("change",this.onChildViewPropsChange_),T.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),T.viewProps.handleDispose(this.onChildDispose_),T instanceof mn)T.binding.emitter.on("change",this.onChildInputChange_);else if(T instanceof Jn)T.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(T instanceof ue)T.value.emitter.on("change",this.onChildValueChange_);else{const I=vr(T);if(I){const it=I.emitter;it.on("layout",this.onDescendantLayout_),it.on("inputchange",this.onDescendantInputChange_),it.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(f){this.updatePositions_();const x=f.target===f.root;if(this.emitter.emit("remove",{bladeController:f.item,isRoot:x,sender:this}),!x)return;const T=f.item;if(T instanceof mn)T.binding.emitter.off("change",this.onChildInputChange_);else if(T instanceof Jn)T.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(T instanceof ue)T.value.emitter.off("change",this.onChildValueChange_);else{const I=vr(T);if(I){const it=I.emitter;it.off("layout",this.onDescendantLayout_),it.off("inputchange",this.onDescendantInputChange_),it.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const f=this.bcSet_.items.filter(I=>!I.viewProps.get("hidden")),x=f[0],T=f[f.length-1];this.bcSet_.items.forEach(I=>{const it=[];I===x&&(it.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&it.push("veryfirst")),I===T&&(it.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&it.push("verylast")),I.blade.set("positions",it)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(f){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(x=>x.viewProps.get("disposed")).forEach(x=>{this.bcSet_.remove(x)})}onChildInputChange_(f){const x=uu(this.find(mn),f.sender);if(!x)throw _.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:x,options:f.options,sender:this})}onChildMonitorUpdate_(f){const x=Ws(this.find(Jn),f.sender);if(!x)throw _.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:x,sender:this})}onChildValueChange_(f){const x=Al(this.find(ue),f.sender);if(!x)throw _.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:x,options:f.options,sender:this})}onDescendantLayout_(f){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(f){this.emitter.emit("inputchange",{bladeController:f.bladeController,options:f.options,sender:this})}onDescendantMonitorUpdate_(f){this.emitter.emit("monitorupdate",{bladeController:f.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Nt extends et{constructor(f,x){super(Object.assign(Object.assign({},x),{view:new Tl(f,{viewName:"brk",viewProps:x.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const T=new At({blade:x.root?void 0:x.blade,viewProps:x.viewProps});T.emitter.on("add",this.onRackAdd_),T.emitter.on("remove",this.onRackRemove_),this.rack=T,this.viewProps.handleDispose(()=>{for(let I=this.rack.children.length-1;I>=0;I--)this.rack.children[I].viewProps.set("disposed",!0)})}onRackAdd_(f){f.isRoot&&Lt(this.view.element,f.bladeController.view.element,f.index)}onRackRemove_(f){f.isRoot&&jt(f.bladeController.view.element)}}const wt=E("cnt");class Ft{constructor(f,x){var T;this.className_=E((T=x.viewName)!==null&&T!==void 0?T:"fld"),this.element=f.createElement("div"),this.element.classList.add(this.className_(),wt()),x.viewProps.bindClassModifiers(this.element),this.foldable_=x.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),L(this.foldable_,"completed",D(this.element,this.className_(void 0,"cpl")));const I=f.createElement("button");I.classList.add(this.className_("b")),L(x.props,"title",He=>{h(He)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),x.viewProps.bindDisabled(I),this.element.appendChild(I),this.buttonElement=I;const it=f.createElement("div");it.classList.add(this.className_("i")),this.element.appendChild(it);const xt=f.createElement("div");xt.classList.add(this.className_("t")),V(x.props.value("title"),xt),this.buttonElement.appendChild(xt),this.titleElement=xt;const Zt=f.createElement("div");Zt.classList.add(this.className_("m")),this.buttonElement.appendChild(Zt);const Te=x.containerElement;Te.classList.add(this.className_("c")),this.element.appendChild(Te),this.containerElement=Te}}class fe extends ja{constructor(f,x){var T;const I=xe.create((T=x.expanded)!==null&&T!==void 0?T:!0),it=new Nt(f,{blade:x.blade,root:x.root,viewProps:x.viewProps});super(Object.assign(Object.assign({},x),{rackController:it,view:new Ft(f,{containerElement:it.view.element,foldable:I,props:x.props,viewName:x.root?"rot":void 0,viewProps:x.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=x.props,this.foldable=I,ee(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Re={id:"folder",type:"blade",accept(w){const f=Bt,x=Wt(w,{title:f.required.string,view:f.required.constant("folder"),expanded:f.optional.boolean});return x?{params:x}:null},controller(w){return new fe(w.document,{blade:w.blade,expanded:w.params.expanded,props:Q.fromObject({title:w.params.title}),viewProps:w.viewProps})},api(w){return w.controller instanceof fe?new Wo(w.controller,w.pool):null}};class Me extends ue{constructor(f,x){const T=x.valueController.viewProps;super(Object.assign(Object.assign({},x),{value:x.valueController.value,view:new tt(f,{props:x.props,viewProps:T}),viewProps:T})),this.props=x.props,this.valueController=x.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class ze extends r{}const Ye=E("spr");class De{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(Ye()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("hr");T.classList.add(Ye("r")),this.element.appendChild(T)}}class Ue extends et{constructor(f,x){super(Object.assign(Object.assign({},x),{view:new De(f,{viewProps:x.viewProps})}))}}const Qn={id:"separator",type:"blade",accept(w){const x=Wt(w,{view:Bt.required.constant("separator")});return x?{params:x}:null},controller(w){return new Ue(w.document,{blade:w.blade,viewProps:w.viewProps})},api(w){return w.controller instanceof Ue?new ze(w.controller):null}},kn=E("tbi");class qi{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(kn()),x.viewProps.bindClassModifiers(this.element),L(x.props,"selected",it=>{it?this.element.classList.add(kn(void 0,"sel")):this.element.classList.remove(kn(void 0,"sel"))});const T=f.createElement("button");T.classList.add(kn("b")),x.viewProps.bindDisabled(T),this.element.appendChild(T),this.buttonElement=T;const I=f.createElement("div");I.classList.add(kn("t")),V(x.props.value("title"),I),this.buttonElement.appendChild(I),this.titleElement=I}}class Rr{constructor(f,x){this.emitter=new M,this.onClick_=this.onClick_.bind(this),this.props=x.props,this.viewProps=x.viewProps,this.view=new qi(f,{props:x.props,viewProps:x.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Qe{constructor(f,x){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Rr(f,{props:x.itemProps,viewProps:ne.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Nt(f,{blade:ae(),viewProps:ne.create()}),this.props=x.props,L(this.props,"selected",T=>{this.itemController.props.set("selected",T),this.contentController.viewProps.set("hidden",!T)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Ve{constructor(f,x){this.controller_=f,this.rackApi_=x}get title(){var f;return(f=this.controller_.itemController.props.get("title"))!==null&&f!==void 0?f:""}set title(f){this.controller_.itemController.props.set("title",f)}get selected(){return this.controller_.props.get("selected")}set selected(f){this.controller_.props.set("selected",f)}get children(){return this.rackApi_.children}addButton(f){return this.rackApi_.addButton(f)}addFolder(f){return this.rackApi_.addFolder(f)}addSeparator(f){return this.rackApi_.addSeparator(f)}addTab(f){return this.rackApi_.addTab(f)}add(f,x){this.rackApi_.add(f,x)}remove(f){this.rackApi_.remove(f)}addInput(f,x,T){return this.rackApi_.addInput(f,x,T)}addMonitor(f,x,T){return this.rackApi_.addMonitor(f,x,T)}addBlade(f){return this.rackApi_.addBlade(f)}}class js extends Mt{constructor(f,x){super(f,new As(f.rackController,x)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new M,this.pageApiMap_=new Map,this.rackApi_.on("change",T=>{this.emitter_.emit("change",{event:T})}),this.rackApi_.on("update",T=>{this.emitter_.emit("update",{event:T})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(T=>{this.setUpPageApi_(T)})}get pages(){return this.controller_.pageSet.items.map(f=>{const x=this.pageApiMap_.get(f);if(!x)throw _.shouldNeverHappen();return x})}addPage(f){const x=this.controller_.view.element.ownerDocument,T=new Qe(x,{itemProps:Q.fromObject({selected:!1,title:f.title}),props:Q.fromObject({selected:!1})});this.controller_.add(T,f.index);const I=this.pageApiMap_.get(T);if(!I)throw _.shouldNeverHappen();return I}removePage(f){this.controller_.remove(f)}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}setUpPageApi_(f){const x=this.rackApi_.apiSet_.find(I=>I.controller_===f.contentController);if(!x)throw _.shouldNeverHappen();const T=new Ve(f,x);this.pageApiMap_.set(f,T)}onPageAdd_(f){this.setUpPageApi_(f.item)}onPageRemove_(f){if(!this.pageApiMap_.get(f.item))throw _.shouldNeverHappen();this.pageApiMap_.delete(f.item)}onSelect_(f){this.emitter_.emit("select",{event:new c(this,f.rawValue)})}}const yi=-1;class oi{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=nt(!0),this.selectedIndex=nt(yi),this.items_=[]}add(f,x){const T=x??this.items_.length;this.items_.splice(T,0,f),f.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(f){const x=this.items_.indexOf(f);x<0||(this.items_.splice(x,1),f.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=yi,this.empty.rawValue=!0;return}const f=this.items_.findIndex(x=>x.rawValue);f<0?(this.items_.forEach((x,T)=>{x.rawValue=T===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((x,T)=>{x.rawValue=T===f}),this.selectedIndex.rawValue=f),this.empty.rawValue=!1}onItemSelectedChange_(f){if(f.rawValue){const x=this.items_.findIndex(T=>T===f.sender);this.items_.forEach((T,I)=>{T.rawValue=I===x}),this.selectedIndex.rawValue=x}else this.keepSelection_()}}const Ni=E("tab");class wa{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(Ni(),wt()),x.viewProps.bindClassModifiers(this.element),O(x.empty,D(this.element,Ni(void 0,"nop")));const T=f.createElement("div");T.classList.add(Ni("t")),this.element.appendChild(T),this.itemsElement=T;const I=f.createElement("div");I.classList.add(Ni("i")),this.element.appendChild(I);const it=x.contentsElement;it.classList.add(Ni("c")),this.element.appendChild(it),this.contentsElement=it}}class jo extends ja{constructor(f,x){const T=new Nt(f,{blade:x.blade,viewProps:x.viewProps}),I=new oi;super({blade:x.blade,rackController:T,view:new wa(f,{contentsElement:T.view.element,empty:I.empty,viewProps:x.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new Zn(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=I}get pageSet(){return this.pageSet_}add(f,x){this.pageSet_.add(f,x)}remove(f){this.pageSet_.remove(this.pageSet_.items[f])}onPageAdd_(f){const x=f.item;Lt(this.view.itemsElement,x.itemController.view.element,f.index),x.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(x.contentController,f.index),this.tab.add(x.props.value("selected"))}onPageRemove_(f){const x=f.item;jt(x.itemController.view.element),x.itemController.viewProps.set("parent",null),this.rackController.rack.remove(x.contentController),this.tab.remove(x.props.value("selected"))}}const ai={id:"tab",type:"blade",accept(w){const f=Bt,x=Wt(w,{pages:f.required.array(f.required.object({title:f.required.string})),view:f.required.constant("tab")});return!x||x.pages.length===0?null:{params:x}},controller(w){const f=new jo(w.document,{blade:w.blade,viewProps:w.viewProps});return w.params.pages.forEach(x=>{const T=new Qe(w.document,{itemProps:Q.fromObject({selected:!1,title:x.title}),props:Q.fromObject({selected:!1})});f.add(T)}),f},api(w){return w.controller instanceof jo?new js(w.controller,w.pool):null}};function Ps(w,f){const x=w.accept(f.params);if(!x)return null;const T=Bt.optional.boolean(f.params.disabled).value,I=Bt.optional.boolean(f.params.hidden).value;return w.controller({blade:ae(),document:f.document,params:Object.assign(Object.assign({},x.params),{disabled:T,hidden:I}),viewProps:ne.create({disabled:T,hidden:I})})}class Xo{constructor(){this.disabled=!1,this.emitter=new M}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class kr{constructor(f,x){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=f,this.emitter=new M,this.interval_=x,this.setTimer_()}get disabled(){return this.disabled_}set disabled(f){this.disabled_=f,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const f=this.doc_.defaultView;f&&f.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const f=this.doc_.defaultView;f&&(this.timerId_=f.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Xa{constructor(f){this.onValueChange_=this.onValueChange_.bind(this),this.reader=f.reader,this.writer=f.writer,this.emitter=new M,this.value=f.value,this.value.emitter.on("change",this.onValueChange_),this.target=f.target,this.read()}read(){const f=this.target.read();f!==void 0&&(this.value.rawValue=this.reader(f))}write_(f){this.writer(this.target,f)}onValueChange_(f){this.write_(f.rawValue),this.emitter.emit("change",{options:f.options,rawValue:f.rawValue,sender:this})}}function uc(w,f){for(;w.length<f;)w.push(void 0)}function Sa(w){const f=[];return uc(f,w),nt(f)}function zi(w){const f=w.indexOf(void 0);return f<0?w:w.slice(0,f)}function er(w,f){const x=[...zi(w),f];return x.length>w.length?x.splice(0,x.length-w.length):uc(x,w.length),x}class hc{constructor(f){this.onTick_=this.onTick_.bind(this),this.reader_=f.reader,this.target=f.target,this.emitter=new M,this.value=f.value,this.ticker=f.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const f=this.target.read();if(f===void 0)return;const x=this.value.rawValue,T=this.reader_(f);this.value.rawValue=er(x,T),this.emitter.emit("update",{rawValue:T,sender:this})}onTick_(f){this.read()}}class Ma{constructor(f){this.constraints=f}constrain(f){return this.constraints.reduce((x,T)=>T.constrain(x),f)}}function os(w,f){if(w instanceof f)return w;if(w instanceof Ma){const x=w.constraints.reduce((T,I)=>T||(I instanceof f?I:null),null);if(x)return x}return null}class as{constructor(f){this.values=Q.fromObject({max:f.max,min:f.min})}constrain(f){const x=this.values.get("max"),T=this.values.get("min");return Math.min(Math.max(f,T),x)}}class Yo{constructor(f){this.values=Q.fromObject({options:f})}get options(){return this.values.get("options")}constrain(f){const x=this.values.get("options");return x.length===0||x.filter(I=>I.value===f).length>0?f:x[0].value}}class Pl{constructor(f){this.values=Q.fromObject({max:f.max,min:f.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(f){const x=this.values.get("max"),T=this.values.get("min");let I=f;return h(T)||(I=Math.max(I,T)),h(x)||(I=Math.min(I,x)),I}}class Ya{constructor(f,x=0){this.step=f,this.origin=x}constrain(f){const x=this.origin%this.step,T=Math.round((f-x)/this.step);return x+T*this.step}}const en=E("lst");class hu{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.props_=x.props,this.element=f.createElement("div"),this.element.classList.add(en()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("select");T.classList.add(en("s")),x.viewProps.bindDisabled(T),this.element.appendChild(T),this.selectElement=T;const I=f.createElement("div");I.classList.add(en("m")),I.appendChild(B(f,"dropdown")),this.element.appendChild(I),x.value.emitter.on("change",this.onValueChange_),this.value_=x.value,L(this.props_,"options",it=>{Kt(this.selectElement),it.forEach(xt=>{const Zt=f.createElement("option");Zt.textContent=xt.text,this.selectElement.appendChild(Zt)}),this.update_()})}update_(){const f=this.props_.get("options").map(x=>x.value);this.selectElement.selectedIndex=f.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class mo{constructor(f,x){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=x.props,this.value=x.value,this.viewProps=x.viewProps,this.view=new hu(f,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(f){const x=f.currentTarget;this.value.rawValue=this.props.get("options")[x.selectedIndex].value}}const du=E("pop");class Rl{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(du()),x.viewProps.bindClassModifiers(this.element),O(x.shows,D(this.element,du(void 0,"v")))}}class pu{constructor(f,x){this.shows=nt(!1),this.viewProps=x.viewProps,this.view=new Rl(f,{shows:this.shows,viewProps:this.viewProps})}}const kl=E("txt");class Ca{constructor(f,x){this.onChange_=this.onChange_.bind(this),this.element=f.createElement("div"),this.element.classList.add(kl()),x.viewProps.bindClassModifiers(this.element),this.props_=x.props,this.props_.emitter.on("change",this.onChange_);const T=f.createElement("input");T.classList.add(kl("i")),T.type="text",x.viewProps.bindDisabled(T),this.element.appendChild(T),this.inputElement=T,x.value.emitter.on("change",this.onChange_),this.value_=x.value,this.refresh()}refresh(){const f=this.props_.get("formatter");this.inputElement.value=f(this.value_.rawValue)}onChange_(){this.refresh()}}class fu{constructor(f,x){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=x.parser,this.props=x.props,this.value=x.value,this.viewProps=x.viewProps,this.view=new Ca(f,{props:x.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(f){const T=f.currentTarget.value,I=this.parser_(T);h(I)||(this.value.rawValue=I),this.view.refresh()}}function op(w){return String(w)}function Ea(w){return w==="false"?!1:!!w}function ls(w){return op(w)}class mu{constructor(f){this.text=f}evaluate(){return Number(this.text)}toString(){return this.text}}const Th={"**":(w,f)=>Math.pow(w,f),"*":(w,f)=>w*f,"/":(w,f)=>w/f,"%":(w,f)=>w%f,"+":(w,f)=>w+f,"-":(w,f)=>w-f,"<<":(w,f)=>w<<f,">>":(w,f)=>w>>f,">>>":(w,f)=>w>>>f,"&":(w,f)=>w&f,"^":(w,f)=>w^f,"|":(w,f)=>w|f};class ap{constructor(f,x,T){this.left=x,this.operator=f,this.right=T}evaluate(){const f=Th[this.operator];if(!f)throw new Error(`unexpected binary operator: '${this.operator}`);return f(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Yr={"+":w=>w,"-":w=>-w,"~":w=>~w};class Ka{constructor(f,x){this.operator=f,this.expression=x}evaluate(){const f=Yr[this.operator];if(!f)throw new Error(`unexpected unary operator: '${this.operator}`);return f(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function gu(w){return(f,x)=>{for(let T=0;T<w.length;T++){const I=w[T](f,x);if(I!=="")return I}return""}}function jn(w,f){var x;const T=w.substr(f).match(/^\s+/);return(x=T&&T[0])!==null&&x!==void 0?x:""}function ei(w,f){const x=w.substr(f,1);return x.match(/^[1-9]$/)?x:""}function Xs(w,f){var x;const T=w.substr(f).match(/^[0-9]+/);return(x=T&&T[0])!==null&&x!==void 0?x:""}function Ah(w,f){const x=Xs(w,f);if(x!=="")return x;const T=w.substr(f,1);if(f+=1,T!=="-"&&T!=="+")return"";const I=Xs(w,f);return I===""?"":T+I}function Ll(w,f){const x=w.substr(f,1);if(f+=1,x.toLowerCase()!=="e")return"";const T=Ah(w,f);return T===""?"":x+T}function Ol(w,f){const x=w.substr(f,1);if(x==="0")return x;const T=ei(w,f);return f+=T.length,T===""?"":T+Xs(w,f)}function Ko(w,f){const x=Ol(w,f);if(f+=x.length,x==="")return"";const T=w.substr(f,1);if(f+=T.length,T!==".")return"";const I=Xs(w,f);return f+=I.length,x+T+I+Ll(w,f)}function Ph(w,f){const x=w.substr(f,1);if(f+=x.length,x!==".")return"";const T=Xs(w,f);return f+=T.length,T===""?"":x+T+Ll(w,f)}function dc(w,f){const x=Ol(w,f);return f+=x.length,x===""?"":x+Ll(w,f)}const um=gu([Ko,Ph,dc]);function Wi(w,f){var x;const T=w.substr(f).match(/^[01]+/);return(x=T&&T[0])!==null&&x!==void 0?x:""}function Rh(w,f){const x=w.substr(f,2);if(f+=x.length,x.toLowerCase()!=="0b")return"";const T=Wi(w,f);return T===""?"":x+T}function Rs(w,f){var x;const T=w.substr(f).match(/^[0-7]+/);return(x=T&&T[0])!==null&&x!==void 0?x:""}function pc(w,f){const x=w.substr(f,2);if(f+=x.length,x.toLowerCase()!=="0o")return"";const T=Rs(w,f);return T===""?"":x+T}function kh(w,f){var x;const T=w.substr(f).match(/^[0-9a-f]+/i);return(x=T&&T[0])!==null&&x!==void 0?x:""}function Kr(w,f){const x=w.substr(f,2);if(f+=x.length,x.toLowerCase()!=="0x")return"";const T=kh(w,f);return T===""?"":x+T}const Lh=gu([Rh,pc,Kr]),lp=gu([Lh,um]);function Oh(w,f){const x=lp(w,f);return f+=x.length,x===""?null:{evaluable:new mu(x),cursor:f}}function Dh(w,f){const x=w.substr(f,1);if(f+=x.length,x!=="(")return null;const T=mc(w,f);if(!T)return null;f=T.cursor,f+=jn(w,f).length;const I=w.substr(f,1);return f+=I.length,I!==")"?null:{evaluable:T.evaluable,cursor:f}}function fc(w,f){var x;return(x=Oh(w,f))!==null&&x!==void 0?x:Dh(w,f)}function vu(w,f){const x=fc(w,f);if(x)return x;const T=w.substr(f,1);if(f+=T.length,T!=="+"&&T!=="-"&&T!=="~")return null;const I=vu(w,f);return I?(f=I.cursor,{cursor:f,evaluable:new Ka(T,I.evaluable)}):null}function Fe(w,f,x){x+=jn(f,x).length;const T=w.filter(I=>f.startsWith(I,x))[0];return T?(x+=T.length,x+=jn(f,x).length,{cursor:x,operator:T}):null}function cp(w,f){return(x,T)=>{const I=w(x,T);if(!I)return null;T=I.cursor;let it=I.evaluable;for(;;){const xt=Fe(f,x,T);if(!xt)break;T=xt.cursor;const Zt=w(x,T);if(!Zt)return null;T=Zt.cursor,it=new ap(xt.operator,it,Zt.evaluable)}return it?{cursor:T,evaluable:it}:null}}const cs=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((w,f)=>cp(w,f),vu);function mc(w,f){return f+=jn(w,f).length,cs(w,f)}function up(w){const f=mc(w,0);return!f||f.cursor+jn(w,f.cursor).length!==w.length?null:f.evaluable}function _r(w){var f;const x=up(w);return(f=x==null?void 0:x.evaluate())!==null&&f!==void 0?f:null}function gc(w){if(typeof w=="number")return w;if(typeof w=="string"){const f=_r(w);if(!h(f))return f}return 0}function _u(w){return String(w)}function nn(w){return f=>f.toFixed(Math.max(Math.min(w,20),0))}const Ta=nn(0);function yt(w){return Ta(w)+"%"}function F(w){return String(w)}function at(w){return w}function q({primary:w,secondary:f,forward:x,backward:T}){let I=!1;function it(xt){I||(I=!0,xt(),I=!1)}w.emitter.on("change",xt=>{it(()=>{f.setRawValue(x(w,f),xt.options)})}),f.emitter.on("change",xt=>{it(()=>{w.setRawValue(T(w,f),xt.options)}),it(()=>{f.setRawValue(x(w,f),xt.options)})}),it(()=>{f.setRawValue(x(w,f),{forceEmit:!1,last:!0})})}function j(w,f){const x=w*(f.altKey?.1:1)*(f.shiftKey?10:1);return f.upKey?+x:f.downKey?-x:0}function gt(w){return{altKey:w.altKey,downKey:w.key==="ArrowDown",shiftKey:w.shiftKey,upKey:w.key==="ArrowUp"}}function Dt(w){return{altKey:w.altKey,downKey:w.key==="ArrowLeft",shiftKey:w.shiftKey,upKey:w.key==="ArrowRight"}}function Et(w){return w==="ArrowUp"||w==="ArrowDown"}function de(w){return Et(w)||w==="ArrowLeft"||w==="ArrowRight"}function $e(w,f){var x,T;const I=f.ownerDocument.defaultView,it=f.getBoundingClientRect();return{x:w.pageX-(((x=I&&I.scrollX)!==null&&x!==void 0?x:0)+it.left),y:w.pageY-(((T=I&&I.scrollY)!==null&&T!==void 0?T:0)+it.top)}}class sn{constructor(f){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=f,this.emitter=new M,f.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),f.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),f.addEventListener("touchend",this.onTouchEnd_),f.addEventListener("mousedown",this.onMouseDown_)}computePosition_(f){const x=this.elem_.getBoundingClientRect();return{bounds:{width:x.width,height:x.height},point:f?{x:f.x,y:f.y}:null}}onMouseDown_(f){var x;f.preventDefault(),(x=f.currentTarget)===null||x===void 0||x.focus();const T=this.elem_.ownerDocument;T.addEventListener("mousemove",this.onDocumentMouseMove_),T.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:f.altKey,data:this.computePosition_($e(f,this.elem_)),sender:this,shiftKey:f.shiftKey})}onDocumentMouseMove_(f){this.emitter.emit("move",{altKey:f.altKey,data:this.computePosition_($e(f,this.elem_)),sender:this,shiftKey:f.shiftKey})}onDocumentMouseUp_(f){const x=this.elem_.ownerDocument;x.removeEventListener("mousemove",this.onDocumentMouseMove_),x.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:f.altKey,data:this.computePosition_($e(f,this.elem_)),sender:this,shiftKey:f.shiftKey})}onTouchStart_(f){f.preventDefault();const x=f.targetTouches.item(0),T=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:f.altKey,data:this.computePosition_(x?{x:x.clientX-T.left,y:x.clientY-T.top}:void 0),sender:this,shiftKey:f.shiftKey}),this.lastTouch_=x}onTouchMove_(f){const x=f.targetTouches.item(0),T=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:f.altKey,data:this.computePosition_(x?{x:x.clientX-T.left,y:x.clientY-T.top}:void 0),sender:this,shiftKey:f.shiftKey}),this.lastTouch_=x}onTouchEnd_(f){var x;const T=(x=f.targetTouches.item(0))!==null&&x!==void 0?x:this.lastTouch_,I=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:f.altKey,data:this.computePosition_(T?{x:T.clientX-I.left,y:T.clientY-I.top}:void 0),sender:this,shiftKey:f.shiftKey})}}function Ce(w,f,x,T,I){const it=(w-f)/(x-f);return T+it*(I-T)}function Ee(w){return String(w.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ht(w,f,x){return Math.min(Math.max(w,f),x)}function ke(w,f){return(w%f+f)%f}const Ln=E("txt");class ni{constructor(f,x){this.onChange_=this.onChange_.bind(this),this.props_=x.props,this.props_.emitter.on("change",this.onChange_),this.element=f.createElement("div"),this.element.classList.add(Ln(),Ln(void 0,"num")),x.arrayPosition&&this.element.classList.add(Ln(void 0,x.arrayPosition)),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("input");T.classList.add(Ln("i")),T.type="text",x.viewProps.bindDisabled(T),this.element.appendChild(T),this.inputElement=T,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=x.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Ln()),this.inputElement.classList.add(Ln("i"));const I=f.createElement("div");I.classList.add(Ln("k")),this.element.appendChild(I),this.knobElement=I;const it=f.createElementNS(ft,"svg");it.classList.add(Ln("g")),this.knobElement.appendChild(it);const xt=f.createElementNS(ft,"path");xt.classList.add(Ln("gb")),it.appendChild(xt),this.guideBodyElem_=xt;const Zt=f.createElementNS(ft,"path");Zt.classList.add(Ln("gh")),it.appendChild(Zt),this.guideHeadElem_=Zt;const Te=f.createElement("div");Te.classList.add(E("tt")()),this.knobElement.appendChild(Te),this.tooltipElem_=Te,x.value.emitter.on("change",this.onChange_),this.value=x.value,this.refresh()}onDraggingChange_(f){if(f.rawValue===null){this.element.classList.remove(Ln(void 0,"drg"));return}this.element.classList.add(Ln(void 0,"drg"));const x=f.rawValue/this.props_.get("draggingScale"),T=x+(x>0?-1:x<0?1:0),I=Ht(-T,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${T+I},0 L${T},4 L${T+I},8`,`M ${x},-1 L${x},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${x},4`);const it=this.props_.get("formatter");this.tooltipElem_.textContent=it(this.value.rawValue),this.tooltipElem_.style.left=`${x}px`}refresh(){const f=this.props_.get("formatter");this.inputElement.value=f(this.value.rawValue)}onChange_(){this.refresh()}}class ui{constructor(f,x){var T;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=x.baseStep,this.parser_=x.parser,this.props=x.props,this.sliderProps_=(T=x.sliderProps)!==null&&T!==void 0?T:null,this.value=x.value,this.viewProps=x.viewProps,this.dragging_=nt(null),this.view=new ni(f,{arrayPosition:x.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const I=new sn(this.view.knobElement);I.emitter.on("down",this.onPointerDown_),I.emitter.on("move",this.onPointerMove_),I.emitter.on("up",this.onPointerUp_)}constrainValue_(f){var x,T;const I=(x=this.sliderProps_)===null||x===void 0?void 0:x.get("minValue"),it=(T=this.sliderProps_)===null||T===void 0?void 0:T.get("maxValue");let xt=f;return I!==void 0&&(xt=Math.max(xt,I)),it!==void 0&&(xt=Math.min(xt,it)),xt}onInputChange_(f){const T=f.currentTarget.value,I=this.parser_(T);h(I)||(this.value.rawValue=this.constrainValue_(I)),this.view.refresh()}onInputKeyDown_(f){const x=j(this.baseStep_,gt(f));x!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+x),{forceEmit:!1,last:!1})}onInputKeyUp_(f){j(this.baseStep_,gt(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(f){if(!f.point)return null;const x=f.point.x-f.bounds.width/2;return this.constrainValue_(this.originRawValue_+x*this.props.get("draggingScale"))}onPointerMove_(f){const x=this.computeDraggingValue_(f.data);x!==null&&(this.value.setRawValue(x,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(f){const x=this.computeDraggingValue_(f.data);x!==null&&(this.value.setRawValue(x,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const hi=E("sld");class nr{constructor(f,x){this.onChange_=this.onChange_.bind(this),this.props_=x.props,this.props_.emitter.on("change",this.onChange_),this.element=f.createElement("div"),this.element.classList.add(hi()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("div");T.classList.add(hi("t")),x.viewProps.bindTabIndex(T),this.element.appendChild(T),this.trackElement=T;const I=f.createElement("div");I.classList.add(hi("k")),this.trackElement.appendChild(I),this.knobElement=I,x.value.emitter.on("change",this.onChange_),this.value=x.value,this.update_()}update_(){const f=Ht(Ce(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${f}%`}onChange_(){this.update_()}}class Le{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=x.baseStep,this.value=x.value,this.viewProps=x.viewProps,this.props=x.props,this.view=new nr(f,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new sn(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){f.point&&this.value.setRawValue(Ce(Ht(f.point.x,0,f.bounds.width),0,f.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),x)}onPointerDownOrMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){const x=j(this.baseStep_,Dt(f));x!==0&&this.value.setRawValue(this.value.rawValue+x,{forceEmit:!1,last:!1})}onKeyUp_(f){j(this.baseStep_,Dt(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Lr=E("sldtxt");class ti{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(Lr());const T=f.createElement("div");T.classList.add(Lr("s")),this.sliderView_=x.sliderView,T.appendChild(this.sliderView_.element),this.element.appendChild(T);const I=f.createElement("div");I.classList.add(Lr("t")),this.textView_=x.textView,I.appendChild(this.textView_.element),this.element.appendChild(I)}}class Be{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.sliderC_=new Le(f,{baseStep:x.baseStep,props:x.sliderProps,value:x.value,viewProps:this.viewProps}),this.textC_=new ui(f,{baseStep:x.baseStep,parser:x.parser,props:x.textProps,sliderProps:x.sliderProps,value:x.value,viewProps:x.viewProps}),this.view=new ti(f,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Ui(w,f){w.write(f)}function br(w){const f=Bt;if(Array.isArray(w))return f.required.array(f.required.object({text:f.required.string,value:f.required.raw}))(w).value;if(typeof w=="object")return f.required.raw(w).value}function Oe(w){if(w==="inline"||w==="popup")return w}function mi(w){const f=Bt;return f.required.object({max:f.optional.number,min:f.optional.number,step:f.optional.number})(w).value}function qe(w){if(Array.isArray(w))return w;const f=[];return Object.keys(w).forEach(x=>{f.push({text:x,value:w[x]})}),f}function Ys(w){return h(w)?null:new Yo(qe(w))}function gi(w){const f=w?os(w,Ya):null;return f?f.step:null}function ir(w,f){const x=w&&os(w,Ya);return x?Ee(x.step):Math.max(Ee(f),2)}function Fi(w){const f=gi(w);return f??1}function Sn(w,f){var x;const T=w&&os(w,Ya),I=Math.abs((x=T==null?void 0:T.step)!==null&&x!==void 0?x:f);return I===0?.1:Math.pow(10,Math.floor(Math.log10(I))-1)}const vi=E("ckb");class ii{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.element=f.createElement("div"),this.element.classList.add(vi()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("label");T.classList.add(vi("l")),this.element.appendChild(T);const I=f.createElement("input");I.classList.add(vi("i")),I.type="checkbox",T.appendChild(I),this.inputElement=I,x.viewProps.bindDisabled(this.inputElement);const it=f.createElement("div");it.classList.add(vi("w")),T.appendChild(it);const xt=B(f,"check");it.appendChild(xt),x.value.emitter.on("change",this.onValueChange_),this.value=x.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Ct{constructor(f,x){this.onInputChange_=this.onInputChange_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new ii(f,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(f){const x=f.currentTarget;this.value.rawValue=x.checked}}function ji(w){const f=[],x=Ys(w.options);return x&&f.push(x),new Ma(f)}const Za={id:"input-bool",type:"input",accept:(w,f)=>{if(typeof w!="boolean")return null;const T=Wt(f,{options:Bt.optional.custom(br)});return T?{initialValue:w,params:T}:null},binding:{reader:w=>Ea,constraint:w=>ji(w.params),writer:w=>Ui},controller:w=>{const f=w.document,x=w.value,T=w.constraint,I=T&&os(T,Yo);return I?new mo(f,{props:new Q({options:I.values.value("options")}),value:x,viewProps:w.viewProps}):new Ct(f,{value:x,viewProps:w.viewProps})}},us=E("col");class yr{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(us()),x.foldable.bindExpandedClass(this.element,us(void 0,"expanded")),L(x.foldable,"completed",D(this.element,us(void 0,"cpl")));const T=f.createElement("div");T.classList.add(us("h")),this.element.appendChild(T);const I=f.createElement("div");I.classList.add(us("s")),T.appendChild(I),this.swatchElement=I;const it=f.createElement("div");if(it.classList.add(us("t")),T.appendChild(it),this.textElement=it,x.pickerLayout==="inline"){const xt=f.createElement("div");xt.classList.add(us("p")),this.element.appendChild(xt),this.pickerElement=xt}else this.pickerElement=null}}function Xi(w,f,x){const T=Ht(w/255,0,1),I=Ht(f/255,0,1),it=Ht(x/255,0,1),xt=Math.max(T,I,it),Zt=Math.min(T,I,it),Te=xt-Zt;let He=0,Nn=0;const In=(Zt+xt)/2;return Te!==0&&(Nn=Te/(1-Math.abs(xt+Zt-1)),T===xt?He=(I-it)/Te:I===xt?He=2+(it-T)/Te:He=4+(T-I)/Te,He=He/6+(He<0?1:0)),[He*360,Nn*100,In*100]}function Or(w,f,x){const T=(w%360+360)%360,I=Ht(f/100,0,1),it=Ht(x/100,0,1),xt=(1-Math.abs(2*it-1))*I,Zt=xt*(1-Math.abs(T/60%2-1)),Te=it-xt/2;let He,Nn,In;return T>=0&&T<60?[He,Nn,In]=[xt,Zt,0]:T>=60&&T<120?[He,Nn,In]=[Zt,xt,0]:T>=120&&T<180?[He,Nn,In]=[0,xt,Zt]:T>=180&&T<240?[He,Nn,In]=[0,Zt,xt]:T>=240&&T<300?[He,Nn,In]=[Zt,0,xt]:[He,Nn,In]=[xt,0,Zt],[(He+Te)*255,(Nn+Te)*255,(In+Te)*255]}function Vi(w,f,x){const T=Ht(w/255,0,1),I=Ht(f/255,0,1),it=Ht(x/255,0,1),xt=Math.max(T,I,it),Zt=Math.min(T,I,it),Te=xt-Zt;let He;Te===0?He=0:xt===T?He=60*(((I-it)/Te%6+6)%6):xt===I?He=60*((it-T)/Te+2):He=60*((T-I)/Te+4);const Nn=xt===0?0:Te/xt,In=xt;return[He,Nn*100,In*100]}function Dr(w,f,x){const T=ke(w,360),I=Ht(f/100,0,1),it=Ht(x/100,0,1),xt=it*I,Zt=xt*(1-Math.abs(T/60%2-1)),Te=it-xt;let He,Nn,In;return T>=0&&T<60?[He,Nn,In]=[xt,Zt,0]:T>=60&&T<120?[He,Nn,In]=[Zt,xt,0]:T>=120&&T<180?[He,Nn,In]=[0,xt,Zt]:T>=180&&T<240?[He,Nn,In]=[0,Zt,xt]:T>=240&&T<300?[He,Nn,In]=[Zt,0,xt]:[He,Nn,In]=[xt,0,Zt],[(He+Te)*255,(Nn+Te)*255,(In+Te)*255]}function Ir(w,f,x){const T=x+f*(100-Math.abs(2*x-100))/200;return[w,T!==0?f*(100-Math.abs(2*x-100))/T:0,x+f*(100-Math.abs(2*x-100))/(2*100)]}function Aa(w,f,x){const T=100-Math.abs(x*(200-f)/100-100);return[w,T!==0?f*x/T:0,x*(200-f)/(2*100)]}function Bi(w){return[w[0],w[1],w[2]]}function Nr(w,f){return[w[0],w[1],w[2],f]}const lt={hsl:{hsl:(w,f,x)=>[w,f,x],hsv:Ir,rgb:Or},hsv:{hsl:Aa,hsv:(w,f,x)=>[w,f,x],rgb:Dr},rgb:{hsl:Xi,hsv:Vi,rgb:(w,f,x)=>[w,f,x]}};function Ot(w,f){return[f==="float"?1:w==="rgb"?255:360,f==="float"?1:w==="rgb"?255:100,f==="float"?1:w==="rgb"?255:100]}function Tt(w,f){return w===f?f:ke(w,f)}function he(w,f,x){var T;const I=Ot(f,x);return[f==="rgb"?Ht(w[0],0,I[0]):Tt(w[0],I[0]),Ht(w[1],0,I[1]),Ht(w[2],0,I[2]),Ht((T=w[3])!==null&&T!==void 0?T:1,0,1)]}function bt(w,f,x,T){const I=Ot(f,x),it=Ot(f,T);return w.map((xt,Zt)=>xt/I[Zt]*it[Zt])}function Je(w,f,x){const T=bt(w,f.mode,f.type,"int"),I=lt[f.mode][x.mode](...T);return bt(I,x.mode,"int",x.type)}function $n(w,f){return typeof w!="object"||h(w)?!1:f in w&&typeof w[f]=="number"}class ve{static black(f="int"){return new ve([0,0,0],"rgb",f)}static fromObject(f,x="int"){const T="a"in f?[f.r,f.g,f.b,f.a]:[f.r,f.g,f.b];return new ve(T,"rgb",x)}static toRgbaObject(f,x="int"){return f.toRgbaObject(x)}static isRgbColorObject(f){return $n(f,"r")&&$n(f,"g")&&$n(f,"b")}static isRgbaColorObject(f){return this.isRgbColorObject(f)&&$n(f,"a")}static isColorObject(f){return this.isRgbColorObject(f)}static equals(f,x){if(f.mode!==x.mode)return!1;const T=f.comps_,I=x.comps_;for(let it=0;it<T.length;it++)if(T[it]!==I[it])return!1;return!0}constructor(f,x,T="int"){this.mode=x,this.type=T,this.comps_=he(f,x,T)}getComponents(f,x="int"){return Nr(Je(Bi(this.comps_),{mode:this.mode,type:this.type},{mode:f??this.mode,type:x}),this.comps_[3])}toRgbaObject(f="int"){const x=this.getComponents("rgb",f);return{r:x[0],g:x[1],b:x[2],a:x[3]}}}const Xn=E("colp");class Ja{constructor(f,x){this.alphaViews_=null,this.element=f.createElement("div"),this.element.classList.add(Xn()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("div");T.classList.add(Xn("hsv"));const I=f.createElement("div");I.classList.add(Xn("sv")),this.svPaletteView_=x.svPaletteView,I.appendChild(this.svPaletteView_.element),T.appendChild(I);const it=f.createElement("div");it.classList.add(Xn("h")),this.hPaletteView_=x.hPaletteView,it.appendChild(this.hPaletteView_.element),T.appendChild(it),this.element.appendChild(T);const xt=f.createElement("div");if(xt.classList.add(Xn("rgb")),this.textView_=x.textView,xt.appendChild(this.textView_.element),this.element.appendChild(xt),x.alphaViews){this.alphaViews_={palette:x.alphaViews.palette,text:x.alphaViews.text};const Zt=f.createElement("div");Zt.classList.add(Xn("a"));const Te=f.createElement("div");Te.classList.add(Xn("ap")),Te.appendChild(this.alphaViews_.palette.element),Zt.appendChild(Te);const He=f.createElement("div");He.classList.add(Xn("at")),He.appendChild(this.alphaViews_.text.element),Zt.appendChild(He),this.element.appendChild(Zt)}}get allFocusableElements(){const f=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(x=>x.inputElement)];return this.alphaViews_&&f.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),f}}function rr(w){return w==="int"?"int":w==="float"?"float":void 0}function go(w){const f=Bt;return Wt(w,{alpha:f.optional.boolean,color:f.optional.object({alpha:f.optional.boolean,type:f.optional.custom(rr)}),expanded:f.optional.boolean,picker:f.optional.custom(Oe)})}function xi(w){return w?.1:1}function On(w){var f;return(f=w.color)===null||f===void 0?void 0:f.type}function hs(w,f){return w.alpha===f.alpha&&w.mode===f.mode&&w.notation===f.notation&&w.type===f.type}function di(w,f){const x=w.match(/^(.+)%$/);return Math.min(x?parseFloat(x[1])*.01*f:parseFloat(w),f)}const yn={deg:w=>w,grad:w=>w*360/400,rad:w=>w*360/(2*Math.PI),turn:w=>w*360};function vo(w){const f=w.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!f)return parseFloat(w);const x=parseFloat(f[1]),T=f[2];return yn[T](x)}function ks(w){const f=w.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[di(f[1],255),di(f[2],255),di(f[3],255)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])?null:x}function sr(w){return f=>{const x=ks(f);return x?new ve(x,"rgb",w):null}}function Pa(w){const f=w.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[di(f[1],255),di(f[2],255),di(f[3],255),di(f[4],1)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])||isNaN(x[3])?null:x}function Qa(w){return f=>{const x=Pa(f);return x?new ve(x,"rgb",w):null}}function tl(w){const f=w.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[vo(f[1]),di(f[2],100),di(f[3],100)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])?null:x}function Ks(w){return f=>{const x=tl(f);return x?new ve(x,"hsl",w):null}}function zr(w){const f=w.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!f)return null;const x=[vo(f[1]),di(f[2],100),di(f[3],100),di(f[4],1)];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])||isNaN(x[3])?null:x}function Ls(w){return f=>{const x=zr(f);return x?new ve(x,"hsl",w):null}}function xn(w){const f=w.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(f)return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)];const x=w.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return x?[parseInt(x[1],16),parseInt(x[2],16),parseInt(x[3],16)]:null}function _o(w){const f=xn(w);return f?new ve(f,"rgb","int"):null}function ws(w){const f=w.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(f)return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16),Ce(parseInt(f[4]+f[4],16),0,255,0,1)];const x=w.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return x?[parseInt(x[1],16),parseInt(x[2],16),parseInt(x[3],16),Ce(parseInt(x[4],16),0,255,0,1)]:null}function Os(w){const f=ws(w);return f?new ve(f,"rgb","int"):null}function Zr(w){const f=w.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!f)return null;const x=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])?null:x}function Zo(w){return f=>{const x=Zr(f);return x?new ve(x,"rgb",w):null}}function Zs(w){const f=w.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!f)return null;const x=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),parseFloat(f[4])];return isNaN(x[0])||isNaN(x[1])||isNaN(x[2])||isNaN(x[3])?null:x}function Ur(w){return f=>{const x=Zs(f);return x?new ve(x,"rgb",w):null}}const Ke=[{parser:xn,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:ws,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:ks,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Pa,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:tl,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:zr,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Zr,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Zs,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Ie(w){return Ke.reduce((f,{parser:x,result:T})=>f||(x(w)?T:null),null)}function En(w,f="int"){const x=Ie(w);return x?x.notation==="hex"&&f!=="float"?Object.assign(Object.assign({},x),{type:"int"}):x.notation==="func"?Object.assign(Object.assign({},x),{type:f}):null:null}const wi={int:[_o,Os,sr("int"),Qa("int"),Ks("int"),Ls("int"),Zo("int"),Ur("int")],float:[sr("float"),Qa("float"),Ks("float"),Ls("float"),Zo("float"),Ur("float")]};function _e(w){const f=wi[w];return x=>{if(typeof x!="string")return ve.black(w);const T=f.reduce((I,it)=>I||it(x),null);return T??ve.black(w)}}function on(w){const f=wi[w];return x=>f.reduce((T,I)=>T||I(x),null)}function Ne(w){const f=Ht(Math.floor(w),0,255).toString(16);return f.length===1?`0${f}`:f}function ln(w,f="#"){const x=Bi(w.getComponents("rgb")).map(Ne).join("");return`${f}${x}`}function Ri(w,f="#"){const x=w.getComponents("rgb"),T=[x[0],x[1],x[2],x[3]*255].map(Ne).join("");return`${f}${T}`}function Mn(w,f){const x=nn(f==="float"?2:0);return`rgb(${Bi(w.getComponents("rgb",f)).map(I=>x(I)).join(", ")})`}function ki(w){return f=>Mn(f,w)}function gn(w,f){const x=nn(2),T=nn(f==="float"?2:0);return`rgba(${w.getComponents("rgb",f).map((it,xt)=>(xt===3?x:T)(it)).join(", ")})`}function Dn(w){return f=>gn(f,w)}function Si(w){const f=[nn(0),yt,yt];return`hsl(${Bi(w.getComponents("hsl")).map((T,I)=>f[I](T)).join(", ")})`}function ri(w){const f=[nn(0),yt,yt,nn(2)];return`hsla(${w.getComponents("hsl").map((T,I)=>f[I](T)).join(", ")})`}function Ss(w,f){const x=nn(f==="float"?2:0),T=["r","g","b"];return`{${Bi(w.getComponents("rgb",f)).map((it,xt)=>`${T[xt]}: ${x(it)}`).join(", ")}}`}function Mi(w){return f=>Ss(f,w)}function Fr(w,f){const x=nn(2),T=nn(f==="float"?2:0),I=["r","g","b","a"];return`{${w.getComponents("rgb",f).map((xt,Zt)=>{const Te=Zt===3?x:T;return`${I[Zt]}: ${Te(xt)}`}).join(", ")}}`}function ds(w){return f=>Fr(f,w)}const Jr=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:ln},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Ri},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Si},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:ri},...["int","float"].reduce((w,f)=>[...w,{format:{alpha:!1,mode:"rgb",notation:"func",type:f},stringifier:ki(f)},{format:{alpha:!0,mode:"rgb",notation:"func",type:f},stringifier:Dn(f)},{format:{alpha:!1,mode:"rgb",notation:"object",type:f},stringifier:Mi(f)},{format:{alpha:!0,mode:"rgb",notation:"object",type:f},stringifier:ds(f)}],[])];function _i(w){return Jr.reduce((f,x)=>f||(hs(x.format,w)?x.stringifier:null),null)}const bi=E("apl");class Js{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.value=x.value,this.value.emitter.on("change",this.onValueChange_),this.element=f.createElement("div"),this.element.classList.add(bi()),x.viewProps.bindClassModifiers(this.element),x.viewProps.bindTabIndex(this.element);const T=f.createElement("div");T.classList.add(bi("b")),this.element.appendChild(T);const I=f.createElement("div");I.classList.add(bi("c")),T.appendChild(I),this.colorElem_=I;const it=f.createElement("div");it.classList.add(bi("m")),this.element.appendChild(it),this.markerElem_=it;const xt=f.createElement("div");xt.classList.add(bi("p")),this.markerElem_.appendChild(xt),this.previewElem_=xt,this.update_()}update_(){const f=this.value.rawValue,x=f.getComponents("rgb"),T=new ve([x[0],x[1],x[2],0],"rgb"),I=new ve([x[0],x[1],x[2],255],"rgb"),it=["to right",gn(T),gn(I)];this.colorElem_.style.background=`linear-gradient(${it.join(",")})`,this.previewElem_.style.backgroundColor=gn(f);const xt=Ce(x[3],0,1,0,100);this.markerElem_.style.left=`${xt}%`}onValueChange_(){this.update_()}}class el{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new Js(f,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new sn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const T=f.point.x/f.bounds.width,I=this.value.rawValue,[it,xt,Zt]=I.getComponents("hsv");this.value.setRawValue(new ve([it,xt,Zt,T],"hsv"),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){const x=j(xi(!0),Dt(f));if(x===0)return;const T=this.value.rawValue,[I,it,xt,Zt]=T.getComponents("hsv");this.value.setRawValue(new ve([I,it,xt,Zt+x],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(f){j(xi(!0),Dt(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const li=E("coltxt");function Yi(w){const f=w.createElement("select"),x=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return f.appendChild(x.reduce((T,I)=>{const it=w.createElement("option");return it.textContent=I.text,it.value=I.value,T.appendChild(it),T},w.createDocumentFragment())),f}class bo{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(li()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("div");T.classList.add(li("m")),this.modeElem_=Yi(f),this.modeElem_.classList.add(li("ms")),T.appendChild(this.modeSelectElement),x.viewProps.bindDisabled(this.modeElem_);const I=f.createElement("div");I.classList.add(li("mm")),I.appendChild(B(f,"dropdown")),T.appendChild(I),this.element.appendChild(T);const it=f.createElement("div");it.classList.add(li("w")),this.element.appendChild(it),this.textsElem_=it,this.textViews_=x.textViews,this.applyTextViews_(),O(x.colorMode,xt=>{this.modeElem_.value=xt})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(f){this.textViews_=f,this.applyTextViews_()}applyTextViews_(){Kt(this.textsElem_);const f=this.element.ownerDocument;this.textViews_.forEach(x=>{const T=f.createElement("div");T.classList.add(li("c")),T.appendChild(x.element),this.textsElem_.appendChild(T)})}}function Ih(w){return nn(w==="float"?2:0)}function hp(w,f,x){const T=Ot(w,f)[x];return new as({min:0,max:T})}function nl(w,f,x){return new ui(w,{arrayPosition:x===0?"fst":x===3-1?"lst":"mid",baseStep:xi(!1),parser:f.parser,props:Q.fromObject({draggingScale:f.colorType==="float"?.01:1,formatter:Ih(f.colorType)}),value:nt(0,{constraint:hp(f.colorMode,f.colorType,x)}),viewProps:f.viewProps})}class Ms{constructor(f,x){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=x.colorType,this.parser_=x.parser,this.value=x.value,this.viewProps=x.viewProps,this.colorMode=nt(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(f),this.view=new bo(f,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(f){const x={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},T=[nl(f,x,0),nl(f,x,1),nl(f,x,2)];return T.forEach((I,it)=>{q({primary:this.value,secondary:I.value,forward:xt=>xt.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[it],backward:(xt,Zt)=>{const Te=this.colorMode.rawValue,He=xt.rawValue.getComponents(Te,this.colorType_);return He[it]=Zt.rawValue,new ve(Nr(Bi(He),He[3]),Te,this.colorType_)}})}),T}onModeSelectChange_(f){const x=f.currentTarget;this.colorMode.rawValue=x.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Qs=E("hpl");class vc{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.value=x.value,this.value.emitter.on("change",this.onValueChange_),this.element=f.createElement("div"),this.element.classList.add(Qs()),x.viewProps.bindClassModifiers(this.element),x.viewProps.bindTabIndex(this.element);const T=f.createElement("div");T.classList.add(Qs("c")),this.element.appendChild(T);const I=f.createElement("div");I.classList.add(Qs("m")),this.element.appendChild(I),this.markerElem_=I,this.update_()}update_(){const f=this.value.rawValue,[x]=f.getComponents("hsv");this.markerElem_.style.backgroundColor=Mn(new ve([x,100,100],"hsv"));const T=Ce(x,0,360,0,100);this.markerElem_.style.left=`${T}%`}onValueChange_(){this.update_()}}class H{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new vc(f,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new sn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const T=Ce(Ht(f.point.x,0,f.bounds.width),0,f.bounds.width,0,360),I=this.value.rawValue,[,it,xt,Zt]=I.getComponents("hsv");this.value.setRawValue(new ve([T,it,xt,Zt],"hsv"),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){const x=j(xi(!1),Dt(f));if(x===0)return;const T=this.value.rawValue,[I,it,xt,Zt]=T.getComponents("hsv");this.value.setRawValue(new ve([I+x,it,xt,Zt],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(f){j(xi(!1),Dt(f))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Dl=E("svp"),Nh=64;class yo{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),this.value=x.value,this.value.emitter.on("change",this.onValueChange_),this.element=f.createElement("div"),this.element.classList.add(Dl()),x.viewProps.bindClassModifiers(this.element),x.viewProps.bindTabIndex(this.element);const T=f.createElement("canvas");T.height=Nh,T.width=Nh,T.classList.add(Dl("c")),this.element.appendChild(T),this.canvasElement=T;const I=f.createElement("div");I.classList.add(Dl("m")),this.element.appendChild(I),this.markerElem_=I,this.update_()}update_(){const f=_t(this.canvasElement);if(!f)return;const T=this.value.rawValue.getComponents("hsv"),I=this.canvasElement.width,it=this.canvasElement.height,xt=f.getImageData(0,0,I,it),Zt=xt.data;for(let Nn=0;Nn<it;Nn++)for(let In=0;In<I;In++){const Ul=Ce(In,0,I,0,100),Sc=Ce(Nn,0,it,100,0),wu=Dr(T[0],Ul,Sc),Su=(Nn*I+In)*4;Zt[Su]=wu[0],Zt[Su+1]=wu[1],Zt[Su+2]=wu[2],Zt[Su+3]=255}f.putImageData(xt,0,0);const Te=Ce(T[1],0,100,0,100);this.markerElem_.style.left=`${Te}%`;const He=Ce(T[2],0,100,100,0);this.markerElem_.style.top=`${He}%`}onValueChange_(){this.update_()}}class Cn{constructor(f,x){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.view=new yo(f,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new sn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const T=Ce(f.point.x,0,f.bounds.width,0,100),I=Ce(f.point.y,0,f.bounds.height,100,0),[it,,,xt]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ve([it,T,I,xt],"hsv"),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onKeyDown_(f){de(f.key)&&f.preventDefault();const[x,T,I,it]=this.value.rawValue.getComponents("hsv"),xt=xi(!1),Zt=j(xt,Dt(f)),Te=j(xt,gt(f));Zt===0&&Te===0||this.value.setRawValue(new ve([x,T+Zt,I+Te,it],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(f){const x=xi(!1),T=j(x,Dt(f)),I=j(x,gt(f));T===0&&I===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Aw{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.hPaletteC_=new H(f,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Cn(f,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=x.supportsAlpha?{palette:new el(f,{value:this.value,viewProps:this.viewProps}),text:new ui(f,{parser:_r,baseStep:.1,props:Q.fromObject({draggingScale:.01,formatter:nn(2)}),value:nt(0,{constraint:new as({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&q({primary:this.value,secondary:this.alphaIcs_.text.value,forward:T=>T.rawValue.getComponents()[3],backward:(T,I)=>{const it=T.rawValue.getComponents();return it[3]=I.rawValue,new ve(it,T.rawValue.mode)}}),this.textC_=new Ms(f,{colorType:x.colorType,parser:_r,value:this.value,viewProps:this.viewProps}),this.view=new Ja(f,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:x.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const hm=E("colsw");class Pw{constructor(f,x){this.onValueChange_=this.onValueChange_.bind(this),x.value.emitter.on("change",this.onValueChange_),this.value=x.value,this.element=f.createElement("div"),this.element.classList.add(hm()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("div");T.classList.add(hm("sw")),this.element.appendChild(T),this.swatchElem_=T;const I=f.createElement("button");I.classList.add(hm("b")),x.viewProps.bindDisabled(I),this.element.appendChild(I),this.buttonElement=I,this.update_()}update_(){const f=this.value.rawValue;this.swatchElem_.style.backgroundColor=Ri(f)}onValueChange_(){this.update_()}}class _c{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.view=new Pw(f,{value:this.value,viewProps:this.viewProps})}}class dm{constructor(f,x){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.foldable_=xe.create(x.expanded),this.swatchC_=new _c(f,{value:this.value,viewProps:this.viewProps});const T=this.swatchC_.view.buttonElement;T.addEventListener("blur",this.onButtonBlur_),T.addEventListener("click",this.onButtonClick_),this.textC_=new fu(f,{parser:x.parser,props:Q.fromObject({formatter:x.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new yr(f,{foldable:this.foldable_,pickerLayout:x.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=x.pickerLayout==="popup"?new pu(f,{viewProps:this.viewProps}):null;const I=new Aw(f,{colorType:x.colorType,supportsAlpha:x.supportsAlpha,value:this.value,viewProps:this.viewProps});I.view.allFocusableElements.forEach(it=>{it.addEventListener("blur",this.onPopupChildBlur_),it.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=I,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(I.view.element),q({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:it=>it.rawValue,backward:(it,xt)=>xt.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ee(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(f){if(!this.popC_)return;const x=this.view.element,T=f.relatedTarget;(!T||!x.contains(T))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(f){if(!this.popC_)return;const x=this.popC_.view.element,T=we(f);T&&x.contains(T)||T&&T===this.swatchC_.view.buttonElement&&!qt(x.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(f){this.popC_?f.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&f.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Rw(w,f){return ve.isColorObject(w)?ve.fromObject(w,f):ve.black(f)}function kw(w){return Bi(w.getComponents("rgb")).reduce((f,x)=>f<<8|Math.floor(x)&255,0)}function Lw(w){return w.getComponents("rgb").reduce((f,x,T)=>{const I=Math.floor(T===3?x*255:x)&255;return f<<8|I},0)>>>0}function Ow(w){return new ve([w>>16&255,w>>8&255,w&255],"rgb")}function il(w){return new ve([w>>24&255,w>>16&255,w>>8&255,Ce(w&255,0,255,0,1)],"rgb")}function Dw(w){return typeof w!="number"?ve.black():Ow(w)}function Iw(w){return typeof w!="number"?ve.black():il(w)}function Nw(w){const f=_i(w);return f?(x,T)=>{Ui(x,f(T))}:null}function zw(w){const f=w?Lw:kw;return(x,T)=>{Ui(x,f(T))}}function Uw(w,f,x){const T=f.toRgbaObject(x);w.writeProperty("r",T.r),w.writeProperty("g",T.g),w.writeProperty("b",T.b),w.writeProperty("a",T.a)}function rl(w,f,x){const T=f.toRgbaObject(x);w.writeProperty("r",T.r),w.writeProperty("g",T.g),w.writeProperty("b",T.b)}function Fw(w,f){return(x,T)=>{w?Uw(x,T,f):rl(x,T,f)}}function pm(w){var f;return!!(w!=null&&w.alpha||!((f=w==null?void 0:w.color)===null||f===void 0)&&f.alpha)}function Vw(w){return w?f=>Ri(f,"0x"):f=>ln(f,"0x")}function Bw(w){return"color"in w||"view"in w&&w.view==="color"}const Hw={id:"input-color-number",type:"input",accept:(w,f)=>{if(typeof w!="number"||!Bw(f))return null;const x=go(f);return x?{initialValue:w,params:x}:null},binding:{reader:w=>pm(w.params)?Iw:Dw,equals:ve.equals,writer:w=>zw(pm(w.params))},controller:w=>{const f=pm(w.params),x="expanded"in w.params?w.params.expanded:void 0,T="picker"in w.params?w.params.picker:void 0;return new dm(w.document,{colorType:"int",expanded:x??!1,formatter:Vw(f),parser:on("int"),pickerLayout:T??"popup",supportsAlpha:f,value:w.value,viewProps:w.viewProps})}};function bc(w){return ve.isRgbaColorObject(w)}function $w(w){return f=>Rw(f,w)}function Gw(w,f){return x=>w?Fr(x,f):Ss(x,f)}const Jo={id:"input-color-object",type:"input",accept:(w,f)=>{if(!ve.isColorObject(w))return null;const x=go(f);return x?{initialValue:w,params:x}:null},binding:{reader:w=>$w(On(w.params)),equals:ve.equals,writer:w=>Fw(bc(w.initialValue),On(w.params))},controller:w=>{var f;const x=ve.isRgbaColorObject(w.initialValue),T="expanded"in w.params?w.params.expanded:void 0,I="picker"in w.params?w.params.picker:void 0,it=(f=On(w.params))!==null&&f!==void 0?f:"int";return new dm(w.document,{colorType:it,expanded:T??!1,formatter:Gw(x,it),parser:on(it),pickerLayout:I??"popup",supportsAlpha:x,value:w.value,viewProps:w.viewProps})}},qw={id:"input-color-string",type:"input",accept:(w,f)=>{if(typeof w!="string"||"view"in f&&f.view==="text")return null;const x=En(w,On(f));if(!x||!_i(x))return null;const I=go(f);return I?{initialValue:w,params:I}:null},binding:{reader:w=>{var f;return _e((f=On(w.params))!==null&&f!==void 0?f:"int")},equals:ve.equals,writer:w=>{const f=En(w.initialValue,On(w.params));if(!f)throw _.shouldNeverHappen();const x=Nw(f);if(!x)throw _.notBindable();return x}},controller:w=>{const f=En(w.initialValue,On(w.params));if(!f)throw _.shouldNeverHappen();const x=_i(f);if(!x)throw _.shouldNeverHappen();const T="expanded"in w.params?w.params.expanded:void 0,I="picker"in w.params?w.params.picker:void 0;return new dm(w.document,{colorType:f.type,expanded:T??!1,formatter:x,parser:on(f.type),pickerLayout:I??"popup",supportsAlpha:f.alpha,value:w.value,viewProps:w.viewProps})}};class Il{constructor(f){this.components=f.components,this.asm_=f.assembly}constrain(f){const x=this.asm_.toComponents(f).map((T,I)=>{var it,xt;return(xt=(it=this.components[I])===null||it===void 0?void 0:it.constrain(T))!==null&&xt!==void 0?xt:T});return this.asm_.fromComponents(x)}}const L_=E("pndtxt");class Ww{constructor(f,x){this.textViews=x.textViews,this.element=f.createElement("div"),this.element.classList.add(L_()),this.textViews.forEach(T=>{const I=f.createElement("div");I.classList.add(L_("a")),I.appendChild(T.element),this.element.appendChild(I)})}}function jw(w,f,x){return new ui(w,{arrayPosition:x===0?"fst":x===f.axes.length-1?"lst":"mid",baseStep:f.axes[x].baseStep,parser:f.parser,props:f.axes[x].textProps,value:nt(0,{constraint:f.axes[x].constraint}),viewProps:f.viewProps})}class dp{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.acs_=x.axes.map((T,I)=>jw(f,x,I)),this.acs_.forEach((T,I)=>{q({primary:this.value,secondary:T.value,forward:it=>x.assembly.toComponents(it.rawValue)[I],backward:(it,xt)=>{const Zt=x.assembly.toComponents(it.rawValue);return Zt[I]=xt.rawValue,x.assembly.fromComponents(Zt)}})}),this.view=new Ww(f,{textViews:this.acs_.map(T=>T.view)})}}function fm(w,f){return"step"in w&&!h(w.step)?new Ya(w.step,f):null}function O_(w){return!h(w.max)&&!h(w.min)?new as({max:w.max,min:w.min}):!h(w.max)||!h(w.min)?new Pl({max:w.max,min:w.min}):null}function Xw(w){const f=os(w,as);if(f)return[f.values.get("min"),f.values.get("max")];const x=os(w,Pl);return x?[x.minValue,x.maxValue]:[void 0,void 0]}function mm(w,f){const x=[],T=fm(w,f);T&&x.push(T);const I=O_(w);I&&x.push(I);const it=Ys(w.options);return it&&x.push(it),new Ma(x)}const zh={id:"input-number",type:"input",accept:(w,f)=>{if(typeof w!="number")return null;const x=Bt,T=Wt(f,{format:x.optional.function,max:x.optional.number,min:x.optional.number,options:x.optional.custom(br),step:x.optional.number});return T?{initialValue:w,params:T}:null},binding:{reader:w=>gc,constraint:w=>mm(w.params,w.initialValue),writer:w=>Ui},controller:w=>{var f;const x=w.value,T=w.constraint,I=T&&os(T,Yo);if(I)return new mo(w.document,{props:new Q({options:I.values.value("options")}),value:x,viewProps:w.viewProps});const it=(f="format"in w.params?w.params.format:void 0)!==null&&f!==void 0?f:nn(ir(T,x.rawValue)),xt=T&&os(T,as);return xt?new Be(w.document,{baseStep:Fi(T),parser:_r,sliderProps:new Q({maxValue:xt.values.value("max"),minValue:xt.values.value("min")}),textProps:Q.fromObject({draggingScale:Sn(T,x.rawValue),formatter:it}),value:x,viewProps:w.viewProps}):new ui(w.document,{baseStep:Fi(T),parser:_r,props:Q.fromObject({draggingScale:Sn(T,x.rawValue),formatter:it}),value:x,viewProps:w.viewProps})}};class Qo{constructor(f=0,x=0){this.x=f,this.y=x}getComponents(){return[this.x,this.y]}static isObject(f){if(h(f))return!1;const x=f.x,T=f.y;return!(typeof x!="number"||typeof T!="number")}static equals(f,x){return f.x===x.x&&f.y===x.y}toObject(){return{x:this.x,y:this.y}}}const D_={toComponents:w=>w.getComponents(),fromComponents:w=>new Qo(...w)},yc=E("p2d");class Yw{constructor(f,x){this.element=f.createElement("div"),this.element.classList.add(yc()),x.viewProps.bindClassModifiers(this.element),O(x.expanded,D(this.element,yc(void 0,"expanded")));const T=f.createElement("div");T.classList.add(yc("h")),this.element.appendChild(T);const I=f.createElement("button");I.classList.add(yc("b")),I.appendChild(B(f,"p2dpad")),x.viewProps.bindDisabled(I),T.appendChild(I),this.buttonElement=I;const it=f.createElement("div");if(it.classList.add(yc("t")),T.appendChild(it),this.textElement=it,x.pickerLayout==="inline"){const xt=f.createElement("div");xt.classList.add(yc("p")),this.element.appendChild(xt),this.pickerElement=xt}else this.pickerElement=null}}const ps=E("p2dp");class gm{constructor(f,x){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=x.invertsY,this.maxValue_=x.maxValue,this.element=f.createElement("div"),this.element.classList.add(ps()),x.layout==="popup"&&this.element.classList.add(ps(void 0,"p")),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("div");T.classList.add(ps("p")),x.viewProps.bindTabIndex(T),this.element.appendChild(T),this.padElement=T;const I=f.createElementNS(ft,"svg");I.classList.add(ps("g")),this.padElement.appendChild(I),this.svgElem_=I;const it=f.createElementNS(ft,"line");it.classList.add(ps("ax")),it.setAttributeNS(null,"x1","0"),it.setAttributeNS(null,"y1","50%"),it.setAttributeNS(null,"x2","100%"),it.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(it);const xt=f.createElementNS(ft,"line");xt.classList.add(ps("ax")),xt.setAttributeNS(null,"x1","50%"),xt.setAttributeNS(null,"y1","0"),xt.setAttributeNS(null,"x2","50%"),xt.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(xt);const Zt=f.createElementNS(ft,"line");Zt.classList.add(ps("l")),Zt.setAttributeNS(null,"x1","50%"),Zt.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(Zt),this.lineElem_=Zt;const Te=f.createElement("div");Te.classList.add(ps("m")),this.padElement.appendChild(Te),this.markerElem_=Te,x.value.emitter.on("change",this.onValueChange_),this.value=x.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[f,x]=this.value.rawValue.getComponents(),T=this.maxValue_,I=Ce(f,-T,+T,0,100),it=Ce(x,-T,+T,0,100),xt=this.invertsY_?100-it:it;this.lineElem_.setAttributeNS(null,"x2",`${I}%`),this.lineElem_.setAttributeNS(null,"y2",`${xt}%`),this.markerElem_.style.left=`${I}%`,this.markerElem_.style.top=`${xt}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Nl(w,f,x){return[j(f[0],Dt(w)),j(f[1],gt(w))*(x?1:-1)]}class xo{constructor(f,x){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.baseSteps_=x.baseSteps,this.maxValue_=x.maxValue,this.invertsY_=x.invertsY,this.view=new gm(f,{invertsY:this.invertsY_,layout:x.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new sn(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(f,x){if(!f.point)return;const T=this.maxValue_,I=Ce(f.point.x,0,f.bounds.width,-T,+T),it=Ce(this.invertsY_?f.bounds.height-f.point.y:f.point.y,0,f.bounds.height,-T,+T);this.value.setRawValue(new Qo(I,it),x)}onPointerDown_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerMove_(f){this.handlePointerEvent_(f.data,{forceEmit:!1,last:!1})}onPointerUp_(f){this.handlePointerEvent_(f.data,{forceEmit:!0,last:!0})}onPadKeyDown_(f){de(f.key)&&f.preventDefault();const[x,T]=Nl(f,this.baseSteps_,this.invertsY_);x===0&&T===0||this.value.setRawValue(new Qo(this.value.rawValue.x+x,this.value.rawValue.y+T),{forceEmit:!1,last:!1})}onPadKeyUp_(f){const[x,T]=Nl(f,this.baseSteps_,this.invertsY_);x===0&&T===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Kw{constructor(f,x){var T,I;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=x.value,this.viewProps=x.viewProps,this.foldable_=xe.create(x.expanded),this.popC_=x.pickerLayout==="popup"?new pu(f,{viewProps:this.viewProps}):null;const it=new xo(f,{baseSteps:[x.axes[0].baseStep,x.axes[1].baseStep],invertsY:x.invertsY,layout:x.pickerLayout,maxValue:x.maxValue,value:this.value,viewProps:this.viewProps});it.view.allFocusableElements.forEach(xt=>{xt.addEventListener("blur",this.onPopupChildBlur_),xt.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=it,this.textC_=new dp(f,{assembly:D_,axes:x.axes,parser:x.parser,value:this.value,viewProps:this.viewProps}),this.view=new Yw(f,{expanded:this.foldable_.value("expanded"),pickerLayout:x.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(T=this.view.buttonElement)===null||T===void 0||T.addEventListener("blur",this.onPadButtonBlur_),(I=this.view.buttonElement)===null||I===void 0||I.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),q({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:xt=>xt.rawValue,backward:(xt,Zt)=>Zt.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ee(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(f){if(!this.popC_)return;const x=this.view.element,T=f.relatedTarget;(!T||!x.contains(T))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(f){if(!this.popC_)return;const x=this.popC_.view.element,T=we(f);T&&x.contains(T)||T&&T===this.view.buttonElement&&!qt(x.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(f){this.popC_?f.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&f.key==="Escape"&&this.view.buttonElement.focus()}}class xc{constructor(f=0,x=0,T=0){this.x=f,this.y=x,this.z=T}getComponents(){return[this.x,this.y,this.z]}static isObject(f){if(h(f))return!1;const x=f.x,T=f.y,I=f.z;return!(typeof x!="number"||typeof T!="number"||typeof I!="number")}static equals(f,x){return f.x===x.x&&f.y===x.y&&f.z===x.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const vm={toComponents:w=>w.getComponents(),fromComponents:w=>new xc(...w)};function Uh(w){return xc.isObject(w)?new xc(w.x,w.y,w.z):new xc}function zl(w,f){w.writeProperty("x",f.x),w.writeProperty("y",f.y),w.writeProperty("z",f.z)}function I_(w,f){return new Il({assembly:vm,components:[ka("x"in w?w.x:void 0,f.x),ka("y"in w?w.y:void 0,f.y),ka("z"in w?w.z:void 0,f.z)]})}function _m(w,f){return{baseStep:Fi(f),constraint:f,textProps:Q.fromObject({draggingScale:Sn(f,w),formatter:nn(ir(f,w))})}}const pp={id:"input-point3d",type:"input",accept:(w,f)=>{if(!xc.isObject(w))return null;const x=Bt,T=Wt(f,{x:x.optional.custom(mi),y:x.optional.custom(mi),z:x.optional.custom(mi)});return T?{initialValue:w,params:T}:null},binding:{reader:w=>Uh,constraint:w=>I_(w.params,w.initialValue),equals:xc.equals,writer:w=>zl},controller:w=>{const f=w.value,x=w.constraint;if(!(x instanceof Il))throw _.shouldNeverHappen();return new dp(w.document,{assembly:vm,axes:[_m(f.rawValue.x,x.components[0]),_m(f.rawValue.y,x.components[1]),_m(f.rawValue.z,x.components[2])],parser:_r,value:f,viewProps:w.viewProps})}};class bu{constructor(f=0,x=0,T=0,I=0){this.x=f,this.y=x,this.z=T,this.w=I}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(f){if(h(f))return!1;const x=f.x,T=f.y,I=f.z,it=f.w;return!(typeof x!="number"||typeof T!="number"||typeof I!="number"||typeof it!="number")}static equals(f,x){return f.x===x.x&&f.y===x.y&&f.z===x.z&&f.w===x.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const bm={toComponents:w=>w.getComponents(),fromComponents:w=>new bu(...w)};function Qr(w){return bu.isObject(w)?new bu(w.x,w.y,w.z,w.w):new bu}function ym(w,f){w.writeProperty("x",f.x),w.writeProperty("y",f.y),w.writeProperty("z",f.z),w.writeProperty("w",f.w)}function N_(w,f){return new Il({assembly:bm,components:[ka("x"in w?w.x:void 0,f.x),ka("y"in w?w.y:void 0,f.y),ka("z"in w?w.z:void 0,f.z),ka("w"in w?w.w:void 0,f.w)]})}function Ra(w,f){return{baseStep:Fi(f),constraint:f,textProps:Q.fromObject({draggingScale:Sn(f,w),formatter:nn(ir(f,w))})}}const xm={id:"input-point4d",type:"input",accept:(w,f)=>{if(!bu.isObject(w))return null;const x=Bt,T=Wt(f,{x:x.optional.custom(mi),y:x.optional.custom(mi),z:x.optional.custom(mi),w:x.optional.custom(mi)});return T?{initialValue:w,params:T}:null},binding:{reader:w=>Qr,constraint:w=>N_(w.params,w.initialValue),equals:bu.equals,writer:w=>ym},controller:w=>{const f=w.value,x=w.constraint;if(!(x instanceof Il))throw _.shouldNeverHappen();return new dp(w.document,{assembly:bm,axes:f.rawValue.getComponents().map((T,I)=>Ra(T,x.components[I])),parser:_r,value:f,viewProps:w.viewProps})}};function fp(w){const f=[],x=Ys(w.options);return x&&f.push(x),new Ma(f)}const wc={id:"input-string",type:"input",accept:(w,f)=>{if(typeof w!="string")return null;const T=Wt(f,{options:Bt.optional.custom(br)});return T?{initialValue:w,params:T}:null},binding:{reader:w=>F,constraint:w=>fp(w.params),writer:w=>Ui},controller:w=>{const f=w.document,x=w.value,T=w.constraint,I=T&&os(T,Yo);return I?new mo(f,{props:new Q({options:I.values.value("options")}),value:x,viewProps:w.viewProps}):new fu(f,{parser:it=>it,props:Q.fromObject({formatter:at}),value:x,viewProps:w.viewProps})}},yu={monitor:{defaultInterval:200,defaultLineCount:3}},fs=E("mll");class wm{constructor(f,x){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=x.formatter,this.element=f.createElement("div"),this.element.classList.add(fs()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("textarea");T.classList.add(fs("i")),T.style.height=`calc(var(--bld-us) * ${x.lineCount})`,T.readOnly=!0,x.viewProps.bindDisabled(T),this.element.appendChild(T),this.textareaElem_=T,x.value.emitter.on("change",this.onValueUpdate_),this.value=x.value,this.update_()}update_(){const f=this.textareaElem_,x=f.scrollTop===f.scrollHeight-f.clientHeight,T=[];this.value.rawValue.forEach(I=>{I!==void 0&&T.push(this.formatter_(I))}),f.textContent=T.join(`
`),x&&(f.scrollTop=f.scrollHeight)}onValueUpdate_(){this.update_()}}class Sm{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.view=new wm(f,{formatter:x.formatter,lineCount:x.lineCount,value:this.value,viewProps:this.viewProps})}}const z_=E("sgl");class Zw{constructor(f,x){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=x.formatter,this.element=f.createElement("div"),this.element.classList.add(z_()),x.viewProps.bindClassModifiers(this.element);const T=f.createElement("input");T.classList.add(z_("i")),T.readOnly=!0,T.type="text",x.viewProps.bindDisabled(T),this.element.appendChild(T),this.inputElement=T,x.value.emitter.on("change",this.onValueUpdate_),this.value=x.value,this.update_()}update_(){const f=this.value.rawValue,x=f[f.length-1];this.inputElement.value=x!==void 0?this.formatter_(x):""}onValueUpdate_(){this.update_()}}class Fh{constructor(f,x){this.value=x.value,this.viewProps=x.viewProps,this.view=new Zw(f,{formatter:x.formatter,value:this.value,viewProps:this.viewProps})}}const Jw={id:"monitor-bool",type:"monitor",accept:(w,f)=>{if(typeof w!="boolean")return null;const T=Wt(f,{lineCount:Bt.optional.number});return T?{initialValue:w,params:T}:null},binding:{reader:w=>Ea},controller:w=>{var f;return w.value.rawValue.length===1?new Fh(w.document,{formatter:ls,value:w.value,viewProps:w.viewProps}):new Sm(w.document,{formatter:ls,lineCount:(f=w.params.lineCount)!==null&&f!==void 0?f:yu.monitor.defaultLineCount,value:w.value,viewProps:w.viewProps})}},wo=E("grl");class U_{constructor(f,x){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=f.createElement("div"),this.element.classList.add(wo()),x.viewProps.bindClassModifiers(this.element),this.formatter_=x.formatter,this.props_=x.props,this.cursor_=x.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const T=f.createElementNS(ft,"svg");T.classList.add(wo("g")),T.style.height=`calc(var(--bld-us) * ${x.lineCount})`,this.element.appendChild(T),this.svgElem_=T;const I=f.createElementNS(ft,"polyline");this.svgElem_.appendChild(I),this.lineElem_=I;const it=f.createElement("div");it.classList.add(wo("t"),E("tt")()),this.element.appendChild(it),this.tooltipElem_=it,x.value.emitter.on("change",this.onValueUpdate_),this.value=x.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const f=this.svgElem_.getBoundingClientRect(),x=this.value.rawValue.length-1,T=this.props_.get("minValue"),I=this.props_.get("maxValue"),it=[];this.value.rawValue.forEach((Nn,In)=>{if(Nn===void 0)return;const Ul=Ce(In,0,x,0,f.width),Sc=Ce(Nn,T,I,f.height,0);it.push([Ul,Sc].join(","))}),this.lineElem_.setAttributeNS(null,"points",it.join(" "));const xt=this.tooltipElem_,Zt=this.value.rawValue[this.cursor_.rawValue];if(Zt===void 0){xt.classList.remove(wo("t","a"));return}const Te=Ce(this.cursor_.rawValue,0,x,0,f.width),He=Ce(Zt,T,I,f.height,0);xt.style.left=`${Te}px`,xt.style.top=`${He}px`,xt.textContent=`${this.formatter_(Zt)}`,xt.classList.contains(wo("t","a"))||(xt.classList.add(wo("t","a"),wo("t","in")),kt(xt),xt.classList.remove(wo("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Qw{constructor(f,x){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=x.props,this.value=x.value,this.viewProps=x.viewProps,this.cursor_=nt(-1),this.view=new U_(f,{cursor:this.cursor_,formatter:x.formatter,lineCount:x.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!qt(f))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const T=new sn(this.view.element);T.emitter.on("down",this.onGraphPointerDown_),T.emitter.on("move",this.onGraphPointerMove_),T.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(f){const x=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Ce(f.offsetX,0,x.width,0,this.value.rawValue.length))}onGraphPointerDown_(f){this.onGraphPointerMove_(f)}onGraphPointerMove_(f){if(!f.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(Ce(f.data.point.x,0,f.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Mm(w){return"format"in w&&!h(w.format)?w.format:nn(2)}function Vh(w){var f;return w.value.rawValue.length===1?new Fh(w.document,{formatter:Mm(w.params),value:w.value,viewProps:w.viewProps}):new Sm(w.document,{formatter:Mm(w.params),lineCount:(f=w.params.lineCount)!==null&&f!==void 0?f:yu.monitor.defaultLineCount,value:w.value,viewProps:w.viewProps})}function t1(w){var f,x,T;return new Qw(w.document,{formatter:Mm(w.params),lineCount:(f=w.params.lineCount)!==null&&f!==void 0?f:yu.monitor.defaultLineCount,props:Q.fromObject({maxValue:(x="max"in w.params?w.params.max:null)!==null&&x!==void 0?x:100,minValue:(T="min"in w.params?w.params.min:null)!==null&&T!==void 0?T:0}),value:w.value,viewProps:w.viewProps})}function F_(w){return"view"in w&&w.view==="graph"}const Cm={id:"monitor-number",type:"monitor",accept:(w,f)=>{if(typeof w!="number")return null;const x=Bt,T=Wt(f,{format:x.optional.function,lineCount:x.optional.number,max:x.optional.number,min:x.optional.number,view:x.optional.string});return T?{initialValue:w,params:T}:null},binding:{defaultBufferSize:w=>F_(w)?64:1,reader:w=>gc},controller:w=>F_(w.params)?t1(w):Vh(w)},V_={id:"monitor-string",type:"monitor",accept:(w,f)=>{if(typeof w!="string")return null;const x=Bt,T=Wt(f,{lineCount:x.optional.number,multiline:x.optional.boolean});return T?{initialValue:w,params:T}:null},binding:{reader:w=>F},controller:w=>{var f;const x=w.value;return x.rawValue.length>1||"multiline"in w.params&&w.params.multiline?new Sm(w.document,{formatter:at,lineCount:(f=w.params.lineCount)!==null&&f!==void 0?f:yu.monitor.defaultLineCount,value:x,viewProps:w.viewProps}):new Fh(w.document,{formatter:at,value:x,viewProps:w.viewProps})}};function e1(w,f){var x;const T=w.accept(f.target.read(),f.params);if(h(T))return null;const I=Bt,it={target:f.target,initialValue:T.initialValue,params:T.params},xt=w.binding.reader(it),Zt=w.binding.constraint?w.binding.constraint(it):void 0,Te=nt(xt(T.initialValue),{constraint:Zt,equals:w.binding.equals}),He=new Xa({reader:xt,target:f.target,value:Te,writer:w.binding.writer(it)}),Nn=I.optional.boolean(f.params.disabled).value,In=I.optional.boolean(f.params.hidden).value,Ul=w.controller({constraint:Zt,document:f.document,initialValue:T.initialValue,params:T.params,value:He.value,viewProps:ne.create({disabled:Nn,hidden:In})});return new mn(f.document,{binding:He,blade:ae(),props:Q.fromObject({label:"label"in f.params?(x=I.optional.string(f.params.label).value)!==null&&x!==void 0?x:null:f.target.key}),valueController:Ul})}function n1(w,f){return f===0?new Xo:new kr(w,f??yu.monitor.defaultInterval)}function i1(w,f){var x,T,I;const it=Bt,xt=w.accept(f.target.read(),f.params);if(h(xt))return null;const Zt={target:f.target,initialValue:xt.initialValue,params:xt.params},Te=w.binding.reader(Zt),He=(T=(x=it.optional.number(f.params.bufferSize).value)!==null&&x!==void 0?x:w.binding.defaultBufferSize&&w.binding.defaultBufferSize(xt.params))!==null&&T!==void 0?T:1,Nn=it.optional.number(f.params.interval).value,In=new hc({reader:Te,target:f.target,ticker:n1(f.document,Nn),value:Sa(He)}),Ul=it.optional.boolean(f.params.disabled).value,Sc=it.optional.boolean(f.params.hidden).value,wu=w.controller({document:f.document,params:xt.params,value:In.value,viewProps:ne.create({disabled:Ul,hidden:Sc})});return new Jn(f.document,{binding:In,blade:ae(),props:Q.fromObject({label:"label"in f.params?(I=it.optional.string(f.params.label).value)!==null&&I!==void 0?I:null:f.target.key}),valueController:wu})}class B_{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(f){f.type==="blade"?this.pluginsMap_.blades.unshift(f):f.type==="input"?this.pluginsMap_.inputs.unshift(f):f.type==="monitor"&&this.pluginsMap_.monitors.unshift(f)}createInput(f,x,T){const I=x.read();if(h(I))throw new _({context:{key:x.key},type:"nomatchingcontroller"});const it=this.pluginsMap_.inputs.reduce((xt,Zt)=>xt??e1(Zt,{document:f,target:x,params:T}),null);if(it)return it;throw new _({context:{key:x.key},type:"nomatchingcontroller"})}createMonitor(f,x,T){const I=this.pluginsMap_.monitors.reduce((it,xt)=>it??i1(xt,{document:f,params:T,target:x}),null);if(I)return I;throw new _({context:{key:x.key},type:"nomatchingcontroller"})}createBlade(f,x){const T=this.pluginsMap_.blades.reduce((I,it)=>I??Ps(it,{document:f,params:x}),null);if(!T)throw new _({type:"nomatchingview",context:{params:x}});return T}createBladeApi(f){if(f instanceof mn)return new Wr(f);if(f instanceof Jn)return new jr(f);if(f instanceof Nt)return new As(f,this);const x=this.pluginsMap_.blades.reduce((T,I)=>T??I.api({controller:f,pool:this}),null);if(!x)throw _.shouldNeverHappen();return x}}function Em(){const w=new B_;return[q_,pp,xm,wc,zh,qw,Jo,Hw,Za,Jw,V_,Cm,oe,Re,Qn,ai].forEach(f=>{w.register(f)}),w}function r1(w){return Qo.isObject(w)?new Qo(w.x,w.y):new Qo}function Tm(w,f){w.writeProperty("x",f.x),w.writeProperty("y",f.y)}function ka(w,f){if(!w)return;const x=[],T=fm(w,f);T&&x.push(T);const I=O_(w);return I&&x.push(I),new Ma(x)}function H_(w,f){return new Il({assembly:D_,components:[ka("x"in w?w.x:void 0,f.x),ka("y"in w?w.y:void 0,f.y)]})}function Am(w,f){const[x,T]=w?Xw(w):[];if(!h(x)||!h(T))return Math.max(Math.abs(x??0),Math.abs(T??0));const I=Fi(w);return Math.max(Math.abs(I)*10,Math.abs(f)*10)}function mp(w,f){const x=f instanceof Il?f.components[0]:void 0,T=f instanceof Il?f.components[1]:void 0,I=Am(x,w.x),it=Am(T,w.y);return Math.max(I,it)}function $_(w,f){return{baseStep:Fi(f),constraint:f,textProps:Q.fromObject({draggingScale:Sn(f,w),formatter:nn(ir(f,w))})}}function G_(w){if(!("y"in w))return!1;const f=w.y;return f&&"inverted"in f?!!f.inverted:!1}const q_={id:"input-point2d",type:"input",accept:(w,f)=>{if(!Qo.isObject(w))return null;const x=Bt,T=Wt(f,{expanded:x.optional.boolean,picker:x.optional.custom(Oe),x:x.optional.custom(mi),y:x.optional.object({inverted:x.optional.boolean,max:x.optional.number,min:x.optional.number,step:x.optional.number})});return T?{initialValue:w,params:T}:null},binding:{reader:w=>r1,constraint:w=>H_(w.params,w.initialValue),equals:Qo.equals,writer:w=>Tm},controller:w=>{const f=w.document,x=w.value,T=w.constraint;if(!(T instanceof Il))throw _.shouldNeverHappen();const I="expanded"in w.params?w.params.expanded:void 0,it="picker"in w.params?w.params.picker:void 0;return new Kw(f,{axes:[$_(x.rawValue.x,T.components[0]),$_(x.rawValue.y,T.components[1])],expanded:I??!1,invertsY:G_(w.params),maxValue:mp(x.rawValue,T),parser:_r,pickerLayout:it??"popup",value:x,viewProps:w.viewProps})}};class W_ extends r{constructor(f){super(f),this.emitter_=new M,this.controller_.valueController.value.emitter.on("change",x=>{this.emitter_.emit("change",{event:new o(this,x.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get options(){return this.controller_.valueController.props.get("options")}set options(f){this.controller_.valueController.props.set("options",f)}get value(){return this.controller_.valueController.value.rawValue}set value(f){this.controller_.valueController.value.rawValue=f}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}}class Pm extends r{constructor(f){super(f),this.emitter_=new M,this.controller_.valueController.value.emitter.on("change",x=>{this.emitter_.emit("change",{event:new o(this,x.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(f){this.controller_.valueController.sliderController.props.set("maxValue",f)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(f){this.controller_.valueController.sliderController.props.set("minValue",f)}get value(){return this.controller_.valueController.value.rawValue}set value(f){this.controller_.valueController.value.rawValue=f}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}}class j_ extends r{constructor(f){super(f),this.emitter_=new M,this.controller_.valueController.value.emitter.on("change",x=>{this.emitter_.emit("change",{event:new o(this,x.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(f){this.controller_.props.set("label",f)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(f){this.controller_.valueController.props.set("formatter",f)}get value(){return this.controller_.valueController.value.rawValue}set value(f){this.controller_.valueController.value.rawValue=f}on(f,x){const T=x.bind(this);return this.emitter_.on(f,I=>{T(I.event)}),this}}const Rm=function(){return{id:"list",type:"blade",accept(w){const f=Bt,x=Wt(w,{options:f.required.custom(br),value:f.required.raw,view:f.required.constant("list"),label:f.optional.string});return x?{params:x}:null},controller(w){const f=new Yo(qe(w.params.options)),x=nt(w.params.value,{constraint:f}),T=new mo(w.document,{props:new Q({options:f.values.value("options")}),value:x,viewProps:w.viewProps});return new Me(w.document,{blade:w.blade,props:Q.fromObject({label:w.params.label}),valueController:T})},api(w){return!(w.controller instanceof Me)||!(w.controller.valueController instanceof mo)?null:new W_(w.controller)}}}();function X_(w){return w.reduce((f,x)=>Object.assign(f,{[x.presetKey]:x.read()}),{})}function km(w,f){w.forEach(x=>{const T=f[x.target.presetKey];T!==void 0&&x.writer(x.target,x.reader(T))})}class s1 extends Wo{constructor(f,x){super(f,x)}get element(){return this.controller_.view.element}importPreset(f){const x=this.controller_.rackController.rack.find(mn).map(T=>T.binding);km(x,f),this.refresh()}exportPreset(){const f=this.controller_.rackController.rack.find(mn).map(x=>x.binding.target);return X_(f)}refresh(){this.controller_.rackController.rack.find(mn).forEach(f=>{f.binding.read()}),this.controller_.rackController.rack.find(Jn).forEach(f=>{f.binding.read()})}}class Lm extends fe{constructor(f,x){super(f,{expanded:x.expanded,blade:x.blade,props:x.props,root:!0,viewProps:x.viewProps})}}const un={id:"slider",type:"blade",accept(w){const f=Bt,x=Wt(w,{max:f.required.number,min:f.required.number,view:f.required.constant("slider"),format:f.optional.function,label:f.optional.string,value:f.optional.number});return x?{params:x}:null},controller(w){var f,x;const T=(f=w.params.value)!==null&&f!==void 0?f:0,I=new as({max:w.params.max,min:w.params.min}),it=new Be(w.document,{baseStep:1,parser:_r,sliderProps:new Q({maxValue:I.values.value("max"),minValue:I.values.value("min")}),textProps:Q.fromObject({draggingScale:Sn(void 0,T),formatter:(x=w.params.format)!==null&&x!==void 0?x:_u}),value:nt(T,{constraint:I}),viewProps:w.viewProps});return new Me(w.document,{blade:w.blade,props:Q.fromObject({label:w.params.label}),valueController:it})},api(w){return!(w.controller instanceof Me)||!(w.controller.valueController instanceof Be)?null:new Pm(w.controller)}},o1=function(){return{id:"text",type:"blade",accept(w){const f=Bt,x=Wt(w,{parse:f.required.function,value:f.required.raw,view:f.required.constant("text"),format:f.optional.function,label:f.optional.string});return x?{params:x}:null},controller(w){var f;const x=new fu(w.document,{parser:w.params.parse,props:Q.fromObject({formatter:(f=w.params.format)!==null&&f!==void 0?f:T=>String(T)}),value:nt(w.params.value),viewProps:w.viewProps});return new Me(w.document,{blade:w.blade,props:Q.fromObject({label:w.params.label}),valueController:x})},api(w){return!(w.controller instanceof Me)||!(w.controller.valueController instanceof fu)?null:new j_(w.controller)}}}();function a1(w){const f=w.createElement("div");return f.classList.add(E("dfw")()),w.body&&w.body.appendChild(f),f}function xu(w,f,x){if(w.querySelector(`style[data-tp-style=${f}]`))return;const T=w.createElement("style");T.dataset.tpStyle=f,T.textContent=x,w.head.appendChild(T)}class Y_ extends s1{constructor(f){var x,T;const I=f??{},it=(x=I.document)!==null&&x!==void 0?x:st(),xt=Em(),Zt=new Lm(it,{expanded:I.expanded,blade:ae(),props:Q.fromObject({title:I.title}),viewProps:ne.create()});super(Zt,xt),this.pool_=xt,this.containerElem_=(T=I.container)!==null&&T!==void 0?T:a1(it),this.containerElem_.appendChild(this.element),this.doc_=it,this.usesDefaultWrapper_=!I.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw _.alreadyDisposed();return this.doc_}dispose(){const f=this.containerElem_;if(!f)throw _.alreadyDisposed();if(this.usesDefaultWrapper_){const x=f.parentElement;x&&x.removeChild(f)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(f){("plugin"in f?[f.plugin]:"plugins"in f?f.plugins:[]).forEach(T=>{this.pool_.register(T),this.embedPluginStyle_(T)})}embedPluginStyle_(f){f.css&&xu(this.document,`plugin-${f.id}`,f.css)}setUpDefaultPlugins_(){xu(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(f=>{this.embedPluginStyle_(f)}),this.registerPlugin({plugins:[un,Rm,ai,o1]})}}const l1=new n("3.1.10");e.BladeApi=r,e.ButtonApi=y,e.FolderApi=Wo,e.InputBindingApi=Wr,e.ListApi=W_,e.MonitorBindingApi=jr,e.Pane=Y_,e.SeparatorApi=ze,e.SliderApi=Pm,e.TabApi=js,e.TabPageApi=Ve,e.TextApi=j_,e.TpChangeEvent=o,e.VERSION=l1,Object.defineProperty(e,"__esModule",{value:!0})})})(CC,CC.exports);var ZU=CC.exports;const JU=zd(ZU),Ejt=ZC({__proto__:null,default:JU},[ZU]);var LS={},cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.BladeApi=void 0;var Tjt=function(){function i(t){this.controller_=t}return Object.defineProperty(i.prototype,"element",{get:function(){return this.controller_.view.element},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"disabled",{get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hidden",{get:function(){return this.controller_.viewProps.get("hidden")},set:function(t){this.controller_.viewProps.set("hidden",t)},enumerable:!1,configurable:!0}),i.prototype.dispose=function(){this.controller_.viewProps.set("disposed",!0)},i}();cc.BladeApi=Tjt;var QU={};Object.defineProperty(QU,"__esModule",{value:!0});var tF={};Object.defineProperty(tF,"__esModule",{value:!0});var _s={},Bx=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(_s,"__esModule",{value:!0});_s.TpTabSelectEvent=_s.TpFoldEvent=_s.TpUpdateEvent=_s.TpChangeEvent=_s.TpEvent=void 0;var zv=function(){function i(t){this.target=t}return i}();_s.TpEvent=zv;var Ajt=function(i){Bx(t,i);function t(e,n,r,s){var o=i.call(this,e)||this;return o.value=n,o.presetKey=r,o.last=s??!0,o}return t}(zv);_s.TpChangeEvent=Ajt;var Pjt=function(i){Bx(t,i);function t(e,n,r){var s=i.call(this,e)||this;return s.value=n,s.presetKey=r,s}return t}(zv);_s.TpUpdateEvent=Pjt;var Rjt=function(i){Bx(t,i);function t(e,n){var r=i.call(this,e)||this;return r.expanded=n,r}return t}(zv);_s.TpFoldEvent=Rjt;var kjt=function(i){Bx(t,i);function t(e,n){var r=i.call(this,e)||this;return r.index=n,r}return t}(zv);_s.TpTabSelectEvent=kjt;var Uv={},Go={},pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.isPropertyWritable=pn.deepEqualsArray=pn.isEmpty=pn.forceCast=void 0;function Ljt(i){return i}pn.forceCast=Ljt;function Ojt(i){return i==null}pn.isEmpty=Ojt;function Djt(i,t){if(i.length!==t.length)return!1;for(var e=0;e<i.length;e++)if(i[e]!==t[e])return!1;return!0}pn.deepEqualsArray=Djt;function Ijt(i,t){var e=i;do{var n=Object.getOwnPropertyDescriptor(e,t);if(n&&(n.set!==void 0||n.writable===!0))return!0;e=Object.getPrototypeOf(e)}while(e!==null);return!1}pn.isPropertyWritable=Ijt;Object.defineProperty(Go,"__esModule",{value:!0});Go.TpError=void 0;var Njt=pn,zjt={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(i){return"Invalid parameters for '".concat(i.name,"'")},nomatchingcontroller:function(i){return"No matching controller for '".concat(i.key,"'")},nomatchingview:function(i){return"No matching view for '".concat(JSON.stringify(i.params),"'")},notbindable:function(){return"Value is not bindable"},propertynotfound:function(i){return"Property '".concat(i.name,"' not found")},shouldneverhappen:function(){return"This error should never happen"}},Ujt=function(){function i(t){var e;this.message=(e=zjt[t.type]((0,Njt.forceCast)(t.context)))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}return i.alreadyDisposed=function(){return new i({type:"alreadydisposed"})},i.notBindable=function(){return new i({type:"notbindable"})},i.propertyNotFound=function(t){return new i({type:"propertynotfound",context:{name:t}})},i.shouldNeverHappen=function(){return new i({type:"shouldneverhappen"})},i}();Go.TpError=Ujt;Object.defineProperty(Uv,"__esModule",{value:!0});Uv.BindingTarget=void 0;var uL=Go,Fjt=function(){function i(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=n??e}return i.isBindable=function(t){return!(t===null||typeof t!="object"&&typeof t!="function")},Object.defineProperty(i.prototype,"key",{get:function(){return this.key_},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"presetKey",{get:function(){return this.presetKey_},enumerable:!1,configurable:!0}),i.prototype.read=function(){return this.obj_[this.key_]},i.prototype.write=function(t){this.obj_[this.key_]=t},i.prototype.writeProperty=function(t,e){var n=this.read();if(!i.isBindable(n))throw uL.TpError.notBindable();if(!(t in n))throw uL.TpError.propertyNotFound(t);n[t]=e},i}();Uv.BindingTarget=Fjt;var Fv={},Vjt=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Fv,"__esModule",{value:!0});Fv.ButtonApi=void 0;var Bjt=cc,Hjt=_s,$jt=function(i){Vjt(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(e){this.controller_.props.set("label",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){var e;return(e=this.controller_.valueController.props.get("title"))!==null&&e!==void 0?e:""},set:function(e){this.controller_.valueController.props.set("title",e)},enumerable:!1,configurable:!0}),t.prototype.on=function(e,n){var r=this,s=n.bind(this),o=this.controller_.valueController.emitter;return o.on(e,function(){s(new Hjt.TpEvent(r))}),this},t}(Bjt.BladeApi);Fv.ButtonApi=$jt;var Vv={},Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.Emitter=void 0;var Gjt=function(){function i(){this.observers_={}}return i.prototype.on=function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this},i.prototype.off=function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter(function(r){return r.handler!==e})),this},i.prototype.emit=function(t,e){var n=this.observers_[t];n&&n.forEach(function(r){r.handler(e)})},i}();Pr.Emitter=Gjt;var Bv={},Wn={};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.ClassName=void 0;var qjt="tp";function Wjt(i){var t=function(e,n){return[qjt,"-",i,"v",e?"_".concat(e):"",n?"-".concat(n):""].join("")};return t}Wn.ClassName=Wjt;var Vo={},ss={};Object.defineProperty(ss,"__esModule",{value:!0});ss.bindValueMap=ss.bindValue=void 0;function jjt(i,t){return function(e){return t(i(e))}}function Xjt(i){return i.rawValue}function eF(i,t){i.emitter.on("change",jjt(Xjt,t)),t(i.rawValue)}ss.bindValue=eF;function Yjt(i,t,e){eF(i.value(t),e)}ss.bindValueMap=Yjt;Object.defineProperty(Vo,"__esModule",{value:!0});Vo.bindValueToTextContent=Vo.valueToClassName=void 0;var Kjt=ss;function Zjt(i,t,e){e?i.classList.add(t):i.classList.remove(t)}function Jjt(i,t){return function(e){Zjt(i,t,e)}}Vo.valueToClassName=Jjt;function Qjt(i,t){(0,Kjt.bindValue)(i,function(e){t.textContent=e??""})}Vo.bindValueToTextContent=Qjt;Object.defineProperty(Bv,"__esModule",{value:!0});Bv.ButtonView=void 0;var t6t=Wn,e6t=Vo,OS=(0,t6t.ClassName)("btn"),n6t=function(){function i(t,e){this.element=t.createElement("div"),this.element.classList.add(OS()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("button");n.classList.add(OS("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;var r=t.createElement("div");r.classList.add(OS("t")),(0,e6t.bindValueToTextContent)(e.props.value("title"),r),this.buttonElement.appendChild(r)}return i}();Bv.ButtonView=n6t;Object.defineProperty(Vv,"__esModule",{value:!0});Vv.ButtonController=void 0;var i6t=Pr,r6t=Bv,s6t=function(){function i(t,e){this.emitter=new i6t.Emitter,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new r6t.ButtonView(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return i.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},i}();Vv.ButtonController=s6t;var Hv={},Pi={},Gs={},Hx={};Object.defineProperty(Hx,"__esModule",{value:!0});Hx.BoundValue=void 0;var o6t=Pr,a6t=function(){function i(t,e){var n;this.constraint_=e==null?void 0:e.constraint,this.equals_=(n=e==null?void 0:e.equals)!==null&&n!==void 0?n:function(r,s){return r===s},this.emitter=new o6t.Emitter,this.rawValue_=t}return Object.defineProperty(i.prototype,"constraint",{get:function(){return this.constraint_},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rawValue",{get:function(){return this.rawValue_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),i.prototype.setRawValue=function(t,e){var n=e??{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(t):t,s=this.rawValue_,o=!this.equals_(s,r);!o&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:n,previousRawValue:s,rawValue:r,sender:this}))},i}();Hx.BoundValue=a6t;var $x={};Object.defineProperty($x,"__esModule",{value:!0});$x.PrimitiveValue=void 0;var l6t=Pr,c6t=function(){function i(t){this.emitter=new l6t.Emitter,this.value_=t}return Object.defineProperty(i.prototype,"rawValue",{get:function(){return this.value_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),i.prototype.setRawValue=function(t,e){var n=e??{forceEmit:!1,last:!0},r=this.value_;r===t&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:this.value_,sender:this}))},i}();$x.PrimitiveValue=c6t;Object.defineProperty(Gs,"__esModule",{value:!0});Gs.createValue=void 0;var u6t=Hx,h6t=$x;function d6t(i,t){var e=t==null?void 0:t.constraint,n=t==null?void 0:t.equals;return!e&&!n?new h6t.PrimitiveValue(i):new u6t.BoundValue(i,t)}Gs.createValue=d6t;Object.defineProperty(Pi,"__esModule",{value:!0});Pi.ValueMap=void 0;var p6t=Pr,f6t=Gs,m6t=function(){function i(t){var e=this;this.emitter=new p6t.Emitter,this.valMap_=t;var n=function(o){var a=r.valMap_[o];a.emitter.on("change",function(){e.emitter.emit("change",{key:o,sender:e})})},r=this;for(var s in this.valMap_)n(s)}return i.createCore=function(t){var e=Object.keys(t);return e.reduce(function(n,r){var s;return Object.assign(n,(s={},s[r]=(0,f6t.createValue)(t[r]),s))},{})},i.fromObject=function(t){var e=this.createCore(t);return new i(e)},i.prototype.get=function(t){return this.valMap_[t].rawValue},i.prototype.set=function(t,e){this.valMap_[t].rawValue=e},i.prototype.value=function(t){return this.valMap_[t]},i}();Pi.ValueMap=m6t;var qr={};(function(i){var t=zt&&zt.__assign||function(){return t=Object.assign||function(u){for(var h,p=1,m=arguments.length;p<m;p++){h=arguments[p];for(var v in h)Object.prototype.hasOwnProperty.call(h,v)&&(u[v]=h[v])}return u},t.apply(this,arguments)},e=zt&&zt.__spreadArray||function(u,h,p){if(p||arguments.length===2)for(var m=0,v=h.length,_;m<v;m++)(_||!(m in h))&&(_||(_=Array.prototype.slice.call(h,0,m)),_[m]=h[m]);return u.concat(_||Array.prototype.slice.call(h))};Object.defineProperty(i,"__esModule",{value:!0}),i.parseParams=i.ParamsParsers=void 0;var n=pn;function r(u,h){var p=Object.keys(h),m=p.reduce(function(v,_){var b;if(v!==void 0){var y=h[_],M=y(u[_]);return M.succeeded?t(t({},v),(b={},b[_]=M.value,b)):void 0}},{});return(0,n.forceCast)(m)}function s(u,h){return u.reduce(function(p,m){if(p!==void 0){var v=h(m);if(!(!v.succeeded||v.value===void 0))return e(e([],p,!0),[v.value],!1)}},[])}function o(u){return u===null?!1:typeof u=="object"}function a(u){return function(h){return function(p){if(!h&&p===void 0)return{succeeded:!1,value:void 0};if(h&&p===void 0)return{succeeded:!0,value:void 0};var m=u(p);return m!==void 0?{succeeded:!0,value:m}:{succeeded:!1,value:void 0}}}}function l(u){return{custom:function(h){return a(h)(u)},boolean:a(function(h){return typeof h=="boolean"?h:void 0})(u),number:a(function(h){return typeof h=="number"?h:void 0})(u),string:a(function(h){return typeof h=="string"?h:void 0})(u),function:a(function(h){return typeof h=="function"?h:void 0})(u),constant:function(h){return a(function(p){return p===h?h:void 0})(u)},raw:a(function(h){return h})(u),object:function(h){return a(function(p){if(o(p))return r(p,h)})(u)},array:function(h){return a(function(p){if(Array.isArray(p))return s(p,h)})(u)}}}i.ParamsParsers={optional:l(!0),required:l(!1)};function c(u,h){var p=i.ParamsParsers.required.object(h)(u);return p.succeeded?p.value:void 0}i.parseParams=c})(qr);var Kd={},su={},sh={};Object.defineProperty(sh,"__esModule",{value:!0});sh.warnMissing=sh.warnDeprecation=void 0;function g6t(i){var t;console.warn(["".concat(i.name," is deprecated."),i.alternative?"use ".concat(i.alternative," instead."):"",(t=i.postscript)!==null&&t!==void 0?t:""].join(" "))}sh.warnDeprecation=g6t;function v6t(i){console.warn(["Missing '".concat(i.key,"' of ").concat(i.target," in ").concat(i.place,"."),"Please rebuild plugins with the latest core package."].join(" "))}sh.warnMissing=v6t;var Gx={};Object.defineProperty(Gx,"__esModule",{value:!0});Gx.disposeElement=void 0;function _6t(i){return i&&i.parentElement&&i.parentElement.removeChild(i),null}Gx.disposeElement=_6t;var ou={},qx={};Object.defineProperty(qx,"__esModule",{value:!0});qx.ReadonlyValue=void 0;var b6t=function(){function i(t){this.value_=t}return i.create=function(t){return[new i(t),function(e,n){t.setRawValue(e,n)}]},Object.defineProperty(i.prototype,"emitter",{get:function(){return this.value_.emitter},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rawValue",{get:function(){return this.value_.rawValue},enumerable:!1,configurable:!0}),i}();qx.ReadonlyValue=b6t;var y6t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ou,"__esModule",{value:!0});ou.ViewProps=void 0;var x6t=Wn,w6t=Vo,cb=ss,S6t=qx,hL=Pi,M6t=Gs,C6t=(0,x6t.ClassName)("");function dL(i,t){return(0,w6t.valueToClassName)(i,C6t(void 0,t))}var E6t=function(i){y6t(t,i);function t(e){var n,r=this,s;return r=i.call(this,e)||this,r.onDisabledChange_=r.onDisabledChange_.bind(r),r.onParentChange_=r.onParentChange_.bind(r),r.onParentGlobalDisabledChange_=r.onParentGlobalDisabledChange_.bind(r),n=S6t.ReadonlyValue.create((0,M6t.createValue)(r.getGlobalDisabled_())),r.globalDisabled_=n[0],r.setGlobalDisabled_=n[1],r.value("disabled").emitter.on("change",r.onDisabledChange_),r.value("parent").emitter.on("change",r.onParentChange_),(s=r.get("parent"))===null||s===void 0||s.globalDisabled.emitter.on("change",r.onParentGlobalDisabledChange_),r}return t.create=function(e){var n,r,s,o=e??{};return new t(hL.ValueMap.createCore({disabled:(n=o.disabled)!==null&&n!==void 0?n:!1,disposed:!1,hidden:(r=o.hidden)!==null&&r!==void 0?r:!1,parent:(s=o.parent)!==null&&s!==void 0?s:null}))},Object.defineProperty(t.prototype,"globalDisabled",{get:function(){return this.globalDisabled_},enumerable:!1,configurable:!0}),t.prototype.bindClassModifiers=function(e){(0,cb.bindValue)(this.globalDisabled_,dL(e,"disabled")),(0,cb.bindValueMap)(this,"hidden",dL(e,"hidden"))},t.prototype.bindDisabled=function(e){(0,cb.bindValue)(this.globalDisabled_,function(n){e.disabled=n})},t.prototype.bindTabIndex=function(e){(0,cb.bindValue)(this.globalDisabled_,function(n){e.tabIndex=n?-1:0})},t.prototype.handleDispose=function(e){this.value("disposed").emitter.on("change",function(n){n&&e()})},t.prototype.getGlobalDisabled_=function(){var e=this.get("parent"),n=e?e.globalDisabled.rawValue:!1;return n||this.get("disabled")},t.prototype.updateGlobalDisabled_=function(){this.setGlobalDisabled_(this.getGlobalDisabled_())},t.prototype.onDisabledChange_=function(){this.updateGlobalDisabled_()},t.prototype.onParentGlobalDisabledChange_=function(){this.updateGlobalDisabled_()},t.prototype.onParentChange_=function(e){var n,r=e.previousRawValue;r==null||r.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(n=this.get("parent"))===null||n===void 0||n.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()},t}(hL.ValueMap);ou.ViewProps=E6t;var $v={};Object.defineProperty($v,"__esModule",{value:!0});$v.getAllBladePositions=void 0;function T6t(){return["veryfirst","first","last","verylast"]}$v.getAllBladePositions=T6t;Object.defineProperty(su,"__esModule",{value:!0});su.BladeController=void 0;var A6t=sh,P6t=Gx,R6t=ou,k6t=Wn,L6t=$v,pL=(0,k6t.ClassName)(""),fL={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},O6t=function(){function i(t){var e=this;this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;var n=this.view.element;this.blade.value("positions").emitter.on("change",function(){(0,L6t.getAllBladePositions)().forEach(function(r){n.classList.remove(pL(void 0,fL[r]))}),e.blade.get("positions").forEach(function(r){n.classList.add(pL(void 0,fL[r]))})}),this.viewProps.handleDispose(function(){(0,P6t.disposeElement)(n)})}return Object.defineProperty(i.prototype,"parent",{get:function(){return this.parent_},set:function(t){if(this.parent_=t,!("parent"in this.viewProps.valMap_)){(0,A6t.warnMissing)({key:"parent",target:R6t.ViewProps.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)},enumerable:!1,configurable:!0}),i}();su.BladeController=O6t;var tm={},Ts={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.findNextTarget=i.indexOfChildElement=i.removeChildNodes=i.removeChildElements=i.removeElement=i.insertElementAt=i.createSvgIconElement=i.getCanvasContext=i.getWindowDocument=i.supportsTouch=i.disableTransitionTemporarily=i.forceReflow=i.SVG_NS=void 0;var t=pn;i.SVG_NS="http://www.w3.org/2000/svg";function e(b){b.offsetHeight}i.forceReflow=e;function n(b,y){var M=b.style.transition;b.style.transition="none",y(),b.style.transition=M}i.disableTransitionTemporarily=n;function r(b){return b.ontouchstart!==void 0}i.supportsTouch=r;function s(){return globalThis}function o(){var b=(0,t.forceCast)(s());return b.document}i.getWindowDocument=o;function a(b){var y=b.ownerDocument.defaultView;if(!y)return null;var M="document"in y;return M?b.getContext("2d",{willReadFrequently:!0}):null}i.getCanvasContext=a;var l={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function c(b,y){var M=b.createElementNS(i.SVG_NS,"svg");return M.innerHTML=l[y],M}i.createSvgIconElement=c;function u(b,y,M){b.insertBefore(y,b.children[M])}i.insertElementAt=u;function h(b){b.parentElement&&b.parentElement.removeChild(b)}i.removeElement=h;function p(b){for(;b.children.length>0;)b.removeChild(b.children[0])}i.removeChildElements=p;function m(b){for(;b.childNodes.length>0;)b.removeChild(b.childNodes[0])}i.removeChildNodes=m;function v(b){var y=b.parentElement;if(!y)return-1;var M=Array.prototype.slice.call(y.children);return M.indexOf(b)}i.indexOfChildElement=v;function _(b){return b.relatedTarget?(0,t.forceCast)(b.relatedTarget):"explicitOriginalTarget"in b?b.explicitOriginalTarget:null}i.findNextTarget=_})(Ts);Object.defineProperty(tm,"__esModule",{value:!0});tm.LabelView=void 0;var D6t=Ts,I6t=ss,N6t=Wn,z6t=pn,Qm=(0,N6t.ClassName)("lbl");function U6t(i,t){var e=i.createDocumentFragment(),n=t.split(`
`).map(function(r){return i.createTextNode(r)});return n.forEach(function(r,s){s>0&&e.appendChild(i.createElement("br")),e.appendChild(r)}),e}var F6t=function(){function i(t,e){var n=this;this.element=t.createElement("div"),this.element.classList.add(Qm()),e.viewProps.bindClassModifiers(this.element);var r=t.createElement("div");r.classList.add(Qm("l")),(0,I6t.bindValueMap)(e.props,"label",function(o){(0,z6t.isEmpty)(o)?n.element.classList.add(Qm(void 0,"nol")):(n.element.classList.remove(Qm(void 0,"nol")),(0,D6t.removeChildNodes)(r),r.appendChild(U6t(t,o)))}),this.element.appendChild(r),this.labelElement=r;var s=t.createElement("div");s.classList.add(Qm("v")),this.element.appendChild(s),this.valueElement=s}return i}();tm.LabelView=F6t;var V6t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),dy=zt&&zt.__assign||function(){return dy=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},dy.apply(this,arguments)};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.LabelController=void 0;var B6t=su,H6t=tm,$6t=function(i){V6t(t,i);function t(e,n){var r=this,s=n.valueController.viewProps;return r=i.call(this,dy(dy({},n),{view:new H6t.LabelView(e,{props:n.props,viewProps:s}),viewProps:s}))||this,r.props=n.props,r.valueController=n.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return t}(B6t.BladeController);Kd.LabelController=$6t;Object.defineProperty(Hv,"__esModule",{value:!0});Hv.ButtonBladePlugin=void 0;var mL=Pi,gL=qr,vL=Kd,G6t=Fv,_L=Vv;Hv.ButtonBladePlugin={id:"button",type:"blade",accept:function(i){var t=gL.ParamsParsers,e=(0,gL.parseParams)(i,{title:t.required.string,view:t.required.constant("button"),label:t.optional.string});return e?{params:e}:null},controller:function(i){return new vL.LabelController(i.document,{blade:i.blade,props:mL.ValueMap.fromObject({label:i.params.label}),valueController:new _L.ButtonController(i.document,{props:mL.ValueMap.fromObject({title:i.params.title}),viewProps:i.viewProps})})},api:function(i){return!(i.controller instanceof vL.LabelController)||!(i.controller.valueController instanceof _L.ButtonController)?null:new G6t.ButtonApi(i.controller)}};var Zd={},q6t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Zd,"__esModule",{value:!0});Zd.ValueBladeController=void 0;var W6t=su,j6t=function(i){q6t(t,i);function t(e){var n=i.call(this,e)||this;return n.value=e.value,n}return t}(W6t.BladeController);Zd.ValueBladeController=j6t;var yh={};Object.defineProperty(yh,"__esModule",{value:!0});yh.createBlade=void 0;var X6t=Pi,Y6t=Gs,K6t=pn;function Z6t(){return new X6t.ValueMap({positions:(0,Y6t.createValue)([],{equals:K6t.deepEqualsArray})})}yh.createBlade=Z6t;var oo={},J6t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(oo,"__esModule",{value:!0});oo.bindFoldable=oo.getFoldableStyleHeight=oo.getFoldableStyleExpanded=oo.createFoldable=oo.Foldable=void 0;var Bb=Ts,bL=ss,yL=Pi,nF=pn,iF=function(i){J6t(t,i);function t(e){return i.call(this,e)||this}return t.create=function(e){var n={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},r=yL.ValueMap.createCore(n);return new t(r)},Object.defineProperty(t.prototype,"styleExpanded",{get:function(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"styleHeight",{get:function(){if(!this.styleExpanded)return"0";var e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!(0,nF.isEmpty)(e)?"".concat(e,"px"):"auto"},enumerable:!1,configurable:!0}),t.prototype.bindExpandedClass=function(e,n){var r=this,s=function(){var o=r.styleExpanded;o?e.classList.add(n):e.classList.remove(n)};(0,bL.bindValueMap)(this,"expanded",s),(0,bL.bindValueMap)(this,"temporaryExpanded",s)},t.prototype.cleanUpTransition=function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)},t}(yL.ValueMap);oo.Foldable=iF;function Q6t(i){return iF.create(i)}oo.createFoldable=Q6t;function t8t(i,t){var e=0;return(0,Bb.disableTransitionTemporarily)(t,function(){i.set("expandedHeight",null),i.set("temporaryExpanded",!0),(0,Bb.forceReflow)(t),e=t.clientHeight,i.set("temporaryExpanded",null),(0,Bb.forceReflow)(t)}),e}function e8t(i){return i.styleExpanded}oo.getFoldableStyleExpanded=e8t;function n8t(i){return i.styleHeight}oo.getFoldableStyleHeight=n8t;function xL(i,t){t.style.height=i.styleHeight}function i8t(i,t){i.value("expanded").emitter.on("beforechange",function(){if(i.set("completed",!1),(0,nF.isEmpty)(i.get("expandedHeight"))){var e=t8t(i,t);e>0&&i.set("expandedHeight",e)}i.set("shouldFixHeight",!0),(0,Bb.forceReflow)(t)}),i.emitter.on("change",function(){xL(i,t)}),xL(i,t),t.addEventListener("transitionend",function(e){e.propertyName==="height"&&i.cleanUpTransition()})}oo.bindFoldable=i8t;var Gv={},em={},r8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(em,"__esModule",{value:!0});em.RackLikeApi=void 0;var s8t=cc,o8t=function(i){r8t(t,i);function t(e,n){var r=i.call(this,e)||this;return r.rackApi_=n,r}return t}(s8t.BladeApi);em.RackLikeApi=o8t;var oh={},jl={},ic=zt&&zt.__assign||function(){return ic=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},ic.apply(this,arguments)};Object.defineProperty(jl,"__esModule",{value:!0});jl.addTabAsBlade=jl.addSeparatorAsBlade=jl.addFolderAsBlade=jl.addButtonAsBlade=void 0;function a8t(i,t){return i.addBlade(ic(ic({},t),{view:"button"}))}jl.addButtonAsBlade=a8t;function l8t(i,t){return i.addBlade(ic(ic({},t),{view:"folder"}))}jl.addFolderAsBlade=l8t;function c8t(i,t){var e=t??{};return i.addBlade(ic(ic({},e),{view:"separator"}))}jl.addSeparatorAsBlade=c8t;function u8t(i,t){return i.addBlade(ic(ic({},t),{view:"tab"}))}jl.addTabAsBlade=u8t;var nm={};Object.defineProperty(nm,"__esModule",{value:!0});nm.NestedOrderedSet=void 0;var h8t=Pr,d8t=Go,p8t=function(){function i(t){this.emitter=new h8t.Emitter,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}return Object.defineProperty(i.prototype,"items",{get:function(){return this.items_},enumerable:!1,configurable:!0}),i.prototype.allItems=function(){return Array.from(this.cache_)},i.prototype.find=function(t){for(var e=0,n=this.allItems();e<n.length;e++){var r=n[e];if(t(r))return r}return null},i.prototype.includes=function(t){return this.cache_.has(t)},i.prototype.add=function(t,e){var n=this;if(this.includes(t))throw d8t.TpError.shouldNeverHappen();var r=e!==void 0?e:this.items_.length;this.items_.splice(r,0,t),this.cache_.add(t);var s=this.extract_(t);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(function(o){n.cache_.add(o)})),this.emitter.emit("add",{index:r,item:t,root:this,target:this})},i.prototype.remove=function(t){var e=this.items_.indexOf(t);if(!(e<0)){this.items_.splice(e,1),this.cache_.delete(t);var n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}},i.prototype.onSubListAdd_=function(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})},i.prototype.onSubListRemove_=function(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})},i}();nm.NestedOrderedSet=p8t;var im={},f8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(im,"__esModule",{value:!0});im.InputBindingApi=void 0;var m8t=Pr,g8t=pn,v8t=cc,_8t=_s,b8t=function(i){f8t(t,i);function t(e){var n=i.call(this,e)||this;return n.onBindingChange_=n.onBindingChange_.bind(n),n.emitter_=new m8t.Emitter,n.controller_.binding.emitter.on("change",n.onBindingChange_),n}return Object.defineProperty(t.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(e){this.controller_.props.set("label",e)},enumerable:!1,configurable:!0}),t.prototype.on=function(e,n){var r=n.bind(this);return this.emitter_.on(e,function(s){r(s.event)}),this},t.prototype.refresh=function(){this.controller_.binding.read()},t.prototype.onBindingChange_=function(e){var n=e.sender.target.read();this.emitter_.emit("change",{event:new _8t.TpChangeEvent(this,(0,g8t.forceCast)(n),this.controller_.binding.target.presetKey,e.options.last)})},t}(v8t.BladeApi);im.InputBindingApi=b8t;var xh={},y8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(xh,"__esModule",{value:!0});xh.InputBindingController=void 0;var x8t=Kd,w8t=function(i){y8t(t,i);function t(e,n){var r=i.call(this,e,n)||this;return r.binding=n.binding,r}return t}(x8t.LabelController);xh.InputBindingController=w8t;var rm={},S8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(rm,"__esModule",{value:!0});rm.MonitorBindingApi=void 0;var M8t=Pr,C8t=pn,E8t=cc,T8t=_s,A8t=function(i){S8t(t,i);function t(e){var n=i.call(this,e)||this;return n.onBindingUpdate_=n.onBindingUpdate_.bind(n),n.emitter_=new M8t.Emitter,n.controller_.binding.emitter.on("update",n.onBindingUpdate_),n}return Object.defineProperty(t.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(e){this.controller_.props.set("label",e)},enumerable:!1,configurable:!0}),t.prototype.on=function(e,n){var r=n.bind(this);return this.emitter_.on(e,function(s){r(s.event)}),this},t.prototype.refresh=function(){this.controller_.binding.read()},t.prototype.onBindingUpdate_=function(e){var n=e.sender.target.read();this.emitter_.emit("update",{event:new T8t.TpUpdateEvent(this,(0,C8t.forceCast)(n),this.controller_.binding.target.presetKey)})},t}(E8t.BladeApi);rm.MonitorBindingApi=A8t;var wh={},P8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(wh,"__esModule",{value:!0});wh.MonitorBindingController=void 0;var R8t=Kd,k8t=function(i){P8t(t,i);function t(e,n){var r=i.call(this,e,n)||this;return r.binding=n.binding,r.viewProps.bindDisabled(r.binding.ticker),r.viewProps.handleDispose(function(){r.binding.dispose()}),r}return t}(R8t.LabelController);wh.MonitorBindingController=k8t;var L8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(oh,"__esModule",{value:!0});oh.RackApi=oh.findSubBladeApiSet=void 0;var wL=Uv,O8t=Pr,iA=Go,DS=pn,D8t=cc,ub=jl,I8t=em,IS=_s,N8t=Zd,z8t=nm,U8t=im,F8t=xh,V8t=rm,B8t=wh;function rF(i){return i instanceof sF?i.apiSet_:i instanceof I8t.RackLikeApi?i.rackApi_.apiSet_:null}oh.findSubBladeApiSet=rF;function tg(i,t){var e=i.find(function(n){return n.controller_===t});if(!e)throw iA.TpError.shouldNeverHappen();return e}function SL(i,t,e){if(!wL.BindingTarget.isBindable(i))throw iA.TpError.notBindable();return new wL.BindingTarget(i,t,e)}var sF=function(i){L8t(t,i);function t(e,n){var r=i.call(this,e)||this;r.onRackAdd_=r.onRackAdd_.bind(r),r.onRackRemove_=r.onRackRemove_.bind(r),r.onRackInputChange_=r.onRackInputChange_.bind(r),r.onRackMonitorUpdate_=r.onRackMonitorUpdate_.bind(r),r.emitter_=new O8t.Emitter,r.apiSet_=new z8t.NestedOrderedSet(rF),r.pool_=n;var s=r.controller_.rack;return s.emitter.on("add",r.onRackAdd_),s.emitter.on("remove",r.onRackRemove_),s.emitter.on("inputchange",r.onRackInputChange_),s.emitter.on("monitorupdate",r.onRackMonitorUpdate_),s.children.forEach(function(o){r.setUpApi_(o)}),r}return Object.defineProperty(t.prototype,"children",{get:function(){var e=this;return this.controller_.rack.children.map(function(n){return tg(e.apiSet_,n)})},enumerable:!1,configurable:!0}),t.prototype.addInput=function(e,n,r){var s=r??{},o=this.controller_.view.element.ownerDocument,a=this.pool_.createInput(o,SL(e,n,s.presetKey),s),l=new U8t.InputBindingApi(a);return this.add(l,s.index)},t.prototype.addMonitor=function(e,n,r){var s=r??{},o=this.controller_.view.element.ownerDocument,a=this.pool_.createMonitor(o,SL(e,n),s),l=new V8t.MonitorBindingApi(a);return(0,DS.forceCast)(this.add(l,s.index))},t.prototype.addFolder=function(e){return(0,ub.addFolderAsBlade)(this,e)},t.prototype.addButton=function(e){return(0,ub.addButtonAsBlade)(this,e)},t.prototype.addSeparator=function(e){return(0,ub.addSeparatorAsBlade)(this,e)},t.prototype.addTab=function(e){return(0,ub.addTabAsBlade)(this,e)},t.prototype.add=function(e,n){this.controller_.rack.add(e.controller_,n);var r=this.apiSet_.find(function(s){return s.controller_===e.controller_});return r&&this.apiSet_.remove(r),this.apiSet_.add(e),e},t.prototype.remove=function(e){this.controller_.rack.remove(e.controller_)},t.prototype.addBlade=function(e){var n=this.controller_.view.element.ownerDocument,r=this.pool_.createBlade(n,e),s=this.pool_.createBladeApi(r);return this.add(s,e.index)},t.prototype.on=function(e,n){var r=n.bind(this);return this.emitter_.on(e,function(s){r(s.event)}),this},t.prototype.setUpApi_=function(e){var n=this.apiSet_.find(function(r){return r.controller_===e});n||this.apiSet_.add(this.pool_.createBladeApi(e))},t.prototype.onRackAdd_=function(e){this.setUpApi_(e.bladeController)},t.prototype.onRackRemove_=function(e){if(e.isRoot){var n=tg(this.apiSet_,e.bladeController);this.apiSet_.remove(n)}},t.prototype.onRackInputChange_=function(e){var n=e.bladeController;if(n instanceof F8t.InputBindingController){var r=tg(this.apiSet_,n),s=n.binding;this.emitter_.emit("change",{event:new IS.TpChangeEvent(r,(0,DS.forceCast)(s.target.read()),s.target.presetKey,e.options.last)})}else if(n instanceof N8t.ValueBladeController){var r=tg(this.apiSet_,n);this.emitter_.emit("change",{event:new IS.TpChangeEvent(r,n.value.rawValue,void 0,e.options.last)})}},t.prototype.onRackMonitorUpdate_=function(e){if(!(e.bladeController instanceof B8t.MonitorBindingController))throw iA.TpError.shouldNeverHappen();var n=tg(this.apiSet_,e.bladeController),r=e.bladeController.binding;this.emitter_.emit("update",{event:new IS.TpUpdateEvent(n,(0,DS.forceCast)(r.target.read()),r.target.presetKey)})},t}(D8t.BladeApi);oh.RackApi=sF;var H8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Gv,"__esModule",{value:!0});Gv.FolderApi=void 0;var $8t=Pr,G8t=em,q8t=_s,W8t=oh,j8t=function(i){H8t(t,i);function t(e,n){var r=i.call(this,e,new W8t.RackApi(e.rackController,n))||this;return r.emitter_=new $8t.Emitter,r.controller_.foldable.value("expanded").emitter.on("change",function(s){r.emitter_.emit("fold",{event:new q8t.TpFoldEvent(r,s.sender.rawValue)})}),r.rackApi_.on("change",function(s){r.emitter_.emit("change",{event:s})}),r.rackApi_.on("update",function(s){r.emitter_.emit("update",{event:s})}),r}return Object.defineProperty(t.prototype,"expanded",{get:function(){return this.controller_.foldable.get("expanded")},set:function(e){this.controller_.foldable.set("expanded",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.controller_.props.get("title")},set:function(e){this.controller_.props.set("title",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),t.prototype.addInput=function(e,n,r){return this.rackApi_.addInput(e,n,r)},t.prototype.addMonitor=function(e,n,r){return this.rackApi_.addMonitor(e,n,r)},t.prototype.addFolder=function(e){return this.rackApi_.addFolder(e)},t.prototype.addButton=function(e){return this.rackApi_.addButton(e)},t.prototype.addSeparator=function(e){return this.rackApi_.addSeparator(e)},t.prototype.addTab=function(e){return this.rackApi_.addTab(e)},t.prototype.add=function(e,n){return this.rackApi_.add(e,n)},t.prototype.remove=function(e){this.rackApi_.remove(e)},t.prototype.addBlade=function(e){return this.rackApi_.addBlade(e)},t.prototype.on=function(e,n){var r=n.bind(this);return this.emitter_.on(e,function(s){r(s.event)}),this},t}(G8t.RackLikeApi);Gv.FolderApi=j8t;var qv={},sm={},X8t=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(sm,"__esModule",{value:!0});sm.RackLikeController=void 0;var Y8t=su,K8t=function(i){X8t(t,i);function t(e){var n=i.call(this,{blade:e.blade,view:e.view,viewProps:e.rackController.viewProps})||this;return n.rackController=e.rackController,n}return t}(Y8t.BladeController);sm.RackLikeController=K8t;var eg={},Wv={};Object.defineProperty(Wv,"__esModule",{value:!0});Wv.PlainView=void 0;var Z8t=Wn,J8t=function(){function i(t,e){var n=(0,Z8t.ClassName)(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}return i}();Wv.PlainView=J8t;var ng={},ML;function Q8t(){if(ML)return ng;ML=1,Object.defineProperty(ng,"__esModule",{value:!0}),ng.BladeRack=void 0;var i=sh,t=Pr,e=Go,n=pn,r=xh,s=wh,o=jv(),a=sm,l=Zd,c=nm;function u(b,y){for(var M=0;M<b.length;M++){var S=b[M];if(S instanceof r.InputBindingController&&S.binding===y)return S}return null}function h(b,y){for(var M=0;M<b.length;M++){var S=b[M];if(S instanceof s.MonitorBindingController&&S.binding===y)return S}return null}function p(b,y){for(var M=0;M<b.length;M++){var S=b[M];if(S instanceof l.ValueBladeController&&S.value===y)return S}return null}function m(b){return b instanceof o.RackController?b.rack:b instanceof a.RackLikeController?b.rackController.rack:null}function v(b){var y=m(b);return y?y.bcSet_:null}var _=function(){function b(y){var M,S;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new t.Emitter,this.blade_=(M=y.blade)!==null&&M!==void 0?M:null,(S=this.blade_)===null||S===void 0||S.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=y.viewProps,this.bcSet_=new c.NestedOrderedSet(v),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return Object.defineProperty(b.prototype,"children",{get:function(){return this.bcSet_.items},enumerable:!1,configurable:!0}),b.prototype.add=function(y,M){var S;(S=y.parent)===null||S===void 0||S.remove(y),(0,n.isPropertyWritable)(y,"parent")?y.parent=this:(y.parent_=this,(0,i.warnMissing)({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(y,M)},b.prototype.remove=function(y){(0,n.isPropertyWritable)(y,"parent")?y.parent=null:(y.parent_=null,(0,i.warnMissing)({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(y)},b.prototype.find=function(y){return(0,n.forceCast)(this.bcSet_.allItems().filter(function(M){return M instanceof y}))},b.prototype.onSetAdd_=function(y){this.updatePositions_();var M=y.target===y.root;if(this.emitter.emit("add",{bladeController:y.item,index:y.index,isRoot:M,sender:this}),!!M){var S=y.item;if(S.viewProps.emitter.on("change",this.onChildViewPropsChange_),S.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),S.viewProps.handleDispose(this.onChildDispose_),S instanceof r.InputBindingController)S.binding.emitter.on("change",this.onChildInputChange_);else if(S instanceof s.MonitorBindingController)S.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(S instanceof l.ValueBladeController)S.value.emitter.on("change",this.onChildValueChange_);else{var E=m(S);if(E){var A=E.emitter;A.on("layout",this.onDescendantLayout_),A.on("inputchange",this.onDescendantInputChange_),A.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}},b.prototype.onSetRemove_=function(y){this.updatePositions_();var M=y.target===y.root;if(this.emitter.emit("remove",{bladeController:y.item,isRoot:M,sender:this}),!!M){var S=y.item;if(S instanceof r.InputBindingController)S.binding.emitter.off("change",this.onChildInputChange_);else if(S instanceof s.MonitorBindingController)S.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(S instanceof l.ValueBladeController)S.value.emitter.off("change",this.onChildValueChange_);else{var E=m(S);if(E){var A=E.emitter;A.off("layout",this.onDescendantLayout_),A.off("inputchange",this.onDescendantInputChange_),A.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}},b.prototype.updatePositions_=function(){var y=this,M=this.bcSet_.items.filter(function(A){return!A.viewProps.get("hidden")}),S=M[0],E=M[M.length-1];this.bcSet_.items.forEach(function(A){var R=[];A===S&&(R.push("first"),(!y.blade_||y.blade_.get("positions").includes("veryfirst"))&&R.push("veryfirst")),A===E&&(R.push("last"),(!y.blade_||y.blade_.get("positions").includes("verylast"))&&R.push("verylast")),A.blade.set("positions",R)})},b.prototype.onChildPositionsChange_=function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},b.prototype.onChildViewPropsChange_=function(y){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},b.prototype.onChildDispose_=function(){var y=this,M=this.bcSet_.items.filter(function(S){return S.viewProps.get("disposed")});M.forEach(function(S){y.bcSet_.remove(S)})},b.prototype.onChildInputChange_=function(y){var M=u(this.find(r.InputBindingController),y.sender);if(!M)throw e.TpError.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:M,options:y.options,sender:this})},b.prototype.onChildMonitorUpdate_=function(y){var M=h(this.find(s.MonitorBindingController),y.sender);if(!M)throw e.TpError.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:M,sender:this})},b.prototype.onChildValueChange_=function(y){var M=p(this.find(l.ValueBladeController),y.sender);if(!M)throw e.TpError.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:M,options:y.options,sender:this})},b.prototype.onDescendantLayout_=function(y){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},b.prototype.onDescendantInputChange_=function(y){this.emitter.emit("inputchange",{bladeController:y.bladeController,options:y.options,sender:this})},b.prototype.onDescendantMonitorUpdate_=function(y){this.emitter.emit("monitorupdate",{bladeController:y.bladeController,sender:this})},b.prototype.onBladePositionsChange_=function(){this.updatePositions_()},b}();return ng.BladeRack=_,ng}var CL;function jv(){if(CL)return eg;CL=1;var i=zt&&zt.__extends||function(){var a=function(l,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&(u[p]=h[p])},a(l,c)};return function(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(l,c);function u(){this.constructor=l}l.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}}(),t=zt&&zt.__assign||function(){return t=Object.assign||function(a){for(var l,c=1,u=arguments.length;c<u;c++){l=arguments[c];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(a[h]=l[h])}return a},t.apply(this,arguments)};Object.defineProperty(eg,"__esModule",{value:!0}),eg.RackController=void 0;var e=Ts,n=Wv,r=su,s=Q8t(),o=function(a){i(l,a);function l(c,u){var h=a.call(this,t(t({},u),{view:new n.PlainView(c,{viewName:"brk",viewProps:u.viewProps})}))||this;h.onRackAdd_=h.onRackAdd_.bind(h),h.onRackRemove_=h.onRackRemove_.bind(h);var p=new s.BladeRack({blade:u.root?void 0:u.blade,viewProps:u.viewProps});return p.emitter.on("add",h.onRackAdd_),p.emitter.on("remove",h.onRackRemove_),h.rack=p,h.viewProps.handleDispose(function(){for(var m=h.rack.children.length-1;m>=0;m--){var v=h.rack.children[m];v.viewProps.set("disposed",!0)}}),h}return l.prototype.onRackAdd_=function(c){c.isRoot&&(0,e.insertElementAt)(this.view.element,c.bladeController.view.element,c.index)},l.prototype.onRackRemove_=function(c){c.isRoot&&(0,e.removeElement)(c.bladeController.view.element)},l}(r.BladeController);return eg.RackController=o,eg}var Xv={},Yv={};Object.defineProperty(Yv,"__esModule",{value:!0});Yv.bladeContainerClassName=void 0;var tXt=Wn;Yv.bladeContainerClassName=(0,tXt.ClassName)("cnt");Object.defineProperty(Xv,"__esModule",{value:!0});Xv.FolderView=void 0;var EL=ss,eXt=Wn,TL=Vo,nXt=pn,iXt=Yv,rXt=function(){function i(t,e){var n=this,r;this.className_=(0,eXt.ClassName)((r=e.viewName)!==null&&r!==void 0?r:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),(0,iXt.bladeContainerClassName)()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),(0,EL.bindValueMap)(this.foldable_,"completed",(0,TL.valueToClassName)(this.element,this.className_(void 0,"cpl")));var s=t.createElement("button");s.classList.add(this.className_("b")),(0,EL.bindValueMap)(e.props,"title",function(u){(0,nXt.isEmpty)(u)?n.element.classList.add(n.className_(void 0,"not")):n.element.classList.remove(n.className_(void 0,"not"))}),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;var o=t.createElement("div");o.classList.add(this.className_("i")),this.element.appendChild(o);var a=t.createElement("div");a.classList.add(this.className_("t")),(0,TL.bindValueToTextContent)(e.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a;var l=t.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);var c=e.containerElement;c.classList.add(this.className_("c")),this.element.appendChild(c),this.containerElement=c}return i}();Xv.FolderView=rXt;var sXt=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),py=zt&&zt.__assign||function(){return py=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},py.apply(this,arguments)};Object.defineProperty(qv,"__esModule",{value:!0});qv.FolderController=void 0;var oXt=sm,AL=oo,aXt=jv(),lXt=Xv,cXt=function(i){sXt(t,i);function t(e,n){var r=this,s,o=AL.Foldable.create((s=n.expanded)!==null&&s!==void 0?s:!0),a=new aXt.RackController(e,{blade:n.blade,root:n.root,viewProps:n.viewProps});return r=i.call(this,py(py({},n),{rackController:a,view:new lXt.FolderView(e,{containerElement:a.view.element,foldable:o,props:n.props,viewName:n.root?"rot":void 0,viewProps:n.viewProps})}))||this,r.onTitleClick_=r.onTitleClick_.bind(r),r.props=n.props,r.foldable=o,(0,AL.bindFoldable)(r.foldable,r.view.containerElement),r.rackController.rack.emitter.on("add",function(){r.foldable.cleanUpTransition()}),r.rackController.rack.emitter.on("remove",function(){r.foldable.cleanUpTransition()}),r.view.buttonElement.addEventListener("click",r.onTitleClick_),r}return Object.defineProperty(t.prototype,"document",{get:function(){return this.view.element.ownerDocument},enumerable:!1,configurable:!0}),t.prototype.onTitleClick_=function(){this.foldable.set("expanded",!this.foldable.get("expanded"))},t}(oXt.RackLikeController);qv.FolderController=cXt;var Kv={};Object.defineProperty(Kv,"__esModule",{value:!0});Kv.FolderBladePlugin=void 0;var uXt=Pi,PL=qr,hXt=Gv,RL=qv;Kv.FolderBladePlugin={id:"folder",type:"blade",accept:function(i){var t=PL.ParamsParsers,e=(0,PL.parseParams)(i,{title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean});return e?{params:e}:null},controller:function(i){return new RL.FolderController(i.document,{blade:i.blade,expanded:i.params.expanded,props:uXt.ValueMap.fromObject({title:i.params.title}),viewProps:i.viewProps})},api:function(i){return i.controller instanceof RL.FolderController?new hXt.FolderApi(i.controller,i.pool):null}};var Wx={},dXt=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),fy=zt&&zt.__assign||function(){return fy=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},fy.apply(this,arguments)};Object.defineProperty(Wx,"__esModule",{value:!0});Wx.LabeledValueController=void 0;var pXt=Zd,fXt=tm,mXt=function(i){dXt(t,i);function t(e,n){var r=this,s=n.valueController.viewProps;return r=i.call(this,fy(fy({},n),{value:n.valueController.value,view:new fXt.LabelView(e,{props:n.props,viewProps:s}),viewProps:s}))||this,r.props=n.props,r.valueController=n.valueController,r.view.valueElement.appendChild(r.valueController.view.element),r}return t}(pXt.ValueBladeController);Wx.LabeledValueController=mXt;var Zv={},gXt=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Zv,"__esModule",{value:!0});Zv.SeparatorApi=void 0;var vXt=cc,_Xt=function(i){gXt(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t}(vXt.BladeApi);Zv.SeparatorApi=_Xt;var Jv={},jx={};Object.defineProperty(jx,"__esModule",{value:!0});jx.SeparatorView=void 0;var bXt=Wn,kL=(0,bXt.ClassName)("spr"),yXt=function(){function i(t,e){this.element=t.createElement("div"),this.element.classList.add(kL()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("hr");n.classList.add(kL("r")),this.element.appendChild(n)}return i}();jx.SeparatorView=yXt;var xXt=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),my=zt&&zt.__assign||function(){return my=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},my.apply(this,arguments)};Object.defineProperty(Jv,"__esModule",{value:!0});Jv.SeparatorController=void 0;var wXt=su,SXt=jx,MXt=function(i){xXt(t,i);function t(e,n){return i.call(this,my(my({},n),{view:new SXt.SeparatorView(e,{viewProps:n.viewProps})}))||this}return t}(wXt.BladeController);Jv.SeparatorController=MXt;var Qv={};Object.defineProperty(Qv,"__esModule",{value:!0});Qv.SeparatorBladePlugin=void 0;var LL=qr,CXt=Zv,OL=Jv;Qv.SeparatorBladePlugin={id:"separator",type:"blade",accept:function(i){var t=LL.ParamsParsers,e=(0,LL.parseParams)(i,{view:t.required.constant("separator")});return e?{params:e}:null},controller:function(i){return new OL.SeparatorController(i.document,{blade:i.blade,viewProps:i.viewProps})},api:function(i){return i.controller instanceof OL.SeparatorController?new CXt.SeparatorApi(i.controller):null}};var t_={},om={},Xx={},Yx={};Object.defineProperty(Yx,"__esModule",{value:!0});Yx.TabItemView=void 0;var EXt=ss,TXt=Wn,AXt=Vo,ig=(0,TXt.ClassName)("tbi"),PXt=function(){function i(t,e){var n=this;this.element=t.createElement("div"),this.element.classList.add(ig()),e.viewProps.bindClassModifiers(this.element),(0,EXt.bindValueMap)(e.props,"selected",function(o){o?n.element.classList.add(ig(void 0,"sel")):n.element.classList.remove(ig(void 0,"sel"))});var r=t.createElement("button");r.classList.add(ig("b")),e.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var s=t.createElement("div");s.classList.add(ig("t")),(0,AXt.bindValueToTextContent)(e.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}return i}();Yx.TabItemView=PXt;Object.defineProperty(Xx,"__esModule",{value:!0});Xx.TabItemController=void 0;var RXt=Pr,kXt=Yx,LXt=function(){function i(t,e){this.emitter=new RXt.Emitter,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new kXt.TabItemView(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return i.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},i}();Xx.TabItemController=LXt;Object.defineProperty(om,"__esModule",{value:!0});om.TabPageController=void 0;var OXt=ss,DL=ou,DXt=yh,IXt=jv(),NXt=Xx,zXt=function(){function i(t,e){var n=this;this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new NXt.TabItemController(t,{props:e.itemProps,viewProps:DL.ViewProps.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new IXt.RackController(t,{blade:(0,DXt.createBlade)(),viewProps:DL.ViewProps.create()}),this.props=e.props,(0,OXt.bindValueMap)(this.props,"selected",function(r){n.itemController.props.set("selected",r),n.contentController.viewProps.set("hidden",!r)})}return Object.defineProperty(i.prototype,"itemController",{get:function(){return this.ic_},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"contentController",{get:function(){return this.cc_},enumerable:!1,configurable:!0}),i.prototype.onItemClick_=function(){this.props.set("selected",!0)},i}();om.TabPageController=zXt;var e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.TabPageApi=void 0;var UXt=function(){function i(t,e){this.controller_=t,this.rackApi_=e}return Object.defineProperty(i.prototype,"title",{get:function(){var t;return(t=this.controller_.itemController.props.get("title"))!==null&&t!==void 0?t:""},set:function(t){this.controller_.itemController.props.set("title",t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this.controller_.props.get("selected")},set:function(t){this.controller_.props.set("selected",t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),i.prototype.addButton=function(t){return this.rackApi_.addButton(t)},i.prototype.addFolder=function(t){return this.rackApi_.addFolder(t)},i.prototype.addSeparator=function(t){return this.rackApi_.addSeparator(t)},i.prototype.addTab=function(t){return this.rackApi_.addTab(t)},i.prototype.add=function(t,e){this.rackApi_.add(t,e)},i.prototype.remove=function(t){this.rackApi_.remove(t)},i.prototype.addInput=function(t,e,n){return this.rackApi_.addInput(t,e,n)},i.prototype.addMonitor=function(t,e,n){return this.rackApi_.addMonitor(t,e,n)},i.prototype.addBlade=function(t){return this.rackApi_.addBlade(t)},i}();e_.TabPageApi=UXt;var FXt=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(t_,"__esModule",{value:!0});t_.TabApi=void 0;var VXt=Pr,IL=Pi,hb=Go,BXt=em,HXt=_s,$Xt=oh,GXt=om,qXt=e_,WXt=function(i){FXt(t,i);function t(e,n){var r=i.call(this,e,new $Xt.RackApi(e.rackController,n))||this;return r.onPageAdd_=r.onPageAdd_.bind(r),r.onPageRemove_=r.onPageRemove_.bind(r),r.onSelect_=r.onSelect_.bind(r),r.emitter_=new VXt.Emitter,r.pageApiMap_=new Map,r.rackApi_.on("change",function(s){r.emitter_.emit("change",{event:s})}),r.rackApi_.on("update",function(s){r.emitter_.emit("update",{event:s})}),r.controller_.tab.selectedIndex.emitter.on("change",r.onSelect_),r.controller_.pageSet.emitter.on("add",r.onPageAdd_),r.controller_.pageSet.emitter.on("remove",r.onPageRemove_),r.controller_.pageSet.items.forEach(function(s){r.setUpPageApi_(s)}),r}return Object.defineProperty(t.prototype,"pages",{get:function(){var e=this;return this.controller_.pageSet.items.map(function(n){var r=e.pageApiMap_.get(n);if(!r)throw hb.TpError.shouldNeverHappen();return r})},enumerable:!1,configurable:!0}),t.prototype.addPage=function(e){var n=this.controller_.view.element.ownerDocument,r=new GXt.TabPageController(n,{itemProps:IL.ValueMap.fromObject({selected:!1,title:e.title}),props:IL.ValueMap.fromObject({selected:!1})});this.controller_.add(r,e.index);var s=this.pageApiMap_.get(r);if(!s)throw hb.TpError.shouldNeverHappen();return s},t.prototype.removePage=function(e){this.controller_.remove(e)},t.prototype.on=function(e,n){var r=n.bind(this);return this.emitter_.on(e,function(s){r(s.event)}),this},t.prototype.setUpPageApi_=function(e){var n=this.rackApi_.apiSet_.find(function(s){return s.controller_===e.contentController});if(!n)throw hb.TpError.shouldNeverHappen();var r=new qXt.TabPageApi(e,n);this.pageApiMap_.set(e,r)},t.prototype.onPageAdd_=function(e){this.setUpPageApi_(e.item)},t.prototype.onPageRemove_=function(e){var n=this.pageApiMap_.get(e.item);if(!n)throw hb.TpError.shouldNeverHappen();this.pageApiMap_.delete(e.item)},t.prototype.onSelect_=function(e){this.emitter_.emit("select",{event:new HXt.TpTabSelectEvent(this,e.rawValue)})},t}(BXt.RackLikeApi);t_.TabApi=WXt;var n_={},Kx={};Object.defineProperty(Kx,"__esModule",{value:!0});Kx.Tab=void 0;var NL=Gs,zL=-1,jXt=function(){function i(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=(0,NL.createValue)(!0),this.selectedIndex=(0,NL.createValue)(zL),this.items_=[]}return i.prototype.add=function(t,e){var n=e??this.items_.length;this.items_.splice(n,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()},i.prototype.remove=function(t){var e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())},i.prototype.keepSelection_=function(){if(this.items_.length===0){this.selectedIndex.rawValue=zL,this.empty.rawValue=!0;return}var t=this.items_.findIndex(function(e){return e.rawValue});t<0?(this.items_.forEach(function(e,n){e.rawValue=n===0}),this.selectedIndex.rawValue=0):(this.items_.forEach(function(e,n){e.rawValue=n===t}),this.selectedIndex.rawValue=t),this.empty.rawValue=!1},i.prototype.onItemSelectedChange_=function(t){if(t.rawValue){var e=this.items_.findIndex(function(n){return n===t.sender});this.items_.forEach(function(n,r){n.rawValue=r===e}),this.selectedIndex.rawValue=e}else this.keepSelection_()},i}();Kx.Tab=jXt;var Zx={};Object.defineProperty(Zx,"__esModule",{value:!0});Zx.TabView=void 0;var XXt=ss,YXt=Wn,KXt=Vo,ZXt=Yv,rg=(0,YXt.ClassName)("tab"),JXt=function(){function i(t,e){this.element=t.createElement("div"),this.element.classList.add(rg(),(0,ZXt.bladeContainerClassName)()),e.viewProps.bindClassModifiers(this.element),(0,XXt.bindValue)(e.empty,(0,KXt.valueToClassName)(this.element,rg(void 0,"nop")));var n=t.createElement("div");n.classList.add(rg("t")),this.element.appendChild(n),this.itemsElement=n;var r=t.createElement("div");r.classList.add(rg("i")),this.element.appendChild(r);var s=e.contentsElement;s.classList.add(rg("c")),this.element.appendChild(s),this.contentsElement=s}return i}();Zx.TabView=JXt;var QXt=zt&&zt.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(n_,"__esModule",{value:!0});n_.TabController=void 0;var UL=Ts,t9t=sm,e9t=nm,n9t=jv(),i9t=Kx,r9t=Zx,s9t=function(i){QXt(t,i);function t(e,n){var r=this,s=new n9t.RackController(e,{blade:n.blade,viewProps:n.viewProps}),o=new i9t.Tab;return r=i.call(this,{blade:n.blade,rackController:s,view:new r9t.TabView(e,{contentsElement:s.view.element,empty:o.empty,viewProps:n.viewProps})})||this,r.onPageAdd_=r.onPageAdd_.bind(r),r.onPageRemove_=r.onPageRemove_.bind(r),r.pageSet_=new e9t.NestedOrderedSet(function(){return null}),r.pageSet_.emitter.on("add",r.onPageAdd_),r.pageSet_.emitter.on("remove",r.onPageRemove_),r.tab=o,r}return Object.defineProperty(t.prototype,"pageSet",{get:function(){return this.pageSet_},enumerable:!1,configurable:!0}),t.prototype.add=function(e,n){this.pageSet_.add(e,n)},t.prototype.remove=function(e){this.pageSet_.remove(this.pageSet_.items[e])},t.prototype.onPageAdd_=function(e){var n=e.item;(0,UL.insertElementAt)(this.view.itemsElement,n.itemController.view.element,e.index),n.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(n.contentController,e.index),this.tab.add(n.props.value("selected"))},t.prototype.onPageRemove_=function(e){var n=e.item;(0,UL.removeElement)(n.itemController.view.element),n.itemController.viewProps.set("parent",null),this.rackController.rack.remove(n.contentController),this.tab.remove(n.props.value("selected"))},t}(t9t.RackLikeController);n_.TabController=s9t;var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.TabBladePlugin=void 0;var FL=Pi,VL=qr,o9t=t_,BL=n_,a9t=om;i_.TabBladePlugin={id:"tab",type:"blade",accept:function(i){var t=VL.ParamsParsers,e=(0,VL.parseParams)(i,{pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")});return!e||e.pages.length===0?null:{params:e}},controller:function(i){var t=new BL.TabController(i.document,{blade:i.blade,viewProps:i.viewProps});return i.params.pages.forEach(function(e){var n=new a9t.TabPageController(i.document,{itemProps:FL.ValueMap.fromObject({selected:!1,title:e.title}),props:FL.ValueMap.fromObject({selected:!1})});t.add(n)}),t},api:function(i){return i.controller instanceof BL.TabController?new o9t.TabApi(i.controller,i.pool):null}};var r_={},gy=zt&&zt.__assign||function(){return gy=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},gy.apply(this,arguments)};Object.defineProperty(r_,"__esModule",{value:!0});r_.createBladeController=void 0;var l9t=ou,HL=qr,c9t=pn,u9t=yh;function h9t(i,t){var e=i.accept(t.params);if(!e)return null;var n=HL.ParamsParsers.optional.boolean(t.params.disabled).value,r=HL.ParamsParsers.optional.boolean(t.params.hidden).value;return i.controller({blade:(0,u9t.createBlade)(),document:t.document,params:(0,c9t.forceCast)(gy(gy({},e.params),{disabled:n,hidden:r})),viewProps:l9t.ViewProps.create({disabled:n,hidden:r})})}r_.createBladeController=h9t;var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.ManualTicker=void 0;var d9t=Pr,p9t=function(){function i(){this.disabled=!1,this.emitter=new d9t.Emitter}return i.prototype.dispose=function(){},i.prototype.tick=function(){this.disabled||this.emitter.emit("tick",{sender:this})},i}();s_.ManualTicker=p9t;var o_={};Object.defineProperty(o_,"__esModule",{value:!0});o_.IntervalTicker=void 0;var f9t=Pr,m9t=function(){function i(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new f9t.Emitter,this.interval_=e,this.setTimer_()}return Object.defineProperty(i.prototype,"disabled",{get:function(){return this.disabled_},set:function(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()},enumerable:!1,configurable:!0}),i.prototype.dispose=function(){this.clearTimer_()},i.prototype.clearTimer_=function(){if(this.timerId_!==null){var t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}},i.prototype.setTimer_=function(){if(this.clearTimer_(),!(this.interval_<=0)){var t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}},i.prototype.onTick_=function(){this.disabled_||this.emitter.emit("tick",{sender:this})},i}();o_.IntervalTicker=m9t;var oF={};Object.defineProperty(oF,"__esModule",{value:!0});var a_={};Object.defineProperty(a_,"__esModule",{value:!0});a_.InputBinding=void 0;var g9t=Pr,v9t=function(){function i(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new g9t.Emitter,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}return i.prototype.read=function(){var t=this.target.read();t!==void 0&&(this.value.rawValue=this.reader(t))},i.prototype.write_=function(t){this.writer(this.target,t)},i.prototype.onValueChange_=function(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})},i}();a_.InputBinding=v9t;var l_={},ah={},$L=zt&&zt.__spreadArray||function(i,t,e){if(e||arguments.length===2)for(var n=0,r=t.length,s;n<r;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return i.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(ah,"__esModule",{value:!0});ah.createPushedBuffer=ah.initializeBuffer=void 0;var _9t=pn,b9t=Gs;function aF(i,t){for(;i.length<t;)i.push(void 0)}function y9t(i){var t=[];return aF(t,i),(0,b9t.createValue)(t)}ah.initializeBuffer=y9t;function x9t(i){var t=i.indexOf(void 0);return(0,_9t.forceCast)(t<0?i:i.slice(0,t))}function w9t(i,t){var e=$L($L([],x9t(i),!0),[t],!1);return e.length>i.length?e.splice(0,e.length-i.length):aF(e,i.length),e}ah.createPushedBuffer=w9t;Object.defineProperty(l_,"__esModule",{value:!0});l_.MonitorBinding=void 0;var S9t=ah,M9t=Pr,C9t=function(){function i(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new M9t.Emitter,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return i.prototype.dispose=function(){this.ticker.dispose()},i.prototype.read=function(){var t=this.target.read();if(t!==void 0){var e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=(0,S9t.createPushedBuffer)(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}},i.prototype.onTick_=function(t){this.read()},i}();l_.MonitorBinding=C9t;var xl={};Object.defineProperty(xl,"__esModule",{value:!0});xl.findConstraint=xl.CompositeConstraint=void 0;var lF=function(){function i(t){this.constraints=t}return i.prototype.constrain=function(t){return this.constraints.reduce(function(e,n){return n.constrain(e)},t)},i}();xl.CompositeConstraint=lF;function E9t(i,t){if(i instanceof t)return i;if(i instanceof lF){var e=i.constraints.reduce(function(n,r){return n||(r instanceof t?r:null)},null);if(e)return e}return null}xl.findConstraint=E9t;var cF={};Object.defineProperty(cF,"__esModule",{value:!0});var Jd={};Object.defineProperty(Jd,"__esModule",{value:!0});Jd.DefiniteRangeConstraint=void 0;var T9t=Pi,A9t=function(){function i(t){this.values=T9t.ValueMap.fromObject({max:t.max,min:t.min})}return i.prototype.constrain=function(t){var e=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(t,n),e)},i}();Jd.DefiniteRangeConstraint=A9t;var Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});Sh.ListConstraint=void 0;var P9t=Pi,R9t=function(){function i(t){this.values=P9t.ValueMap.fromObject({options:t})}return Object.defineProperty(i.prototype,"options",{get:function(){return this.values.get("options")},enumerable:!1,configurable:!0}),i.prototype.constrain=function(t){var e=this.values.get("options");if(e.length===0)return t;var n=e.filter(function(r){return r.value===t}).length>0;return n?t:e[0].value},i}();Sh.ListConstraint=R9t;var c_={};Object.defineProperty(c_,"__esModule",{value:!0});c_.RangeConstraint=void 0;var GL=pn,k9t=Pi,L9t=function(){function i(t){this.values=k9t.ValueMap.fromObject({max:t.max,min:t.min})}return Object.defineProperty(i.prototype,"maxValue",{get:function(){return this.values.get("max")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"minValue",{get:function(){return this.values.get("min")},enumerable:!1,configurable:!0}),i.prototype.constrain=function(t){var e=this.values.get("max"),n=this.values.get("min"),r=t;return(0,GL.isEmpty)(n)||(r=Math.max(r,n)),(0,GL.isEmpty)(e)||(r=Math.min(r,e)),r},i}();c_.RangeConstraint=L9t;var am={};Object.defineProperty(am,"__esModule",{value:!0});am.StepConstraint=void 0;var O9t=function(){function i(t,e){e===void 0&&(e=0),this.step=t,this.origin=e}return i.prototype.constrain=function(t){var e=this.origin%this.step,n=Math.round((t-e)/this.step);return e+n*this.step},i}();am.StepConstraint=O9t;var uF={};Object.defineProperty(uF,"__esModule",{value:!0});var Qd={},u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.ListView=void 0;var qL=Ts,D9t=ss,I9t=Wn,NS=(0,I9t.ClassName)("lst"),N9t=function(){function i(t,e){var n=this;this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(NS()),e.viewProps.bindClassModifiers(this.element);var r=t.createElement("select");r.classList.add(NS("s")),e.viewProps.bindDisabled(r),this.element.appendChild(r),this.selectElement=r;var s=t.createElement("div");s.classList.add(NS("m")),s.appendChild((0,qL.createSvgIconElement)(t,"dropdown")),this.element.appendChild(s),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,(0,D9t.bindValueMap)(this.props_,"options",function(o){(0,qL.removeChildElements)(n.selectElement),o.forEach(function(a){var l=t.createElement("option");l.textContent=a.text,n.selectElement.appendChild(l)}),n.update_()})}return i.prototype.update_=function(){var t=this.props_.get("options").map(function(e){return e.value});this.selectElement.selectedIndex=t.indexOf(this.value_.rawValue)},i.prototype.onValueChange_=function(){this.update_()},i}();u_.ListView=N9t;Object.defineProperty(Qd,"__esModule",{value:!0});Qd.ListController=void 0;var z9t=pn,U9t=u_,F9t=function(){function i(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new U9t.ListView(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return i.prototype.onSelectChange_=function(t){var e=(0,z9t.forceCast)(t.currentTarget);this.value.rawValue=this.props.get("options")[e.selectedIndex].value},i}();Qd.ListController=F9t;var lm={},h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.PopupView=void 0;var V9t=ss,B9t=Wn,H9t=Vo,WL=(0,B9t.ClassName)("pop"),$9t=function(){function i(t,e){this.element=t.createElement("div"),this.element.classList.add(WL()),e.viewProps.bindClassModifiers(this.element),(0,V9t.bindValue)(e.shows,(0,H9t.valueToClassName)(this.element,WL(void 0,"v")))}return i}();h_.PopupView=$9t;Object.defineProperty(lm,"__esModule",{value:!0});lm.PopupController=void 0;var G9t=Gs,q9t=h_,W9t=function(){function i(t,e){this.shows=(0,G9t.createValue)(!1),this.viewProps=e.viewProps,this.view=new q9t.PopupView(t,{shows:this.shows,viewProps:this.viewProps})}return i}();lm.PopupController=W9t;var cm={},d_={};Object.defineProperty(d_,"__esModule",{value:!0});d_.TextView=void 0;var j9t=Wn,jL=(0,j9t.ClassName)("txt"),X9t=function(){function i(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(jL()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);var n=t.createElement("input");n.classList.add(jL("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}return i.prototype.refresh=function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)},i.prototype.onChange_=function(){this.refresh()},i}();d_.TextView=X9t;Object.defineProperty(cm,"__esModule",{value:!0});cm.TextController=void 0;var XL=pn,Y9t=d_,K9t=function(){function i(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Y9t.TextView(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return i.prototype.onInputChange_=function(t){var e=(0,XL.forceCast)(t.currentTarget),n=e.value,r=this.parser_(n);(0,XL.isEmpty)(r)||(this.value.rawValue=r),this.view.refresh()},i}();cm.TextController=K9t;var hF={};Object.defineProperty(hF,"__esModule",{value:!0});var Zl={};Object.defineProperty(Zl,"__esModule",{value:!0});Zl.BooleanFormatter=Zl.boolFromUnknown=Zl.boolToString=void 0;function dF(i){return String(i)}Zl.boolToString=dF;function Z9t(i){return i==="false"?!1:!!i}Zl.boolFromUnknown=Z9t;function J9t(i){return dF(i)}Zl.BooleanFormatter=J9t;var pF={};Object.defineProperty(pF,"__esModule",{value:!0});var ns={},Jx={},Yu={};Object.defineProperty(Yu,"__esModule",{value:!0});Yu.UnaryOperationNode=Yu.BinaryOperationNode=Yu.NumberLiteralNode=void 0;var Q9t=function(){function i(t){this.text=t}return i.prototype.evaluate=function(){return Number(this.text)},i.prototype.toString=function(){return this.text},i}();Yu.NumberLiteralNode=Q9t;var tYt={"**":function(i,t){return Math.pow(i,t)},"*":function(i,t){return i*t},"/":function(i,t){return i/t},"%":function(i,t){return i%t},"+":function(i,t){return i+t},"-":function(i,t){return i-t},"<<":function(i,t){return i<<t},">>":function(i,t){return i>>t},">>>":function(i,t){return i>>>t},"&":function(i,t){return i&t},"^":function(i,t){return i^t},"|":function(i,t){return i|t}},eYt=function(){function i(t,e,n){this.left=e,this.operator=t,this.right=n}return i.prototype.evaluate=function(){var t=tYt[this.operator];if(!t)throw new Error("unexpected binary operator: '".concat(this.operator));return t(this.left.evaluate(),this.right.evaluate())},i.prototype.toString=function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")},i}();Yu.BinaryOperationNode=eYt;var nYt={"+":function(i){return i},"-":function(i){return-i},"~":function(i){return~i}},iYt=function(){function i(t,e){this.operator=t,this.expression=e}return i.prototype.evaluate=function(){var t=nYt[this.operator];if(!t)throw new Error("unexpected unary operator: '".concat(this.operator));return t(this.expression.evaluate())},i.prototype.toString=function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")},i}();Yu.UnaryOperationNode=iYt;var Tf={};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.readNumericLiteral=Tf.readWhitespace=void 0;function rA(i){return function(t,e){for(var n=0;n<i.length;n++){var r=i[n](t,e);if(r!=="")return r}return""}}function rYt(i,t){var e,n=i.substr(t).match(/^\s+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}Tf.readWhitespace=rYt;function sYt(i,t){var e=i.substr(t,1);return e.match(/^[1-9]$/)?e:""}function av(i,t){var e,n=i.substr(t).match(/^[0-9]+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}function oYt(i,t){var e=av(i,t);if(e!=="")return e;var n=i.substr(t,1);if(t+=1,n!=="-"&&n!=="+")return"";var r=av(i,t);return r===""?"":n+r}function sA(i,t){var e=i.substr(t,1);if(t+=1,e.toLowerCase()!=="e")return"";var n=oYt(i,t);return n===""?"":e+n}function fF(i,t){var e=i.substr(t,1);if(e==="0")return e;var n=sYt(i,t);return t+=n.length,n===""?"":n+av(i,t)}function aYt(i,t){var e=fF(i,t);if(t+=e.length,e==="")return"";var n=i.substr(t,1);if(t+=n.length,n!==".")return"";var r=av(i,t);return t+=r.length,e+n+r+sA(i,t)}function lYt(i,t){var e=i.substr(t,1);if(t+=e.length,e!==".")return"";var n=av(i,t);return t+=n.length,n===""?"":e+n+sA(i,t)}function cYt(i,t){var e=fF(i,t);return t+=e.length,e===""?"":e+sA(i,t)}var uYt=rA([aYt,lYt,cYt]);function hYt(i,t){var e,n=i.substr(t).match(/^[01]+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}function dYt(i,t){var e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0b")return"";var n=hYt(i,t);return n===""?"":e+n}function pYt(i,t){var e,n=i.substr(t).match(/^[0-7]+/);return(e=n&&n[0])!==null&&e!==void 0?e:""}function fYt(i,t){var e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0o")return"";var n=pYt(i,t);return n===""?"":e+n}function mYt(i,t){var e,n=i.substr(t).match(/^[0-9a-f]+/i);return(e=n&&n[0])!==null&&e!==void 0?e:""}function gYt(i,t){var e=i.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0x")return"";var n=mYt(i,t);return n===""?"":e+n}var vYt=rA([dYt,fYt,gYt]);Tf.readNumericLiteral=rA([vYt,uYt]);Object.defineProperty(Jx,"__esModule",{value:!0});Jx.parseEcmaNumberExpression=void 0;var oA=Yu,Af=Tf;function _Yt(i,t){var e=(0,Af.readNumericLiteral)(i,t);return t+=e.length,e===""?null:{evaluable:new oA.NumberLiteralNode(e),cursor:t}}function bYt(i,t){var e=i.substr(t,1);if(t+=e.length,e!=="(")return null;var n=gF(i,t);if(!n)return null;t=n.cursor,t+=(0,Af.readWhitespace)(i,t).length;var r=i.substr(t,1);return t+=r.length,r!==")"?null:{evaluable:n.evaluable,cursor:t}}function yYt(i,t){var e;return(e=_Yt(i,t))!==null&&e!==void 0?e:bYt(i,t)}function mF(i,t){var e=yYt(i,t);if(e)return e;var n=i.substr(t,1);if(t+=n.length,n!=="+"&&n!=="-"&&n!=="~")return null;var r=mF(i,t);return r?(t=r.cursor,{cursor:t,evaluable:new oA.UnaryOperationNode(n,r.evaluable)}):null}function xYt(i,t,e){e+=(0,Af.readWhitespace)(t,e).length;var n=i.filter(function(r){return t.startsWith(r,e)})[0];return n?(e+=n.length,e+=(0,Af.readWhitespace)(t,e).length,{cursor:e,operator:n}):null}function wYt(i,t){return function(e,n){var r=i(e,n);if(!r)return null;n=r.cursor;for(var s=r.evaluable;;){var o=xYt(t,e,n);if(!o)break;n=o.cursor;var a=i(e,n);if(!a)return null;n=a.cursor,s=new oA.BinaryOperationNode(o.operator,s,a.evaluable)}return s?{cursor:n,evaluable:s}:null}}var SYt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(function(i,t){return wYt(i,t)},mF);function gF(i,t){return t+=(0,Af.readWhitespace)(i,t).length,SYt(i,t)}function MYt(i){var t=gF(i,0);if(!t)return null;var e=t.cursor+(0,Af.readWhitespace)(i,t.cursor).length;return e!==i.length?null:t.evaluable}Jx.parseEcmaNumberExpression=MYt;Object.defineProperty(ns,"__esModule",{value:!0});ns.createNumberFormatter=ns.numberToString=ns.numberFromUnknown=ns.parseNumber=void 0;var CYt=pn,EYt=Jx;function vF(i){var t,e=(0,EYt.parseEcmaNumberExpression)(i);return(t=e==null?void 0:e.evaluate())!==null&&t!==void 0?t:null}ns.parseNumber=vF;function TYt(i){if(typeof i=="number")return i;if(typeof i=="string"){var t=vF(i);if(!(0,CYt.isEmpty)(t))return t}return 0}ns.numberFromUnknown=TYt;function AYt(i){return String(i)}ns.numberToString=AYt;function PYt(i){return function(t){return t.toFixed(Math.max(Math.min(i,20),0))}}ns.createNumberFormatter=PYt;var _F={};Object.defineProperty(_F,"__esModule",{value:!0});var p_={};Object.defineProperty(p_,"__esModule",{value:!0});p_.formatPercentage=void 0;var RYt=ns,kYt=(0,RYt.createNumberFormatter)(0);function LYt(i){return kYt(i)+"%"}p_.formatPercentage=LYt;var lh={};Object.defineProperty(lh,"__esModule",{value:!0});lh.formatString=lh.stringFromUnknown=void 0;function OYt(i){return String(i)}lh.stringFromUnknown=OYt;function DYt(i){return i}lh.formatString=DYt;var bF={};Object.defineProperty(bF,"__esModule",{value:!0});var au={};Object.defineProperty(au,"__esModule",{value:!0});au.connectValues=void 0;function IYt(i){var t=i.primary,e=i.secondary,n=i.forward,r=i.backward,s=!1;function o(a){s||(s=!0,a(),s=!1)}t.emitter.on("change",function(a){o(function(){e.setRawValue(n(t,e),a.options)})}),e.emitter.on("change",function(a){o(function(){t.setRawValue(r(t,e),a.options)}),o(function(){e.setRawValue(n(t,e),a.options)})}),o(function(){e.setRawValue(n(t,e),{forceEmit:!1,last:!0})})}au.connectValues=IYt;var lu={},bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.isArrowKey=bs.isVerticalArrowKey=bs.getHorizontalStepKeys=bs.getVerticalStepKeys=bs.getStepForKey=void 0;function NYt(i,t){var e=i*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+e:t.downKey?-e:0}bs.getStepForKey=NYt;function zYt(i){return{altKey:i.altKey,downKey:i.key==="ArrowDown",shiftKey:i.shiftKey,upKey:i.key==="ArrowUp"}}bs.getVerticalStepKeys=zYt;function UYt(i){return{altKey:i.altKey,downKey:i.key==="ArrowLeft",shiftKey:i.shiftKey,upKey:i.key==="ArrowRight"}}bs.getHorizontalStepKeys=UYt;function yF(i){return i==="ArrowUp"||i==="ArrowDown"}bs.isVerticalArrowKey=yF;function FYt(i){return yF(i)||i==="ArrowLeft"||i==="ArrowRight"}bs.isArrowKey=FYt;var El={};Object.defineProperty(El,"__esModule",{value:!0});El.PointerHandler=void 0;var VYt=Pr;function zS(i,t){var e,n,r=t.ownerDocument.defaultView,s=t.getBoundingClientRect();return{x:i.pageX-(((e=r&&r.scrollX)!==null&&e!==void 0?e:0)+s.left),y:i.pageY-(((n=r&&r.scrollY)!==null&&n!==void 0?n:0)+s.top)}}var BYt=function(){function i(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new VYt.Emitter,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}return i.prototype.computePosition_=function(t){var e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}},i.prototype.onMouseDown_=function(t){var e;t.preventDefault(),(e=t.currentTarget)===null||e===void 0||e.focus();var n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(zS(t,this.elem_)),sender:this,shiftKey:t.shiftKey})},i.prototype.onDocumentMouseMove_=function(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(zS(t,this.elem_)),sender:this,shiftKey:t.shiftKey})},i.prototype.onDocumentMouseUp_=function(t){var e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(zS(t,this.elem_)),sender:this,shiftKey:t.shiftKey})},i.prototype.onTouchStart_=function(t){t.preventDefault();var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e},i.prototype.onTouchMove_=function(t){var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e},i.prototype.onTouchEnd_=function(t){var e,n=(e=t.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-r.left,y:n.clientY-r.top}:void 0),sender:this,shiftKey:t.shiftKey})},i}();El.PointerHandler=BYt;var f_={},Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});Ai.loopRange=Ai.constrainRange=Ai.getDecimalDigits=Ai.mapRange=void 0;function HYt(i,t,e,n,r){var s=(i-t)/(e-t);return n+s*(r-n)}Ai.mapRange=HYt;function $Yt(i){var t=String(i.toFixed(10)),e=t.split(".")[1];return e.replace(/0+$/,"").length}Ai.getDecimalDigits=$Yt;function GYt(i,t,e){return Math.min(Math.max(i,t),e)}Ai.constrainRange=GYt;function qYt(i,t){return(i%t+t)%t}Ai.loopRange=qYt;Object.defineProperty(f_,"__esModule",{value:!0});f_.NumberTextView=void 0;var US=Ts,WYt=Ai,xF=Wn,Ia=(0,xF.ClassName)("txt"),jYt=function(){function i(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Ia(),Ia(void 0,"num")),e.arrayPosition&&this.element.classList.add(Ia(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("input");n.classList.add(Ia("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Ia()),this.inputElement.classList.add(Ia("i"));var r=t.createElement("div");r.classList.add(Ia("k")),this.element.appendChild(r),this.knobElement=r;var s=t.createElementNS(US.SVG_NS,"svg");s.classList.add(Ia("g")),this.knobElement.appendChild(s);var o=t.createElementNS(US.SVG_NS,"path");o.classList.add(Ia("gb")),s.appendChild(o),this.guideBodyElem_=o;var a=t.createElementNS(US.SVG_NS,"path");a.classList.add(Ia("gh")),s.appendChild(a),this.guideHeadElem_=a;var l=t.createElement("div");l.classList.add((0,xF.ClassName)("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}return i.prototype.onDraggingChange_=function(t){if(t.rawValue===null){this.element.classList.remove(Ia(void 0,"drg"));return}this.element.classList.add(Ia(void 0,"drg"));var e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),r=(0,WYt.constrainRange)(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(n+r,",0 L").concat(n,",4 L").concat(n+r,",8"),"M ".concat(e,",-1 L").concat(e,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(e,",4"));var s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left="".concat(e,"px")},i.prototype.refresh=function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)},i.prototype.onChange_=function(){this.refresh()},i}();f_.NumberTextView=jYt;Object.defineProperty(lu,"__esModule",{value:!0});lu.NumberTextController=void 0;var YL=pn,XYt=Gs,db=bs,YYt=El,KYt=f_,ZYt=function(){function i(t,e){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=(n=e.sliderProps)!==null&&n!==void 0?n:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=(0,XYt.createValue)(null),this.view=new KYt.NumberTextView(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var r=new YYt.PointerHandler(this.view.knobElement);r.emitter.on("down",this.onPointerDown_),r.emitter.on("move",this.onPointerMove_),r.emitter.on("up",this.onPointerUp_)}return i.prototype.constrainValue_=function(t){var e,n,r=(e=this.sliderProps_)===null||e===void 0?void 0:e.get("minValue"),s=(n=this.sliderProps_)===null||n===void 0?void 0:n.get("maxValue"),o=t;return r!==void 0&&(o=Math.max(o,r)),s!==void 0&&(o=Math.min(o,s)),o},i.prototype.onInputChange_=function(t){var e=(0,YL.forceCast)(t.currentTarget),n=e.value,r=this.parser_(n);(0,YL.isEmpty)(r)||(this.value.rawValue=this.constrainValue_(r)),this.view.refresh()},i.prototype.onInputKeyDown_=function(t){var e=(0,db.getStepForKey)(this.baseStep_,(0,db.getVerticalStepKeys)(t));e!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})},i.prototype.onInputKeyUp_=function(t){var e=(0,db.getStepForKey)(this.baseStep_,(0,db.getVerticalStepKeys)(t));e!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},i.prototype.onPointerDown_=function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0},i.prototype.computeDraggingValue_=function(t){if(!t.point)return null;var e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))},i.prototype.onPointerMove_=function(t){var e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)},i.prototype.onPointerUp_=function(t){var e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)},i}();lu.NumberTextController=ZYt;var m_={},g_={};Object.defineProperty(g_,"__esModule",{value:!0});g_.SliderView=void 0;var KL=Ai,JYt=Wn,FS=(0,JYt.ClassName)("sld"),QYt=function(){function i(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(FS()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("div");n.classList.add(FS("t")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;var r=t.createElement("div");r.classList.add(FS("k")),this.trackElement.appendChild(r),this.knobElement=r,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}return i.prototype.update_=function(){var t=(0,KL.constrainRange)((0,KL.mapRange)(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width="".concat(t,"%")},i.prototype.onChange_=function(){this.update_()},i}();g_.SliderView=QYt;Object.defineProperty(m_,"__esModule",{value:!0});m_.SliderController=void 0;var ZL=Ai,pb=bs,t7t=El,e7t=g_,n7t=function(){function i(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new e7t.SliderView(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new t7t.PointerHandler(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return i.prototype.handlePointerEvent_=function(t,e){t.point&&this.value.setRawValue((0,ZL.mapRange)((0,ZL.constrainRange)(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)},i.prototype.onPointerDownOrMove_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})},i.prototype.onKeyDown_=function(t){var e=(0,pb.getStepForKey)(this.baseStep_,(0,pb.getHorizontalStepKeys)(t));e!==0&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})},i.prototype.onKeyUp_=function(t){var e=(0,pb.getStepForKey)(this.baseStep_,(0,pb.getHorizontalStepKeys)(t));e!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},i}();m_.SliderController=n7t;var v_={},__={};Object.defineProperty(__,"__esModule",{value:!0});__.SliderTextView=void 0;var i7t=Wn,VS=(0,i7t.ClassName)("sldtxt"),r7t=function(){function i(t,e){this.element=t.createElement("div"),this.element.classList.add(VS());var n=t.createElement("div");n.classList.add(VS("s")),this.sliderView_=e.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);var r=t.createElement("div");r.classList.add(VS("t")),this.textView_=e.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)}return i}();__.SliderTextView=r7t;Object.defineProperty(v_,"__esModule",{value:!0});v_.SliderTextController=void 0;var s7t=__,o7t=lu,a7t=m_,l7t=function(){function i(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new a7t.SliderController(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new o7t.NumberTextController(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new s7t.SliderTextView(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return Object.defineProperty(i.prototype,"sliderController",{get:function(){return this.sliderC_},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),i}();v_.SliderTextController=l7t;var wF={};Object.defineProperty(wF,"__esModule",{value:!0});var SF={};Object.defineProperty(SF,"__esModule",{value:!0});var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});Mh.writePrimitive=void 0;function c7t(i,t){i.write(t)}Mh.writePrimitive=c7t;var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.getSuitableDraggingScale=Oi.getBaseStep=Oi.getSuitableDecimalDigits=Oi.createListConstraint=Oi.normalizeListOptions=Oi.parsePointDimensionParams=Oi.parsePickerLayout=Oi.parseListOptions=void 0;var JL=pn,aA=xl,u7t=Sh,lA=am,QL=Ai,MF=qr;function h7t(i){var t=MF.ParamsParsers;if(Array.isArray(i))return t.required.array(t.required.object({text:t.required.string,value:t.required.raw}))(i).value;if(typeof i=="object")return t.required.raw(i).value}Oi.parseListOptions=h7t;function d7t(i){if(i==="inline"||i==="popup")return i}Oi.parsePickerLayout=d7t;function p7t(i){var t=MF.ParamsParsers;return t.required.object({max:t.optional.number,min:t.optional.number,step:t.optional.number})(i).value}Oi.parsePointDimensionParams=p7t;function CF(i){if(Array.isArray(i))return i;var t=[];return Object.keys(i).forEach(function(e){t.push({text:e,value:i[e]})}),t}Oi.normalizeListOptions=CF;function f7t(i){return(0,JL.isEmpty)(i)?null:new u7t.ListConstraint(CF((0,JL.forceCast)(i)))}Oi.createListConstraint=f7t;function m7t(i){var t=i?(0,aA.findConstraint)(i,lA.StepConstraint):null;return t?t.step:null}function g7t(i,t){var e=i&&(0,aA.findConstraint)(i,lA.StepConstraint);return e?(0,QL.getDecimalDigits)(e.step):Math.max((0,QL.getDecimalDigits)(t),2)}Oi.getSuitableDecimalDigits=g7t;function v7t(i){var t=m7t(i);return t??1}Oi.getBaseStep=v7t;function _7t(i,t){var e,n=i&&(0,aA.findConstraint)(i,lA.StepConstraint),r=Math.abs((e=n==null?void 0:n.step)!==null&&e!==void 0?e:t);return r===0?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}Oi.getSuitableDraggingScale=_7t;var b_={},Qx={};Object.defineProperty(Qx,"__esModule",{value:!0});Qx.CheckboxView=void 0;var b7t=Ts,y7t=Wn,fb=(0,y7t.ClassName)("ckb"),x7t=function(){function i(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(fb()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("label");n.classList.add(fb("l")),this.element.appendChild(n);var r=t.createElement("input");r.classList.add(fb("i")),r.type="checkbox",n.appendChild(r),this.inputElement=r,e.viewProps.bindDisabled(this.inputElement);var s=t.createElement("div");s.classList.add(fb("w")),n.appendChild(s);var o=(0,b7t.createSvgIconElement)(t,"check");s.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}return i.prototype.update_=function(){this.inputElement.checked=this.value.rawValue},i.prototype.onValueChange_=function(){this.update_()},i}();Qx.CheckboxView=x7t;Object.defineProperty(b_,"__esModule",{value:!0});b_.CheckboxController=void 0;var w7t=pn,S7t=Qx,M7t=function(){function i(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new S7t.CheckboxView(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return i.prototype.onInputChange_=function(t){var e=(0,w7t.forceCast)(t.currentTarget);this.value.rawValue=e.checked},i}();b_.CheckboxController=M7t;var y_={};Object.defineProperty(y_,"__esModule",{value:!0});y_.BooleanInputPlugin=void 0;var EF=xl,C7t=Sh,E7t=Qd,T7t=Zl,A7t=Pi,tO=qr,P7t=Mh,TF=Oi,R7t=b_;function k7t(i){var t=[],e=(0,TF.createListConstraint)(i.options);return e&&t.push(e),new EF.CompositeConstraint(t)}y_.BooleanInputPlugin={id:"input-bool",type:"input",accept:function(i,t){if(typeof i!="boolean")return null;var e=tO.ParamsParsers,n=(0,tO.parseParams)(t,{options:e.optional.custom(TF.parseListOptions)});return n?{initialValue:i,params:n}:null},binding:{reader:function(i){return T7t.boolFromUnknown},constraint:function(i){return k7t(i.params)},writer:function(i){return P7t.writePrimitive}},controller:function(i){var t=i.document,e=i.value,n=i.constraint,r=n&&(0,EF.findConstraint)(n,C7t.ListConstraint);return r?new E7t.ListController(t,{props:new A7t.ValueMap({options:r.values.value("options")}),value:e,viewProps:i.viewProps}):new R7t.CheckboxController(t,{value:e,viewProps:i.viewProps})}};var tp={},tw={};Object.defineProperty(tw,"__esModule",{value:!0});tw.ColorView=void 0;var L7t=ss,O7t=Wn,D7t=Vo,td=(0,O7t.ClassName)("col"),I7t=function(){function i(t,e){this.element=t.createElement("div"),this.element.classList.add(td()),e.foldable.bindExpandedClass(this.element,td(void 0,"expanded")),(0,L7t.bindValueMap)(e.foldable,"completed",(0,D7t.valueToClassName)(this.element,td(void 0,"cpl")));var n=t.createElement("div");n.classList.add(td("h")),this.element.appendChild(n);var r=t.createElement("div");r.classList.add(td("s")),n.appendChild(r),this.swatchElement=r;var s=t.createElement("div");if(s.classList.add(td("t")),n.appendChild(s),this.textElement=s,e.pickerLayout==="inline"){var o=t.createElement("div");o.classList.add(td("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}return i}();tw.ColorView=I7t;var ew={},qs={},ur={};Object.defineProperty(ur,"__esModule",{value:!0});ur.convertColor=ur.constrainColorComponents=ur.getColorMaxComponents=ur.appendAlphaComponent=ur.removeAlphaComponent=ur.hsvToHslInt=ur.hslToHsvInt=ur.hsvToRgbInt=void 0;var Fs=Ai;function N7t(i,t,e){var n=(0,Fs.constrainRange)(i/255,0,1),r=(0,Fs.constrainRange)(t/255,0,1),s=(0,Fs.constrainRange)(e/255,0,1),o=Math.max(n,r,s),a=Math.min(n,r,s),l=o-a,c=0,u=0,h=(a+o)/2;return l!==0&&(u=l/(1-Math.abs(o+a-1)),n===o?c=(r-s)/l:r===o?c=2+(s-n)/l:c=4+(n-r)/l,c=c/6+(c<0?1:0)),[c*360,u*100,h*100]}function z7t(i,t,e){var n,r,s,o,a,l,c=(i%360+360)%360,u=(0,Fs.constrainRange)(t/100,0,1),h=(0,Fs.constrainRange)(e/100,0,1),p=(1-Math.abs(2*h-1))*u,m=p*(1-Math.abs(c/60%2-1)),v=h-p/2,_,b,y;return c>=0&&c<60?(n=[p,m,0],_=n[0],b=n[1],y=n[2]):c>=60&&c<120?(r=[m,p,0],_=r[0],b=r[1],y=r[2]):c>=120&&c<180?(s=[0,p,m],_=s[0],b=s[1],y=s[2]):c>=180&&c<240?(o=[0,m,p],_=o[0],b=o[1],y=o[2]):c>=240&&c<300?(a=[m,0,p],_=a[0],b=a[1],y=a[2]):(l=[p,0,m],_=l[0],b=l[1],y=l[2]),[(_+v)*255,(b+v)*255,(y+v)*255]}function U7t(i,t,e){var n=(0,Fs.constrainRange)(i/255,0,1),r=(0,Fs.constrainRange)(t/255,0,1),s=(0,Fs.constrainRange)(e/255,0,1),o=Math.max(n,r,s),a=Math.min(n,r,s),l=o-a,c;l===0?c=0:o===n?c=60*(((r-s)/l%6+6)%6):o===r?c=60*((s-n)/l+2):c=60*((n-r)/l+4);var u=o===0?0:l/o,h=o;return[c,u*100,h*100]}function AF(i,t,e){var n,r,s,o,a,l,c=(0,Fs.loopRange)(i,360),u=(0,Fs.constrainRange)(t/100,0,1),h=(0,Fs.constrainRange)(e/100,0,1),p=h*u,m=p*(1-Math.abs(c/60%2-1)),v=h-p,_,b,y;return c>=0&&c<60?(n=[p,m,0],_=n[0],b=n[1],y=n[2]):c>=60&&c<120?(r=[m,p,0],_=r[0],b=r[1],y=r[2]):c>=120&&c<180?(s=[0,p,m],_=s[0],b=s[1],y=s[2]):c>=180&&c<240?(o=[0,m,p],_=o[0],b=o[1],y=o[2]):c>=240&&c<300?(a=[m,0,p],_=a[0],b=a[1],y=a[2]):(l=[p,0,m],_=l[0],b=l[1],y=l[2]),[(_+v)*255,(b+v)*255,(y+v)*255]}ur.hsvToRgbInt=AF;function PF(i,t,e){var n=e+t*(100-Math.abs(2*e-100))/200;return[i,n!==0?t*(100-Math.abs(2*e-100))/n:0,e+t*(100-Math.abs(2*e-100))/(2*100)]}ur.hslToHsvInt=PF;function RF(i,t,e){var n=100-Math.abs(e*(200-t)/100-100);return[i,n!==0?t*e/n:0,e*(200-t)/(2*100)]}ur.hsvToHslInt=RF;function F7t(i){return[i[0],i[1],i[2]]}ur.removeAlphaComponent=F7t;function V7t(i,t){return[i[0],i[1],i[2],t]}ur.appendAlphaComponent=V7t;var B7t={hsl:{hsl:function(i,t,e){return[i,t,e]},hsv:PF,rgb:z7t},hsv:{hsl:RF,hsv:function(i,t,e){return[i,t,e]},rgb:AF},rgb:{hsl:N7t,hsv:U7t,rgb:function(i,t,e){return[i,t,e]}}};function vy(i,t){return[t==="float"?1:i==="rgb"?255:360,t==="float"?1:i==="rgb"?255:100,t==="float"?1:i==="rgb"?255:100]}ur.getColorMaxComponents=vy;function H7t(i,t){return i===t?t:(0,Fs.loopRange)(i,t)}function $7t(i,t,e){var n,r=vy(t,e);return[t==="rgb"?(0,Fs.constrainRange)(i[0],0,r[0]):H7t(i[0],r[0]),(0,Fs.constrainRange)(i[1],0,r[1]),(0,Fs.constrainRange)(i[2],0,r[2]),(0,Fs.constrainRange)((n=i[3])!==null&&n!==void 0?n:1,0,1)]}ur.constrainColorComponents=$7t;function eO(i,t,e,n){var r=vy(t,e),s=vy(t,n);return i.map(function(o,a){return o/r[a]*s[a]})}function G7t(i,t,e){var n,r=eO(i,t.mode,t.type,"int"),s=(n=B7t[t.mode])[e.mode].apply(n,r);return eO(s,e.mode,"int",e.type)}ur.convertColor=G7t;Object.defineProperty(qs,"__esModule",{value:!0});qs.Color=void 0;var q7t=pn,mb=ur;function gb(i,t){return typeof i!="object"||(0,q7t.isEmpty)(i)?!1:t in i&&typeof i[t]=="number"}var W7t=function(){function i(t,e,n){n===void 0&&(n="int"),this.mode=e,this.type=n,this.comps_=(0,mb.constrainColorComponents)(t,e,n)}return i.black=function(t){return t===void 0&&(t="int"),new i([0,0,0],"rgb",t)},i.fromObject=function(t,e){e===void 0&&(e="int");var n="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new i(n,"rgb",e)},i.toRgbaObject=function(t,e){return e===void 0&&(e="int"),t.toRgbaObject(e)},i.isRgbColorObject=function(t){return gb(t,"r")&&gb(t,"g")&&gb(t,"b")},i.isRgbaColorObject=function(t){return this.isRgbColorObject(t)&&gb(t,"a")},i.isColorObject=function(t){return this.isRgbColorObject(t)},i.equals=function(t,e){if(t.mode!==e.mode)return!1;for(var n=t.comps_,r=e.comps_,s=0;s<n.length;s++)if(n[s]!==r[s])return!1;return!0},i.prototype.getComponents=function(t,e){return e===void 0&&(e="int"),(0,mb.appendAlphaComponent)((0,mb.convertColor)((0,mb.removeAlphaComponent)(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:e}),this.comps_[3])},i.prototype.toRgbaObject=function(t){t===void 0&&(t="int");var e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}},i}();qs.Color=W7t;var nw={},j7t=zt&&zt.__spreadArray||function(i,t,e){if(e||arguments.length===2)for(var n=0,r=t.length,s;n<r;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return i.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(nw,"__esModule",{value:!0});nw.ColorPickerView=void 0;var X7t=Wn,Ou=(0,X7t.ClassName)("colp"),Y7t=function(){function i(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(Ou()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("div");n.classList.add(Ou("hsv"));var r=t.createElement("div");r.classList.add(Ou("sv")),this.svPaletteView_=e.svPaletteView,r.appendChild(this.svPaletteView_.element),n.appendChild(r);var s=t.createElement("div");s.classList.add(Ou("h")),this.hPaletteView_=e.hPaletteView,s.appendChild(this.hPaletteView_.element),n.appendChild(s),this.element.appendChild(n);var o=t.createElement("div");if(o.classList.add(Ou("rgb")),this.textView_=e.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};var a=t.createElement("div");a.classList.add(Ou("a"));var l=t.createElement("div");l.classList.add(Ou("ap")),l.appendChild(this.alphaViews_.palette.element),a.appendChild(l);var c=t.createElement("div");c.classList.add(Ou("at")),c.appendChild(this.alphaViews_.text.element),a.appendChild(c),this.element.appendChild(a)}}return Object.defineProperty(i.prototype,"allFocusableElements",{get:function(){var t=j7t([this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement],this.textView_.textViews.map(function(e){return e.inputElement}),!0);return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t},enumerable:!1,configurable:!0}),i}();nw.ColorPickerView=Y7t;var iw={},Io={};Object.defineProperty(Io,"__esModule",{value:!0});Io.extractColorType=Io.getBaseStepForColor=Io.parseColorInputParams=void 0;var nO=qr,K7t=Oi;function Z7t(i){return i==="int"?"int":i==="float"?"float":void 0}function J7t(i){var t=nO.ParamsParsers;return(0,nO.parseParams)(i,{alpha:t.optional.boolean,color:t.optional.object({alpha:t.optional.boolean,type:t.optional.custom(Z7t)}),expanded:t.optional.boolean,picker:t.optional.custom(K7t.parsePickerLayout)})}Io.parseColorInputParams=J7t;function Q7t(i){return i?.1:1}Io.getBaseStepForColor=Q7t;function tKt(i){var t;return(t=i.color)===null||t===void 0?void 0:t.type}Io.extractColorType=tKt;var rw={},cu={};(function(i){var t=zt&&zt.__assign||function(){return t=Object.assign||function(ot){for(var st,_t=1,$=arguments.length;_t<$;_t++){st=arguments[_t];for(var B in st)Object.prototype.hasOwnProperty.call(st,B)&&(ot[B]=st[B])}return ot},t.apply(this,arguments)},e=zt&&zt.__spreadArray||function(ot,st,_t){if(_t||arguments.length===2)for(var $=0,B=st.length,Lt;$<B;$++)(Lt||!($ in st))&&(Lt||(Lt=Array.prototype.slice.call(st,0,$)),Lt[$]=st[$]);return ot.concat(Lt||Array.prototype.slice.call(st))};Object.defineProperty(i,"__esModule",{value:!0}),i.findColorStringifier=i.getColorStringifier=i.colorToObjectRgbaString=i.colorToObjectRgbString=i.colorToFunctionalHslaString=i.colorToFunctionalHslString=i.colorToFunctionalRgbaString=i.colorToFunctionalRgbString=i.colorToHexRgbaString=i.colorToHexRgbString=i.colorFromString=i.hasAlphaComponent=i.createColorStringParser=i.createColorStringBindingReader=i.CompositeColorParser=i.detectStringColorFormat=i.getColorNotation=void 0;var n=ns,r=p_,s=Ai,o=qs,a=ur;function l(ot,st){return ot.alpha===st.alpha&&ot.mode===st.mode&&ot.notation===st.notation&&ot.type===st.type}function c(ot,st){var _t=ot.match(/^(.+)%$/);return Math.min(_t?parseFloat(_t[1])*.01*st:parseFloat(ot),st)}var u={deg:function(ot){return ot},grad:function(ot){return ot*360/400},rad:function(ot){return ot*360/(2*Math.PI)},turn:function(ot){return ot*360}};function h(ot){var st=ot.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!st)return parseFloat(ot);var _t=parseFloat(st[1]),$=st[2];return u[$](_t)}function p(ot){var st=ot.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!st)return null;var _t=[c(st[1],255),c(st[2],255),c(st[3],255)];return isNaN(_t[0])||isNaN(_t[1])||isNaN(_t[2])?null:_t}function m(ot){return function(st){var _t=p(st);return _t?new o.Color(_t,"rgb",ot):null}}function v(ot){var st=ot.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!st)return null;var _t=[c(st[1],255),c(st[2],255),c(st[3],255),c(st[4],1)];return isNaN(_t[0])||isNaN(_t[1])||isNaN(_t[2])||isNaN(_t[3])?null:_t}function _(ot){return function(st){var _t=v(st);return _t?new o.Color(_t,"rgb",ot):null}}function b(ot){var st=ot.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!st)return null;var _t=[h(st[1]),c(st[2],100),c(st[3],100)];return isNaN(_t[0])||isNaN(_t[1])||isNaN(_t[2])?null:_t}function y(ot){return function(st){var _t=b(st);return _t?new o.Color(_t,"hsl",ot):null}}function M(ot){var st=ot.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!st)return null;var _t=[h(st[1]),c(st[2],100),c(st[3],100),c(st[4],1)];return isNaN(_t[0])||isNaN(_t[1])||isNaN(_t[2])||isNaN(_t[3])?null:_t}function S(ot){return function(st){var _t=M(st);return _t?new o.Color(_t,"hsl",ot):null}}function E(ot){var st=ot.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(st)return[parseInt(st[1]+st[1],16),parseInt(st[2]+st[2],16),parseInt(st[3]+st[3],16)];var _t=ot.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return _t?[parseInt(_t[1],16),parseInt(_t[2],16),parseInt(_t[3],16)]:null}function A(ot){var st=E(ot);return st?new o.Color(st,"rgb","int"):null}function R(ot){var st=ot.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(st)return[parseInt(st[1]+st[1],16),parseInt(st[2]+st[2],16),parseInt(st[3]+st[3],16),(0,s.mapRange)(parseInt(st[4]+st[4],16),0,255,0,1)];var _t=ot.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return _t?[parseInt(_t[1],16),parseInt(_t[2],16),parseInt(_t[3],16),(0,s.mapRange)(parseInt(_t[4],16),0,255,0,1)]:null}function O(ot){var st=R(ot);return st?new o.Color(st,"rgb","int"):null}function L(ot){var st=ot.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!st)return null;var _t=[parseFloat(st[1]),parseFloat(st[2]),parseFloat(st[3])];return isNaN(_t[0])||isNaN(_t[1])||isNaN(_t[2])?null:_t}function P(ot){return function(st){var _t=L(st);return _t?new o.Color(_t,"rgb",ot):null}}function D(ot){var st=ot.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!st)return null;var _t=[parseFloat(st[1]),parseFloat(st[2]),parseFloat(st[3]),parseFloat(st[4])];return isNaN(_t[0])||isNaN(_t[1])||isNaN(_t[2])||isNaN(_t[3])?null:_t}function V(ot){return function(st){var _t=D(st);return _t?new o.Color(_t,"rgb",ot):null}}var K={"func.rgb":m("int"),"func.rgba":_("int"),"func.hsl":y("int"),"func.hsla":S("int"),"hex.rgb":A,"hex.rgba":O};function W(ot){var st=Object.keys(K);return st.reduce(function(_t,$){if(_t)return _t;var B=K[$];return B(ot)?$:null},null)}i.getColorNotation=W;var Z=[{parser:E,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:R,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:p,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:v,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:b,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:M,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:L,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:D,result:{alpha:!0,mode:"rgb",notation:"object"}}];function z(ot){return Z.reduce(function(st,_t){var $=_t.parser,B=_t.result;return st||($(ot)?B:null)},null)}function ut(ot,st){st===void 0&&(st="int");var _t=z(ot);return _t?_t.notation==="hex"&&st!=="float"?t(t({},_t),{type:"int"}):_t.notation==="func"?t(t({},_t),{type:st}):null:null}i.detectStringColorFormat=ut;var nt=function(ot){var st=W(ot);return st?K[st](ot):null};i.CompositeColorParser=nt;var Q={int:[A,O,m("int"),_("int"),y("int"),S("int"),P("int"),V("int")],float:[m("float"),_("float"),y("float"),S("float"),P("float"),V("float")]};function St(ot){var st=Q[ot];return function(_t){if(typeof _t!="string")return o.Color.black(ot);var $=st.reduce(function(B,Lt){return B||Lt(_t)},null);return $??o.Color.black(ot)}}i.createColorStringBindingReader=St;function Pt(ot){var st=Q[ot];return function(_t){return st.reduce(function($,B){return $||B(_t)},null)}}i.createColorStringParser=Pt;function dt(ot){return ot==="func.hsla"||ot==="func.rgba"||ot==="hex.rgba"}i.hasAlphaComponent=dt;function Rt(ot){if(typeof ot=="string"){var st=(0,i.CompositeColorParser)(ot);if(st)return st}return o.Color.black()}i.colorFromString=Rt;function Jt(ot){var st=(0,s.constrainRange)(Math.floor(ot),0,255).toString(16);return st.length===1?"0".concat(st):st}function Bt(ot,st){st===void 0&&(st="#");var _t=(0,a.removeAlphaComponent)(ot.getComponents("rgb")).map(Jt).join("");return"".concat(st).concat(_t)}i.colorToHexRgbString=Bt;function Wt(ot,st){st===void 0&&(st="#");var _t=ot.getComponents("rgb"),$=[_t[0],_t[1],_t[2],_t[3]*255].map(Jt).join("");return"".concat(st).concat($)}i.colorToHexRgbaString=Wt;function be(ot,st){var _t=(0,n.createNumberFormatter)(st==="float"?2:0),$=(0,a.removeAlphaComponent)(ot.getComponents("rgb",st)).map(function(B){return _t(B)});return"rgb(".concat($.join(", "),")")}i.colorToFunctionalRgbString=be;function re(ot){return function(st){return be(st,ot)}}function It(ot,st){var _t=(0,n.createNumberFormatter)(2),$=(0,n.createNumberFormatter)(st==="float"?2:0),B=ot.getComponents("rgb",st).map(function(Lt,jt){var Kt=jt===3?_t:$;return Kt(Lt)});return"rgba(".concat(B.join(", "),")")}i.colorToFunctionalRgbaString=It;function ye(ot){return function(st){return It(st,ot)}}function ce(ot){var st=[(0,n.createNumberFormatter)(0),r.formatPercentage,r.formatPercentage],_t=(0,a.removeAlphaComponent)(ot.getComponents("hsl")).map(function($,B){return st[B]($)});return"hsl(".concat(_t.join(", "),")")}i.colorToFunctionalHslString=ce;function ne(ot){var st=[(0,n.createNumberFormatter)(0),r.formatPercentage,r.formatPercentage,(0,n.createNumberFormatter)(2)],_t=ot.getComponents("hsl").map(function($,B){return st[B]($)});return"hsla(".concat(_t.join(", "),")")}i.colorToFunctionalHslaString=ne;function Gt(ot,st){var _t=(0,n.createNumberFormatter)(st==="float"?2:0),$=["r","g","b"],B=(0,a.removeAlphaComponent)(ot.getComponents("rgb",st)).map(function(Lt,jt){return"".concat($[jt],": ").concat(_t(Lt))});return"{".concat(B.join(", "),"}")}i.colorToObjectRgbString=Gt;function J(ot){return function(st){return Gt(st,ot)}}function $t(ot,st){var _t=(0,n.createNumberFormatter)(2),$=(0,n.createNumberFormatter)(st==="float"?2:0),B=["r","g","b","a"],Lt=ot.getComponents("rgb",st).map(function(jt,Kt){var se=Kt===3?_t:$;return"".concat(B[Kt],": ").concat(se(jt))});return"{".concat(Lt.join(", "),"}")}i.colorToObjectRgbaString=$t;function et(ot){return function(st){return $t(st,ot)}}var ft={"func.hsl":ce,"func.hsla":ne,"func.rgb":be,"func.rgba":It,"hex.rgb":Bt,"hex.rgba":Wt};function kt(ot){return ft[ot]}i.getColorStringifier=kt;var Qt=e([{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Bt},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Wt},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:ce},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:ne}],["int","float"].reduce(function(ot,st){return e(e([],ot,!0),[{format:{alpha:!1,mode:"rgb",notation:"func",type:st},stringifier:re(st)},{format:{alpha:!0,mode:"rgb",notation:"func",type:st},stringifier:ye(st)},{format:{alpha:!1,mode:"rgb",notation:"object",type:st},stringifier:J(st)},{format:{alpha:!0,mode:"rgb",notation:"object",type:st},stringifier:et(st)}],!1)},[]),!0);function qt(ot){return Qt.reduce(function(st,_t){return st||(l(_t.format,ot)?_t.stringifier:null)},null)}i.findColorStringifier=qt})(cu);Object.defineProperty(rw,"__esModule",{value:!0});rw.APaletteView=void 0;var eKt=Ai,nKt=Wn,BS=cu,iO=qs,sg=(0,nKt.ClassName)("apl"),iKt=function(){function i(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(sg()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);var n=t.createElement("div");n.classList.add(sg("b")),this.element.appendChild(n);var r=t.createElement("div");r.classList.add(sg("c")),n.appendChild(r),this.colorElem_=r;var s=t.createElement("div");s.classList.add(sg("m")),this.element.appendChild(s),this.markerElem_=s;var o=t.createElement("div");o.classList.add(sg("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}return i.prototype.update_=function(){var t=this.value.rawValue,e=t.getComponents("rgb"),n=new iO.Color([e[0],e[1],e[2],0],"rgb"),r=new iO.Color([e[0],e[1],e[2],255],"rgb"),s=["to right",(0,BS.colorToFunctionalRgbaString)(n),(0,BS.colorToFunctionalRgbaString)(r)];this.colorElem_.style.background="linear-gradient(".concat(s.join(","),")"),this.previewElem_.style.backgroundColor=(0,BS.colorToFunctionalRgbaString)(t);var o=(0,eKt.mapRange)(e[3],0,1,0,100);this.markerElem_.style.left="".concat(o,"%")},i.prototype.onValueChange_=function(){this.update_()},i}();rw.APaletteView=iKt;Object.defineProperty(iw,"__esModule",{value:!0});iw.APaletteController=void 0;var vb=bs,rKt=El,rO=qs,sO=Io,sKt=rw,oKt=function(){function i(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new sKt.APaletteView(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new rKt.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return i.prototype.handlePointerEvent_=function(t,e){if(t.point){var n=t.point.x/t.bounds.width,r=this.value.rawValue,s=r.getComponents("hsv"),o=s[0],a=s[1],l=s[2];this.value.setRawValue(new rO.Color([o,a,l,n],"hsv"),e)}},i.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})},i.prototype.onKeyDown_=function(t){var e=(0,vb.getStepForKey)((0,sO.getBaseStepForColor)(!0),(0,vb.getHorizontalStepKeys)(t));if(e!==0){var n=this.value.rawValue,r=n.getComponents("hsv"),s=r[0],o=r[1],a=r[2],l=r[3];this.value.setRawValue(new rO.Color([s,o,a,l+e],"hsv"),{forceEmit:!1,last:!1})}},i.prototype.onKeyUp_=function(t){var e=(0,vb.getStepForKey)((0,sO.getBaseStepForColor)(!0),(0,vb.getHorizontalStepKeys)(t));e!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},i}();iw.APaletteController=oKt;var sw={},ow={};Object.defineProperty(ow,"__esModule",{value:!0});ow.ColorTextView=void 0;var oO=Ts,aKt=ss,lKt=Wn,Gp=(0,lKt.ClassName)("coltxt");function cKt(i){var t=i.createElement("select"),e=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return t.appendChild(e.reduce(function(n,r){var s=i.createElement("option");return s.textContent=r.text,s.value=r.value,n.appendChild(s),n},i.createDocumentFragment())),t}var uKt=function(){function i(t,e){var n=this;this.element=t.createElement("div"),this.element.classList.add(Gp()),e.viewProps.bindClassModifiers(this.element);var r=t.createElement("div");r.classList.add(Gp("m")),this.modeElem_=cKt(t),this.modeElem_.classList.add(Gp("ms")),r.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);var s=t.createElement("div");s.classList.add(Gp("mm")),s.appendChild((0,oO.createSvgIconElement)(t,"dropdown")),r.appendChild(s),this.element.appendChild(r);var o=t.createElement("div");o.classList.add(Gp("w")),this.element.appendChild(o),this.textsElem_=o,this.textViews_=e.textViews,this.applyTextViews_(),(0,aKt.bindValue)(e.colorMode,function(a){n.modeElem_.value=a})}return Object.defineProperty(i.prototype,"modeSelectElement",{get:function(){return this.modeElem_},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textViews",{get:function(){return this.textViews_},set:function(t){this.textViews_=t,this.applyTextViews_()},enumerable:!1,configurable:!0}),i.prototype.applyTextViews_=function(){var t=this;(0,oO.removeChildElements)(this.textsElem_);var e=this.element.ownerDocument;this.textViews_.forEach(function(n){var r=e.createElement("div");r.classList.add(Gp("c")),r.appendChild(n.element),t.textsElem_.appendChild(r)})},i}();ow.ColorTextView=uKt;Object.defineProperty(sw,"__esModule",{value:!0});sw.ColorTextController=void 0;var hKt=Jd,dKt=ns,pKt=Pi,fKt=au,kF=Gs,mKt=lu,gKt=qs,EC=ur,vKt=Io,_Kt=ow;function bKt(i){return(0,dKt.createNumberFormatter)(i==="float"?2:0)}function yKt(i,t,e){var n=(0,EC.getColorMaxComponents)(i,t)[e];return new hKt.DefiniteRangeConstraint({min:0,max:n})}function HS(i,t,e){return new mKt.NumberTextController(i,{arrayPosition:e===0?"fst":e===3-1?"lst":"mid",baseStep:(0,vKt.getBaseStepForColor)(!1),parser:t.parser,props:pKt.ValueMap.fromObject({draggingScale:t.colorType==="float"?.01:1,formatter:bKt(t.colorType)}),value:(0,kF.createValue)(0,{constraint:yKt(t.colorMode,t.colorType,e)}),viewProps:t.viewProps})}var xKt=function(){function i(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=(0,kF.createValue)(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new _Kt.ColorTextView(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return i.prototype.createComponentControllers_=function(t){var e=this,n={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},r=[HS(t,n,0),HS(t,n,1),HS(t,n,2)];return r.forEach(function(s,o){(0,fKt.connectValues)({primary:e.value,secondary:s.value,forward:function(a){return a.rawValue.getComponents(e.colorMode.rawValue,e.colorType_)[o]},backward:function(a,l){var c=e.colorMode.rawValue,u=a.rawValue.getComponents(c,e.colorType_);return u[o]=l.rawValue,new gKt.Color((0,EC.appendAlphaComponent)((0,EC.removeAlphaComponent)(u),u[3]),c,e.colorType_)}})}),r},i.prototype.onModeSelectChange_=function(t){var e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]},i}();sw.ColorTextController=xKt;var aw={},lw={};Object.defineProperty(lw,"__esModule",{value:!0});lw.HPaletteView=void 0;var wKt=Ai,SKt=Wn,MKt=cu,CKt=qs,$S=(0,SKt.ClassName)("hpl"),EKt=function(){function i(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add($S()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);var n=t.createElement("div");n.classList.add($S("c")),this.element.appendChild(n);var r=t.createElement("div");r.classList.add($S("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return i.prototype.update_=function(){var t=this.value.rawValue,e=t.getComponents("hsv")[0];this.markerElem_.style.backgroundColor=(0,MKt.colorToFunctionalRgbString)(new CKt.Color([e,100,100],"hsv"));var n=(0,wKt.mapRange)(e,0,360,0,100);this.markerElem_.style.left="".concat(n,"%")},i.prototype.onValueChange_=function(){this.update_()},i}();lw.HPaletteView=EKt;Object.defineProperty(aw,"__esModule",{value:!0});aw.HPaletteController=void 0;var aO=Ai,_b=bs,TKt=El,lO=qs,cO=Io,AKt=lw,PKt=function(){function i(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new AKt.HPaletteView(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new TKt.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return i.prototype.handlePointerEvent_=function(t,e){if(t.point){var n=(0,aO.mapRange)((0,aO.constrainRange)(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),r=this.value.rawValue,s=r.getComponents("hsv"),o=s[1],a=s[2],l=s[3];this.value.setRawValue(new lO.Color([n,o,a,l],"hsv"),e)}},i.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})},i.prototype.onKeyDown_=function(t){var e=(0,_b.getStepForKey)((0,cO.getBaseStepForColor)(!1),(0,_b.getHorizontalStepKeys)(t));if(e!==0){var n=this.value.rawValue,r=n.getComponents("hsv"),s=r[0],o=r[1],a=r[2],l=r[3];this.value.setRawValue(new lO.Color([s+e,o,a,l],"hsv"),{forceEmit:!1,last:!1})}},i.prototype.onKeyUp_=function(t){var e=(0,_b.getStepForKey)((0,cO.getBaseStepForColor)(!1),(0,_b.getHorizontalStepKeys)(t));e!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},i}();aw.HPaletteController=PKt;var cw={},uw={};Object.defineProperty(uw,"__esModule",{value:!0});uw.SvPaletteView=void 0;var RKt=Ts,bb=Ai,kKt=Wn,LKt=ur,GS=(0,kKt.ClassName)("svp"),uO=64,OKt=function(){function i(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(GS()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);var n=t.createElement("canvas");n.height=uO,n.width=uO,n.classList.add(GS("c")),this.element.appendChild(n),this.canvasElement=n;var r=t.createElement("div");r.classList.add(GS("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}return i.prototype.update_=function(){var t=(0,RKt.getCanvasContext)(this.canvasElement);if(t){for(var e=this.value.rawValue,n=e.getComponents("hsv"),r=this.canvasElement.width,s=this.canvasElement.height,o=t.getImageData(0,0,r,s),a=o.data,l=0;l<s;l++)for(var c=0;c<r;c++){var u=(0,bb.mapRange)(c,0,r,0,100),h=(0,bb.mapRange)(l,0,s,100,0),p=(0,LKt.hsvToRgbInt)(n[0],u,h),m=(l*r+c)*4;a[m]=p[0],a[m+1]=p[1],a[m+2]=p[2],a[m+3]=255}t.putImageData(o,0,0);var v=(0,bb.mapRange)(n[1],0,100,0,100);this.markerElem_.style.left="".concat(v,"%");var _=(0,bb.mapRange)(n[2],0,100,100,0);this.markerElem_.style.top="".concat(_,"%")}},i.prototype.onValueChange_=function(){this.update_()},i}();uw.SvPaletteView=OKt;Object.defineProperty(cw,"__esModule",{value:!0});cw.SvPaletteController=void 0;var hO=Ai,Fc=bs,DKt=El,dO=qs,pO=Io,IKt=uw,NKt=function(){function i(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new IKt.SvPaletteView(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new DKt.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return i.prototype.handlePointerEvent_=function(t,e){if(t.point){var n=(0,hO.mapRange)(t.point.x,0,t.bounds.width,0,100),r=(0,hO.mapRange)(t.point.y,0,t.bounds.height,100,0),s=this.value.rawValue.getComponents("hsv"),o=s[0],a=s[3];this.value.setRawValue(new dO.Color([o,n,r,a],"hsv"),e)}},i.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})},i.prototype.onKeyDown_=function(t){(0,Fc.isArrowKey)(t.key)&&t.preventDefault();var e=this.value.rawValue.getComponents("hsv"),n=e[0],r=e[1],s=e[2],o=e[3],a=(0,pO.getBaseStepForColor)(!1),l=(0,Fc.getStepForKey)(a,(0,Fc.getHorizontalStepKeys)(t)),c=(0,Fc.getStepForKey)(a,(0,Fc.getVerticalStepKeys)(t));l===0&&c===0||this.value.setRawValue(new dO.Color([n,r+l,s+c,o],"hsv"),{forceEmit:!1,last:!1})},i.prototype.onKeyUp_=function(t){var e=(0,pO.getBaseStepForColor)(!1),n=(0,Fc.getStepForKey)(e,(0,Fc.getHorizontalStepKeys)(t)),r=(0,Fc.getStepForKey)(e,(0,Fc.getVerticalStepKeys)(t));n===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},i}();cw.SvPaletteController=NKt;Object.defineProperty(ew,"__esModule",{value:!0});ew.ColorPickerController=void 0;var zKt=Jd,qS=ns,UKt=Pi,FKt=au,VKt=Gs,BKt=lu,HKt=qs,$Kt=nw,GKt=iw,qKt=sw,WKt=aw,jKt=cw,XKt=function(){function i(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new WKt.HPaletteController(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new jKt.SvPaletteController(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new GKt.APaletteController(t,{value:this.value,viewProps:this.viewProps}),text:new BKt.NumberTextController(t,{parser:qS.parseNumber,baseStep:.1,props:UKt.ValueMap.fromObject({draggingScale:.01,formatter:(0,qS.createNumberFormatter)(2)}),value:(0,VKt.createValue)(0,{constraint:new zKt.DefiniteRangeConstraint({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&(0,FKt.connectValues)({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(n){return n.rawValue.getComponents()[3]},backward:function(n,r){var s=n.rawValue.getComponents();return s[3]=r.rawValue,new HKt.Color(s,n.rawValue.mode)}}),this.textC_=new qKt.ColorTextController(t,{colorType:e.colorType,parser:qS.parseNumber,value:this.value,viewProps:this.viewProps}),this.view=new $Kt.ColorPickerView(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}return Object.defineProperty(i.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),i}();ew.ColorPickerController=XKt;var hw={},dw={};Object.defineProperty(dw,"__esModule",{value:!0});dw.ColorSwatchView=void 0;var YKt=Wn,KKt=cu,WS=(0,YKt.ClassName)("colsw"),ZKt=function(){function i(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(WS()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("div");n.classList.add(WS("sw")),this.element.appendChild(n),this.swatchElem_=n;var r=t.createElement("button");r.classList.add(WS("b")),e.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}return i.prototype.update_=function(){var t=this.value.rawValue;this.swatchElem_.style.backgroundColor=(0,KKt.colorToHexRgbaString)(t)},i.prototype.onValueChange_=function(){this.update_()},i}();dw.ColorSwatchView=ZKt;Object.defineProperty(hw,"__esModule",{value:!0});hw.ColorSwatchController=void 0;var JKt=dw,QKt=function(){function i(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new JKt.ColorSwatchView(t,{value:this.value,viewProps:this.viewProps})}return i}();hw.ColorSwatchController=QKt;Object.defineProperty(tp,"__esModule",{value:!0});tp.ColorController=void 0;var fO=oo,tZt=lm,eZt=cm,mO=Ts,nZt=Pi,iZt=au,rZt=pn,sZt=tw,oZt=ew,aZt=hw,lZt=function(){function i(t,e){var n=this;this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=fO.Foldable.create(e.expanded),this.swatchC_=new aZt.ColorSwatchController(t,{value:this.value,viewProps:this.viewProps});var r=this.swatchC_.view.buttonElement;r.addEventListener("blur",this.onButtonBlur_),r.addEventListener("click",this.onButtonClick_),this.textC_=new eZt.TextController(t,{parser:e.parser,props:nZt.ValueMap.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new sZt.ColorView(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=e.pickerLayout==="popup"?new tZt.PopupController(t,{viewProps:this.viewProps}):null;var s=new oZt.ColorPickerController(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(function(o){o.addEventListener("blur",n.onPopupChildBlur_),o.addEventListener("keydown",n.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),(0,iZt.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(o){return o.rawValue},backward:function(o,a){return a.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,fO.bindFoldable)(this.foldable_,this.view.pickerElement))}return Object.defineProperty(i.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),i.prototype.onButtonBlur_=function(t){if(this.popC_){var e=this.view.element,n=(0,rZt.forceCast)(t.relatedTarget);(!n||!e.contains(n))&&(this.popC_.shows.rawValue=!1)}},i.prototype.onButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},i.prototype.onPopupChildBlur_=function(t){if(this.popC_){var e=this.popC_.view.element,n=(0,mO.findNextTarget)(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!(0,mO.supportsTouch)(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}},i.prototype.onPopupChildKeydown_=function(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.swatchC_.view.buttonElement.focus()},i}();tp.ColorController=lZt;var ts={};Object.defineProperty(ts,"__esModule",{value:!0});ts.colorFromRgbaNumber=ts.colorFromRgbNumber=ts.numberToRgbaColor=ts.numberToRgbColor=ts.colorToRgbaNumber=ts.colorToRgbNumber=ts.colorFromObject=void 0;var cZt=Ai,wd=qs,uZt=ur;function hZt(i,t){return wd.Color.isColorObject(i)?wd.Color.fromObject(i,t):wd.Color.black(t)}ts.colorFromObject=hZt;function dZt(i){return(0,uZt.removeAlphaComponent)(i.getComponents("rgb")).reduce(function(t,e){return t<<8|Math.floor(e)&255},0)}ts.colorToRgbNumber=dZt;function pZt(i){return i.getComponents("rgb").reduce(function(t,e,n){var r=Math.floor(n===3?e*255:e)&255;return t<<8|r},0)>>>0}ts.colorToRgbaNumber=pZt;function LF(i){return new wd.Color([i>>16&255,i>>8&255,i&255],"rgb")}ts.numberToRgbColor=LF;function OF(i){return new wd.Color([i>>24&255,i>>16&255,i>>8&255,(0,cZt.mapRange)(i&255,0,255,0,1)],"rgb")}ts.numberToRgbaColor=OF;function fZt(i){return typeof i!="number"?wd.Color.black():LF(i)}ts.colorFromRgbNumber=fZt;function mZt(i){return typeof i!="number"?wd.Color.black():OF(i)}ts.colorFromRgbaNumber=mZt;var x_={},Lo={};Object.defineProperty(Lo,"__esModule",{value:!0});Lo.createColorObjectWriter=Lo.writeRgbColorObject=Lo.writeRgbaColorObject=Lo.createColorNumberWriter=Lo.createColorStringWriter=void 0;var DF=Mh,gO=ts,gZt=cu;function vZt(i){var t=(0,gZt.findColorStringifier)(i);return t?function(e,n){(0,DF.writePrimitive)(e,t(n))}:null}Lo.createColorStringWriter=vZt;function _Zt(i){var t=i?gO.colorToRgbaNumber:gO.colorToRgbNumber;return function(e,n){(0,DF.writePrimitive)(e,t(n))}}Lo.createColorNumberWriter=_Zt;function IF(i,t,e){var n=t.toRgbaObject(e);i.writeProperty("r",n.r),i.writeProperty("g",n.g),i.writeProperty("b",n.b),i.writeProperty("a",n.a)}Lo.writeRgbaColorObject=IF;function NF(i,t,e){var n=t.toRgbaObject(e);i.writeProperty("r",n.r),i.writeProperty("g",n.g),i.writeProperty("b",n.b)}Lo.writeRgbColorObject=NF;function bZt(i,t){return function(e,n){i?IF(e,n,t):NF(e,n,t)}}Lo.createColorObjectWriter=bZt;Object.defineProperty(x_,"__esModule",{value:!0});x_.NumberColorInputPlugin=void 0;var yZt=tp,vO=ts,TC=cu,xZt=Lo,wZt=qs,SZt=Io;function jS(i){var t;return!!(i!=null&&i.alpha||!((t=i==null?void 0:i.color)===null||t===void 0)&&t.alpha)}function MZt(i){return i?function(t){return(0,TC.colorToHexRgbaString)(t,"0x")}:function(t){return(0,TC.colorToHexRgbString)(t,"0x")}}function CZt(i){return"color"in i||"view"in i&&i.view==="color"}x_.NumberColorInputPlugin={id:"input-color-number",type:"input",accept:function(i,t){if(typeof i!="number"||!CZt(t))return null;var e=(0,SZt.parseColorInputParams)(t);return e?{initialValue:i,params:e}:null},binding:{reader:function(i){return jS(i.params)?vO.colorFromRgbaNumber:vO.colorFromRgbNumber},equals:wZt.Color.equals,writer:function(i){return(0,xZt.createColorNumberWriter)(jS(i.params))}},controller:function(i){var t=jS(i.params),e="expanded"in i.params?i.params.expanded:void 0,n="picker"in i.params?i.params.picker:void 0;return new yZt.ColorController(i.document,{colorType:"int",expanded:e??!1,formatter:MZt(t),parser:(0,TC.createColorStringParser)("int"),pickerLayout:n??"popup",supportsAlpha:t,value:i.value,viewProps:i.viewProps})}};var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.ObjectColorInputPlugin=void 0;var EZt=tp,TZt=ts,AC=cu,AZt=Lo,Hb=qs,yb=Io;function PZt(i){return Hb.Color.isRgbaColorObject(i)}function RZt(i){return function(t){return(0,TZt.colorFromObject)(t,i)}}function kZt(i,t){return function(e){return i?(0,AC.colorToObjectRgbaString)(e,t):(0,AC.colorToObjectRgbString)(e,t)}}w_.ObjectColorInputPlugin={id:"input-color-object",type:"input",accept:function(i,t){if(!Hb.Color.isColorObject(i))return null;var e=(0,yb.parseColorInputParams)(t);return e?{initialValue:i,params:e}:null},binding:{reader:function(i){return RZt((0,yb.extractColorType)(i.params))},equals:Hb.Color.equals,writer:function(i){return(0,AZt.createColorObjectWriter)(PZt(i.initialValue),(0,yb.extractColorType)(i.params))}},controller:function(i){var t,e=Hb.Color.isRgbaColorObject(i.initialValue),n="expanded"in i.params?i.params.expanded:void 0,r="picker"in i.params?i.params.picker:void 0,s=(t=(0,yb.extractColorType)(i.params))!==null&&t!==void 0?t:"int";return new EZt.ColorController(i.document,{colorType:s,expanded:n??!1,formatter:kZt(e,s),parser:(0,AC.createColorStringParser)(s),pickerLayout:r??"popup",supportsAlpha:e,value:i.value,viewProps:i.viewProps})}};var S_={};Object.defineProperty(S_,"__esModule",{value:!0});S_.StringColorInputPlugin=void 0;var xb=Go,LZt=tp,ed=cu,OZt=Lo,DZt=qs,og=Io;S_.StringColorInputPlugin={id:"input-color-string",type:"input",accept:function(i,t){if(typeof i!="string"||"view"in t&&t.view==="text")return null;var e=(0,ed.detectStringColorFormat)(i,(0,og.extractColorType)(t));if(!e)return null;var n=(0,ed.findColorStringifier)(e);if(!n)return null;var r=(0,og.parseColorInputParams)(t);return r?{initialValue:i,params:r}:null},binding:{reader:function(i){var t;return(0,ed.createColorStringBindingReader)((t=(0,og.extractColorType)(i.params))!==null&&t!==void 0?t:"int")},equals:DZt.Color.equals,writer:function(i){var t=(0,ed.detectStringColorFormat)(i.initialValue,(0,og.extractColorType)(i.params));if(!t)throw xb.TpError.shouldNeverHappen();var e=(0,OZt.createColorStringWriter)(t);if(!e)throw xb.TpError.notBindable();return e}},controller:function(i){var t=(0,ed.detectStringColorFormat)(i.initialValue,(0,og.extractColorType)(i.params));if(!t)throw xb.TpError.shouldNeverHappen();var e=(0,ed.findColorStringifier)(t);if(!e)throw xb.TpError.shouldNeverHappen();var n="expanded"in i.params?i.params.expanded:void 0,r="picker"in i.params?i.params.picker:void 0;return new LZt.ColorController(i.document,{colorType:t.type,expanded:n??!1,formatter:e,parser:(0,ed.createColorStringParser)(t.type),pickerLayout:r??"popup",supportsAlpha:t.alpha,value:i.value,viewProps:i.viewProps})}};var ep={};Object.defineProperty(ep,"__esModule",{value:!0});ep.PointNdConstraint=void 0;var IZt=function(){function i(t){this.components=t.components,this.asm_=t.assembly}return i.prototype.constrain=function(t){var e=this,n=this.asm_.toComponents(t).map(function(r,s){var o,a;return(a=(o=e.components[s])===null||o===void 0?void 0:o.constrain(r))!==null&&a!==void 0?a:r});return this.asm_.fromComponents(n)},i}();ep.PointNdConstraint=IZt;var np={},pw={};Object.defineProperty(pw,"__esModule",{value:!0});pw.PointNdTextView=void 0;var NZt=Wn,_O=(0,NZt.ClassName)("pndtxt"),zZt=function(){function i(t,e){var n=this;this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(_O()),this.textViews.forEach(function(r){var s=t.createElement("div");s.classList.add(_O("a")),s.appendChild(r.element),n.element.appendChild(s)})}return i}();pw.PointNdTextView=zZt;Object.defineProperty(np,"__esModule",{value:!0});np.PointNdTextController=void 0;var UZt=au,FZt=Gs,VZt=lu,BZt=pw;function HZt(i,t,e){return new VZt.NumberTextController(i,{arrayPosition:e===0?"fst":e===t.axes.length-1?"lst":"mid",baseStep:t.axes[e].baseStep,parser:t.parser,props:t.axes[e].textProps,value:(0,FZt.createValue)(0,{constraint:t.axes[e].constraint}),viewProps:t.viewProps})}var $Zt=function(){function i(t,e){var n=this;this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(function(r,s){return HZt(t,e,s)}),this.acs_.forEach(function(r,s){(0,UZt.connectValues)({primary:n.value,secondary:r.value,forward:function(o){return e.assembly.toComponents(o.rawValue)[s]},backward:function(o,a){var l=e.assembly.toComponents(o.rawValue);return l[s]=a.rawValue,e.assembly.fromComponents(l)}})}),this.view=new BZt.PointNdTextView(t,{textViews:this.acs_.map(function(r){return r.view})})}return i}();np.PointNdTextController=$Zt;var Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.NumberInputPlugin=Ba.findNumberRange=Ba.createRangeConstraint=Ba.createStepConstraint=void 0;var lv=xl,cA=Jd,GZt=Sh,zF=c_,qZt=am,WZt=Qd,wb=ns,Sb=Pi,jZt=lu,XZt=v_,bO=qr,YZt=Mh,ld=Oi,gg=pn;function UF(i,t){return"step"in i&&!(0,gg.isEmpty)(i.step)?new qZt.StepConstraint(i.step,t):null}Ba.createStepConstraint=UF;function FF(i){return!(0,gg.isEmpty)(i.max)&&!(0,gg.isEmpty)(i.min)?new cA.DefiniteRangeConstraint({max:i.max,min:i.min}):!(0,gg.isEmpty)(i.max)||!(0,gg.isEmpty)(i.min)?new zF.RangeConstraint({max:i.max,min:i.min}):null}Ba.createRangeConstraint=FF;function KZt(i){var t=(0,lv.findConstraint)(i,cA.DefiniteRangeConstraint);if(t)return[t.values.get("min"),t.values.get("max")];var e=(0,lv.findConstraint)(i,zF.RangeConstraint);return e?[e.minValue,e.maxValue]:[void 0,void 0]}Ba.findNumberRange=KZt;function ZZt(i,t){var e=[],n=UF(i,t);n&&e.push(n);var r=FF(i);r&&e.push(r);var s=(0,ld.createListConstraint)(i.options);return s&&e.push(s),new lv.CompositeConstraint(e)}Ba.NumberInputPlugin={id:"input-number",type:"input",accept:function(i,t){if(typeof i!="number")return null;var e=bO.ParamsParsers,n=(0,bO.parseParams)(t,{format:e.optional.function,max:e.optional.number,min:e.optional.number,options:e.optional.custom(ld.parseListOptions),step:e.optional.number});return n?{initialValue:i,params:n}:null},binding:{reader:function(i){return wb.numberFromUnknown},constraint:function(i){return ZZt(i.params,i.initialValue)},writer:function(i){return YZt.writePrimitive}},controller:function(i){var t,e=i.value,n=i.constraint,r=n&&(0,lv.findConstraint)(n,GZt.ListConstraint);if(r)return new WZt.ListController(i.document,{props:new Sb.ValueMap({options:r.values.value("options")}),value:e,viewProps:i.viewProps});var s=(t="format"in i.params?i.params.format:void 0)!==null&&t!==void 0?t:(0,wb.createNumberFormatter)((0,ld.getSuitableDecimalDigits)(n,e.rawValue)),o=n&&(0,lv.findConstraint)(n,cA.DefiniteRangeConstraint);return o?new XZt.SliderTextController(i.document,{baseStep:(0,ld.getBaseStep)(n),parser:wb.parseNumber,sliderProps:new Sb.ValueMap({maxValue:o.values.value("max"),minValue:o.values.value("min")}),textProps:Sb.ValueMap.fromObject({draggingScale:(0,ld.getSuitableDraggingScale)(n,e.rawValue),formatter:s}),value:e,viewProps:i.viewProps}):new jZt.NumberTextController(i.document,{baseStep:(0,ld.getBaseStep)(n),parser:wb.parseNumber,props:Sb.ValueMap.fromObject({draggingScale:(0,ld.getSuitableDraggingScale)(n,e.rawValue),formatter:s}),value:e,viewProps:i.viewProps})}};var M_={},tu={},JZt=zt&&zt.__spreadArray||function(i,t,e){if(e||arguments.length===2)for(var n=0,r=t.length,s;n<r;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return i.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(tu,"__esModule",{value:!0});tu.Point2dAssembly=tu.Point2d=void 0;var QZt=pn,PC=function(){function i(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=t,this.y=e}return i.prototype.getComponents=function(){return[this.x,this.y]},i.isObject=function(t){if((0,QZt.isEmpty)(t))return!1;var e=t.x,n=t.y;return!(typeof e!="number"||typeof n!="number")},i.equals=function(t,e){return t.x===e.x&&t.y===e.y},i.prototype.toObject=function(){return{x:this.x,y:this.y}},i}();tu.Point2d=PC;tu.Point2dAssembly={toComponents:function(i){return i.getComponents()},fromComponents:function(i){return new(PC.bind.apply(PC,JZt([void 0],i,!1)))}};var fw={};Object.defineProperty(fw,"__esModule",{value:!0});fw.Point2dView=void 0;var tJt=Ts,eJt=ss,nJt=Wn,iJt=Vo,qp=(0,nJt.ClassName)("p2d"),rJt=function(){function i(t,e){this.element=t.createElement("div"),this.element.classList.add(qp()),e.viewProps.bindClassModifiers(this.element),(0,eJt.bindValue)(e.expanded,(0,iJt.valueToClassName)(this.element,qp(void 0,"expanded")));var n=t.createElement("div");n.classList.add(qp("h")),this.element.appendChild(n);var r=t.createElement("button");r.classList.add(qp("b")),r.appendChild((0,tJt.createSvgIconElement)(t,"p2dpad")),e.viewProps.bindDisabled(r),n.appendChild(r),this.buttonElement=r;var s=t.createElement("div");if(s.classList.add(qp("t")),n.appendChild(s),this.textElement=s,e.pickerLayout==="inline"){var o=t.createElement("div");o.classList.add(qp("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}return i}();fw.Point2dView=rJt;var mw={},gw={};Object.defineProperty(gw,"__esModule",{value:!0});gw.Point2dPickerView=void 0;var Mb=Ts,yO=Ai,sJt=Wn,Du=(0,sJt.ClassName)("p2dp"),oJt=function(){function i(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Du()),e.layout==="popup"&&this.element.classList.add(Du(void 0,"p")),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("div");n.classList.add(Du("p")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;var r=t.createElementNS(Mb.SVG_NS,"svg");r.classList.add(Du("g")),this.padElement.appendChild(r),this.svgElem_=r;var s=t.createElementNS(Mb.SVG_NS,"line");s.classList.add(Du("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);var o=t.createElementNS(Mb.SVG_NS,"line");o.classList.add(Du("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);var a=t.createElementNS(Mb.SVG_NS,"line");a.classList.add(Du("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;var l=t.createElement("div");l.classList.add(Du("m")),this.padElement.appendChild(l),this.markerElem_=l,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}return Object.defineProperty(i.prototype,"allFocusableElements",{get:function(){return[this.padElement]},enumerable:!1,configurable:!0}),i.prototype.update_=function(){var t=this.value.rawValue.getComponents(),e=t[0],n=t[1],r=this.maxValue_,s=(0,yO.mapRange)(e,-r,+r,0,100),o=(0,yO.mapRange)(n,-r,+r,0,100),a=this.invertsY_?100-o:o;this.lineElem_.setAttributeNS(null,"x2","".concat(s,"%")),this.lineElem_.setAttributeNS(null,"y2","".concat(a,"%")),this.markerElem_.style.left="".concat(s,"%"),this.markerElem_.style.top="".concat(a,"%")},i.prototype.onValueChange_=function(){this.update_()},i.prototype.onFoldableChange_=function(){this.update_()},i}();gw.Point2dPickerView=oJt;Object.defineProperty(mw,"__esModule",{value:!0});mw.Point2dPickerController=void 0;var xO=Ai,vg=bs,aJt=El,wO=tu,lJt=gw;function SO(i,t,e){return[(0,vg.getStepForKey)(t[0],(0,vg.getHorizontalStepKeys)(i)),(0,vg.getStepForKey)(t[1],(0,vg.getVerticalStepKeys)(i))*(e?1:-1)]}var cJt=function(){function i(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new lJt.Point2dPickerView(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new aJt.PointerHandler(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return i.prototype.handlePointerEvent_=function(t,e){if(t.point){var n=this.maxValue_,r=(0,xO.mapRange)(t.point.x,0,t.bounds.width,-n,+n),s=(0,xO.mapRange)(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new wO.Point2d(r,s),e)}},i.prototype.onPointerDown_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerMove_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})},i.prototype.onPointerUp_=function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})},i.prototype.onPadKeyDown_=function(t){(0,vg.isArrowKey)(t.key)&&t.preventDefault();var e=SO(t,this.baseSteps_,this.invertsY_),n=e[0],r=e[1];n===0&&r===0||this.value.setRawValue(new wO.Point2d(this.value.rawValue.x+n,this.value.rawValue.y+r),{forceEmit:!1,last:!1})},i.prototype.onPadKeyUp_=function(t){var e=SO(t,this.baseSteps_,this.invertsY_),n=e[0],r=e[1];n===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},i}();mw.Point2dPickerController=cJt;Object.defineProperty(M_,"__esModule",{value:!0});M_.Point2dController=void 0;var MO=oo,uJt=lm,CO=Ts,hJt=au,dJt=pn,pJt=np,fJt=tu,mJt=fw,gJt=mw,vJt=function(){function i(t,e){var n=this,r,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=MO.Foldable.create(e.expanded),this.popC_=e.pickerLayout==="popup"?new uJt.PopupController(t,{viewProps:this.viewProps}):null;var o=new gJt.Point2dPickerController(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach(function(a){a.addEventListener("blur",n.onPopupChildBlur_),a.addEventListener("keydown",n.onPopupChildKeydown_)}),this.pickerC_=o,this.textC_=new pJt.PointNdTextController(t,{assembly:fJt.Point2dAssembly,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new mJt.Point2dView(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(r=this.view.buttonElement)===null||r===void 0||r.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),(0,hJt.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(a){return a.rawValue},backward:function(a,l){return l.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,MO.bindFoldable)(this.foldable_,this.view.pickerElement))}return i.prototype.onPadButtonBlur_=function(t){if(this.popC_){var e=this.view.element,n=(0,dJt.forceCast)(t.relatedTarget);(!n||!e.contains(n))&&(this.popC_.shows.rawValue=!1)}},i.prototype.onPadButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},i.prototype.onPopupChildBlur_=function(t){if(this.popC_){var e=this.popC_.view.element,n=(0,CO.findNextTarget)(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!(0,CO.supportsTouch)(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}},i.prototype.onPopupChildKeydown_=function(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.view.buttonElement.focus()},i}();M_.Point2dController=vJt;var Vc={},Pf={};Object.defineProperty(Pf,"__esModule",{value:!0});Pf.writePoint2d=Pf.point2dFromUnknown=void 0;var XS=tu;function _Jt(i){return XS.Point2d.isObject(i)?new XS.Point2d(i.x,i.y):new XS.Point2d}Pf.point2dFromUnknown=_Jt;function bJt(i,t){i.writeProperty("x",t.x),i.writeProperty("y",t.y)}Pf.writePoint2d=bJt;var EO;function vw(){if(EO)return Vc;EO=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.Point2dInputPlugin=Vc.getSuitableMaxValue=Vc.createDimensionConstraint=void 0;var i=xl,t=ns,e=Pi,n=qr,r=Go,s=Oi,o=XF(),a=ep,l=Ba,c=M_,u=Pf,h=tu;function p(M,S){if(M){var E=[],A=(0,l.createStepConstraint)(M,S);A&&E.push(A);var R=(0,l.createRangeConstraint)(M);return R&&E.push(R),new i.CompositeConstraint(E)}}Vc.createDimensionConstraint=p;function m(M,S){return new a.PointNdConstraint({assembly:h.Point2dAssembly,components:[p("x"in M?M.x:void 0,S.x),p("y"in M?M.y:void 0,S.y)]})}function v(M,S){var E=M?(0,l.findNumberRange)(M):[],A=E[0],R=E[1];if(!(0,o.isEmpty)(A)||!(0,o.isEmpty)(R))return Math.max(Math.abs(A??0),Math.abs(R??0));var O=(0,s.getBaseStep)(M);return Math.max(Math.abs(O)*10,Math.abs(S)*10)}function _(M,S){var E=S instanceof a.PointNdConstraint?S.components[0]:void 0,A=S instanceof a.PointNdConstraint?S.components[1]:void 0,R=v(E,M.x),O=v(A,M.y);return Math.max(R,O)}Vc.getSuitableMaxValue=_;function b(M,S){return{baseStep:(0,s.getBaseStep)(S),constraint:S,textProps:e.ValueMap.fromObject({draggingScale:(0,s.getSuitableDraggingScale)(S,M),formatter:(0,t.createNumberFormatter)((0,s.getSuitableDecimalDigits)(S,M))})}}function y(M){if(!("y"in M))return!1;var S=M.y;return S&&"inverted"in S?!!S.inverted:!1}return Vc.Point2dInputPlugin={id:"input-point2d",type:"input",accept:function(M,S){if(!h.Point2d.isObject(M))return null;var E=n.ParamsParsers,A=(0,n.parseParams)(S,{expanded:E.optional.boolean,picker:E.optional.custom(s.parsePickerLayout),x:E.optional.custom(s.parsePointDimensionParams),y:E.optional.object({inverted:E.optional.boolean,max:E.optional.number,min:E.optional.number,step:E.optional.number})});return A?{initialValue:M,params:A}:null},binding:{reader:function(M){return u.point2dFromUnknown},constraint:function(M){return m(M.params,M.initialValue)},equals:h.Point2d.equals,writer:function(M){return u.writePoint2d}},controller:function(M){var S=M.document,E=M.value,A=M.constraint;if(!(A instanceof a.PointNdConstraint))throw r.TpError.shouldNeverHappen();var R="expanded"in M.params?M.params.expanded:void 0,O="picker"in M.params?M.params.picker:void 0;return new c.Point2dController(S,{axes:[b(E.rawValue.x,A.components[0]),b(E.rawValue.y,A.components[1])],expanded:R??!1,invertsY:y(M.params),maxValue:_(E.rawValue,A),parser:t.parseNumber,pickerLayout:O??"popup",value:E,viewProps:M.viewProps})}},Vc}var ag={},Rf={},Dd={},yJt=zt&&zt.__spreadArray||function(i,t,e){if(e||arguments.length===2)for(var n=0,r=t.length,s;n<r;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return i.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(Dd,"__esModule",{value:!0});Dd.Point3dAssembly=Dd.Point3d=void 0;var xJt=pn,RC=function(){function i(t,e,n){t===void 0&&(t=0),e===void 0&&(e=0),n===void 0&&(n=0),this.x=t,this.y=e,this.z=n}return i.prototype.getComponents=function(){return[this.x,this.y,this.z]},i.isObject=function(t){if((0,xJt.isEmpty)(t))return!1;var e=t.x,n=t.y,r=t.z;return!(typeof e!="number"||typeof n!="number"||typeof r!="number")},i.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z},i.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z}},i}();Dd.Point3d=RC;Dd.Point3dAssembly={toComponents:function(i){return i.getComponents()},fromComponents:function(i){return new(RC.bind.apply(RC,yJt([void 0],i,!1)))}};Object.defineProperty(Rf,"__esModule",{value:!0});Rf.writePoint3d=Rf.point3dFromUnknown=void 0;var YS=Dd;function wJt(i){return YS.Point3d.isObject(i)?new YS.Point3d(i.x,i.y,i.z):new YS.Point3d}Rf.point3dFromUnknown=wJt;function SJt(i,t){i.writeProperty("x",t.x),i.writeProperty("y",t.y),i.writeProperty("z",t.z)}Rf.writePoint3d=SJt;var TO;function VF(){if(TO)return ag;TO=1,Object.defineProperty(ag,"__esModule",{value:!0}),ag.Point3dInputPlugin=void 0;var i=ns,t=Pi,e=qr,n=Go,r=Oi,s=ep,o=np,a=vw(),l=Rf,c=Dd;function u(p,m){return new s.PointNdConstraint({assembly:c.Point3dAssembly,components:[(0,a.createDimensionConstraint)("x"in p?p.x:void 0,m.x),(0,a.createDimensionConstraint)("y"in p?p.y:void 0,m.y),(0,a.createDimensionConstraint)("z"in p?p.z:void 0,m.z)]})}function h(p,m){return{baseStep:(0,r.getBaseStep)(m),constraint:m,textProps:t.ValueMap.fromObject({draggingScale:(0,r.getSuitableDraggingScale)(m,p),formatter:(0,i.createNumberFormatter)((0,r.getSuitableDecimalDigits)(m,p))})}}return ag.Point3dInputPlugin={id:"input-point3d",type:"input",accept:function(p,m){if(!c.Point3d.isObject(p))return null;var v=e.ParamsParsers,_=(0,e.parseParams)(m,{x:v.optional.custom(r.parsePointDimensionParams),y:v.optional.custom(r.parsePointDimensionParams),z:v.optional.custom(r.parsePointDimensionParams)});return _?{initialValue:p,params:_}:null},binding:{reader:function(p){return l.point3dFromUnknown},constraint:function(p){return u(p.params,p.initialValue)},equals:c.Point3d.equals,writer:function(p){return l.writePoint3d}},controller:function(p){var m=p.value,v=p.constraint;if(!(v instanceof s.PointNdConstraint))throw n.TpError.shouldNeverHappen();return new o.PointNdTextController(p.document,{assembly:c.Point3dAssembly,axes:[h(m.rawValue.x,v.components[0]),h(m.rawValue.y,v.components[1]),h(m.rawValue.z,v.components[2])],parser:i.parseNumber,value:m,viewProps:p.viewProps})}},ag}var lg={},kf={},Id={},MJt=zt&&zt.__spreadArray||function(i,t,e){if(e||arguments.length===2)for(var n=0,r=t.length,s;n<r;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return i.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(Id,"__esModule",{value:!0});Id.Point4dAssembly=Id.Point4d=void 0;var CJt=pn,kC=function(){function i(t,e,n,r){t===void 0&&(t=0),e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=0),this.x=t,this.y=e,this.z=n,this.w=r}return i.prototype.getComponents=function(){return[this.x,this.y,this.z,this.w]},i.isObject=function(t){if((0,CJt.isEmpty)(t))return!1;var e=t.x,n=t.y,r=t.z,s=t.w;return!(typeof e!="number"||typeof n!="number"||typeof r!="number"||typeof s!="number")},i.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w},i.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},i}();Id.Point4d=kC;Id.Point4dAssembly={toComponents:function(i){return i.getComponents()},fromComponents:function(i){return new(kC.bind.apply(kC,MJt([void 0],i,!1)))}};Object.defineProperty(kf,"__esModule",{value:!0});kf.writePoint4d=kf.point4dFromUnknown=void 0;var KS=Id;function EJt(i){return KS.Point4d.isObject(i)?new KS.Point4d(i.x,i.y,i.z,i.w):new KS.Point4d}kf.point4dFromUnknown=EJt;function TJt(i,t){i.writeProperty("x",t.x),i.writeProperty("y",t.y),i.writeProperty("z",t.z),i.writeProperty("w",t.w)}kf.writePoint4d=TJt;var AO;function BF(){if(AO)return lg;AO=1,Object.defineProperty(lg,"__esModule",{value:!0}),lg.Point4dInputPlugin=void 0;var i=ns,t=Pi,e=qr,n=Go,r=Oi,s=ep,o=np,a=vw(),l=kf,c=Id;function u(p,m){return new s.PointNdConstraint({assembly:c.Point4dAssembly,components:[(0,a.createDimensionConstraint)("x"in p?p.x:void 0,m.x),(0,a.createDimensionConstraint)("y"in p?p.y:void 0,m.y),(0,a.createDimensionConstraint)("z"in p?p.z:void 0,m.z),(0,a.createDimensionConstraint)("w"in p?p.w:void 0,m.w)]})}function h(p,m){return{baseStep:(0,r.getBaseStep)(m),constraint:m,textProps:t.ValueMap.fromObject({draggingScale:(0,r.getSuitableDraggingScale)(m,p),formatter:(0,i.createNumberFormatter)((0,r.getSuitableDecimalDigits)(m,p))})}}return lg.Point4dInputPlugin={id:"input-point4d",type:"input",accept:function(p,m){if(!c.Point4d.isObject(p))return null;var v=e.ParamsParsers,_=(0,e.parseParams)(m,{x:v.optional.custom(r.parsePointDimensionParams),y:v.optional.custom(r.parsePointDimensionParams),z:v.optional.custom(r.parsePointDimensionParams),w:v.optional.custom(r.parsePointDimensionParams)});return _?{initialValue:p,params:_}:null},binding:{reader:function(p){return l.point4dFromUnknown},constraint:function(p){return u(p.params,p.initialValue)},equals:c.Point4d.equals,writer:function(p){return l.writePoint4d}},controller:function(p){var m=p.value,v=p.constraint;if(!(v instanceof s.PointNdConstraint))throw n.TpError.shouldNeverHappen();return new o.PointNdTextController(p.document,{assembly:c.Point4dAssembly,axes:m.rawValue.getComponents().map(function(_,b){return h(_,v.components[b])}),parser:i.parseNumber,value:m,viewProps:p.viewProps})}},lg}var C_={};Object.defineProperty(C_,"__esModule",{value:!0});C_.StringInputPlugin=void 0;var HF=xl,AJt=Sh,PJt=Qd,RJt=cm,PO=lh,RO=Pi,kO=qr,kJt=Mh,$F=Oi;function LJt(i){var t=[],e=(0,$F.createListConstraint)(i.options);return e&&t.push(e),new HF.CompositeConstraint(t)}C_.StringInputPlugin={id:"input-string",type:"input",accept:function(i,t){if(typeof i!="string")return null;var e=kO.ParamsParsers,n=(0,kO.parseParams)(t,{options:e.optional.custom($F.parseListOptions)});return n?{initialValue:i,params:n}:null},binding:{reader:function(i){return PO.stringFromUnknown},constraint:function(i){return LJt(i.params)},writer:function(i){return kJt.writePrimitive}},controller:function(i){var t=i.document,e=i.value,n=i.constraint,r=n&&(0,HF.findConstraint)(n,AJt.ListConstraint);return r?new PJt.ListController(t,{props:new RO.ValueMap({options:r.values.value("options")}),value:e,viewProps:i.viewProps}):new RJt.TextController(t,{parser:function(s){return s},props:RO.ValueMap.fromObject({formatter:PO.formatString}),value:e,viewProps:i.viewProps})}};var Ch={};Object.defineProperty(Ch,"__esModule",{value:!0});Ch.Constants=void 0;Ch.Constants={monitor:{defaultInterval:200,defaultLineCount:3}};var E_={},ip={},_w={};Object.defineProperty(_w,"__esModule",{value:!0});_w.MultiLogView=void 0;var OJt=Wn,LO=(0,OJt.ClassName)("mll"),DJt=function(){function i(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(LO()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("textarea");n.classList.add(LO("i")),n.style.height="calc(var(--bld-us) * ".concat(e.lineCount,")"),n.readOnly=!0,e.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}return i.prototype.update_=function(){var t=this,e=this.textareaElem_,n=e.scrollTop===e.scrollHeight-e.clientHeight,r=[];this.value.rawValue.forEach(function(s){s!==void 0&&r.push(t.formatter_(s))}),e.textContent=r.join(`
`),n&&(e.scrollTop=e.scrollHeight)},i.prototype.onValueUpdate_=function(){this.update_()},i}();_w.MultiLogView=DJt;Object.defineProperty(ip,"__esModule",{value:!0});ip.MultiLogController=void 0;var IJt=_w,NJt=function(){function i(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new IJt.MultiLogView(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}return i}();ip.MultiLogController=NJt;var rp={},bw={};Object.defineProperty(bw,"__esModule",{value:!0});bw.SingleLogView=void 0;var zJt=Wn,OO=(0,zJt.ClassName)("sgl"),UJt=function(){function i(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(OO()),e.viewProps.bindClassModifiers(this.element);var n=t.createElement("input");n.classList.add(OO("i")),n.readOnly=!0,n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}return i.prototype.update_=function(){var t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=e!==void 0?this.formatter_(e):""},i.prototype.onValueUpdate_=function(){this.update_()},i}();bw.SingleLogView=UJt;Object.defineProperty(rp,"__esModule",{value:!0});rp.SingleLogController=void 0;var FJt=bw,VJt=function(){function i(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new FJt.SingleLogView(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}return i}();rp.SingleLogController=VJt;Object.defineProperty(E_,"__esModule",{value:!0});E_.BooleanMonitorPlugin=void 0;var ZS=Zl,DO=qr,BJt=Ch,HJt=ip,$Jt=rp;E_.BooleanMonitorPlugin={id:"monitor-bool",type:"monitor",accept:function(i,t){if(typeof i!="boolean")return null;var e=DO.ParamsParsers,n=(0,DO.parseParams)(t,{lineCount:e.optional.number});return n?{initialValue:i,params:n}:null},binding:{reader:function(i){return ZS.boolFromUnknown}},controller:function(i){var t;return i.value.rawValue.length===1?new $Jt.SingleLogController(i.document,{formatter:ZS.BooleanFormatter,value:i.value,viewProps:i.viewProps}):new HJt.MultiLogController(i.document,{formatter:ZS.BooleanFormatter,lineCount:(t=i.params.lineCount)!==null&&t!==void 0?t:BJt.Constants.monitor.defaultLineCount,value:i.value,viewProps:i.viewProps})}};var T_={},yw={};Object.defineProperty(yw,"__esModule",{value:!0});yw.GraphLogView=void 0;var JS=Ts,Cb=Ai,GF=Wn,Iu=(0,GF.ClassName)("grl"),GJt=function(){function i(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Iu()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var n=t.createElementNS(JS.SVG_NS,"svg");n.classList.add(Iu("g")),n.style.height="calc(var(--bld-us) * ".concat(e.lineCount,")"),this.element.appendChild(n),this.svgElem_=n;var r=t.createElementNS(JS.SVG_NS,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;var s=t.createElement("div");s.classList.add(Iu("t"),(0,GF.ClassName)("tt")()),this.element.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}return Object.defineProperty(i.prototype,"graphElement",{get:function(){return this.svgElem_},enumerable:!1,configurable:!0}),i.prototype.update_=function(){var t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.props_.get("minValue"),r=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(function(u,h){if(u!==void 0){var p=(0,Cb.mapRange)(h,0,e,0,t.width),m=(0,Cb.mapRange)(u,n,r,t.height,0);s.push([p,m].join(","))}}),this.lineElem_.setAttributeNS(null,"points",s.join(" "));var o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){o.classList.remove(Iu("t","a"));return}var l=(0,Cb.mapRange)(this.cursor_.rawValue,0,e,0,t.width),c=(0,Cb.mapRange)(a,n,r,t.height,0);o.style.left="".concat(l,"px"),o.style.top="".concat(c,"px"),o.textContent="".concat(this.formatter_(a)),o.classList.contains(Iu("t","a"))||(o.classList.add(Iu("t","a"),Iu("t","in")),(0,JS.forceReflow)(o),o.classList.remove(Iu("t","in")))},i.prototype.onValueUpdate_=function(){this.update_()},i.prototype.onCursorChange_=function(){this.update_()},i}();yw.GraphLogView=GJt;Object.defineProperty(T_,"__esModule",{value:!0});T_.GraphLogController=void 0;var qJt=Ts,WJt=Gs,IO=Ai,jJt=El,XJt=yw,YJt=function(){function i(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=(0,WJt.createValue)(-1),this.view=new XJt.GraphLogView(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!(0,qJt.supportsTouch)(t))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{var n=new jJt.PointerHandler(this.view.element);n.emitter.on("down",this.onGraphPointerDown_),n.emitter.on("move",this.onGraphPointerMove_),n.emitter.on("up",this.onGraphPointerUp_)}}return i.prototype.onGraphMouseLeave_=function(){this.cursor_.rawValue=-1},i.prototype.onGraphMouseMove_=function(t){var e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor((0,IO.mapRange)(t.offsetX,0,e.width,0,this.value.rawValue.length))},i.prototype.onGraphPointerDown_=function(t){this.onGraphPointerMove_(t)},i.prototype.onGraphPointerMove_=function(t){if(!t.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor((0,IO.mapRange)(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length))},i.prototype.onGraphPointerUp_=function(){this.cursor_.rawValue=-1},i}();T_.GraphLogController=YJt;var A_={};Object.defineProperty(A_,"__esModule",{value:!0});A_.NumberMonitorPlugin=void 0;var qF=ns,KJt=Pi,NO=qr,WF=Ch,ZJt=pn,JJt=ip,QJt=rp,tQt=T_;function LC(i){return"format"in i&&!(0,ZJt.isEmpty)(i.format)?i.format:(0,qF.createNumberFormatter)(2)}function eQt(i){var t;return i.value.rawValue.length===1?new QJt.SingleLogController(i.document,{formatter:LC(i.params),value:i.value,viewProps:i.viewProps}):new JJt.MultiLogController(i.document,{formatter:LC(i.params),lineCount:(t=i.params.lineCount)!==null&&t!==void 0?t:WF.Constants.monitor.defaultLineCount,value:i.value,viewProps:i.viewProps})}function nQt(i){var t,e,n;return new tQt.GraphLogController(i.document,{formatter:LC(i.params),lineCount:(t=i.params.lineCount)!==null&&t!==void 0?t:WF.Constants.monitor.defaultLineCount,props:KJt.ValueMap.fromObject({maxValue:(e="max"in i.params?i.params.max:null)!==null&&e!==void 0?e:100,minValue:(n="min"in i.params?i.params.min:null)!==null&&n!==void 0?n:0}),value:i.value,viewProps:i.viewProps})}function zO(i){return"view"in i&&i.view==="graph"}A_.NumberMonitorPlugin={id:"monitor-number",type:"monitor",accept:function(i,t){if(typeof i!="number")return null;var e=NO.ParamsParsers,n=(0,NO.parseParams)(t,{format:e.optional.function,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number,view:e.optional.string});return n?{initialValue:i,params:n}:null},binding:{defaultBufferSize:function(i){return zO(i)?64:1},reader:function(i){return qF.numberFromUnknown}},controller:function(i){return zO(i.params)?nQt(i):eQt(i)}};var P_={};Object.defineProperty(P_,"__esModule",{value:!0});P_.StringMonitorPlugin=void 0;var QS=lh,UO=qr,iQt=Ch,rQt=ip,sQt=rp;P_.StringMonitorPlugin={id:"monitor-string",type:"monitor",accept:function(i,t){if(typeof i!="string")return null;var e=UO.ParamsParsers,n=(0,UO.parseParams)(t,{lineCount:e.optional.number,multiline:e.optional.boolean});return n?{initialValue:i,params:n}:null},binding:{reader:function(i){return QS.stringFromUnknown}},controller:function(i){var t,e=i.value,n=e.rawValue.length>1||"multiline"in i.params&&i.params.multiline;return n?new rQt.MultiLogController(i.document,{formatter:QS.formatString,lineCount:(t=i.params.lineCount)!==null&&t!==void 0?t:iQt.Constants.monitor.defaultLineCount,value:e,viewProps:i.viewProps}):new sQt.SingleLogController(i.document,{formatter:QS.formatString,value:e,viewProps:i.viewProps})}};var jF={};Object.defineProperty(jF,"__esModule",{value:!0});var cg={},R_={},xw={};Object.defineProperty(xw,"__esModule",{value:!0});xw.createInputBindingController=void 0;var oQt=yh,aQt=xh,lQt=a_,cQt=Pi,uQt=Gs,hQt=ou,dQt=qr,pQt=pn;function fQt(i,t){var e,n=i.accept(t.target.read(),t.params);if((0,pQt.isEmpty)(n))return null;var r=dQt.ParamsParsers,s={target:t.target,initialValue:n.initialValue,params:n.params},o=i.binding.reader(s),a=i.binding.constraint?i.binding.constraint(s):void 0,l=(0,uQt.createValue)(o(n.initialValue),{constraint:a,equals:i.binding.equals}),c=new lQt.InputBinding({reader:o,target:t.target,value:l,writer:i.binding.writer(s)}),u=r.optional.boolean(t.params.disabled).value,h=r.optional.boolean(t.params.hidden).value,p=i.controller({constraint:a,document:t.document,initialValue:n.initialValue,params:n.params,value:c.value,viewProps:hQt.ViewProps.create({disabled:u,hidden:h})});return new aQt.InputBindingController(t.document,{binding:c,blade:(0,oQt.createBlade)(),props:cQt.ValueMap.fromObject({label:"label"in t.params?(e=r.optional.string(t.params.label).value)!==null&&e!==void 0?e:null:t.target.key}),valueController:p})}xw.createInputBindingController=fQt;var ww={};Object.defineProperty(ww,"__esModule",{value:!0});ww.createMonitorBindingController=void 0;var mQt=yh,gQt=wh,vQt=l_,_Qt=o_,bQt=s_,yQt=ah,xQt=Pi,wQt=ou,SQt=qr,MQt=Ch,CQt=pn;function EQt(i,t){return t===0?new bQt.ManualTicker:new _Qt.IntervalTicker(i,t??MQt.Constants.monitor.defaultInterval)}function TQt(i,t){var e,n,r,s=SQt.ParamsParsers,o=i.accept(t.target.read(),t.params);if((0,CQt.isEmpty)(o))return null;var a={target:t.target,initialValue:o.initialValue,params:o.params},l=i.binding.reader(a),c=(n=(e=s.optional.number(t.params.bufferSize).value)!==null&&e!==void 0?e:i.binding.defaultBufferSize&&i.binding.defaultBufferSize(o.params))!==null&&n!==void 0?n:1,u=s.optional.number(t.params.interval).value,h=new vQt.MonitorBinding({reader:l,target:t.target,ticker:EQt(t.document,u),value:(0,yQt.initializeBuffer)(c)}),p=s.optional.boolean(t.params.disabled).value,m=s.optional.boolean(t.params.hidden).value,v=i.controller({document:t.document,params:o.params,value:h.value,viewProps:wQt.ViewProps.create({disabled:p,hidden:m})});return new gQt.MonitorBindingController(t.document,{binding:h,blade:(0,mQt.createBlade)(),props:xQt.ValueMap.fromObject({label:"label"in t.params?(r=s.optional.string(t.params.label).value)!==null&&r!==void 0?r:null:t.target.key}),valueController:v})}ww.createMonitorBindingController=TQt;var tM=zt&&zt.__spreadArray||function(i,t,e){if(e||arguments.length===2)for(var n=0,r=t.length,s;n<r;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return i.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(R_,"__esModule",{value:!0});R_.PluginPool=void 0;var AQt=im,PQt=xh,RQt=rm,kQt=wh,LQt=r_,OQt=oh,DQt=jv(),ug=Go,IQt=xw,NQt=pn,zQt=ww,UQt=function(){function i(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}return i.prototype.getAll=function(){return tM(tM(tM([],this.pluginsMap_.blades,!0),this.pluginsMap_.inputs,!0),this.pluginsMap_.monitors,!0)},i.prototype.register=function(t){t.type==="blade"?this.pluginsMap_.blades.unshift(t):t.type==="input"?this.pluginsMap_.inputs.unshift(t):t.type==="monitor"&&this.pluginsMap_.monitors.unshift(t)},i.prototype.createInput=function(t,e,n){var r=e.read();if((0,NQt.isEmpty)(r))throw new ug.TpError({context:{key:e.key},type:"nomatchingcontroller"});var s=this.pluginsMap_.inputs.reduce(function(o,a){return o??(0,IQt.createInputBindingController)(a,{document:t,target:e,params:n})},null);if(s)return s;throw new ug.TpError({context:{key:e.key},type:"nomatchingcontroller"})},i.prototype.createMonitor=function(t,e,n){var r=this.pluginsMap_.monitors.reduce(function(s,o){return s??(0,zQt.createMonitorBindingController)(o,{document:t,params:n,target:e})},null);if(r)return r;throw new ug.TpError({context:{key:e.key},type:"nomatchingcontroller"})},i.prototype.createBlade=function(t,e){var n=this.pluginsMap_.blades.reduce(function(r,s){return r??(0,LQt.createBladeController)(s,{document:t,params:e})},null);if(!n)throw new ug.TpError({type:"nomatchingview",context:{params:e}});return n},i.prototype.createBladeApi=function(t){var e=this;if(t instanceof PQt.InputBindingController)return new AQt.InputBindingApi(t);if(t instanceof kQt.MonitorBindingController)return new RQt.MonitorBindingApi(t);if(t instanceof DQt.RackController)return new OQt.RackApi(t,this);var n=this.pluginsMap_.blades.reduce(function(r,s){return r??s.api({controller:t,pool:e})},null);if(!n)throw ug.TpError.shouldNeverHappen();return n},i}();R_.PluginPool=UQt;var FO;function FQt(){if(FO)return cg;FO=1,Object.defineProperty(cg,"__esModule",{value:!0}),cg.createDefaultPluginPool=void 0;var i=Hv,t=Kv,e=Qv,n=i_,r=y_,s=x_,o=w_,a=S_,l=Ba,c=vw(),u=VF(),h=BF(),p=C_,m=E_,v=A_,_=P_,b=R_;function y(){var M=new b.PluginPool;return[c.Point2dInputPlugin,u.Point3dInputPlugin,h.Point4dInputPlugin,p.StringInputPlugin,l.NumberInputPlugin,a.StringColorInputPlugin,o.ObjectColorInputPlugin,s.NumberColorInputPlugin,r.BooleanInputPlugin,m.BooleanMonitorPlugin,_.StringMonitorPlugin,v.NumberMonitorPlugin,i.ButtonBladePlugin,t.FolderBladePlugin,e.SeparatorBladePlugin,n.TabBladePlugin].forEach(function(S){M.register(S)}),M}return cg.createDefaultPluginPool=y,cg}var VO;function XF(){return VO||(VO=1,function(i){var t=zt&&zt.__createBinding||(Object.create?function(r,s,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(s,o);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(r,a,l)}:function(r,s,o,a){a===void 0&&(a=o),r[a]=s[o]}),e=zt&&zt.__exportStar||function(r,s){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&t(s,r,o)};Object.defineProperty(i,"__esModule",{value:!0}),i.createBladeController=void 0,e(cc,i),e(QU,i),e(tF,i),e(_s,i),e(Uv,i),e(Fv,i),e(Vv,i),e(Bv,i),e(Hv,i),e(su,i),e(Zd,i),e($v,i),e(yh,i),e(oo,i),e(Gv,i),e(qv,i),e(Xv,i),e(Kv,i),e(im,i),e(xh,i),e(Kd,i),e(Wx,i),e(tm,i),e(rm,i),e(wh,i),e(Zv,i),e(Jv,i),e(Qv,i),e(t_,i),e(e_,i),e(n_,i),e(om,i),e(i_,i);var n=r_;Object.defineProperty(i,"createBladeController",{enumerable:!0,get:function(){return n.createBladeController}}),e(s_,i),e(o_,i),e(oF,i),e(a_,i),e(l_,i),e(xl,i),e(cF,i),e(Jd,i),e(Sh,i),e(c_,i),e(am,i),e(uF,i),e(Qd,i),e(lm,i),e(cm,i),e(hF,i),e(Zl,i),e(pF,i),e(ns,i),e(_F,i),e(p_,i),e(lh,i),e(ah,i),e(Pr,i),e(ss,i),e(bF,i),e(Pi,i),e(au,i),e(Gs,i),e(ou,i),e(lu,i),e(m_,i),e(v_,i),e(f_,i),e(g_,i),e(__,i),e(Wn,i),e(u_,i),e(Wv,i),e(El,i),e(h_,i),e(Vo,i),e(d_,i),e(wF,i),e(sh,i),e(Ts,i),e(Ai,i),e(qr,i),e(SF,i),e(Mh,i),e(Go,i),e(bs,i),e(Oi,i),e(b_,i),e(y_,i),e(tp,i),e(ts,i),e(cu,i),e(qs,i),e(x_,i),e(w_,i),e(S_,i),e(ep,i),e(np,i),e(Ba,i),e(M_,i),e(vw(),i),e(VF(),i),e(BF(),i),e(C_,i),e(Ch,i),e(pn,i),e(E_,i),e(ip,i),e(rp,i),e(T_,i),e(A_,i),e(P_,i),e(jF,i),e(FQt(),i),e(R_,i)}(LS)),LS}var YF=XF();const KF=zd(YF),VQt=ZC({__proto__:null,default:KF},[YF]),BQt=JU??Ejt,cf=KF??VQt,BO=cf.ClassName("ph");class HQt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(BO()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(BO("t")),n.textContent=e.text,this.element.appendChild(n)}}class HO extends cf.BladeController{constructor(t,e){super({blade:cf.createBlade(),view:new HQt(t,e),viewProps:e.viewProps})}}const $Qt={id:"text",type:"blade",css:`.tp-phv {
	align-items: center;
	display: flex;
	height: var(--bld-us);
	position: relative;
}
.tp-phv::before {
	border: var(--tw-prose-body) dashed 1px;
	border-radius: var(--elm-br);
	bottom: 0;
	content: '';
	left: var(--cnt-v-p);
	opacity: 0.3;
	position: absolute;
	right: var(--cnt-v-p);
	top: 0;
}
.tp-phv_t {
	box-sizing: border-box;
	color: var(--mo-fg);
	flex: 1;
	padding: 4px;
	text-align: center;
}
`,accept(i){const t=cf.ParamsParsers,e=cf.parseParams(i,{lineCount:t.optional.number,text:t.required.string,view:t.required.constant("text")});return e?{params:e}:null},controller(i){return new HO(i.document,{lineCount:i.params.lineCount??1,text:i.params.text,viewProps:i.viewProps})},api(i){return i.controller instanceof HO?new cf.BladeApi(i.controller):null}},GQt=i=>{if(typeof window>"u")throw new Error("useTweakpane can only be used in the browser");let t=!1;const e=new BQt.Pane(i);e.registerPlugin({plugin:$Qt});const n=new Set,r=a=>(a.append(e.element),a.style.top="1.5rem",a.style.right="1.5rem",a.style.width="calc(100% - 3rem)",a.style.maxWidth="300px",a.style.position="absolute",a.style.setProperty("--tp-base-background-color","hsla(230, 0%, 90%, 1.00"),a.style.setProperty("--tp-base-shadow-color","hsla(0, 0%, 0%, 0.0"),a.style.setProperty("--tp-button-background-color","hsla(230, 0%, 75%, 1.00"),a.style.setProperty("--tp-button-background-color-active","hsla(230, 0%, 60%, 1.00"),a.style.setProperty("--tp-button-background-color-focus","hsla(230, 0%, 65%, 1.00"),a.style.setProperty("--tp-button-background-color-hover","hsla(230, 0%, 70%, 1.00"),a.style.setProperty("--tp-button-foreground-color","hsla(230, 10%, 0%, 1.00"),a.style.setProperty("--tp-container-background-color","hsla(230, 0%, 30%, 0.20"),a.style.setProperty("--tp-container-background-color-active","hsla(230, 0%, 30%, 0.32"),a.style.setProperty("--tp-container-background-color-focus","hsla(230, 0%, 30%, 0.28"),a.style.setProperty("--tp-container-background-color-hover","hsla(230, 0%, 30%, 0.24"),a.style.setProperty("--tp-container-foreground-color","hsla(230, 0%, 30%, 1.00"),a.style.setProperty("--tp-groove-foreground-color","hsla(230, 0%, 30%, 0.10"),a.style.setProperty("--tp-input-background-color","hsla(230, 0%, 30%, 0.10"),a.style.setProperty("--tp-input-background-color-active","hsla(230, 0%, 30%, 0.22"),a.style.setProperty("--tp-input-background-color-focus","hsla(230, 0%, 30%, 0.18"),a.style.setProperty("--tp-input-background-color-hover","hsla(230, 0%, 30%, 0.14"),a.style.setProperty("--tp-input-foreground-color","hsla(230, 0%, 30%, 1.00"),a.style.setProperty("--tp-label-foreground-color","hsla(230, 0%, 30%, 0.70"),a.style.setProperty("--tp-monitor-background-color","hsla(230, 0%, 30%, 0.10"),a.style.setProperty("--tp-monitor-foreground-color","hsla(230, 0%, 30%, 1"),{destroy(){t||(e.dispose(),n.forEach(l=>l()),t=!0)}}),s=a=>{(a.parent?a.parent:e).addButton({title:a.title,label:a.label}).on("click",a.onClick)},o=a=>{const l=_a(a.value),c=(a.parent?a.parent:e).addInput({[a.label]:aD(l)},a.label,a.params);let u=!1,h=!1,p=!1;c.on("change",v=>{if(p){p=!1;return}h=!0,l.set(v.value)});const m=l.subscribe(v=>{if(!u){u=!0;return}if(h){h=!1;return}p=!0,c.controller_.binding.target.write(v),c.refresh()});return n.add(m),l};return ys(()=>{t||(e.dispose(),n.forEach(a=>a()),t=!0)}),{addFolder:e.addFolder.bind(e),addSeparator:e.addSeparator.bind(e),addButton:s,addInput:o,action:r,pane:e}},qQt={blue:"#4477AA",red:"#EE6677",green:"#228833",yellow:"#CCBB44",cyan:"#66CCEE",purple:"#AA3377",gray:"#BBBBBB"},WQt={black:"#000000",white:"#ffffff","gray-50":"rgb(247, 247, 247)","gray-100":"rgb(239, 239, 239)","gray-200":"rgb(223, 223, 223)","gray-300":"rgb(202, 202, 202)","gray-400":"rgb(168, 168, 168)","gray-500":"rgb(135, 135, 135)","gray-600":"rgb(109, 109, 109)","gray-700":"rgb(78, 78, 78)","gray-800":"rgb(55, 55, 55)","gray-900":"rgb(38, 38, 38)","gray-1000":"rgb(25, 25, 25)",purple:"#a239ca",blue:"#4717f6",green:"#34a29e",red:"#ff533d",yellow:"#e5e338",x:"#0891b2",y:"#ea580c",z:"#059669"},eM={category:qQt,color:WQt,"":{"12px":"0.75rem","14px":"0.875rem","16px":"1rem","18px":"1.125rem","20px":"1.25rem","22px":"1.375rem","24px":"1.5rem","28px":"1.75rem","32px":"2rem","36px":"2.25rem","40px":"2.5rem","44px":"2.75rem","48px":"3rem","56px":"3.5rem","64px":"4rem","80px":"5rem","96px":"6rem","112px":"7rem","128px":"8rem"}};function jQt(i,t,e){let{view:n}=t;const r={end:!0,width:3,zBias:1e4};return n.array({data:[0,0,0,1,0,0],width:2,items:2,channels:3}).vector({...r,color:eM.color.x}),n.array({data:[0,0,0,0,1,0],width:2,items:2,channels:3}).vector({...r,color:eM.color.y}),n.array({data:[0,0,0,0,0,1],width:2,items:2,channels:3}).vector({...r,color:eM.color.z}),i.$$set=s=>{"view"in s&&e(0,n=s.view)},[n]}class XQt extends uo{constructor(t){super(),ho(this,t,jQt,null,co,{view:0})}}var OC={exports:{}};(function(i,t){(function(e,n){n(t)})(zt,function(e){function n(yt,F){for(var at=0;at<F.length;at++){var q=F[at];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(yt,q.key,q)}}function r(yt,F,at){return F&&n(yt.prototype,F),at&&n(yt,at),yt}/*!
 * Observer 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var s,o,a,l,c,u,h,p,m,v,_,b,y,M=function(){return s||typeof window<"u"&&(s=window.gsap)&&s.registerPlugin&&s},S=1,E=[],A=[],R=[],O=Date.now,L=function(F,at){return at},P=function(){var F=m.core,at=F.bridge||{},q=F._scrollers,j=F._proxies;q.push.apply(q,A),j.push.apply(j,R),A=q,R=j,L=function(Dt,Et){return at[Dt](Et)}},D=function(F,at){return~R.indexOf(F)&&R[R.indexOf(F)+1][at]},V=function(F){return!!~v.indexOf(F)},K=function(F,at,q,j,gt){return F.addEventListener(at,q,{passive:!j,capture:!!gt})},W=function(F,at,q,j){return F.removeEventListener(at,q,!!j)},Z="scrollLeft",z="scrollTop",ut=function(){return _&&_.isPressed||A.cache++},nt=function(F,at){var q=function j(gt){if(gt||gt===0){S&&(a.history.scrollRestoration="manual");var Dt=_&&_.isPressed;gt=j.v=Math.round(gt)||(_&&_.iOS?1:0),F(gt),j.cacheID=A.cache,Dt&&L("ss",gt)}else(at||A.cache!==j.cacheID||L("ref"))&&(j.cacheID=A.cache,j.v=F());return j.v+j.offset};return q.offset=0,F&&q},Q={s:Z,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:nt(function(yt){return arguments.length?a.scrollTo(yt,St.sc()):a.pageXOffset||l[Z]||c[Z]||u[Z]||0})},St={s:z,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:Q,sc:nt(function(yt){return arguments.length?a.scrollTo(Q.sc(),yt):a.pageYOffset||l[z]||c[z]||u[z]||0})},Pt=function(F,at){return(at&&at._ctx&&at._ctx.selector||s.utils.toArray)(F)[0]||(typeof F=="string"&&s.config().nullTargetWarn!==!1?console.warn("Element not found:",F):null)},dt=function(F,at){var q=at.s,j=at.sc;V(F)&&(F=l.scrollingElement||c);var gt=A.indexOf(F),Dt=j===St.sc?1:2;!~gt&&(gt=A.push(F)-1),A[gt+Dt]||K(F,"scroll",ut);var Et=A[gt+Dt],de=Et||(A[gt+Dt]=nt(D(F,q),!0)||(V(F)?j:nt(function($e){return arguments.length?F[q]=$e:F[q]})));return de.target=F,Et||(de.smooth=s.getProperty(F,"scrollBehavior")==="smooth"),de},Rt=function(F,at,q){var j=F,gt=F,Dt=O(),Et=Dt,de=at||50,$e=Math.max(500,de*3),sn=function(ke,Ln){var ni=O();Ln||ni-Dt>de?(gt=j,j=ke,Et=Dt,Dt=ni):q?j+=ke:j=gt+(ke-gt)/(ni-Et)*(Dt-Et)},Ce=function(){gt=j=q?0:j,Et=Dt=0},Ee=function(ke){var Ln=Et,ni=gt,ui=O();return(ke||ke===0)&&ke!==j&&sn(ke),Dt===Et||ui-Et>$e?0:(j+(q?ni:-ni))/((q?ui:Dt)-Ln)*1e3};return{update:sn,reset:Ce,getVelocity:Ee}},Jt=function(F,at){return at&&!F._gsapAllow&&F.preventDefault(),F.changedTouches?F.changedTouches[0]:F},Bt=function(F){var at=Math.max.apply(Math,F),q=Math.min.apply(Math,F);return Math.abs(at)>=Math.abs(q)?at:q},Wt=function(){m=s.core.globals().ScrollTrigger,m&&m.core&&P()},be=function(F){return s=F||M(),s&&typeof document<"u"&&document.body&&(a=window,l=document,c=l.documentElement,u=l.body,v=[a,l,c,u],s.utils.clamp,y=s.core.context||function(){},p="onpointerenter"in u?"pointer":"mouse",h=re.isTouch=a.matchMedia&&a.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in a||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,b=re.eventTypes=("ontouchstart"in c?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in c?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return S=0},500),Wt(),o=1),o};Q.op=St,A.cache=0;var re=function(){function yt(at){this.init(at)}var F=yt.prototype;return F.init=function(q){o||be(s)||console.warn("Please gsap.registerPlugin(Observer)"),m||Wt();var j=q.tolerance,gt=q.dragMinimum,Dt=q.type,Et=q.target,de=q.lineHeight,$e=q.debounce,sn=q.preventDefault,Ce=q.onStop,Ee=q.onStopDelay,Ht=q.ignore,ke=q.wheelSpeed,Ln=q.event,ni=q.onDragStart,ui=q.onDragEnd,hi=q.onDrag,nr=q.onPress,Le=q.onRelease,Lr=q.onRight,ti=q.onLeft,Be=q.onUp,Ui=q.onDown,br=q.onChangeX,Oe=q.onChangeY,mi=q.onChange,qe=q.onToggleX,Ys=q.onToggleY,gi=q.onHover,ir=q.onHoverEnd,Fi=q.onMove,Sn=q.ignoreCheck,vi=q.isNormalizer,ii=q.onGestureStart,Ct=q.onGestureEnd,ji=q.onWheel,Za=q.onEnable,us=q.onDisable,yr=q.onClick,Xi=q.scrollSpeed,Or=q.capture,Vi=q.allowClicks,Dr=q.lockAxis,Ir=q.onLockAxis;this.target=Et=Pt(Et)||c,this.vars=q,Ht&&(Ht=s.utils.toArray(Ht)),j=j||1e-9,gt=gt||0,ke=ke||1,Xi=Xi||1,Dt=Dt||"wheel,touch,pointer",$e=$e!==!1,de||(de=parseFloat(a.getComputedStyle(u).lineHeight)||22);var Aa,Bi,Nr,lt,Ot,Tt,he,bt=this,Je=0,$n=0,ve=dt(Et,Q),Xn=dt(Et,St),Ja=ve(),rr=Xn(),go=~Dt.indexOf("touch")&&!~Dt.indexOf("pointer")&&b[0]==="pointerdown",xi=V(Et),On=Et.ownerDocument||l,hs=[0,0,0],di=[0,0,0],yn=0,vo=function(){return yn=O()},ks=function(Ie,En){return(bt.event=Ie)&&Ht&&~Ht.indexOf(Ie.target)||En&&go&&Ie.pointerType!=="touch"||Sn&&Sn(Ie,En)},sr=function(){bt._vx.reset(),bt._vy.reset(),Bi.pause(),Ce&&Ce(bt)},Pa=function(){var Ie=bt.deltaX=Bt(hs),En=bt.deltaY=Bt(di),wi=Math.abs(Ie)>=j,_e=Math.abs(En)>=j;mi&&(wi||_e)&&mi(bt,Ie,En,hs,di),wi&&(Lr&&bt.deltaX>0&&Lr(bt),ti&&bt.deltaX<0&&ti(bt),br&&br(bt),qe&&bt.deltaX<0!=Je<0&&qe(bt),Je=bt.deltaX,hs[0]=hs[1]=hs[2]=0),_e&&(Ui&&bt.deltaY>0&&Ui(bt),Be&&bt.deltaY<0&&Be(bt),Oe&&Oe(bt),Ys&&bt.deltaY<0!=$n<0&&Ys(bt),$n=bt.deltaY,di[0]=di[1]=di[2]=0),(lt||Nr)&&(Fi&&Fi(bt),Nr&&(hi(bt),Nr=!1),lt=!1),Tt&&!(Tt=!1)&&Ir&&Ir(bt),Ot&&(ji(bt),Ot=!1),Aa=0},Qa=function(Ie,En,wi){hs[wi]+=Ie,di[wi]+=En,bt._vx.update(Ie),bt._vy.update(En),$e?Aa||(Aa=requestAnimationFrame(Pa)):Pa()},tl=function(Ie,En){Dr&&!he&&(bt.axis=he=Math.abs(Ie)>Math.abs(En)?"x":"y",Tt=!0),he!=="y"&&(hs[2]+=Ie,bt._vx.update(Ie,!0)),he!=="x"&&(di[2]+=En,bt._vy.update(En,!0)),$e?Aa||(Aa=requestAnimationFrame(Pa)):Pa()},Ks=function(Ie){if(!ks(Ie,1)){Ie=Jt(Ie,sn);var En=Ie.clientX,wi=Ie.clientY,_e=En-bt.x,on=wi-bt.y,Ne=bt.isDragging;bt.x=En,bt.y=wi,(Ne||Math.abs(bt.startX-En)>=gt||Math.abs(bt.startY-wi)>=gt)&&(hi&&(Nr=!0),Ne||(bt.isDragging=!0),tl(_e,on),Ne||ni&&ni(bt))}},zr=bt.onPress=function(Ke){ks(Ke,1)||Ke&&Ke.button||(bt.axis=he=null,Bi.pause(),bt.isPressed=!0,Ke=Jt(Ke),Je=$n=0,bt.startX=bt.x=Ke.clientX,bt.startY=bt.y=Ke.clientY,bt._vx.reset(),bt._vy.reset(),K(vi?Et:On,b[1],Ks,sn,!0),bt.deltaX=bt.deltaY=0,nr&&nr(bt))},Ls=bt.onRelease=function(Ke){if(!ks(Ke,1)){W(vi?Et:On,b[1],Ks,!0);var Ie=!isNaN(bt.y-bt.startY),En=bt.isDragging&&(Math.abs(bt.x-bt.startX)>3||Math.abs(bt.y-bt.startY)>3),wi=Jt(Ke);!En&&Ie&&(bt._vx.reset(),bt._vy.reset(),sn&&Vi&&s.delayedCall(.08,function(){if(O()-yn>300&&!Ke.defaultPrevented){if(Ke.target.click)Ke.target.click();else if(On.createEvent){var _e=On.createEvent("MouseEvents");_e.initMouseEvent("click",!0,!0,a,1,wi.screenX,wi.screenY,wi.clientX,wi.clientY,!1,!1,!1,!1,0,null),Ke.target.dispatchEvent(_e)}}})),bt.isDragging=bt.isGesturing=bt.isPressed=!1,Ce&&!vi&&Bi.restart(!0),ui&&En&&ui(bt),Le&&Le(bt,En)}},xn=function(Ie){return Ie.touches&&Ie.touches.length>1&&(bt.isGesturing=!0)&&ii(Ie,bt.isDragging)},_o=function(){return(bt.isGesturing=!1)||Ct(bt)},ws=function(Ie){if(!ks(Ie)){var En=ve(),wi=Xn();Qa((En-Ja)*Xi,(wi-rr)*Xi,1),Ja=En,rr=wi,Ce&&Bi.restart(!0)}},Os=function(Ie){if(!ks(Ie)){Ie=Jt(Ie,sn),ji&&(Ot=!0);var En=(Ie.deltaMode===1?de:Ie.deltaMode===2?a.innerHeight:1)*ke;Qa(Ie.deltaX*En,Ie.deltaY*En,0),Ce&&!vi&&Bi.restart(!0)}},Zr=function(Ie){if(!ks(Ie)){var En=Ie.clientX,wi=Ie.clientY,_e=En-bt.x,on=wi-bt.y;bt.x=En,bt.y=wi,lt=!0,(_e||on)&&tl(_e,on)}},Zo=function(Ie){bt.event=Ie,gi(bt)},Zs=function(Ie){bt.event=Ie,ir(bt)},Ur=function(Ie){return ks(Ie)||Jt(Ie,sn)&&yr(bt)};Bi=bt._dc=s.delayedCall(Ee||.25,sr).pause(),bt.deltaX=bt.deltaY=0,bt._vx=Rt(0,50,!0),bt._vy=Rt(0,50,!0),bt.scrollX=ve,bt.scrollY=Xn,bt.isDragging=bt.isGesturing=bt.isPressed=!1,y(this),bt.enable=function(Ke){return bt.isEnabled||(K(xi?On:Et,"scroll",ut),Dt.indexOf("scroll")>=0&&K(xi?On:Et,"scroll",ws,sn,Or),Dt.indexOf("wheel")>=0&&K(Et,"wheel",Os,sn,Or),(Dt.indexOf("touch")>=0&&h||Dt.indexOf("pointer")>=0)&&(K(Et,b[0],zr,sn,Or),K(On,b[2],Ls),K(On,b[3],Ls),Vi&&K(Et,"click",vo,!1,!0),yr&&K(Et,"click",Ur),ii&&K(On,"gesturestart",xn),Ct&&K(On,"gestureend",_o),gi&&K(Et,p+"enter",Zo),ir&&K(Et,p+"leave",Zs),Fi&&K(Et,p+"move",Zr)),bt.isEnabled=!0,Ke&&Ke.type&&zr(Ke),Za&&Za(bt)),bt},bt.disable=function(){bt.isEnabled&&(E.filter(function(Ke){return Ke!==bt&&V(Ke.target)}).length||W(xi?On:Et,"scroll",ut),bt.isPressed&&(bt._vx.reset(),bt._vy.reset(),W(vi?Et:On,b[1],Ks,!0)),W(xi?On:Et,"scroll",ws,Or),W(Et,"wheel",Os,Or),W(Et,b[0],zr,Or),W(On,b[2],Ls),W(On,b[3],Ls),W(Et,"click",vo,!0),W(Et,"click",Ur),W(On,"gesturestart",xn),W(On,"gestureend",_o),W(Et,p+"enter",Zo),W(Et,p+"leave",Zs),W(Et,p+"move",Zr),bt.isEnabled=bt.isPressed=bt.isDragging=!1,us&&us(bt))},bt.kill=bt.revert=function(){bt.disable();var Ke=E.indexOf(bt);Ke>=0&&E.splice(Ke,1),_===bt&&(_=0)},E.push(bt),vi&&V(Et)&&(_=bt),bt.enable(Ln)},r(yt,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),yt}();re.version="3.12.2",re.create=function(yt){return new re(yt)},re.register=be,re.getAll=function(){return E.slice()},re.getById=function(yt){return E.filter(function(F){return F.vars.id===yt})[0]},M()&&s.registerPlugin(re);/*!
 * ScrollTrigger 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var It,ye,ce,ne,Gt,J,$t,et,ft,kt,Qt,qt,ot,st,_t,$,B,Lt,jt,Kt,se,we,ht,mt,tt,Ut,oe,ue,ae,xe,Ze,pt,ee=1,Mt=Date.now,ie=Mt(),le=0,Xe=0,Rn=function(F,at,q){var j=vr(F)&&(F.substr(0,6)==="clamp("||F.indexOf("max")>-1);return q["_"+at+"Clamp"]=j,j?F.substr(6,F.length-7):F},Zn=function(F,at){return at&&(!vr(F)||F.substr(0,6)!=="clamp(")?"clamp("+F+")":F},Wr=function yt(){return Xe&&requestAnimationFrame(yt)},mn=function(){return st=1},jr=function(){return st=0},Jn=function(F){return F},Xr=function(F){return Math.round(F*1e5)/1e5||0},qo=function(){return typeof window<"u"},xa=function(){return It||qo()&&(It=window.gsap)&&It.registerPlugin&&It},As=function(F){return!!~$t.indexOf(F)},Wo=function(F){return(F==="Height"?Ze:ce["inner"+F])||Gt["client"+F]||J["client"+F]},ja=function(F){return D(F,"getBoundingClientRect")||(As(F)?function(){return Kr.width=ce.innerWidth,Kr.height=Ze,Kr}:function(){return ai(F)})},Tl=function(F,at,q){var j=q.d,gt=q.d2,Dt=q.a;return(Dt=D(F,"getBoundingClientRect"))?function(){return Dt()[j]}:function(){return(at?Wo(gt):F["client"+gt])||0}},uu=function(F,at){return!at||~R.indexOf(F)?ja(F):function(){return Kr}},Ws=function(F,at){var q=at.s,j=at.d2,gt=at.d,Dt=at.a;return Math.max(0,(q="scroll"+j)&&(Dt=D(F,q))?Dt()-ja(F)()[gt]:As(F)?(Gt[q]||J[q])-Wo(j):F[q]-F["offset"+j])},Al=function(F,at){for(var q=0;q<jt.length;q+=3)(!at||~at.indexOf(jt[q+1]))&&F(jt[q],jt[q+1],jt[q+2])},vr=function(F){return typeof F=="string"},X=function(F){return typeof F=="function"},At=function(F){return typeof F=="number"},Nt=function(F){return typeof F=="object"},wt=function(F,at,q){return F&&F.progress(at?0:1)&&q&&F.pause()},Ft=function(F,at){if(F.enabled){var q=at(F);q&&q.totalTime&&(F.callbackAnimation=q)}},fe=Math.abs,Re="left",Me="top",ze="right",Ye="bottom",De="width",Ue="height",Qn="Right",kn="Left",qi="Top",Rr="Bottom",Qe="padding",Ve="margin",js="Width",yi="Height",oi="px",Ni=function(F){return ce.getComputedStyle(F)},wa=function(F){var at=Ni(F).position;F.style.position=at==="absolute"||at==="fixed"?at:"relative"},jo=function(F,at){for(var q in at)q in F||(F[q]=at[q]);return F},ai=function(F,at){var q=at&&Ni(F)[_t]!=="matrix(1, 0, 0, 1, 0, 0)"&&It.to(F,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),j=F.getBoundingClientRect();return q&&q.progress(0).kill(),j},Ps=function(F,at){var q=at.d2;return F["offset"+q]||F["client"+q]||0},Xo=function(F){var at=[],q=F.labels,j=F.duration(),gt;for(gt in q)at.push(q[gt]/j);return at},kr=function(F){return function(at){return It.utils.snap(Xo(F),at)}},Xa=function(F){var at=It.utils.snap(F),q=Array.isArray(F)&&F.slice(0).sort(function(j,gt){return j-gt});return q?function(j,gt,Dt){Dt===void 0&&(Dt=.001);var Et;if(!gt)return at(j);if(gt>0){for(j-=Dt,Et=0;Et<q.length;Et++)if(q[Et]>=j)return q[Et];return q[Et-1]}else for(Et=q.length,j+=Dt;Et--;)if(q[Et]<=j)return q[Et];return q[0]}:function(j,gt,Dt){Dt===void 0&&(Dt=.001);var Et=at(j);return!gt||Math.abs(Et-j)<Dt||Et-j<0==gt<0?Et:at(gt<0?j-F:j+F)}},uc=function(F){return function(at,q){return Xa(Xo(F))(at,q.direction)}},Sa=function(F,at,q,j){return q.split(",").forEach(function(gt){return F(at,gt,j)})},zi=function(F,at,q,j,gt){return F.addEventListener(at,q,{passive:!j,capture:!!gt})},er=function(F,at,q,j){return F.removeEventListener(at,q,!!j)},hc=function(F,at,q){q=q&&q.wheelHandler,q&&(F(at,"wheel",q),F(at,"touchmove",q))},Ma={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},os={toggleActions:"play",anticipatePin:0},as={top:0,left:0,center:.5,bottom:1,right:1},Yo=function(F,at){if(vr(F)){var q=F.indexOf("="),j=~q?+(F.charAt(q-1)+1)*parseFloat(F.substr(q+1)):0;~q&&(F.indexOf("%")>q&&(j*=at/100),F=F.substr(0,q-1)),F=j+(F in as?as[F]*at:~F.indexOf("%")?parseFloat(F)*at/100:parseFloat(F)||0)}return F},Pl=function(F,at,q,j,gt,Dt,Et,de){var $e=gt.startColor,sn=gt.endColor,Ce=gt.fontSize,Ee=gt.indent,Ht=gt.fontWeight,ke=ne.createElement("div"),Ln=As(q)||D(q,"pinType")==="fixed",ni=F.indexOf("scroller")!==-1,ui=Ln?J:q,hi=F.indexOf("start")!==-1,nr=hi?$e:sn,Le="border-color:"+nr+";font-size:"+Ce+";color:"+nr+";font-weight:"+Ht+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return Le+="position:"+((ni||de)&&Ln?"fixed;":"absolute;"),(ni||de||!Ln)&&(Le+=(j===St?ze:Ye)+":"+(Dt+parseFloat(Ee))+"px;"),Et&&(Le+="box-sizing:border-box;text-align:left;width:"+Et.offsetWidth+"px;"),ke._isStart=hi,ke.setAttribute("class","gsap-marker-"+F+(at?" marker-"+at:"")),ke.style.cssText=Le,ke.innerText=at||at===0?F+"-"+at:F,ui.children[0]?ui.insertBefore(ke,ui.children[0]):ui.appendChild(ke),ke._offset=ke["offset"+j.op.d2],Ya(ke,0,j,hi),ke},Ya=function(F,at,q,j){var gt={display:"block"},Dt=q[j?"os2":"p2"],Et=q[j?"p2":"os2"];F._isFlipped=j,gt[q.a+"Percent"]=j?-100:0,gt[q.a]=j?"1px":0,gt["border"+Dt+js]=1,gt["border"+Et+js]=0,gt[q.p]=at+"px",It.set(F,gt)},en=[],hu={},mo,du=function(){return Mt()-le>34&&(mo||(mo=requestAnimationFrame(Ko)))},Rl=function(){(!ht||!ht.isPressed||ht.startX>J.clientWidth)&&(A.cache++,ht?mo||(mo=requestAnimationFrame(Ko)):Ko(),le||Ea("scrollStart"),le=Mt())},pu=function(){Ut=ce.innerWidth,tt=ce.innerHeight},kl=function(){A.cache++,!ot&&!we&&!ne.fullscreenElement&&!ne.webkitFullscreenElement&&(!mt||Ut!==ce.innerWidth||Math.abs(ce.innerHeight-tt)>ce.innerHeight*.25)&&et.restart(!0)},Ca={},fu=[],op=function yt(){return er(Fe,"scrollEnd",yt)||Xs(!0)},Ea=function(F){return Ca[F]&&Ca[F].map(function(at){return at()})||fu},ls=[],mu=function(F){for(var at=0;at<ls.length;at+=5)(!F||ls[at+4]&&ls[at+4].query===F)&&(ls[at].style.cssText=ls[at+1],ls[at].getBBox&&ls[at].setAttribute("transform",ls[at+2]||""),ls[at+3].uncache=1)},Th=function(F,at){var q;for($=0;$<en.length;$++)q=en[$],q&&(!at||q._ctx===at)&&(F?q.kill(1):q.revert(!0,!0));at&&mu(at),at||Ea("revert")},ap=function(F,at){A.cache++,(at||!Yr)&&A.forEach(function(q){return X(q)&&q.cacheID++&&(q.rec=0)}),vr(F)&&(ce.history.scrollRestoration=ae=F)},Yr,Ka=0,gu,jn=function(){if(gu!==Ka){var F=gu=Ka;requestAnimationFrame(function(){return F===Ka&&Xs(!0)})}},ei=function(){J.appendChild(xe),Ze=xe.offsetHeight||ce.innerHeight,J.removeChild(xe)},Xs=function(F,at){if(le&&!F){zi(Fe,"scrollEnd",op);return}ei(),Yr=Fe.isRefreshing=!0,A.forEach(function(j){return X(j)&&++j.cacheID&&(j.rec=j())});var q=Ea("refreshInit");Kt&&Fe.sort(),at||Th(),A.forEach(function(j){X(j)&&(j.smooth&&(j.target.style.scrollBehavior="auto"),j(0))}),en.slice(0).forEach(function(j){return j.refresh()}),en.forEach(function(j,gt){if(j._subPinOffset&&j.pin){var Dt=j.vars.horizontal?"offsetWidth":"offsetHeight",Et=j.pin[Dt];j.revert(!0,1),j.adjustPinSpacing(j.pin[Dt]-Et),j.refresh()}}),en.forEach(function(j){var gt=Ws(j.scroller,j._dir);(j.vars.end==="max"||j._endClamp&&j.end>gt)&&j.setPositions(j.start,Math.max(j.start+1,gt),!0)}),q.forEach(function(j){return j&&j.render&&j.render(-1)}),A.forEach(function(j){X(j)&&(j.smooth&&requestAnimationFrame(function(){return j.target.style.scrollBehavior="smooth"}),j.rec&&j(j.rec))}),ap(ae,1),et.pause(),Ka++,Yr=2,Ko(2),en.forEach(function(j){return X(j.vars.onRefresh)&&j.vars.onRefresh(j)}),Yr=Fe.isRefreshing=!1,Ea("refresh")},Ah=0,Ll=1,Ol,Ko=function(F){if(!Yr||F===2){Fe.isUpdating=!0,Ol&&Ol.update(0);var at=en.length,q=Mt(),j=q-ie>=50,gt=at&&en[0].scroll();if(Ll=Ah>gt?-1:1,Yr||(Ah=gt),j&&(le&&!st&&q-le>200&&(le=0,Ea("scrollEnd")),Qt=ie,ie=q),Ll<0){for($=at;$-- >0;)en[$]&&en[$].update(0,j);Ll=1}else for($=0;$<at;$++)en[$]&&en[$].update(0,j);Fe.isUpdating=!1}mo=0},Ph=[Re,Me,Ye,ze,Ve+Rr,Ve+Qn,Ve+qi,Ve+kn,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],dc=Ph.concat([De,Ue,"boxSizing","max"+js,"max"+yi,"position",Ve,Qe,Qe+qi,Qe+Qn,Qe+Rr,Qe+kn]),um=function(F,at,q){Rs(q);var j=F._gsap;if(j.spacerIsNative)Rs(j.spacerState);else if(F._gsap.swappedIn){var gt=at.parentNode;gt&&(gt.insertBefore(F,at),gt.removeChild(at))}F._gsap.swappedIn=!1},Wi=function(F,at,q,j){if(!F._gsap.swappedIn){for(var gt=Ph.length,Dt=at.style,Et=F.style,de;gt--;)de=Ph[gt],Dt[de]=q[de];Dt.position=q.position==="absolute"?"absolute":"relative",q.display==="inline"&&(Dt.display="inline-block"),Et[Ye]=Et[ze]="auto",Dt.flexBasis=q.flexBasis||"auto",Dt.overflow="visible",Dt.boxSizing="border-box",Dt[De]=Ps(F,Q)+oi,Dt[Ue]=Ps(F,St)+oi,Dt[Qe]=Et[Ve]=Et[Me]=Et[Re]="0",Rs(j),Et[De]=Et["max"+js]=q[De],Et[Ue]=Et["max"+yi]=q[Ue],Et[Qe]=q[Qe],F.parentNode!==at&&(F.parentNode.insertBefore(at,F),at.appendChild(F)),F._gsap.swappedIn=!0}},Rh=/([A-Z])/g,Rs=function(F){if(F){var at=F.t.style,q=F.length,j=0,gt,Dt;for((F.t._gsap||It.core.getCache(F.t)).uncache=1;j<q;j+=2)Dt=F[j+1],gt=F[j],Dt?at[gt]=Dt:at[gt]&&at.removeProperty(gt.replace(Rh,"-$1").toLowerCase())}},pc=function(F){for(var at=dc.length,q=F.style,j=[],gt=0;gt<at;gt++)j.push(dc[gt],q[dc[gt]]);return j.t=F,j},kh=function(F,at,q){for(var j=[],gt=F.length,Dt=q?8:0,Et;Dt<gt;Dt+=2)Et=F[Dt],j.push(Et,Et in at?at[Et]:F[Dt+1]);return j.t=F.t,j},Kr={left:0,top:0},Lh=function(F,at,q,j,gt,Dt,Et,de,$e,sn,Ce,Ee,Ht,ke){X(F)&&(F=F(de)),vr(F)&&F.substr(0,3)==="max"&&(F=Ee+(F.charAt(4)==="="?Yo("0"+F.substr(3),q):0));var Ln=Ht?Ht.time():0,ni,ui,hi;if(Ht&&Ht.seek(0),isNaN(F)||(F=+F),At(F))Ht&&(F=It.utils.mapRange(Ht.scrollTrigger.start,Ht.scrollTrigger.end,0,Ee,F)),Et&&Ya(Et,q,j,!0);else{X(at)&&(at=at(de));var nr=(F||"0").split(" "),Le,Lr,ti,Be;hi=Pt(at,de)||J,Le=ai(hi)||{},(!Le||!Le.left&&!Le.top)&&Ni(hi).display==="none"&&(Be=hi.style.display,hi.style.display="block",Le=ai(hi),Be?hi.style.display=Be:hi.style.removeProperty("display")),Lr=Yo(nr[0],Le[j.d]),ti=Yo(nr[1]||"0",q),F=Le[j.p]-$e[j.p]-sn+Lr+gt-ti,Et&&Ya(Et,ti,j,q-ti<20||Et._isStart&&ti>20),q-=q-ti}if(ke&&(de[ke]=F||-.001,F<0&&(F=0)),Dt){var Ui=F+q,br=Dt._isStart;ni="scroll"+j.d2,Ya(Dt,Ui,j,br&&Ui>20||!br&&(Ce?Math.max(J[ni],Gt[ni]):Dt.parentNode[ni])<=Ui+1),Ce&&($e=ai(Et),Ce&&(Dt.style[j.op.p]=$e[j.op.p]-j.op.m-Dt._offset+oi))}return Ht&&hi&&(ni=ai(hi),Ht.seek(Ee),ui=ai(hi),Ht._caScrollDist=ni[j.p]-ui[j.p],F=F/Ht._caScrollDist*Ee),Ht&&Ht.seek(Ln),Ht?F:Math.round(F)},lp=/(webkit|moz|length|cssText|inset)/i,Oh=function(F,at,q,j){if(F.parentNode!==at){var gt=F.style,Dt,Et;if(at===J){F._stOrig=gt.cssText,Et=Ni(F);for(Dt in Et)!+Dt&&!lp.test(Dt)&&Et[Dt]&&typeof gt[Dt]=="string"&&Dt!=="0"&&(gt[Dt]=Et[Dt]);gt.top=q,gt.left=j}else gt.cssText=F._stOrig;It.core.getCache(F).uncache=1,at.appendChild(F)}},Dh=function(F,at,q){var j=at,gt=j;return function(Dt){var Et=Math.round(F());return Et!==j&&Et!==gt&&Math.abs(Et-j)>3&&Math.abs(Et-gt)>3&&(Dt=Et,q&&q()),gt=j,j=Dt,Dt}},fc=function(F,at,q){var j={};j[at.p]="+="+q,It.set(F,j)},vu=function(F,at){var q=dt(F,at),j="_scroll"+at.p2,gt=function Dt(Et,de,$e,sn,Ce){var Ee=Dt.tween,Ht=de.onComplete,ke={};$e=$e||q();var Ln=Dh(q,$e,function(){Ee.kill(),Dt.tween=0});return Ce=sn&&Ce||0,sn=sn||Et-$e,Ee&&Ee.kill(),de[j]=Et,de.modifiers=ke,ke[j]=function(){return Ln($e+sn*Ee.ratio+Ce*Ee.ratio*Ee.ratio)},de.onUpdate=function(){A.cache++,Ko()},de.onComplete=function(){Dt.tween=0,Ht&&Ht.call(Ee)},Ee=Dt.tween=It.to(F,de),Ee};return F[j]=q,q.wheelHandler=function(){return gt.tween&&gt.tween.kill()&&(gt.tween=0)},zi(F,"wheel",q.wheelHandler),Fe.isTouch&&zi(F,"touchmove",q.wheelHandler),gt},Fe=function(){function yt(at,q){ye||yt.register(It)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),ue(this),this.init(at,q)}var F=yt.prototype;return F.init=function(q,j){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!Xe){this.update=this.refresh=this.kill=Jn;return}q=jo(vr(q)||At(q)||q.nodeType?{trigger:q}:q,os);var gt=q,Dt=gt.onUpdate,Et=gt.toggleClass,de=gt.id,$e=gt.onToggle,sn=gt.onRefresh,Ce=gt.scrub,Ee=gt.trigger,Ht=gt.pin,ke=gt.pinSpacing,Ln=gt.invalidateOnRefresh,ni=gt.anticipatePin,ui=gt.onScrubComplete,hi=gt.onSnapComplete,nr=gt.once,Le=gt.snap,Lr=gt.pinReparent,ti=gt.pinSpacer,Be=gt.containerAnimation,Ui=gt.fastScrollEnd,br=gt.preventOverlaps,Oe=q.horizontal||q.containerAnimation&&q.horizontal!==!1?Q:St,mi=!Ce&&Ce!==0,qe=Pt(q.scroller||ce),Ys=It.core.getCache(qe),gi=As(qe),ir=("pinType"in q?q.pinType:D(qe,"pinType")||gi&&"fixed")==="fixed",Fi=[q.onEnter,q.onLeave,q.onEnterBack,q.onLeaveBack],Sn=mi&&q.toggleActions.split(" "),vi="markers"in q?q.markers:os.markers,ii=gi?0:parseFloat(Ni(qe)["border"+Oe.p2+js])||0,Ct=this,ji=q.onRefreshInit&&function(){return q.onRefreshInit(Ct)},Za=Tl(qe,gi,Oe),us=uu(qe,gi),yr=0,Xi=0,Or=0,Vi=dt(qe,Oe),Dr,Ir,Aa,Bi,Nr,lt,Ot,Tt,he,bt,Je,$n,ve,Xn,Ja,rr,go,xi,On,hs,di,yn,vo,ks,sr,Pa,Qa,tl,Ks,zr,Ls,xn,_o,ws,Os,Zr,Zo,Zs,Ur;if(Ct._startClamp=Ct._endClamp=!1,Ct._dir=Oe,ni*=45,Ct.scroller=qe,Ct.scroll=Be?Be.time.bind(Be):Vi,Bi=Vi(),Ct.vars=q,j=j||q.animation,"refreshPriority"in q&&(Kt=1,q.refreshPriority===-9999&&(Ol=Ct)),Ys.tweenScroll=Ys.tweenScroll||{top:vu(qe,St),left:vu(qe,Q)},Ct.tweenTo=Dr=Ys.tweenScroll[Oe.p],Ct.scrubDuration=function(_e){_o=At(_e)&&_e,_o?xn?xn.duration(_e):xn=It.to(j,{ease:"expo",totalProgress:"+=0",duration:_o,paused:!0,onComplete:function(){return ui&&ui(Ct)}}):(xn&&xn.progress(1).kill(),xn=0)},j&&(j.vars.lazy=!1,j._initted&&!Ct.isReverted||j.vars.immediateRender!==!1&&q.immediateRender!==!1&&j.duration()&&j.render(0,!0,!0),Ct.animation=j.pause(),j.scrollTrigger=Ct,Ct.scrubDuration(Ce),zr=0,de||(de=j.vars.id)),Le&&((!Nt(Le)||Le.push)&&(Le={snapTo:Le}),"scrollBehavior"in J.style&&It.set(gi?[J,Gt]:qe,{scrollBehavior:"auto"}),A.forEach(function(_e){return X(_e)&&_e.target===(gi?ne.scrollingElement||Gt:qe)&&(_e.smooth=!1)}),Aa=X(Le.snapTo)?Le.snapTo:Le.snapTo==="labels"?kr(j):Le.snapTo==="labelsDirectional"?uc(j):Le.directional!==!1?function(_e,on){return Xa(Le.snapTo)(_e,Mt()-Xi<500?0:on.direction)}:It.utils.snap(Le.snapTo),ws=Le.duration||{min:.1,max:2},ws=Nt(ws)?kt(ws.min,ws.max):kt(ws,ws),Os=It.delayedCall(Le.delay||_o/2||.1,function(){var _e=Vi(),on=Mt()-Xi<500,Ne=Dr.tween;if((on||Math.abs(Ct.getVelocity())<10)&&!Ne&&!st&&yr!==_e){var ln=(_e-lt)/Xn,Ri=j&&!mi?j.totalProgress():ln,Mn=on?0:(Ri-Ls)/(Mt()-Qt)*1e3||0,ki=It.utils.clamp(-ln,1-ln,fe(Mn/2)*Mn/.185),gn=ln+(Le.inertia===!1?0:ki),Dn=kt(0,1,Aa(gn,Ct)),Si=Math.round(lt+Dn*Xn),ri=Le,Ss=ri.onStart,Mi=ri.onInterrupt,Fr=ri.onComplete;if(_e<=Ot&&_e>=lt&&Si!==_e){if(Ne&&!Ne._initted&&Ne.data<=fe(Si-_e))return;Le.inertia===!1&&(ki=Dn-ln),Dr(Si,{duration:ws(fe(Math.max(fe(gn-Ri),fe(Dn-Ri))*.185/Mn/.05||0)),ease:Le.ease||"power3",data:fe(Si-_e),onInterrupt:function(){return Os.restart(!0)&&Mi&&Mi(Ct)},onComplete:function(){Ct.update(),yr=Vi(),zr=Ls=j&&!mi?j.totalProgress():Ct.progress,hi&&hi(Ct),Fr&&Fr(Ct)}},_e,ki*Xn,Si-_e-ki*Xn),Ss&&Ss(Ct,Dr.tween)}}else Ct.isActive&&yr!==_e&&Os.restart(!0)}).pause()),de&&(hu[de]=Ct),Ee=Ct.trigger=Pt(Ee||Ht!==!0&&Ht),Ur=Ee&&Ee._gsap&&Ee._gsap.stRevert,Ur&&(Ur=Ur(Ct)),Ht=Ht===!0?Ee:Pt(Ht),vr(Et)&&(Et={targets:Ee,className:Et}),Ht&&(ke===!1||ke===Ve||(ke=!ke&&Ht.parentNode&&Ht.parentNode.style&&Ni(Ht.parentNode).display==="flex"?!1:Qe),Ct.pin=Ht,Ir=It.core.getCache(Ht),Ir.spacer?Ja=Ir.pinState:(ti&&(ti=Pt(ti),ti&&!ti.nodeType&&(ti=ti.current||ti.nativeElement),Ir.spacerIsNative=!!ti,ti&&(Ir.spacerState=pc(ti))),Ir.spacer=xi=ti||ne.createElement("div"),xi.classList.add("pin-spacer"),de&&xi.classList.add("pin-spacer-"+de),Ir.pinState=Ja=pc(Ht)),q.force3D!==!1&&It.set(Ht,{force3D:!0}),Ct.spacer=xi=Ir.spacer,Ks=Ni(Ht),ks=Ks[ke+Oe.os2],hs=It.getProperty(Ht),di=It.quickSetter(Ht,Oe.a,oi),Wi(Ht,xi,Ks),go=pc(Ht)),vi){$n=Nt(vi)?jo(vi,Ma):Ma,bt=Pl("scroller-start",de,qe,Oe,$n,0),Je=Pl("scroller-end",de,qe,Oe,$n,0,bt),On=bt["offset"+Oe.op.d2];var Ke=Pt(D(qe,"content")||qe);Tt=this.markerStart=Pl("start",de,Ke,Oe,$n,On,0,Be),he=this.markerEnd=Pl("end",de,Ke,Oe,$n,On,0,Be),Be&&(Zs=It.quickSetter([Tt,he],Oe.a,oi)),!ir&&!(R.length&&D(qe,"fixedMarkers")===!0)&&(wa(gi?J:qe),It.set([bt,Je],{force3D:!0}),Pa=It.quickSetter(bt,Oe.a,oi),tl=It.quickSetter(Je,Oe.a,oi))}if(Be){var Ie=Be.vars.onUpdate,En=Be.vars.onUpdateParams;Be.eventCallback("onUpdate",function(){Ct.update(0,0,1),Ie&&Ie.apply(Be,En||[])})}if(Ct.previous=function(){return en[en.indexOf(Ct)-1]},Ct.next=function(){return en[en.indexOf(Ct)+1]},Ct.revert=function(_e,on){if(!on)return Ct.kill(!0);var Ne=_e!==!1||!Ct.enabled,ln=ot;Ne!==Ct.isReverted&&(Ne&&(Zr=Math.max(Vi(),Ct.scroll.rec||0),Or=Ct.progress,Zo=j&&j.progress()),Tt&&[Tt,he,bt,Je].forEach(function(Ri){return Ri.style.display=Ne?"none":"block"}),Ne&&(ot=Ct,Ct.update(Ne)),Ht&&(!Lr||!Ct.isActive)&&(Ne?um(Ht,xi,Ja):Wi(Ht,xi,Ni(Ht),sr)),Ne||Ct.update(Ne),ot=ln,Ct.isReverted=Ne)},Ct.refresh=function(_e,on,Ne,ln){if(!((ot||!Ct.enabled)&&!on)){if(Ht&&_e&&le){zi(yt,"scrollEnd",op);return}!Yr&&ji&&ji(Ct),ot=Ct,Dr.tween&&!Ne&&(Dr.tween.kill(),Dr.tween=0),xn&&xn.pause(),Ln&&j&&j.revert({kill:!1}).invalidate(),Ct.isReverted||Ct.revert(!0,!0),Ct._subPinOffset=!1;var Ri=Za(),Mn=us(),ki=Be?Be.duration():Ws(qe,Oe),gn=Xn<=.01,Dn=0,Si=ln||0,ri=Nt(Ne)?Ne.end:q.end,Ss=q.endTrigger||Ee,Mi=Nt(Ne)?Ne.start:q.start||(q.start===0||!Ee?0:Ht?"0 0":"0 100%"),Fr=Ct.pinnedContainer=q.pinnedContainer&&Pt(q.pinnedContainer,Ct),ds=Ee&&Math.max(0,en.indexOf(Ct))||0,Jr=ds,_i,bi,Js,el,li,Yi,bo,Ih,hp,nl,Ms,Qs,vc;for(vi&&Nt(Ne)&&(Qs=It.getProperty(bt,Oe.p),vc=It.getProperty(Je,Oe.p));Jr--;)Yi=en[Jr],Yi.end||Yi.refresh(0,1)||(ot=Ct),bo=Yi.pin,bo&&(bo===Ee||bo===Ht||bo===Fr)&&!Yi.isReverted&&(nl||(nl=[]),nl.unshift(Yi),Yi.revert(!0,!0)),Yi!==en[Jr]&&(ds--,Jr--);for(X(Mi)&&(Mi=Mi(Ct)),Mi=Rn(Mi,"start",Ct),lt=Lh(Mi,Ee,Ri,Oe,Vi(),Tt,bt,Ct,Mn,ii,ir,ki,Be,Ct._startClamp&&"_startClamp")||(Ht?-.001:0),X(ri)&&(ri=ri(Ct)),vr(ri)&&!ri.indexOf("+=")&&(~ri.indexOf(" ")?ri=(vr(Mi)?Mi.split(" ")[0]:"")+ri:(Dn=Yo(ri.substr(2),Ri),ri=vr(Mi)?Mi:(Be?It.utils.mapRange(0,Be.duration(),Be.scrollTrigger.start,Be.scrollTrigger.end,lt):lt)+Dn,Ss=Ee)),ri=Rn(ri,"end",Ct),Ot=Math.max(lt,Lh(ri||(Ss?"100% 0":ki),Ss,Ri,Oe,Vi()+Dn,he,Je,Ct,Mn,ii,ir,ki,Be,Ct._endClamp&&"_endClamp"))||-.001,Dn=0,Jr=ds;Jr--;)Yi=en[Jr],bo=Yi.pin,bo&&Yi.start-Yi._pinPush<=lt&&!Be&&Yi.end>0&&(_i=Yi.end-(Ct._startClamp?Math.max(0,Yi.start):Yi.start),(bo===Ee&&Yi.start-Yi._pinPush<lt||bo===Fr)&&isNaN(Mi)&&(Dn+=_i*(1-Yi.progress)),bo===Ht&&(Si+=_i));if(lt+=Dn,Ot+=Dn,Ct._startClamp&&(Ct._startClamp+=Dn),Ct._endClamp&&!Yr&&(Ct._endClamp=Ot||-.001,Ot=Math.min(Ot,Ws(qe,Oe))),Xn=Ot-lt||(lt-=.01)&&.001,gn&&(Or=It.utils.clamp(0,1,It.utils.normalize(lt,Ot,Zr))),Ct._pinPush=Si,Tt&&Dn&&(_i={},_i[Oe.a]="+="+Dn,Fr&&(_i[Oe.p]="-="+Vi()),It.set([Tt,he],_i)),Ht)_i=Ni(Ht),el=Oe===St,Js=Vi(),yn=parseFloat(hs(Oe.a))+Si,!ki&&Ot>1&&(Ms=(gi?ne.scrollingElement||Gt:qe).style,Ms={style:Ms,value:Ms["overflow"+Oe.a.toUpperCase()]},gi&&Ni(J)["overflow"+Oe.a.toUpperCase()]!=="scroll"&&(Ms.style["overflow"+Oe.a.toUpperCase()]="scroll")),Wi(Ht,xi,_i),go=pc(Ht),bi=ai(Ht,!0),Ih=ir&&dt(qe,el?Q:St)(),ke&&(sr=[ke+Oe.os2,Xn+Si+oi],sr.t=xi,Jr=ke===Qe?Ps(Ht,Oe)+Xn+Si:0,Jr&&sr.push(Oe.d,Jr+oi),Rs(sr),Fr&&en.forEach(function(H){H.pin===Fr&&H.vars.pinSpacing!==!1&&(H._subPinOffset=!0)}),ir&&Vi(Zr)),ir&&(li={top:bi.top+(el?Js-lt:Ih)+oi,left:bi.left+(el?Ih:Js-lt)+oi,boxSizing:"border-box",position:"fixed"},li[De]=li["max"+js]=Math.ceil(bi.width)+oi,li[Ue]=li["max"+yi]=Math.ceil(bi.height)+oi,li[Ve]=li[Ve+qi]=li[Ve+Qn]=li[Ve+Rr]=li[Ve+kn]="0",li[Qe]=_i[Qe],li[Qe+qi]=_i[Qe+qi],li[Qe+Qn]=_i[Qe+Qn],li[Qe+Rr]=_i[Qe+Rr],li[Qe+kn]=_i[Qe+kn],rr=kh(Ja,li,Lr),Yr&&Vi(0)),j?(hp=j._initted,se(1),j.render(j.duration(),!0,!0),vo=hs(Oe.a)-yn+Xn+Si,Qa=Math.abs(Xn-vo)>1,ir&&Qa&&rr.splice(rr.length-2,2),j.render(0,!0,!0),hp||j.invalidate(!0),j.parent||j.totalTime(j.totalTime()),se(0)):vo=Xn,Ms&&(Ms.value?Ms.style["overflow"+Oe.a.toUpperCase()]=Ms.value:Ms.style.removeProperty("overflow-"+Oe.a));else if(Ee&&Vi()&&!Be)for(bi=Ee.parentNode;bi&&bi!==J;)bi._pinOffset&&(lt-=bi._pinOffset,Ot-=bi._pinOffset),bi=bi.parentNode;nl&&nl.forEach(function(H){return H.revert(!1,!0)}),Ct.start=lt,Ct.end=Ot,Bi=Nr=Yr?Zr:Vi(),!Be&&!Yr&&(Bi<Zr&&Vi(Zr),Ct.scroll.rec=0),Ct.revert(!1,!0),Xi=Mt(),Os&&(yr=-1,Os.restart(!0)),ot=0,j&&mi&&(j._initted||Zo)&&j.progress()!==Zo&&j.progress(Zo||0,!0).render(j.time(),!0,!0),(gn||Or!==Ct.progress||Be)&&(j&&!mi&&j.totalProgress(Be&&lt<-.001&&!Or?It.utils.normalize(lt,Ot,0):Or,!0),Ct.progress=gn||(Bi-lt)/Xn===Or?0:Or),Ht&&ke&&(xi._pinOffset=Math.round(Ct.progress*vo)),xn&&xn.invalidate(),isNaN(Qs)||(Qs-=It.getProperty(bt,Oe.p),vc-=It.getProperty(Je,Oe.p),fc(bt,Oe,Qs),fc(Tt,Oe,Qs-(ln||0)),fc(Je,Oe,vc),fc(he,Oe,vc-(ln||0))),gn&&!Yr&&Ct.update(),sn&&!Yr&&!ve&&(ve=!0,sn(Ct),ve=!1)}},Ct.getVelocity=function(){return(Vi()-Nr)/(Mt()-Qt)*1e3||0},Ct.endAnimation=function(){wt(Ct.callbackAnimation),j&&(xn?xn.progress(1):j.paused()?mi||wt(j,Ct.direction<0,1):wt(j,j.reversed()))},Ct.labelToScroll=function(_e){return j&&j.labels&&(lt||Ct.refresh()||lt)+j.labels[_e]/j.duration()*Xn||0},Ct.getTrailing=function(_e){var on=en.indexOf(Ct),Ne=Ct.direction>0?en.slice(0,on).reverse():en.slice(on+1);return(vr(_e)?Ne.filter(function(ln){return ln.vars.preventOverlaps===_e}):Ne).filter(function(ln){return Ct.direction>0?ln.end<=lt:ln.start>=Ot})},Ct.update=function(_e,on,Ne){if(!(Be&&!Ne&&!_e)){var ln=Yr===!0?Zr:Ct.scroll(),Ri=_e?0:(ln-lt)/Xn,Mn=Ri<0?0:Ri>1?1:Ri||0,ki=Ct.progress,gn,Dn,Si,ri,Ss,Mi,Fr,ds;if(on&&(Nr=Bi,Bi=Be?Vi():ln,Le&&(Ls=zr,zr=j&&!mi?j.totalProgress():Mn)),ni&&!Mn&&Ht&&!ot&&!ee&&le&&lt<ln+(ln-Nr)/(Mt()-Qt)*ni&&(Mn=1e-4),Mn!==ki&&Ct.enabled){if(gn=Ct.isActive=!!Mn&&Mn<1,Dn=!!ki&&ki<1,Mi=gn!==Dn,Ss=Mi||!!Mn!=!!ki,Ct.direction=Mn>ki?1:-1,Ct.progress=Mn,Ss&&!ot&&(Si=Mn&&!ki?0:Mn===1?1:ki===1?2:3,mi&&(ri=!Mi&&Sn[Si+1]!=="none"&&Sn[Si+1]||Sn[Si],ds=j&&(ri==="complete"||ri==="reset"||ri in j))),br&&(Mi||ds)&&(ds||Ce||!j)&&(X(br)?br(Ct):Ct.getTrailing(br).forEach(function(Js){return Js.endAnimation()})),mi||(xn&&!ot&&!ee?(xn._dp._time-xn._start!==xn._time&&xn.render(xn._dp._time-xn._start),xn.resetTo?xn.resetTo("totalProgress",Mn,j._tTime/j._tDur):(xn.vars.totalProgress=Mn,xn.invalidate().restart())):j&&j.totalProgress(Mn,!!(ot&&(Xi||_e)))),Ht){if(_e&&ke&&(xi.style[ke+Oe.os2]=ks),!ir)di(Xr(yn+vo*Mn));else if(Ss){if(Fr=!_e&&Mn>ki&&Ot+1>ln&&ln+1>=Ws(qe,Oe),Lr)if(!_e&&(gn||Fr)){var Jr=ai(Ht,!0),_i=ln-lt;Oh(Ht,J,Jr.top+(Oe===St?_i:0)+oi,Jr.left+(Oe===St?0:_i)+oi)}else Oh(Ht,xi);Rs(gn||Fr?rr:go),Qa&&Mn<1&&gn||di(yn+(Mn===1&&!Fr?vo:0))}}Le&&!Dr.tween&&!ot&&!ee&&Os.restart(!0),Et&&(Mi||nr&&Mn&&(Mn<1||!pt))&&ft(Et.targets).forEach(function(Js){return Js.classList[gn||nr?"add":"remove"](Et.className)}),Dt&&!mi&&!_e&&Dt(Ct),Ss&&!ot?(mi&&(ds&&(ri==="complete"?j.pause().totalProgress(1):ri==="reset"?j.restart(!0).pause():ri==="restart"?j.restart(!0):j[ri]()),Dt&&Dt(Ct)),(Mi||!pt)&&($e&&Mi&&Ft(Ct,$e),Fi[Si]&&Ft(Ct,Fi[Si]),nr&&(Mn===1?Ct.kill(!1,1):Fi[Si]=0),Mi||(Si=Mn===1?1:3,Fi[Si]&&Ft(Ct,Fi[Si]))),Ui&&!gn&&Math.abs(Ct.getVelocity())>(At(Ui)?Ui:2500)&&(wt(Ct.callbackAnimation),xn?xn.progress(1):wt(j,ri==="reverse"?1:!Mn,1))):mi&&Dt&&!ot&&Dt(Ct)}if(tl){var bi=Be?ln/Be.duration()*(Be._caScrollDist||0):ln;Pa(bi+(bt._isFlipped?1:0)),tl(bi)}Zs&&Zs(-ln/Be.duration()*(Be._caScrollDist||0))}},Ct.enable=function(_e,on){Ct.enabled||(Ct.enabled=!0,zi(qe,"resize",kl),gi||zi(qe,"scroll",Rl),ji&&zi(yt,"refreshInit",ji),_e!==!1&&(Ct.progress=Or=0,Bi=Nr=yr=Vi()),on!==!1&&Ct.refresh())},Ct.getTween=function(_e){return _e&&Dr?Dr.tween:xn},Ct.setPositions=function(_e,on,Ne,ln){if(Be){var Ri=Be.scrollTrigger,Mn=Be.duration(),ki=Ri.end-Ri.start;_e=Ri.start+ki*_e/Mn,on=Ri.start+ki*on/Mn}Ct.refresh(!1,!1,{start:Zn(_e,Ne&&!!Ct._startClamp),end:Zn(on,Ne&&!!Ct._endClamp)},ln),Ct.update()},Ct.adjustPinSpacing=function(_e){if(sr&&_e){var on=sr.indexOf(Oe.d)+1;sr[on]=parseFloat(sr[on])+_e+oi,sr[1]=parseFloat(sr[1])+_e+oi,Rs(sr)}},Ct.disable=function(_e,on){if(Ct.enabled&&(_e!==!1&&Ct.revert(!0,!0),Ct.enabled=Ct.isActive=!1,on||xn&&xn.pause(),Zr=0,Ir&&(Ir.uncache=1),ji&&er(yt,"refreshInit",ji),Os&&(Os.pause(),Dr.tween&&Dr.tween.kill()&&(Dr.tween=0)),!gi)){for(var Ne=en.length;Ne--;)if(en[Ne].scroller===qe&&en[Ne]!==Ct)return;er(qe,"resize",kl),gi||er(qe,"scroll",Rl)}},Ct.kill=function(_e,on){Ct.disable(_e,on),xn&&!on&&xn.kill(),de&&delete hu[de];var Ne=en.indexOf(Ct);Ne>=0&&en.splice(Ne,1),Ne===$&&Ll>0&&$--,Ne=0,en.forEach(function(ln){return ln.scroller===Ct.scroller&&(Ne=1)}),Ne||Yr||(Ct.scroll.rec=0),j&&(j.scrollTrigger=null,_e&&j.revert({kill:!1}),on||j.kill()),Tt&&[Tt,he,bt,Je].forEach(function(ln){return ln.parentNode&&ln.parentNode.removeChild(ln)}),Ol===Ct&&(Ol=0),Ht&&(Ir&&(Ir.uncache=1),Ne=0,en.forEach(function(ln){return ln.pin===Ht&&Ne++}),Ne||(Ir.spacer=0)),q.onKill&&q.onKill(Ct)},en.push(Ct),Ct.enable(!1,!1),Ur&&Ur(Ct),j&&j.add&&!Xn){var wi=Ct.update;Ct.update=function(){Ct.update=wi,lt||Ot||Ct.refresh()},It.delayedCall(.01,Ct.update),Xn=.01,lt=Ot=0}else Ct.refresh();Ht&&jn()},yt.register=function(q){return ye||(It=q||xa(),qo()&&window.document&&yt.enable(),ye=Xe),ye},yt.defaults=function(q){if(q)for(var j in q)os[j]=q[j];return os},yt.disable=function(q,j){Xe=0,en.forEach(function(Dt){return Dt[j?"kill":"disable"](q)}),er(ce,"wheel",Rl),er(ne,"scroll",Rl),clearInterval(qt),er(ne,"touchcancel",Jn),er(J,"touchstart",Jn),Sa(er,ne,"pointerdown,touchstart,mousedown",mn),Sa(er,ne,"pointerup,touchend,mouseup",jr),et.kill(),Al(er);for(var gt=0;gt<A.length;gt+=3)hc(er,A[gt],A[gt+1]),hc(er,A[gt],A[gt+2])},yt.enable=function(){if(ce=window,ne=document,Gt=ne.documentElement,J=ne.body,It&&(ft=It.utils.toArray,kt=It.utils.clamp,ue=It.core.context||Jn,se=It.core.suppressOverwrites||Jn,ae=ce.history.scrollRestoration||"auto",Ah=ce.pageYOffset,It.core.globals("ScrollTrigger",yt),J)){Xe=1,xe=document.createElement("div"),xe.style.height="100vh",xe.style.position="absolute",ei(),Wr(),re.register(It),yt.isTouch=re.isTouch,oe=re.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),zi(ce,"wheel",Rl),$t=[ce,ne,Gt,J],It.matchMedia?(yt.matchMedia=function(de){var $e=It.matchMedia(),sn;for(sn in de)$e.add(sn,de[sn]);return $e},It.addEventListener("matchMediaInit",function(){return Th()}),It.addEventListener("matchMediaRevert",function(){return mu()}),It.addEventListener("matchMedia",function(){Xs(0,1),Ea("matchMedia")}),It.matchMedia("(orientation: portrait)",function(){return pu(),pu})):console.warn("Requires GSAP 3.11.0 or later"),pu(),zi(ne,"scroll",Rl);var q=J.style,j=q.borderTopStyle,gt=It.core.Animation.prototype,Dt,Et;for(gt.revert||Object.defineProperty(gt,"revert",{value:function(){return this.time(-.01,!0)}}),q.borderTopStyle="solid",Dt=ai(J),St.m=Math.round(Dt.top+St.sc())||0,Q.m=Math.round(Dt.left+Q.sc())||0,j?q.borderTopStyle=j:q.removeProperty("border-top-style"),qt=setInterval(du,250),It.delayedCall(.5,function(){return ee=0}),zi(ne,"touchcancel",Jn),zi(J,"touchstart",Jn),Sa(zi,ne,"pointerdown,touchstart,mousedown",mn),Sa(zi,ne,"pointerup,touchend,mouseup",jr),_t=It.utils.checkPrefix("transform"),dc.push(_t),ye=Mt(),et=It.delayedCall(.2,Xs).pause(),jt=[ne,"visibilitychange",function(){var de=ce.innerWidth,$e=ce.innerHeight;ne.hidden?(B=de,Lt=$e):(B!==de||Lt!==$e)&&kl()},ne,"DOMContentLoaded",Xs,ce,"load",Xs,ce,"resize",kl],Al(zi),en.forEach(function(de){return de.enable(0,1)}),Et=0;Et<A.length;Et+=3)hc(er,A[Et],A[Et+1]),hc(er,A[Et],A[Et+2])}},yt.config=function(q){"limitCallbacks"in q&&(pt=!!q.limitCallbacks);var j=q.syncInterval;j&&clearInterval(qt)||(qt=j)&&setInterval(du,j),"ignoreMobileResize"in q&&(mt=yt.isTouch===1&&q.ignoreMobileResize),"autoRefreshEvents"in q&&(Al(er)||Al(zi,q.autoRefreshEvents||"none"),we=(q.autoRefreshEvents+"").indexOf("resize")===-1)},yt.scrollerProxy=function(q,j){var gt=Pt(q),Dt=A.indexOf(gt),Et=As(gt);~Dt&&A.splice(Dt,Et?6:2),j&&(Et?R.unshift(ce,j,J,j,Gt,j):R.unshift(gt,j))},yt.clearMatchMedia=function(q){en.forEach(function(j){return j._ctx&&j._ctx.query===q&&j._ctx.kill(!0,!0)})},yt.isInViewport=function(q,j,gt){var Dt=(vr(q)?Pt(q):q).getBoundingClientRect(),Et=Dt[gt?De:Ue]*j||0;return gt?Dt.right-Et>0&&Dt.left+Et<ce.innerWidth:Dt.bottom-Et>0&&Dt.top+Et<ce.innerHeight},yt.positionInViewport=function(q,j,gt){vr(q)&&(q=Pt(q));var Dt=q.getBoundingClientRect(),Et=Dt[gt?De:Ue],de=j==null?Et/2:j in as?as[j]*Et:~j.indexOf("%")?parseFloat(j)*Et/100:parseFloat(j)||0;return gt?(Dt.left+de)/ce.innerWidth:(Dt.top+de)/ce.innerHeight},yt.killAll=function(q){if(en.slice(0).forEach(function(gt){return gt.vars.id!=="ScrollSmoother"&&gt.kill()}),q!==!0){var j=Ca.killAll||[];Ca={},j.forEach(function(gt){return gt()})}},yt}();Fe.version="3.12.2",Fe.saveStyles=function(yt){return yt?ft(yt).forEach(function(F){if(F&&F.style){var at=ls.indexOf(F);at>=0&&ls.splice(at,5),ls.push(F,F.style.cssText,F.getBBox&&F.getAttribute("transform"),It.core.getCache(F),ue())}}):ls},Fe.revert=function(yt,F){return Th(!yt,F)},Fe.create=function(yt,F){return new Fe(yt,F)},Fe.refresh=function(yt){return yt?kl():(ye||Fe.register())&&Xs(!0)},Fe.update=function(yt){return++A.cache&&Ko(yt===!0?2:0)},Fe.clearScrollMemory=ap,Fe.maxScroll=function(yt,F){return Ws(yt,F?Q:St)},Fe.getScrollFunc=function(yt,F){return dt(Pt(yt),F?Q:St)},Fe.getById=function(yt){return hu[yt]},Fe.getAll=function(){return en.filter(function(yt){return yt.vars.id!=="ScrollSmoother"})},Fe.isScrolling=function(){return!!le},Fe.snapDirectional=Xa,Fe.addEventListener=function(yt,F){var at=Ca[yt]||(Ca[yt]=[]);~at.indexOf(F)||at.push(F)},Fe.removeEventListener=function(yt,F){var at=Ca[yt],q=at&&at.indexOf(F);q>=0&&at.splice(q,1)},Fe.batch=function(yt,F){var at=[],q={},j=F.interval||.016,gt=F.batchMax||1e9,Dt=function($e,sn){var Ce=[],Ee=[],Ht=It.delayedCall(j,function(){sn(Ce,Ee),Ce=[],Ee=[]}).pause();return function(ke){Ce.length||Ht.restart(!0),Ce.push(ke.trigger),Ee.push(ke),gt<=Ce.length&&Ht.progress(1)}},Et;for(Et in F)q[Et]=Et.substr(0,2)==="on"&&X(F[Et])&&Et!=="onRefreshInit"?Dt(Et,F[Et]):F[Et];return X(gt)&&(gt=gt(),zi(Fe,"refresh",function(){return gt=F.batchMax()})),ft(yt).forEach(function(de){var $e={};for(Et in q)$e[Et]=q[Et];$e.trigger=de,at.push(Fe.create($e))}),at};var cp=function(F,at,q,j){return at>j?F(j):at<0&&F(0),q>j?(j-at)/(q-at):q<0?at/(at-q):1},cs=function yt(F,at){at===!0?F.style.removeProperty("touch-action"):F.style.touchAction=at===!0?"auto":at?"pan-"+at+(re.isTouch?" pinch-zoom":""):"none",F===Gt&&yt(J,at)},mc={auto:1,scroll:1},up=function(F){var at=F.event,q=F.target,j=F.axis,gt=(at.changedTouches?at.changedTouches[0]:at).target,Dt=gt._gsap||It.core.getCache(gt),Et=Mt(),de;if(!Dt._isScrollT||Et-Dt._isScrollT>2e3){for(;gt&&gt!==J&&(gt.scrollHeight<=gt.clientHeight&&gt.scrollWidth<=gt.clientWidth||!(mc[(de=Ni(gt)).overflowY]||mc[de.overflowX]));)gt=gt.parentNode;Dt._isScroll=gt&&gt!==q&&!As(gt)&&(mc[(de=Ni(gt)).overflowY]||mc[de.overflowX]),Dt._isScrollT=Et}(Dt._isScroll||j==="x")&&(at.stopPropagation(),at._gsapAllow=!0)},_r=function(F,at,q,j){return re.create({target:F,capture:!0,debounce:!1,lockAxis:!0,type:at,onWheel:j=j&&up,onPress:j,onDrag:j,onScroll:j,onEnable:function(){return q&&zi(ne,re.eventTypes[0],nn,!1,!0)},onDisable:function(){return er(ne,re.eventTypes[0],nn,!0)}})},gc=/(input|label|select|textarea)/i,_u,nn=function(F){var at=gc.test(F.target.tagName);(at||_u)&&(F._gsapAllow=!0,_u=at)},Ta=function(F){Nt(F)||(F={}),F.preventDefault=F.isNormalizer=F.allowClicks=!0,F.type||(F.type="wheel,touch"),F.debounce=!!F.debounce,F.id=F.id||"normalizer";var at=F,q=at.normalizeScrollX,j=at.momentum,gt=at.allowNestedScroll,Dt=at.onRelease,Et,de,$e=Pt(F.target)||Gt,sn=It.core.globals().ScrollSmoother,Ce=sn&&sn.get(),Ee=oe&&(F.content&&Pt(F.content)||Ce&&F.content!==!1&&!Ce.smooth()&&Ce.content()),Ht=dt($e,St),ke=dt($e,Q),Ln=1,ni=(re.isTouch&&ce.visualViewport?ce.visualViewport.scale*ce.visualViewport.width:ce.outerWidth)/ce.innerWidth,ui=0,hi=X(j)?function(){return j(Et)}:function(){return j||2.8},nr,Le,Lr=_r($e,F.type,!0,gt),ti=function(){return Le=!1},Be=Jn,Ui=Jn,br=function(){de=Ws($e,St),Ui=kt(oe?1:0,de),q&&(Be=kt(0,Ws($e,Q))),nr=Ka},Oe=function(){Ee._gsap.y=Xr(parseFloat(Ee._gsap.y)+Ht.offset)+"px",Ee.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(Ee._gsap.y)+", 0, 1)",Ht.offset=Ht.cacheID=0},mi=function(){if(Le){requestAnimationFrame(ti);var vi=Xr(Et.deltaY/2),ii=Ui(Ht.v-vi);if(Ee&&ii!==Ht.v+Ht.offset){Ht.offset=ii-Ht.v;var Ct=Xr((parseFloat(Ee&&Ee._gsap.y)||0)-Ht.offset);Ee.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+Ct+", 0, 1)",Ee._gsap.y=Ct+"px",Ht.cacheID=A.cache,Ko()}return!0}Ht.offset&&Oe(),Le=!0},qe,Ys,gi,ir,Fi=function(){br(),qe.isActive()&&qe.vars.scrollY>de&&(Ht()>de?qe.progress(1)&&Ht(de):qe.resetTo("scrollY",de))};return Ee&&It.set(Ee,{y:"+=0"}),F.ignoreCheck=function(Sn){return oe&&Sn.type==="touchmove"&&mi()||Ln>1.05&&Sn.type!=="touchstart"||Et.isGesturing||Sn.touches&&Sn.touches.length>1},F.onPress=function(){Le=!1;var Sn=Ln;Ln=Xr((ce.visualViewport&&ce.visualViewport.scale||1)/ni),qe.pause(),Sn!==Ln&&cs($e,Ln>1.01?!0:q?!1:"x"),Ys=ke(),gi=Ht(),br(),nr=Ka},F.onRelease=F.onGestureStart=function(Sn,vi){if(Ht.offset&&Oe(),!vi)ir.restart(!0);else{A.cache++;var ii=hi(),Ct,ji;q&&(Ct=ke(),ji=Ct+ii*.05*-Sn.velocityX/.227,ii*=cp(ke,Ct,ji,Ws($e,Q)),qe.vars.scrollX=Be(ji)),Ct=Ht(),ji=Ct+ii*.05*-Sn.velocityY/.227,ii*=cp(Ht,Ct,ji,Ws($e,St)),qe.vars.scrollY=Ui(ji),qe.invalidate().duration(ii).play(.01),(oe&&qe.vars.scrollY>=de||Ct>=de-1)&&It.to({},{onUpdate:Fi,duration:ii})}Dt&&Dt(Sn)},F.onWheel=function(){qe._ts&&qe.pause(),Mt()-ui>1e3&&(nr=0,ui=Mt())},F.onChange=function(Sn,vi,ii,Ct,ji){if(Ka!==nr&&br(),vi&&q&&ke(Be(Ct[2]===vi?Ys+(Sn.startX-Sn.x):ke()+vi-Ct[1])),ii){Ht.offset&&Oe();var Za=ji[2]===ii,us=Za?gi+Sn.startY-Sn.y:Ht()+ii-ji[1],yr=Ui(us);Za&&us!==yr&&(gi+=yr-us),Ht(yr)}(ii||vi)&&Ko()},F.onEnable=function(){cs($e,q?!1:"x"),Fe.addEventListener("refresh",Fi),zi(ce,"resize",Fi),Ht.smooth&&(Ht.target.style.scrollBehavior="auto",Ht.smooth=ke.smooth=!1),Lr.enable()},F.onDisable=function(){cs($e,!0),er(ce,"resize",Fi),Fe.removeEventListener("refresh",Fi),Lr.kill()},F.lockAxis=F.lockAxis!==!1,Et=new re(F),Et.iOS=oe,oe&&!Ht()&&Ht(1),oe&&It.ticker.add(Jn),ir=Et._dc,qe=It.to(Et,{ease:"power4",paused:!0,scrollX:q?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:Dh(Ht,Ht(),function(){return qe.pause()})},onUpdate:Ko,onComplete:ir.vars.onComplete}),Et};Fe.sort=function(yt){return en.sort(yt||function(F,at){return(F.vars.refreshPriority||0)*-1e6+F.start-(at.start+(at.vars.refreshPriority||0)*-1e6)})},Fe.observe=function(yt){return new re(yt)},Fe.normalizeScroll=function(yt){if(typeof yt>"u")return ht;if(yt===!0&&ht)return ht.enable();if(yt===!1)return ht&&ht.kill();var F=yt instanceof re?yt:Ta(yt);return ht&&ht.target===F.target&&ht.kill(),As(F.target)&&(ht=F),F},Fe.core={_getVelocityProp:Rt,_inputObserver:_r,_scrollers:A,_proxies:R,bridge:{ss:function(){le||Ea("scrollStart"),le=Mt()},ref:function(){return ot}}},xa()&&It.registerPlugin(Fe),e.ScrollTrigger=Fe,e.default=Fe,typeof window>"u"||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete window.default})})(OC,OC.exports);var YQt=OC.exports;function Hc(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function ZF(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.__proto__=t}/*!
 * GSAP 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var va={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Lf={duration:.5,overwrite:!1,delay:0},uA,Vs,dr,Ha=1e8,Ei=1/Ha,DC=Math.PI*2,KQt=DC/4,ZQt=0,JF=Math.sqrt,JQt=Math.cos,QQt=Math.sin,xs=function(t){return typeof t=="string"},fr=function(t){return typeof t=="function"},eu=function(t){return typeof t=="number"},hA=function(t){return typeof t>"u"},rc=function(t){return typeof t=="object"},No=function(t){return t!==!1},dA=function(){return typeof window<"u"},Eb=function(t){return fr(t)||xs(t)},QF=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Bs=Array.isArray,IC=/(?:-?\.?\d|\.)+/gi,tV=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,sf=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,nM=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,eV=/[+-]=-?[.\d]+/,nV=/[^,'"\[\]\s]+/gi,tte=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Zi,za,NC,pA,ya={},_y={},iV,rV=function(t){return(_y=Nd(t,ya))&&Bo},fA=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},by=function(t,e){return!e&&console.warn(t)},sV=function(t,e){return t&&(ya[t]=e)&&_y&&(_y[t]=e)||ya},cv=function(){return 0},ete={suppressEvents:!0,isStart:!0,kill:!1},$b={suppressEvents:!0,kill:!1},nte={suppressEvents:!0},mA={},Ku=[],zC={},oV,aa={},iM={},$O=30,Gb=[],gA="",vA=function(t){var e=t[0],n,r;if(rc(e)||fr(e)||(t=[t]),!(n=(e._gsap||{}).harness)){for(r=Gb.length;r--&&!Gb[r].targetTest(e););n=Gb[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new RV(t[r],n)))||t.splice(r,1);return t},Sd=function(t){return t._gsap||vA($a(t))[0]._gsap},aV=function(t,e,n){return(n=t[e])&&fr(n)?t[e]():hA(n)&&t.getAttribute&&t.getAttribute(e)||n},zo=function(t,e){return(t=t.split(",")).forEach(e)||t},Mr=function(t){return Math.round(t*1e5)/1e5||0},Cs=function(t){return Math.round(t*1e7)/1e7||0},uf=function(t,e){var n=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),n==="+"?t+r:n==="-"?t-r:n==="*"?t*r:t/r},ite=function(t,e){for(var n=e.length,r=0;t.indexOf(e[r])<0&&++r<n;);return r<n},yy=function(){var t=Ku.length,e=Ku.slice(0),n,r;for(zC={},Ku.length=0,n=0;n<t;n++)r=e[n],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},lV=function(t,e,n,r){Ku.length&&!Vs&&yy(),t.render(e,n,r||Vs&&e<0&&(t._initted||t._startAt)),Ku.length&&!Vs&&yy()},cV=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(nV).length<2?e:xs(t)?t.trim():t},uV=function(t){return t},Wa=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},rte=function(t){return function(e,n){for(var r in n)r in e||r==="duration"&&t||r==="ease"||(e[r]=n[r])}},Nd=function(t,e){for(var n in e)t[n]=e[n];return t},GO=function i(t,e){for(var n in e)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(t[n]=rc(e[n])?i(t[n]||(t[n]={}),e[n]):e[n]);return t},xy=function(t,e){var n={},r;for(r in t)r in e||(n[r]=t[r]);return n},Rg=function(t){var e=t.parent||Zi,n=t.keyframes?rte(Bs(t.keyframes)):Wa;if(No(t.inherit))for(;e;)n(t,e.vars.defaults),e=e.parent||e._dp;return t},ste=function(t,e){for(var n=t.length,r=n===e.length;r&&n--&&t[n]===e[n];);return n<0},hV=function(t,e,n,r,s){n===void 0&&(n="_first"),r===void 0&&(r="_last");var o=t[r],a;if(s)for(a=e[s];o&&o[s]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},Sw=function(t,e,n,r){n===void 0&&(n="_first"),r===void 0&&(r="_last");var s=e._prev,o=e._next;s?s._next=o:t[n]===e&&(t[n]=o),o?o._prev=s:t[r]===e&&(t[r]=s),e._next=e._prev=e.parent=null},ch=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Md=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},ote=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},UC=function(t,e,n,r){return t._startAt&&(Vs?t._startAt.revert($b):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},ate=function i(t){return!t||t._ts&&i(t.parent)},qO=function(t){return t._repeat?Of(t._tTime,t=t.duration()+t._rDelay)*t:0},Of=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},wy=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Mw=function(t){return t._end=Cs(t._start+(t._tDur/Math.abs(t._ts||t._rts||Ei)||0))},Cw=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Cs(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Mw(t),n._dirty||Md(n,t)),t},dV=function(t,e){var n;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(n=wy(t.rawTime(),e),(!e._dur||k_(0,e.totalDuration(),n)-e._tTime>Ei)&&e.render(n,!0)),Md(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-Ei}},Hl=function(t,e,n,r){return e.parent&&ch(e),e._start=Cs((eu(n)?n:n||t!==Zi?Na(t,n,e):t._time)+e._delay),e._end=Cs(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),hV(t,e,"_first","_last",t._sort?"_start":0),FC(e)||(t._recent=e),r||dV(t,e),t._ts<0&&Cw(t,t._tTime),t},pV=function(t,e){return(ya.ScrollTrigger||fA("scrollTrigger",e))&&ya.ScrollTrigger.create(e,t)},fV=function(t,e,n,r,s){if(bA(t,e,s),!t._initted)return 1;if(!n&&t._pt&&!Vs&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&oV!==da.frame)return Ku.push(t),t._lazy=[s,r],1},lte=function i(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||i(e))},FC=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},cte=function(t,e,n,r){var s=t.ratio,o=e<0||!e&&(!t._start&&lte(t)&&!(!t._initted&&FC(t))||(t._ts<0||t._dp._ts<0)&&!FC(t))?0:1,a=t._rDelay,l=0,c,u,h;if(a&&t._repeat&&(l=k_(0,t._tDur,e),u=Of(l,a),t._yoyo&&u&1&&(o=1-o),u!==Of(t._tTime,a)&&(s=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==s||Vs||r||t._zTime===Ei||!e&&t._zTime){if(!t._initted&&fV(t,e,r,n,l))return;for(h=t._zTime,t._zTime=e||(n?Ei:0),n||(n=e&&!h),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=l,c=t._pt;c;)c.r(o,c.d),c=c._next;e<0&&UC(t,e,n,!0),t._onUpdate&&!n&&Ga(t,"onUpdate"),l&&t._repeat&&!n&&t.parent&&Ga(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&ch(t,1),!n&&!Vs&&(Ga(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},ute=function(t,e,n){var r;if(n>e)for(r=t._first;r&&r._start<=n;){if(r.data==="isPause"&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=n;){if(r.data==="isPause"&&r._start<e)return r;r=r._prev}},Df=function(t,e,n,r){var s=t._repeat,o=Cs(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=s?s<0?1e10:Cs(o*(s+1)+t._rDelay*s):o,a>0&&!r&&Cw(t,t._tTime=t._tDur*a),t.parent&&Mw(t),n||Md(t.parent,t),t},WO=function(t){return t instanceof Oo?Md(t):Df(t,t._dur)},hte={_start:0,endTime:cv,totalDuration:cv},Na=function i(t,e,n){var r=t.labels,s=t._recent||hte,o=t.duration()>=Ha?s.endTime(!1):t._dur,a,l,c;return xs(e)&&(isNaN(e)||e in r)?(l=e.charAt(0),c=e.substr(-1)==="%",a=e.indexOf("="),l==="<"||l===">"?(a>=0&&(e=e.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(e.substr(1))||0)*(c?(a<0?s:n).totalDuration()/100:1)):a<0?(e in r||(r[e]=o),r[e]):(l=parseFloat(e.charAt(a-1)+e.substr(a+1)),c&&n&&(l=l/100*(Bs(n)?n[0]:n).totalDuration()),a>1?i(t,e.substr(0,a-1),n)+l:o+l)):e==null?o:+e},kg=function(t,e,n){var r=eu(e[1]),s=(r?2:1)+(t<2?0:1),o=e[s],a,l;if(r&&(o.duration=e[1]),o.parent=n,t){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=No(l.vars.inherit)&&l.parent;o.immediateRender=No(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[s-1]}return new Br(e[0],o,e[s+1])},Eh=function(t,e){return t||t===0?e(t):e},k_=function(t,e,n){return n<t?t:n>e?e:n},zs=function(t,e){return!xs(t)||!(e=tte.exec(t))?"":e[1]},dte=function(t,e,n){return Eh(n,function(r){return k_(t,e,r)})},VC=[].slice,mV=function(t,e){return t&&rc(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&rc(t[0]))&&!t.nodeType&&t!==za},pte=function(t,e,n){return n===void 0&&(n=[]),t.forEach(function(r){var s;return xs(r)&&!e||mV(r,1)?(s=n).push.apply(s,$a(r)):n.push(r)})||n},$a=function(t,e,n){return dr&&!e&&dr.selector?dr.selector(t):xs(t)&&!n&&(NC||!If())?VC.call((e||pA).querySelectorAll(t),0):Bs(t)?pte(t,n):mV(t)?VC.call(t,0):t?[t]:[]},BC=function(t){return t=$a(t)[0]||by("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return $a(e,n.querySelectorAll?n:n===t?by("Invalid scope")||pA.createElement("div"):t)}},gV=function(t){return t.sort(function(){return .5-Math.random()})},vV=function(t){if(fr(t))return t;var e=rc(t)?t:{each:t},n=Cd(e.ease),r=e.from||0,s=parseFloat(e.base)||0,o={},a=r>0&&r<1,l=isNaN(r)||a,c=e.axis,u=r,h=r;return xs(r)?u=h={center:.5,edges:.5,end:1}[r]||0:!a&&l&&(u=r[0],h=r[1]),function(p,m,v){var _=(v||e).length,b=o[_],y,M,S,E,A,R,O,L,P;if(!b){if(P=e.grid==="auto"?0:(e.grid||[1,Ha])[1],!P){for(O=-Ha;O<(O=v[P++].getBoundingClientRect().left)&&P<_;);P--}for(b=o[_]=[],y=l?Math.min(P,_)*u-.5:r%P,M=P===Ha?0:l?_*h/P-.5:r/P|0,O=0,L=Ha,R=0;R<_;R++)S=R%P-y,E=M-(R/P|0),b[R]=A=c?Math.abs(c==="y"?E:S):JF(S*S+E*E),A>O&&(O=A),A<L&&(L=A);r==="random"&&gV(b),b.max=O-L,b.min=L,b.v=_=(parseFloat(e.amount)||parseFloat(e.each)*(P>_?_-1:c?c==="y"?_/P:P:Math.max(P,_/P))||0)*(r==="edges"?-1:1),b.b=_<0?s-_:s,b.u=zs(e.amount||e.each)||0,n=n&&_<0?TV(n):n}return _=(b[p]-b.min)/b.max||0,Cs(b.b+(n?n(_):_)*b.v)+b.u}},HC=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var r=Cs(Math.round(parseFloat(n)/t)*t*e);return(r-r%1)/e+(eu(n)?0:zs(n))}},_V=function(t,e){var n=Bs(t),r,s;return!n&&rc(t)&&(r=n=t.radius||Ha,t.values?(t=$a(t.values),(s=!eu(t[0]))&&(r*=r)):t=HC(t.increment)),Eh(e,n?fr(t)?function(o){return s=t(o),Math.abs(s-o)<=r?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),c=Ha,u=0,h=t.length,p,m;h--;)s?(p=t[h].x-a,m=t[h].y-l,p=p*p+m*m):p=Math.abs(t[h]-a),p<c&&(c=p,u=h);return u=!r||c<=r?t[u]:o,s||u===o||eu(o)?u:u+zs(o)}:HC(t))},bV=function(t,e,n,r){return Eh(Bs(t)?!e:n===!0?!!(n=0):!r,function(){return Bs(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+n*.99))/n)*n*r)/r})},fte=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduce(function(s,o){return o(s)},r)}},mte=function(t,e){return function(n){return t(parseFloat(n))+(e||zs(n))}},gte=function(t,e,n){return xV(t,e,0,1,n)},yV=function(t,e,n){return Eh(n,function(r){return t[~~e(r)]})},vte=function i(t,e,n){var r=e-t;return Bs(t)?yV(t,i(0,t.length),e):Eh(n,function(s){return(r+(s-t)%r)%r+t})},_te=function i(t,e,n){var r=e-t,s=r*2;return Bs(t)?yV(t,i(0,t.length-1),e):Eh(n,function(o){return o=(s+(o-t)%s)%s||0,t+(o>r?s-o:o)})},uv=function(t){for(var e=0,n="",r,s,o,a;~(r=t.indexOf("random(",e));)o=t.indexOf(")",r),a=t.charAt(r+7)==="[",s=t.substr(r+7,o-r-7).match(a?nV:IC),n+=t.substr(e,r-e)+bV(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),e=o+1;return n+t.substr(e,t.length-e)},xV=function(t,e,n,r,s){var o=e-t,a=r-n;return Eh(s,function(l){return n+((l-t)/o*a||0)})},bte=function i(t,e,n,r){var s=isNaN(t+e)?0:function(m){return(1-m)*t+m*e};if(!s){var o=xs(t),a={},l,c,u,h,p;if(n===!0&&(r=1)&&(n=null),o)t={p:t},e={p:e};else if(Bs(t)&&!Bs(e)){for(u=[],h=t.length,p=h-2,c=1;c<h;c++)u.push(i(t[c-1],t[c]));h--,s=function(v){v*=h;var _=Math.min(p,~~v);return u[_](v-_)},n=e}else r||(t=Nd(Bs(t)?[]:{},t));if(!u){for(l in e)_A.call(a,t,l,"get",e[l]);s=function(v){return wA(v,a)||(o?t.p:t)}}}return Eh(n,s)},jO=function(t,e,n){var r=t.labels,s=Ha,o,a,l;for(o in r)a=r[o]-e,a<0==!!n&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},Ga=function(t,e,n){var r=t.vars,s=r[e],o=dr,a=t._ctx,l,c,u;if(s)return l=r[e+"Params"],c=r.callbackScope||t,n&&Ku.length&&yy(),a&&(dr=a),u=l?s.apply(c,l):s.call(c),dr=o,u},_g=function(t){return ch(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Vs),t.progress()<1&&Ga(t,"onInterrupt"),t},of,wV=[],SV=function(t){if(dA()&&t){t=!t.name&&t.default||t;var e=t.name,n=fr(t),r=e&&!n&&t.init?function(){this._props=[]}:t,s={init:cv,render:wA,add:_A,kill:Ite,modifier:Dte,rawVars:0},o={targetTest:0,get:0,getSetter:xA,aliases:{},register:0};if(If(),t!==r){if(aa[e])return;Wa(r,Wa(xy(t,s),o)),Nd(r.prototype,Nd(s,xy(t,o))),aa[r.prop=e]=r,t.targetTest&&(Gb.push(r),mA[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}sV(e,r),t.register&&t.register(Bo,r,Uo)}else t&&wV.push(t)},Ci=255,bg={aqua:[0,Ci,Ci],lime:[0,Ci,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ci],navy:[0,0,128],white:[Ci,Ci,Ci],olive:[128,128,0],yellow:[Ci,Ci,0],orange:[Ci,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ci,0,0],pink:[Ci,192,203],cyan:[0,Ci,Ci],transparent:[Ci,Ci,Ci,0]},rM=function(t,e,n){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(n-e)*t*6:t<.5?n:t*3<2?e+(n-e)*(2/3-t)*6:e)*Ci+.5|0},MV=function(t,e,n){var r=t?eu(t)?[t>>16,t>>8&Ci,t&Ci]:0:bg.black,s,o,a,l,c,u,h,p,m,v;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),bg[t])r=bg[t];else if(t.charAt(0)==="#"){if(t.length<6&&(s=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+s+s+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&Ci,r&Ci,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&Ci,t&Ci]}else if(t.substr(0,3)==="hsl"){if(r=v=t.match(IC),!e)l=+r[0]%360/360,c=+r[1]/100,u=+r[2]/100,o=u<=.5?u*(c+1):u+c-u*c,s=u*2-o,r.length>3&&(r[3]*=1),r[0]=rM(l+1/3,s,o),r[1]=rM(l,s,o),r[2]=rM(l-1/3,s,o);else if(~t.indexOf("="))return r=t.match(tV),n&&r.length<4&&(r[3]=1),r}else r=t.match(IC)||bg.transparent;r=r.map(Number)}return e&&!v&&(s=r[0]/Ci,o=r[1]/Ci,a=r[2]/Ci,h=Math.max(s,o,a),p=Math.min(s,o,a),u=(h+p)/2,h===p?l=c=0:(m=h-p,c=u>.5?m/(2-h-p):m/(h+p),l=h===s?(o-a)/m+(o<a?6:0):h===o?(a-s)/m+2:(s-o)/m+4,l*=60),r[0]=~~(l+.5),r[1]=~~(c*100+.5),r[2]=~~(u*100+.5)),n&&r.length<4&&(r[3]=1),r},CV=function(t){var e=[],n=[],r=-1;return t.split(Zu).forEach(function(s){var o=s.match(sf)||[];e.push.apply(e,o),n.push(r+=o.length+1)}),e.c=n,e},XO=function(t,e,n){var r="",s=(t+r).match(Zu),o=e?"hsla(":"rgba(",a=0,l,c,u,h;if(!s)return t;if(s=s.map(function(p){return(p=MV(p,e,1))&&o+(e?p[0]+","+p[1]+"%,"+p[2]+"%,"+p[3]:p.join(","))+")"}),n&&(u=CV(t),l=n.c,l.join(r)!==u.c.join(r)))for(c=t.replace(Zu,"1").split(sf),h=c.length-1;a<h;a++)r+=c[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:n).shift());if(!c)for(c=t.split(Zu),h=c.length-1;a<h;a++)r+=c[a]+s[a];return r+c[h]},Zu=function(){var i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in bg)i+="|"+t+"\\b";return new RegExp(i+")","gi")}(),yte=/hsl[a]?\(/,EV=function(t){var e=t.join(" "),n;if(Zu.lastIndex=0,Zu.test(e))return n=yte.test(e),t[1]=XO(t[1],n),t[0]=XO(t[0],n,CV(t[1])),!0},hv,da=function(){var i=Date.now,t=500,e=33,n=i(),r=n,s=1e3/240,o=s,a=[],l,c,u,h,p,m,v=function _(b){var y=i()-r,M=b===!0,S,E,A,R;if(y>t&&(n+=y-e),r+=y,A=r-n,S=A-o,(S>0||M)&&(R=++h.frame,p=A-h.time*1e3,h.time=A=A/1e3,o+=S+(S>=s?4:s-S),E=1),M||(l=c(_)),E)for(m=0;m<a.length;m++)a[m](A,p,R,b)};return h={time:0,frame:0,tick:function(){v(!0)},deltaRatio:function(b){return p/(1e3/(b||60))},wake:function(){iV&&(!NC&&dA()&&(za=NC=window,pA=za.document||{},ya.gsap=Bo,(za.gsapVersions||(za.gsapVersions=[])).push(Bo.version),rV(_y||za.GreenSockGlobals||!za.gsap&&za||{}),u=za.requestAnimationFrame,wV.forEach(SV)),l&&h.sleep(),c=u||function(b){return setTimeout(b,o-h.time*1e3+1|0)},hv=1,v(2))},sleep:function(){(u?za.cancelAnimationFrame:clearTimeout)(l),hv=0,c=cv},lagSmoothing:function(b,y){t=b||1/0,e=Math.min(y||33,t)},fps:function(b){s=1e3/(b||240),o=h.time*1e3+s},add:function(b,y,M){var S=y?function(E,A,R,O){b(E,A,R,O),h.remove(S)}:b;return h.remove(b),a[M?"unshift":"push"](S),If(),S},remove:function(b,y){~(y=a.indexOf(b))&&a.splice(y,1)&&m>=y&&m--},_listeners:a},h}(),If=function(){return!hv&&da.wake()},Hn={},xte=/^[\d.\-M][\d.\-,\s]/,wte=/["']/g,Ste=function(t){for(var e={},n=t.substr(1,t.length-3).split(":"),r=n[0],s=1,o=n.length,a,l,c;s<o;s++)l=n[s],a=s!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),e[r]=isNaN(c)?c.replace(wte,"").trim():+c,r=l.substr(a+1).trim();return e},Mte=function(t){var e=t.indexOf("(")+1,n=t.indexOf(")"),r=t.indexOf("(",e);return t.substring(e,~r&&r<n?t.indexOf(")",n+1):n)},Cte=function(t){var e=(t+"").split("("),n=Hn[e[0]];return n&&e.length>1&&n.config?n.config.apply(null,~t.indexOf("{")?[Ste(e[1])]:Mte(t).split(",").map(cV)):Hn._CE&&xte.test(t)?Hn._CE("",t):n},TV=function(t){return function(e){return 1-t(1-e)}},AV=function i(t,e){for(var n=t._first,r;n;)n instanceof Oo?i(n,e):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==e&&(n.timeline?i(n.timeline,e):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=e)),n=n._next},Cd=function(t,e){return t&&(fr(t)?t:Hn[t]||Cte(t))||e},sp=function(t,e,n,r){n===void 0&&(n=function(l){return 1-e(1-l)}),r===void 0&&(r=function(l){return l<.5?e(l*2)/2:1-e((1-l)*2)/2});var s={easeIn:e,easeOut:n,easeInOut:r},o;return zo(t,function(a){Hn[a]=ya[a]=s,Hn[o=a.toLowerCase()]=n;for(var l in s)Hn[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=Hn[a+"."+l]=s[l]}),s},PV=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},sM=function i(t,e,n){var r=e>=1?e:1,s=(n||(t?.3:.45))/(e<1?e:1),o=s/DC*(Math.asin(1/r)||0),a=function(u){return u===1?1:r*Math.pow(2,-10*u)*QQt((u-o)*s)+1},l=t==="out"?a:t==="in"?function(c){return 1-a(1-c)}:PV(a);return s=DC/s,l.config=function(c,u){return i(t,c,u)},l},oM=function i(t,e){e===void 0&&(e=1.70158);var n=function(o){return o?--o*o*((e+1)*o+e)+1:0},r=t==="out"?n:t==="in"?function(s){return 1-n(1-s)}:PV(n);return r.config=function(s){return i(t,s)},r};zo("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,t){var e=t<5?t+1:t;sp(i+",Power"+(e-1),t?function(n){return Math.pow(n,e)}:function(n){return n},function(n){return 1-Math.pow(1-n,e)},function(n){return n<.5?Math.pow(n*2,e)/2:1-Math.pow((1-n)*2,e)/2})});Hn.Linear.easeNone=Hn.none=Hn.Linear.easeIn;sp("Elastic",sM("in"),sM("out"),sM());(function(i,t){var e=1/t,n=2*e,r=2.5*e,s=function(a){return a<e?i*a*a:a<n?i*Math.pow(a-1.5/t,2)+.75:a<r?i*(a-=2.25/t)*a+.9375:i*Math.pow(a-2.625/t,2)+.984375};sp("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);sp("Expo",function(i){return i?Math.pow(2,10*(i-1)):0});sp("Circ",function(i){return-(JF(1-i*i)-1)});sp("Sine",function(i){return i===1?1:-JQt(i*KQt)+1});sp("Back",oM("in"),oM("out"),oM());Hn.SteppedEase=Hn.steps=ya.SteppedEase={config:function(t,e){t===void 0&&(t=1);var n=1/t,r=t+(e?0:1),s=e?1:0,o=1-Ei;return function(a){return((r*k_(0,o,a)|0)+s)*n}}};Lf.ease=Hn["quad.out"];zo("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return gA+=i+","+i+"Params,"});var RV=function(t,e){this.id=ZQt++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:aV,this.set=e?e.getSetter:xA},dv=function(){function i(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Df(this,+e.duration,1,1),this.data=e.data,dr&&(this._ctx=dr,dr.data.push(this)),hv||da.wake()}var t=i.prototype;return t.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},t.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},t.totalDuration=function(n){return arguments.length?(this._dirty=0,Df(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(n,r){if(If(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Cw(this,n),!s._dp||s.parent||dV(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Hl(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Ei||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),lV(this,n,r)),this},t.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+qO(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},t.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+qO(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(n,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,r):this._repeat?Of(this._tTime,s)+1:1},t.timeScale=function(n){if(!arguments.length)return this._rts===-Ei?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?wy(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Ei?0:this._rts,this.totalTime(k_(-Math.abs(this._delay),this._tDur,r),!0),Mw(this),ote(this)},t.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(If(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Ei&&(this._tTime-=Ei)))),this):this._ps},t.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Hl(r,this,n-this._delay),this}return this._start},t.endTime=function(n){return this._start+(No(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?wy(r.rawTime(n),this):this._tTime:this._tTime},t.revert=function(n){n===void 0&&(n=nte);var r=Vs;return Vs=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),Vs=r,this},t.globalTime=function(n){for(var r=this,s=arguments.length?n:r.rawTime();r;)s=r._start+s/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1/0:this._sat.globalTime(n):s},t.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,WO(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,WO(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},t.seek=function(n,r){return this.totalTime(Na(this,n),No(r))},t.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,No(r))},t.play=function(n,r){return n!=null&&this.seek(n,r),this.reversed(!1).paused(!1)},t.reverse=function(n,r){return n!=null&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(n,r){return n!=null&&this.seek(n,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Ei:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-Ei,this},t.isActive=function(){var n=this.parent||this._dp,r=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=r&&s<this.endTime(!0)-Ei)},t.eventCallback=function(n,r,s){var o=this.vars;return arguments.length>1?(r?(o[n]=r,s&&(o[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=r)):delete o[n],this):o[n]},t.then=function(n){var r=this;return new Promise(function(s){var o=fr(n)?n:uV,a=function(){var c=r.then;r.then=null,fr(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=c),s(o),r.then=c};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},t.kill=function(){_g(this)},i}();Wa(dv.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Ei,_prom:0,_ps:!1,_rts:1});var Oo=function(i){ZF(t,i);function t(n,r){var s;return n===void 0&&(n={}),s=i.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=No(n.sortChildren),Zi&&Hl(n.parent||Zi,Hc(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&pV(Hc(s),n.scrollTrigger),s}var e=t.prototype;return e.to=function(r,s,o){return kg(0,arguments,this),this},e.from=function(r,s,o){return kg(1,arguments,this),this},e.fromTo=function(r,s,o,a){return kg(2,arguments,this),this},e.set=function(r,s,o){return s.duration=0,s.parent=this,Rg(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Br(r,s,Na(this,o),1),this},e.call=function(r,s,o){return Hl(this,Br.delayedCall(0,r,s),o)},e.staggerTo=function(r,s,o,a,l,c,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=u,o.parent=this,new Br(r,o,Na(this,l)),this},e.staggerFrom=function(r,s,o,a,l,c,u){return o.runBackwards=1,Rg(o).immediateRender=No(o.immediateRender),this.staggerTo(r,s,o,a,l,c,u)},e.staggerFromTo=function(r,s,o,a,l,c,u,h){return a.startAt=o,Rg(a).immediateRender=No(a.immediateRender),this.staggerTo(r,s,a,l,c,u,h)},e.render=function(r,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,u=r<=0?0:Cs(r),h=this._zTime<0!=r<0&&(this._initted||!c),p,m,v,_,b,y,M,S,E,A,R,O;if(this!==Zi&&u>l&&r>=0&&(u=l),u!==this._tTime||o||h){if(a!==this._time&&c&&(u+=this._time-a,r+=this._time-a),p=u,E=this._start,S=this._ts,y=!S,h&&(c||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(R=this._yoyo,b=c+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(b*100+r,s,o);if(p=Cs(u%b),u===l?(_=this._repeat,p=c):(_=~~(u/b),_&&_===u/b&&(p=c,_--),p>c&&(p=c)),A=Of(this._tTime,b),!a&&this._tTime&&A!==_&&this._tTime-A*b-this._dur<=0&&(A=_),R&&_&1&&(p=c-p,O=1),_!==A&&!this._lock){var L=R&&A&1,P=L===(R&&_&1);if(_<A&&(L=!L),a=L?0:u%c?c:u,this._lock=1,this.render(a||(O?0:Cs(_*b)),s,!c)._lock=0,this._tTime=u,!s&&this.parent&&Ga(this,"onRepeat"),this.vars.repeatRefresh&&!O&&(this.invalidate()._lock=1),a&&a!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,P&&(this._lock=2,a=L?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!O&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;AV(this,O)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(M=ute(this,Cs(a),Cs(p)),M&&(u-=p-(p=M._start))),this._tTime=u,this._time=p,this._act=!S,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&p&&!s&&!_&&(Ga(this,"onStart"),this._tTime!==u))return this;if(p>=a&&r>=0)for(m=this._first;m;){if(v=m._next,(m._act||p>=m._start)&&m._ts&&M!==m){if(m.parent!==this)return this.render(r,s,o);if(m.render(m._ts>0?(p-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(p-m._start)*m._ts,s,o),p!==this._time||!this._ts&&!y){M=0,v&&(u+=this._zTime=-Ei);break}}m=v}else{m=this._last;for(var D=r<0?r:p;m;){if(v=m._prev,(m._act||D<=m._end)&&m._ts&&M!==m){if(m.parent!==this)return this.render(r,s,o);if(m.render(m._ts>0?(D-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(D-m._start)*m._ts,s,o||Vs&&(m._initted||m._startAt)),p!==this._time||!this._ts&&!y){M=0,v&&(u+=this._zTime=D?-Ei:Ei);break}}m=v}}if(M&&!s&&(this.pause(),M.render(p>=a?0:-Ei)._zTime=p>=a?1:-1,this._ts))return this._start=E,Mw(this),this.render(r,s,o);this._onUpdate&&!s&&Ga(this,"onUpdate",!0),(u===l&&this._tTime>=this.totalDuration()||!u&&a)&&(E===this._start||Math.abs(S)!==Math.abs(this._ts))&&(this._lock||((r||!c)&&(u===l&&this._ts>0||!u&&this._ts<0)&&ch(this,1),!s&&!(r<0&&!a)&&(u||a||!l)&&(Ga(this,u===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(r,s){var o=this;if(eu(s)||(s=Na(this,s,r)),!(r instanceof dv)){if(Bs(r))return r.forEach(function(a){return o.add(a,s)}),this;if(xs(r))return this.addLabel(r,s);if(fr(r))r=Br.delayedCall(0,r);else return this}return this!==r?Hl(this,r,s):this},e.getChildren=function(r,s,o,a){r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-Ha);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof Br?s&&l.push(c):(o&&l.push(c),r&&l.push.apply(l,c.getChildren(!0,s,o)))),c=c._next;return l},e.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},e.remove=function(r){return xs(r)?this.removeLabel(r):fr(r)?this.killTweensOf(r):(Sw(this,r),r===this._recent&&(this._recent=this._last),Md(this))},e.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Cs(da.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},e.addLabel=function(r,s){return this.labels[r]=Na(this,s),this},e.removeLabel=function(r){return delete this.labels[r],this},e.addPause=function(r,s,o){var a=Br.delayedCall(0,s||cv,o);return a.data="isPause",this._hasPause=1,Hl(this,a,Na(this,r))},e.removePause=function(r){var s=this._first;for(r=Na(this,r);s;)s._start===r&&s.data==="isPause"&&ch(s),s=s._next},e.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),l=a.length;l--;)Fu!==a[l]&&a[l].kill(r,s);return this},e.getTweensOf=function(r,s){for(var o=[],a=$a(r),l=this._first,c=eu(s),u;l;)l instanceof Br?ite(l._targets,a)&&(c?(!Fu||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(u=l.getTweensOf(a,s)).length&&o.push.apply(o,u),l=l._next;return o},e.tweenTo=function(r,s){s=s||{};var o=this,a=Na(o,r),l=s,c=l.startAt,u=l.onStart,h=l.onStartParams,p=l.immediateRender,m,v=Br.to(o,Wa({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||Ei,onStart:function(){if(o.pause(),!m){var b=s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());v._dur!==b&&Df(v,b,0,1).render(v._time,!0,!0),m=1}u&&u.apply(v,h||[])}},s));return p?v.render(0):v},e.tweenFromTo=function(r,s,o){return this.tweenTo(s,Wa({startAt:{time:Na(this,r)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(r){return r===void 0&&(r=this._time),jO(this,Na(this,r))},e.previousLabel=function(r){return r===void 0&&(r=this._time),jO(this,Na(this,r),1)},e.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Ei)},e.shiftChildren=function(r,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,c;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(c in l)l[c]>=o&&(l[c]+=r);return Md(this)},e.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return i.prototype.invalidate.call(this,r)},e.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Md(this)},e.totalDuration=function(r){var s=0,o=this,a=o._last,l=Ha,c,u,h;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(h=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Hl(o,a,u-a._delay,1)._lock=0):l=u,u<0&&a._ts&&(s-=u,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=c;Df(o,o===Zi&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(r){if(Zi._ts&&(lV(Zi,wy(r,Zi)),oV=da.frame),da.frame>=$O){$O+=va.autoSleep||120;var s=Zi._first;if((!s||!s._ts)&&va.autoSleep&&da._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||da.sleep()}}},t}(dv);Wa(Oo.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ete=function(t,e,n,r,s,o,a){var l=new Uo(this._pt,t,e,0,1,NV,null,s),c=0,u=0,h,p,m,v,_,b,y,M;for(l.b=n,l.e=r,n+="",r+="",(y=~r.indexOf("random("))&&(r=uv(r)),o&&(M=[n,r],o(M,t,e),n=M[0],r=M[1]),p=n.match(nM)||[];h=nM.exec(r);)v=h[0],_=r.substring(c,h.index),m?m=(m+1)%5:_.substr(-5)==="rgba("&&(m=1),v!==p[u++]&&(b=parseFloat(p[u-1])||0,l._pt={_next:l._pt,p:_||u===1?_:",",s:b,c:v.charAt(1)==="="?uf(b,v)-b:parseFloat(v)-b,m:m&&m<4?Math.round:0},c=nM.lastIndex);return l.c=c<r.length?r.substring(c,r.length):"",l.fp=a,(eV.test(r)||y)&&(l.e=0),this._pt=l,l},_A=function(t,e,n,r,s,o,a,l,c,u){fr(r)&&(r=r(s||0,t,o));var h=t[e],p=n!=="get"?n:fr(h)?c?t[e.indexOf("set")||!fr(t["get"+e.substr(3)])?e:"get"+e.substr(3)](c):t[e]():h,m=fr(h)?c?kte:DV:yA,v;if(xs(r)&&(~r.indexOf("random(")&&(r=uv(r)),r.charAt(1)==="="&&(v=uf(p,r)+(zs(p)||0),(v||v===0)&&(r=v))),!u||p!==r||$C)return!isNaN(p*r)&&r!==""?(v=new Uo(this._pt,t,e,+p||0,r-(p||0),typeof h=="boolean"?Ote:IV,0,m),c&&(v.fp=c),a&&v.modifier(a,this,t),this._pt=v):(!h&&!(e in t)&&fA(e,r),Ete.call(this,t,e,p,r,m,l||va.stringFilter,c))},Tte=function(t,e,n,r,s){if(fr(t)&&(t=Lg(t,s,e,n,r)),!rc(t)||t.style&&t.nodeType||Bs(t)||QF(t))return xs(t)?Lg(t,s,e,n,r):t;var o={},a;for(a in t)o[a]=Lg(t[a],s,e,n,r);return o},kV=function(t,e,n,r,s,o){var a,l,c,u;if(aa[t]&&(a=new aa[t]).init(s,a.rawVars?e[t]:Tte(e[t],r,s,o,n),n,r,o)!==!1&&(n._pt=l=new Uo(n._pt,s,t,0,1,a.render,a,0,a.priority),n!==of))for(c=n._ptLookup[n._targets.indexOf(s)],u=a._props.length;u--;)c[a._props[u]]=l;return a},Fu,$C,bA=function i(t,e,n){var r=t.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,c=r.onUpdate,u=r.onUpdateParams,h=r.callbackScope,p=r.runBackwards,m=r.yoyoEase,v=r.keyframes,_=r.autoRevert,b=t._dur,y=t._startAt,M=t._targets,S=t.parent,E=S&&S.data==="nested"?S.vars.targets:M,A=t._overwrite==="auto"&&!uA,R=t.timeline,O,L,P,D,V,K,W,Z,z,ut,nt,Q,St;if(R&&(!v||!s)&&(s="none"),t._ease=Cd(s,Lf.ease),t._yEase=m?TV(Cd(m===!0?s:m,Lf.ease)):0,m&&t._yoyo&&!t._repeat&&(m=t._yEase,t._yEase=t._ease,t._ease=m),t._from=!R&&!!r.runBackwards,!R||v&&!r.stagger){if(Z=M[0]?Sd(M[0]).harness:0,Q=Z&&r[Z.prop],O=xy(r,mA),y&&(y._zTime<0&&y.progress(1),e<0&&p&&a&&!_?y.render(-1,!0):y.revert(p&&b?$b:ete),y._lazy=0),o){if(ch(t._startAt=Br.set(M,Wa({data:"isStart",overwrite:!1,parent:S,immediateRender:!0,lazy:!y&&No(l),startAt:null,delay:0,onUpdate:c,onUpdateParams:u,callbackScope:h,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Vs||!a&&!_)&&t._startAt.revert($b),a&&b&&e<=0&&n<=0){e&&(t._zTime=e);return}}else if(p&&b&&!y){if(e&&(a=!1),P=Wa({overwrite:!1,data:"isFromStart",lazy:a&&!y&&No(l),immediateRender:a,stagger:0,parent:S},O),Q&&(P[Z.prop]=Q),ch(t._startAt=Br.set(M,P)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Vs?t._startAt.revert($b):t._startAt.render(-1,!0)),t._zTime=e,!a)i(t._startAt,Ei,Ei);else if(!e)return}for(t._pt=t._ptCache=0,l=b&&No(l)||l&&!b,L=0;L<M.length;L++){if(V=M[L],W=V._gsap||vA(M)[L]._gsap,t._ptLookup[L]=ut={},zC[W.id]&&Ku.length&&yy(),nt=E===M?L:E.indexOf(V),Z&&(z=new Z).init(V,Q||O,t,nt,E)!==!1&&(t._pt=D=new Uo(t._pt,V,z.name,0,1,z.render,z,0,z.priority),z._props.forEach(function(Pt){ut[Pt]=D}),z.priority&&(K=1)),!Z||Q)for(P in O)aa[P]&&(z=kV(P,O,t,nt,V,E))?z.priority&&(K=1):ut[P]=D=_A.call(t,V,P,"get",O[P],nt,E,0,r.stringFilter);t._op&&t._op[L]&&t.kill(V,t._op[L]),A&&t._pt&&(Fu=t,Zi.killTweensOf(V,ut,t.globalTime(e)),St=!t.parent,Fu=0),t._pt&&l&&(zC[W.id]=1)}K&&zV(t),t._onInit&&t._onInit(t)}t._onUpdate=c,t._initted=(!t._op||t._pt)&&!St,v&&e<=0&&R.render(Ha,!0,!0)},Ate=function(t,e,n,r,s,o,a){var l=(t._pt&&t._ptCache||(t._ptCache={}))[e],c,u,h,p;if(!l)for(l=t._ptCache[e]=[],h=t._ptLookup,p=t._targets.length;p--;){if(c=h[p][e],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==e&&c.fp!==e;)c=c._next;if(!c)return $C=1,t.vars[e]="+=0",bA(t,a),$C=0,1;l.push(c)}for(p=l.length;p--;)u=l[p],c=u._pt||u,c.s=(r||r===0)&&!s?r:c.s+(r||0)+o*c.c,c.c=n-c.s,u.e&&(u.e=Mr(n)+zs(u.e)),u.b&&(u.b=c.s+zs(u.b))},Pte=function(t,e){var n=t[0]?Sd(t[0]).harness:0,r=n&&n.aliases,s,o,a,l;if(!r)return e;s=Nd({},e);for(o in r)if(o in s)for(l=r[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},Rte=function(t,e,n,r){var s=e.ease||r||"power1.inOut",o,a;if(Bs(e))a=n[t]||(n[t]=[]),e.forEach(function(l,c){return a.push({t:c/(e.length-1)*100,v:l,e:s})});else for(o in e)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:s})},Lg=function(t,e,n,r,s){return fr(t)?t.call(e,n,r,s):xs(t)&&~t.indexOf("random(")?uv(t):t},LV=gA+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",OV={};zo(LV+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return OV[i]=1});var Br=function(i){ZF(t,i);function t(n,r,s,o){var a;typeof r=="number"&&(s.duration=r,r=s,s=null),a=i.call(this,o?r:Rg(r))||this;var l=a.vars,c=l.duration,u=l.delay,h=l.immediateRender,p=l.stagger,m=l.overwrite,v=l.keyframes,_=l.defaults,b=l.scrollTrigger,y=l.yoyoEase,M=r.parent||Zi,S=(Bs(n)||QF(n)?eu(n[0]):"length"in r)?[n]:$a(n),E,A,R,O,L,P,D,V;if(a._targets=S.length?vA(S):by("GSAP target "+n+" not found. https://greensock.com",!va.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=m,v||p||Eb(c)||Eb(u)){if(r=a.vars,E=a.timeline=new Oo({data:"nested",defaults:_||{},targets:M&&M.data==="nested"?M.vars.targets:S}),E.kill(),E.parent=E._dp=Hc(a),E._start=0,p||Eb(c)||Eb(u)){if(O=S.length,D=p&&vV(p),rc(p))for(L in p)~LV.indexOf(L)&&(V||(V={}),V[L]=p[L]);for(A=0;A<O;A++)R=xy(r,OV),R.stagger=0,y&&(R.yoyoEase=y),V&&Nd(R,V),P=S[A],R.duration=+Lg(c,Hc(a),A,P,S),R.delay=(+Lg(u,Hc(a),A,P,S)||0)-a._delay,!p&&O===1&&R.delay&&(a._delay=u=R.delay,a._start+=u,R.delay=0),E.to(P,R,D?D(A,P,S):0),E._ease=Hn.none;E.duration()?c=u=0:a.timeline=0}else if(v){Rg(Wa(E.vars.defaults,{ease:"none"})),E._ease=Cd(v.ease||r.ease||"none");var K=0,W,Z,z;if(Bs(v))v.forEach(function(ut){return E.to(S,ut,">")}),E.duration();else{R={};for(L in v)L==="ease"||L==="easeEach"||Rte(L,v[L],R,v.easeEach);for(L in R)for(W=R[L].sort(function(ut,nt){return ut.t-nt.t}),K=0,A=0;A<W.length;A++)Z=W[A],z={ease:Z.e,duration:(Z.t-(A?W[A-1].t:0))/100*c},z[L]=Z.v,E.to(S,z,K),K+=z.duration;E.duration()<c&&E.to({},{duration:c-E.duration()})}}c||a.duration(c=E.duration())}else a.timeline=0;return m===!0&&!uA&&(Fu=Hc(a),Zi.killTweensOf(S),Fu=0),Hl(M,Hc(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(h||!c&&!v&&a._start===Cs(M._time)&&No(h)&&ate(Hc(a))&&M.data!=="nested")&&(a._tTime=-Ei,a.render(Math.max(0,-u)||0)),b&&pV(Hc(a),b),a}var e=t.prototype;return e.render=function(r,s,o){var a=this._time,l=this._tDur,c=this._dur,u=r<0,h=r>l-Ei&&!u?l:r<Ei?0:r,p,m,v,_,b,y,M,S,E;if(!c)cte(this,r,s,o);else if(h!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(p=h,S=this.timeline,this._repeat){if(_=c+this._rDelay,this._repeat<-1&&u)return this.totalTime(_*100+r,s,o);if(p=Cs(h%_),h===l?(v=this._repeat,p=c):(v=~~(h/_),v&&v===h/_&&(p=c,v--),p>c&&(p=c)),y=this._yoyo&&v&1,y&&(E=this._yEase,p=c-p),b=Of(this._tTime,_),p===a&&!o&&this._initted)return this._tTime=h,this;v!==b&&(S&&this._yEase&&AV(S,y),this.vars.repeatRefresh&&!y&&!this._lock&&(this._lock=o=1,this.render(Cs(_*v),!0).invalidate()._lock=0))}if(!this._initted){if(fV(this,u?r:p,o,s,h))return this._tTime=0,this;if(a!==this._time)return this;if(c!==this._dur)return this.render(r,s,o)}if(this._tTime=h,this._time=p,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=M=(E||this._ease)(p/c),this._from&&(this.ratio=M=1-M),p&&!a&&!s&&!v&&(Ga(this,"onStart"),this._tTime!==h))return this;for(m=this._pt;m;)m.r(M,m.d),m=m._next;S&&S.render(r<0?r:!p&&y?-Ei:S._dur*S._ease(p/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&UC(this,r,s,o),Ga(this,"onUpdate")),this._repeat&&v!==b&&this.vars.onRepeat&&!s&&this.parent&&Ga(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&UC(this,r,!0,!0),(r||!c)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&ch(this,1),!s&&!(u&&!a)&&(h||a||y)&&(Ga(this,h===l?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},e.resetTo=function(r,s,o,a){hv||da.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||bA(this,l),c=this._ease(l/this._dur),Ate(this,r,s,o,a,c,l)?this.resetTo(r,s,o,a):(Cw(this,0),this.parent||hV(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?_g(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Fu&&Fu.vars.overwrite!==!0)._first||_g(this),this.parent&&o!==this.timeline.totalDuration()&&Df(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=r?$a(r):a,c=this._ptLookup,u=this._pt,h,p,m,v,_,b,y;if((!s||s==="all")&&ste(a,l))return s==="all"&&(this._pt=0),_g(this);for(h=this._op=this._op||[],s!=="all"&&(xs(s)&&(_={},zo(s,function(M){return _[M]=1}),s=_),s=Pte(a,s)),y=a.length;y--;)if(~l.indexOf(a[y])){p=c[y],s==="all"?(h[y]=s,v=p,m={}):(m=h[y]=h[y]||{},v=s);for(_ in v)b=p&&p[_],b&&((!("kill"in b.d)||b.d.kill(_)===!0)&&Sw(this,b,"_pt"),delete p[_]),m!=="all"&&(m[_]=1)}return this._initted&&!this._pt&&u&&_g(this),this},t.to=function(r,s){return new t(r,s,arguments[2])},t.from=function(r,s){return kg(1,arguments)},t.delayedCall=function(r,s,o,a){return new t(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(r,s,o){return kg(2,arguments)},t.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new t(r,s)},t.killTweensOf=function(r,s,o){return Zi.killTweensOf(r,s,o)},t}(dv);Wa(Br.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});zo("staggerTo,staggerFrom,staggerFromTo",function(i){Br[i]=function(){var t=new Oo,e=VC.call(arguments,0);return e.splice(i==="staggerFromTo"?5:4,0,0),t[i].apply(t,e)}});var yA=function(t,e,n){return t[e]=n},DV=function(t,e,n){return t[e](n)},kte=function(t,e,n,r){return t[e](r.fp,n)},Lte=function(t,e,n){return t.setAttribute(e,n)},xA=function(t,e){return fr(t[e])?DV:hA(t[e])&&t.setAttribute?Lte:yA},IV=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},Ote=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},NV=function(t,e){var n=e._pt,r="";if(!t&&e.b)r=e.b;else if(t===1&&e.e)r=e.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*t):Math.round((n.s+n.c*t)*1e4)/1e4)+r,n=n._next;r+=e.c}e.set(e.t,e.p,r,e)},wA=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Dte=function(t,e,n,r){for(var s=this._pt,o;s;)o=s._next,s.p===r&&s.modifier(t,e,n),s=o},Ite=function(t){for(var e=this._pt,n,r;e;)r=e._next,e.p===t&&!e.op||e.op===t?Sw(this,e,"_pt"):e.dep||(n=1),e=r;return!n},Nte=function(t,e,n,r){r.mSet(t,e,r.m.call(r.tween,n,r.mt),r)},zV=function(t){for(var e=t._pt,n,r,s,o;e;){for(n=e._next,r=s;r&&r.pr>e.pr;)r=r._next;(e._prev=r?r._prev:o)?e._prev._next=e:s=e,(e._next=r)?r._prev=e:o=e,e=n}t._pt=s},Uo=function(){function i(e,n,r,s,o,a,l,c,u){this.t=n,this.s=s,this.c=o,this.p=r,this.r=a||IV,this.d=l||this,this.set=c||yA,this.pr=u||0,this._next=e,e&&(e._prev=this)}var t=i.prototype;return t.modifier=function(n,r,s){this.mSet=this.mSet||this.set,this.set=Nte,this.m=n,this.mt=s,this.tween=r},i}();zo(gA+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return mA[i]=1});ya.TweenMax=ya.TweenLite=Br;ya.TimelineLite=ya.TimelineMax=Oo;Zi=new Oo({sortChildren:!1,defaults:Lf,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});va.stringFilter=EV;var Ed=[],qb={},zte=[],YO=0,Ute=0,aM=function(t){return(qb[t]||zte).map(function(e){return e()})},GC=function(){var t=Date.now(),e=[];t-YO>2&&(aM("matchMediaInit"),Ed.forEach(function(n){var r=n.queries,s=n.conditions,o,a,l,c;for(a in r)o=za.matchMedia(r[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,c=1);c&&(n.revert(),l&&e.push(n))}),aM("matchMediaRevert"),e.forEach(function(n){return n.onMatch(n)}),YO=t,aM("matchMedia"))},UV=function(){function i(e,n){this.selector=n&&BC(n),this.data=[],this._r=[],this.isReverted=!1,this.id=Ute++,e&&this.add(e)}var t=i.prototype;return t.add=function(n,r,s){fr(n)&&(s=r,r=n,n=fr);var o=this,a=function(){var c=dr,u=o.selector,h;return c&&c!==o&&c.data.push(o),s&&(o.selector=BC(s)),dr=o,h=r.apply(o,arguments),fr(h)&&o._r.push(h),dr=c,o.selector=u,o.isReverted=!1,h};return o.last=a,n===fr?a(o):n?o[n]=a:a},t.ignore=function(n){var r=dr;dr=null,n(this),dr=r},t.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof i?n.push.apply(n,r.getTweens()):r instanceof Br&&!(r.parent&&r.parent.data==="nested")&&n.push(r)}),n},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(n,r){var s=this;if(n){var o=this.getTweens();this.data.forEach(function(l){l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(c){return o.splice(o.indexOf(c),1)}))}),o.map(function(l){return{g:l.globalTime(0),t:l}}).sort(function(l,c){return c.g-l.g||-1/0}).forEach(function(l){return l.t.revert(n)}),this.data.forEach(function(l){return!(l instanceof Br)&&l.revert&&l.revert(n)}),this._r.forEach(function(l){return l(n,s)}),this.isReverted=!0}else this.data.forEach(function(l){return l.kill&&l.kill()});if(this.clear(),r)for(var a=Ed.length;a--;)Ed[a].id===this.id&&Ed.splice(a,1)},t.revert=function(n){this.kill(n||{})},i}(),Fte=function(){function i(e){this.contexts=[],this.scope=e}var t=i.prototype;return t.add=function(n,r,s){rc(n)||(n={matches:n});var o=new UV(0,s||this.scope),a=o.conditions={},l,c,u;dr&&!o.selector&&(o.selector=dr.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=n;for(c in n)c==="all"?u=1:(l=za.matchMedia(n[c]),l&&(Ed.indexOf(o)<0&&Ed.push(o),(a[c]=l.matches)&&(u=1),l.addListener?l.addListener(GC):l.addEventListener("change",GC)));return u&&r(o),this},t.revert=function(n){this.kill(n||{})},t.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},i}(),Sy={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(r){return SV(r)})},timeline:function(t){return new Oo(t)},getTweensOf:function(t,e){return Zi.getTweensOf(t,e)},getProperty:function(t,e,n,r){xs(t)&&(t=$a(t)[0]);var s=Sd(t||{}).get,o=n?uV:cV;return n==="native"&&(n=""),t&&(e?o((aa[e]&&aa[e].get||s)(t,e,n,r)):function(a,l,c){return o((aa[a]&&aa[a].get||s)(t,a,l,c))})},quickSetter:function(t,e,n){if(t=$a(t),t.length>1){var r=t.map(function(u){return Bo.quickSetter(u,e,n)}),s=r.length;return function(u){for(var h=s;h--;)r[h](u)}}t=t[0]||{};var o=aa[e],a=Sd(t),l=a.harness&&(a.harness.aliases||{})[e]||e,c=o?function(u){var h=new o;of._pt=0,h.init(t,n?u+n:u,of,0,[t]),h.render(1,h),of._pt&&wA(1,of)}:a.set(t,l);return o?c:function(u){return c(t,l,n?u+n:u,a,1)}},quickTo:function(t,e,n){var r,s=Bo.to(t,Nd((r={},r[e]="+=0.1",r.paused=!0,r),n||{})),o=function(l,c,u){return s.resetTo(e,l,c,u)};return o.tween=s,o},isTweening:function(t){return Zi.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Cd(t.ease,Lf.ease)),GO(Lf,t||{})},config:function(t){return GO(va,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,r=t.plugins,s=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!aa[a]&&!ya[a]&&by(e+" effect requires "+a+" plugin.")}),iM[e]=function(a,l,c){return n($a(a),Wa(l||{},s),c)},o&&(Oo.prototype[e]=function(a,l,c){return this.add(iM[e](a,rc(l)?l:(c=l)&&{},this),c)})},registerEase:function(t,e){Hn[t]=Cd(e)},parseEase:function(t,e){return arguments.length?Cd(t,e):Hn},getById:function(t){return Zi.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var n=new Oo(t),r,s;for(n.smoothChildTiming=No(t.smoothChildTiming),Zi.remove(n),n._dp=0,n._time=n._tTime=Zi._time,r=Zi._first;r;)s=r._next,(e||!(!r._dur&&r instanceof Br&&r.vars.onComplete===r._targets[0]))&&Hl(n,r,r._start-r._delay),r=s;return Hl(Zi,n,0),n},context:function(t,e){return t?new UV(t,e):dr},matchMedia:function(t){return new Fte(t)},matchMediaRefresh:function(){return Ed.forEach(function(t){var e=t.conditions,n,r;for(r in e)e[r]&&(e[r]=!1,n=1);n&&t.revert()})||GC()},addEventListener:function(t,e){var n=qb[t]||(qb[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=qb[t],r=n&&n.indexOf(e);r>=0&&n.splice(r,1)},utils:{wrap:vte,wrapYoyo:_te,distribute:vV,random:bV,snap:_V,normalize:gte,getUnit:zs,clamp:dte,splitColor:MV,toArray:$a,selector:BC,mapRange:xV,pipe:fte,unitize:mte,interpolate:bte,shuffle:gV},install:rV,effects:iM,ticker:da,updateRoot:Oo.updateRoot,plugins:aa,globalTimeline:Zi,core:{PropTween:Uo,globals:sV,Tween:Br,Timeline:Oo,Animation:dv,getCache:Sd,_removeLinkedListItem:Sw,reverting:function(){return Vs},context:function(t){return t&&dr&&(dr.data.push(t),t._ctx=dr),dr},suppressOverwrites:function(t){return uA=t}}};zo("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return Sy[i]=Br[i]});da.add(Oo.updateRoot);of=Sy.to({},{duration:0});var Vte=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Bte=function(t,e){var n=t._targets,r,s,o;for(r in e)for(s=n.length;s--;)o=t._ptLookup[s][r],o&&(o=o.d)&&(o._pt&&(o=Vte(o,r)),o&&o.modifier&&o.modifier(e[r],t,n[s],r))},lM=function(t,e){return{name:t,rawVars:1,init:function(r,s,o){o._onInit=function(a){var l,c;if(xs(s)&&(l={},zo(s,function(u){return l[u]=1}),s=l),e){l={};for(c in s)l[c]=e(s[c]);s=l}Bte(a,s)}}}},Bo=Sy.registerPlugin({name:"attr",init:function(t,e,n,r,s){var o,a,l;this.tween=n;for(o in e)l=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(l||0)+"",e[o],r,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(t,e){for(var n=e._pt;n;)Vs?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},lM("roundProps",HC),lM("modifiers"),lM("snap",_V))||Sy;Br.version=Oo.version=Bo.version="3.12.2";iV=1;dA()&&If();Hn.Power0;Hn.Power1;Hn.Power2;Hn.Power3;Hn.Power4;Hn.Linear;Hn.Quad;Hn.Cubic;Hn.Quart;Hn.Quint;Hn.Strong;Hn.Elastic;Hn.Back;Hn.SteppedEase;Hn.Bounce;Hn.Sine;Hn.Expo;Hn.Circ;/*!
 * CSSPlugin 3.12.2
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var KO,Vu,hf,SA,_d,ZO,MA,Hte=function(){return typeof window<"u"},nu={},cd=180/Math.PI,df=Math.PI/180,Wp=Math.atan2,JO=1e8,CA=/([A-Z])/g,$te=/(left|right|width|margin|padding|x)/i,Gte=/[\s,\(]\S/,Xl={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},qC=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},qte=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},Wte=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},jte=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},FV=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},VV=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},Xte=function(t,e,n){return t.style[e]=n},Yte=function(t,e,n){return t.style.setProperty(e,n)},Kte=function(t,e,n){return t._gsap[e]=n},Zte=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},Jte=function(t,e,n,r,s){var o=t._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},Qte=function(t,e,n,r,s){var o=t._gsap;o[e]=n,o.renderTransform(s,o)},tr="transform",_l=tr+"Origin",tee=function i(t,e){var n=this,r=this.target,s=r.style;if(t in nu&&s){if(this.tfm=this.tfm||{},t!=="transform")t=Xl[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return n.tfm[o]=Gc(r,o)}):this.tfm[t]=r._gsap.x?r._gsap[t]:Gc(r,t);else return Xl.transform.split(",").forEach(function(o){return i.call(n,o,e)});if(this.props.indexOf(tr)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(_l,e,"")),t=tr}(s||e)&&this.props.push(t,e,s[t])},BV=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},eee=function(){var t=this.props,e=this.target,n=e.style,r=e._gsap,s,o;for(s=0;s<t.length;s+=3)t[s+1]?e[t[s]]=t[s+2]:t[s+2]?n[t[s]]=t[s+2]:n.removeProperty(t[s].substr(0,2)==="--"?t[s]:t[s].replace(CA,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),s=MA(),(!s||!s.isStart)&&!n[tr]&&(BV(n),r.uncache=1)}},HV=function(t,e){var n={target:t,props:[],revert:eee,save:tee};return t._gsap||Bo.core.getCache(t),e&&e.split(",").forEach(function(r){return n.save(r)}),n},$V,WC=function(t,e){var n=Vu.createElementNS?Vu.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Vu.createElement(t);return n.style?n:Vu.createElement(t)},Jl=function i(t,e,n){var r=getComputedStyle(t);return r[e]||r.getPropertyValue(e.replace(CA,"-$1").toLowerCase())||r.getPropertyValue(e)||!n&&i(t,Nf(e)||e,1)||""},QO="O,Moz,ms,Ms,Webkit".split(","),Nf=function(t,e,n){var r=e||_d,s=r.style,o=5;if(t in s&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(QO[o]+t in s););return o<0?null:(o===3?"ms":o>=0?QO[o]:"")+t},jC=function(){Hte()&&window.document&&(KO=window,Vu=KO.document,hf=Vu.documentElement,_d=WC("div")||{style:{}},WC("div"),tr=Nf(tr),_l=tr+"Origin",_d.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",$V=!!Nf("perspective"),MA=Bo.core.reverting,SA=1)},cM=function i(t){var e=WC("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,s=this.style.cssText,o;if(hf.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),hf.removeChild(e),this.style.cssText=s,o},tD=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},GV=function(t){var e;try{e=t.getBBox()}catch{e=cM.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===cM||(e=cM.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+tD(t,["x","cx","x1"])||0,y:+tD(t,["y","cy","y1"])||0,width:0,height:0}:e},qV=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&GV(t))},pv=function(t,e){if(e){var n=t.style;e in nu&&e!==_l&&(e=tr),n.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),n.removeProperty(e.replace(CA,"-$1").toLowerCase())):n.removeAttribute(e)}},Bu=function(t,e,n,r,s,o){var a=new Uo(t._pt,e,n,0,1,o?VV:FV);return t._pt=a,a.b=r,a.e=s,t._props.push(n),a},eD={deg:1,rad:1,turn:1},nee={grid:1,flex:1},uh=function i(t,e,n,r){var s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=_d.style,l=$te.test(e),c=t.tagName.toLowerCase()==="svg",u=(c?"client":"offset")+(l?"Width":"Height"),h=100,p=r==="px",m=r==="%",v,_,b,y;return r===o||!s||eD[r]||eD[o]?s:(o!=="px"&&!p&&(s=i(t,e,n,"px")),y=t.getCTM&&qV(t),(m||o==="%")&&(nu[e]||~e.indexOf("adius"))?(v=y?t.getBBox()[l?"width":"height"]:t[u],Mr(m?s/v*h:s/100*v)):(a[l?"width":"height"]=h+(p?o:r),_=~e.indexOf("adius")||r==="em"&&t.appendChild&&!c?t:t.parentNode,y&&(_=(t.ownerSVGElement||{}).parentNode),(!_||_===Vu||!_.appendChild)&&(_=Vu.body),b=_._gsap,b&&m&&b.width&&l&&b.time===da.time&&!b.uncache?Mr(s/b.width*h):((m||o==="%")&&!nee[Jl(_,"display")]&&(a.position=Jl(t,"position")),_===t&&(a.position="static"),_.appendChild(_d),v=_d[u],_.removeChild(_d),a.position="absolute",l&&m&&(b=Sd(_),b.time=da.time,b.width=_[u]),Mr(p?v*s/h:v&&s?h/v*s:0))))},Gc=function(t,e,n,r){var s;return SA||jC(),e in Xl&&e!=="transform"&&(e=Xl[e],~e.indexOf(",")&&(e=e.split(",")[0])),nu[e]&&e!=="transform"?(s=mv(t,r),s=e!=="transformOrigin"?s[e]:s.svg?s.origin:Cy(Jl(t,_l))+" "+s.zOrigin+"px"):(s=t.style[e],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=My[e]&&My[e](t,e,n)||Jl(t,e)||aV(t,e)||(e==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?uh(t,e,s,n)+n:s},iee=function(t,e,n,r){if(!n||n==="none"){var s=Nf(e,t,1),o=s&&Jl(t,s,1);o&&o!==n?(e=s,n=o):e==="borderColor"&&(n=Jl(t,"borderTopColor"))}var a=new Uo(this._pt,t.style,e,0,1,NV),l=0,c=0,u,h,p,m,v,_,b,y,M,S,E,A;if(a.b=n,a.e=r,n+="",r+="",r==="auto"&&(t.style[e]=r,r=Jl(t,e)||r,t.style[e]=n),u=[n,r],EV(u),n=u[0],r=u[1],p=n.match(sf)||[],A=r.match(sf)||[],A.length){for(;h=sf.exec(r);)b=h[0],M=r.substring(l,h.index),v?v=(v+1)%5:(M.substr(-5)==="rgba("||M.substr(-5)==="hsla(")&&(v=1),b!==(_=p[c++]||"")&&(m=parseFloat(_)||0,E=_.substr((m+"").length),b.charAt(1)==="="&&(b=uf(m,b)+E),y=parseFloat(b),S=b.substr((y+"").length),l=sf.lastIndex-S.length,S||(S=S||va.units[e]||E,l===r.length&&(r+=S,a.e+=S)),E!==S&&(m=uh(t,e,_,S)||0),a._pt={_next:a._pt,p:M||c===1?M:",",s:m,c:y-m,m:v&&v<4||e==="zIndex"?Math.round:0});a.c=l<r.length?r.substring(l,r.length):""}else a.r=e==="display"&&r==="none"?VV:FV;return eV.test(r)&&(a.e=0),this._pt=a,a},nD={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ree=function(t){var e=t.split(" "),n=e[0],r=e[1]||"50%";return(n==="top"||n==="bottom"||r==="left"||r==="right")&&(t=n,n=r,r=t),e[0]=nD[n]||n,e[1]=nD[r]||r,e.join(" ")},see=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n=e.t,r=n.style,s=e.u,o=n._gsap,a,l,c;if(s==="all"||s===!0)r.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)a=s[c],nu[a]&&(l=1,a=a==="transformOrigin"?_l:tr),pv(n,a);l&&(pv(n,tr),o&&(o.svg&&n.removeAttribute("transform"),mv(n,1),o.uncache=1,BV(r)))}},My={clearProps:function(t,e,n,r,s){if(s.data!=="isFromStart"){var o=t._pt=new Uo(t._pt,e,n,0,0,see);return o.u=r,o.pr=-10,o.tween=s,t._props.push(n),1}}},fv=[1,0,0,1,0,0],WV={},jV=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},iD=function(t){var e=Jl(t,tr);return jV(e)?fv:e.substr(7).match(tV).map(Mr)},EA=function(t,e){var n=t._gsap||Sd(t),r=t.style,s=iD(t),o,a,l,c;return n.svg&&t.getAttribute("transform")?(l=t.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?fv:s):(s===fv&&!t.offsetParent&&t!==hf&&!n.svg&&(l=r.display,r.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(c=1,a=t.nextElementSibling,hf.appendChild(t)),s=iD(t),l?r.display=l:pv(t,"display"),c&&(a?o.insertBefore(t,a):o?o.appendChild(t):hf.removeChild(t))),e&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},XC=function(t,e,n,r,s,o){var a=t._gsap,l=s||EA(t,!0),c=a.xOrigin||0,u=a.yOrigin||0,h=a.xOffset||0,p=a.yOffset||0,m=l[0],v=l[1],_=l[2],b=l[3],y=l[4],M=l[5],S=e.split(" "),E=parseFloat(S[0])||0,A=parseFloat(S[1])||0,R,O,L,P;n?l!==fv&&(O=m*b-v*_)&&(L=E*(b/O)+A*(-_/O)+(_*M-b*y)/O,P=E*(-v/O)+A*(m/O)-(m*M-v*y)/O,E=L,A=P):(R=GV(t),E=R.x+(~S[0].indexOf("%")?E/100*R.width:E),A=R.y+(~(S[1]||S[0]).indexOf("%")?A/100*R.height:A)),r||r!==!1&&a.smooth?(y=E-c,M=A-u,a.xOffset=h+(y*m+M*_)-y,a.yOffset=p+(y*v+M*b)-M):a.xOffset=a.yOffset=0,a.xOrigin=E,a.yOrigin=A,a.smooth=!!r,a.origin=e,a.originIsAbsolute=!!n,t.style[_l]="0px 0px",o&&(Bu(o,a,"xOrigin",c,E),Bu(o,a,"yOrigin",u,A),Bu(o,a,"xOffset",h,a.xOffset),Bu(o,a,"yOffset",p,a.yOffset)),t.setAttribute("data-svg-origin",E+" "+A)},mv=function(t,e){var n=t._gsap||new RV(t);if("x"in n&&!e&&!n.uncache)return n;var r=t.style,s=n.scaleX<0,o="px",a="deg",l=getComputedStyle(t),c=Jl(t,_l)||"0",u,h,p,m,v,_,b,y,M,S,E,A,R,O,L,P,D,V,K,W,Z,z,ut,nt,Q,St,Pt,dt,Rt,Jt,Bt,Wt;return u=h=p=_=b=y=M=S=E=0,m=v=1,n.svg=!!(t.getCTM&&qV(t)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(r[tr]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[tr]!=="none"?l[tr]:"")),r.scale=r.rotate=r.translate="none"),O=EA(t,n.svg),n.svg&&(n.uncache?(Q=t.getBBox(),c=n.xOrigin-Q.x+"px "+(n.yOrigin-Q.y)+"px",nt=""):nt=!e&&t.getAttribute("data-svg-origin"),XC(t,nt||c,!!nt||n.originIsAbsolute,n.smooth!==!1,O)),A=n.xOrigin||0,R=n.yOrigin||0,O!==fv&&(V=O[0],K=O[1],W=O[2],Z=O[3],u=z=O[4],h=ut=O[5],O.length===6?(m=Math.sqrt(V*V+K*K),v=Math.sqrt(Z*Z+W*W),_=V||K?Wp(K,V)*cd:0,M=W||Z?Wp(W,Z)*cd+_:0,M&&(v*=Math.abs(Math.cos(M*df))),n.svg&&(u-=A-(A*V+R*W),h-=R-(A*K+R*Z))):(Wt=O[6],Jt=O[7],Pt=O[8],dt=O[9],Rt=O[10],Bt=O[11],u=O[12],h=O[13],p=O[14],L=Wp(Wt,Rt),b=L*cd,L&&(P=Math.cos(-L),D=Math.sin(-L),nt=z*P+Pt*D,Q=ut*P+dt*D,St=Wt*P+Rt*D,Pt=z*-D+Pt*P,dt=ut*-D+dt*P,Rt=Wt*-D+Rt*P,Bt=Jt*-D+Bt*P,z=nt,ut=Q,Wt=St),L=Wp(-W,Rt),y=L*cd,L&&(P=Math.cos(-L),D=Math.sin(-L),nt=V*P-Pt*D,Q=K*P-dt*D,St=W*P-Rt*D,Bt=Z*D+Bt*P,V=nt,K=Q,W=St),L=Wp(K,V),_=L*cd,L&&(P=Math.cos(L),D=Math.sin(L),nt=V*P+K*D,Q=z*P+ut*D,K=K*P-V*D,ut=ut*P-z*D,V=nt,z=Q),b&&Math.abs(b)+Math.abs(_)>359.9&&(b=_=0,y=180-y),m=Mr(Math.sqrt(V*V+K*K+W*W)),v=Mr(Math.sqrt(ut*ut+Wt*Wt)),L=Wp(z,ut),M=Math.abs(L)>2e-4?L*cd:0,E=Bt?1/(Bt<0?-Bt:Bt):0),n.svg&&(nt=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!jV(Jl(t,tr)),nt&&t.setAttribute("transform",nt))),Math.abs(M)>90&&Math.abs(M)<270&&(s?(m*=-1,M+=_<=0?180:-180,_+=_<=0?180:-180):(v*=-1,M+=M<=0?180:-180)),e=e||n.uncache,n.x=u-((n.xPercent=u&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-u)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+o,n.y=h-((n.yPercent=h&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-h)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+o,n.z=p+o,n.scaleX=Mr(m),n.scaleY=Mr(v),n.rotation=Mr(_)+a,n.rotationX=Mr(b)+a,n.rotationY=Mr(y)+a,n.skewX=M+a,n.skewY=S+a,n.transformPerspective=E+o,(n.zOrigin=parseFloat(c.split(" ")[2])||0)&&(r[_l]=Cy(c)),n.xOffset=n.yOffset=0,n.force3D=va.force3D,n.renderTransform=n.svg?aee:$V?XV:oee,n.uncache=0,n},Cy=function(t){return(t=t.split(" "))[0]+" "+t[1]},uM=function(t,e,n){var r=zs(e);return Mr(parseFloat(e)+parseFloat(uh(t,"x",n+"px",r)))+r},oee=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,XV(t,e)},nd="0deg",hg="0px",id=") ",XV=function(t,e){var n=e||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.z,c=n.rotation,u=n.rotationY,h=n.rotationX,p=n.skewX,m=n.skewY,v=n.scaleX,_=n.scaleY,b=n.transformPerspective,y=n.force3D,M=n.target,S=n.zOrigin,E="",A=y==="auto"&&t&&t!==1||y===!0;if(S&&(h!==nd||u!==nd)){var R=parseFloat(u)*df,O=Math.sin(R),L=Math.cos(R),P;R=parseFloat(h)*df,P=Math.cos(R),o=uM(M,o,O*P*-S),a=uM(M,a,-Math.sin(R)*-S),l=uM(M,l,L*P*-S+S)}b!==hg&&(E+="perspective("+b+id),(r||s)&&(E+="translate("+r+"%, "+s+"%) "),(A||o!==hg||a!==hg||l!==hg)&&(E+=l!==hg||A?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+id),c!==nd&&(E+="rotate("+c+id),u!==nd&&(E+="rotateY("+u+id),h!==nd&&(E+="rotateX("+h+id),(p!==nd||m!==nd)&&(E+="skew("+p+", "+m+id),(v!==1||_!==1)&&(E+="scale("+v+", "+_+id),M.style[tr]=E||"translate(0, 0)"},aee=function(t,e){var n=e||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.rotation,c=n.skewX,u=n.skewY,h=n.scaleX,p=n.scaleY,m=n.target,v=n.xOrigin,_=n.yOrigin,b=n.xOffset,y=n.yOffset,M=n.forceCSS,S=parseFloat(o),E=parseFloat(a),A,R,O,L,P;l=parseFloat(l),c=parseFloat(c),u=parseFloat(u),u&&(u=parseFloat(u),c+=u,l+=u),l||c?(l*=df,c*=df,A=Math.cos(l)*h,R=Math.sin(l)*h,O=Math.sin(l-c)*-p,L=Math.cos(l-c)*p,c&&(u*=df,P=Math.tan(c-u),P=Math.sqrt(1+P*P),O*=P,L*=P,u&&(P=Math.tan(u),P=Math.sqrt(1+P*P),A*=P,R*=P)),A=Mr(A),R=Mr(R),O=Mr(O),L=Mr(L)):(A=h,L=p,R=O=0),(S&&!~(o+"").indexOf("px")||E&&!~(a+"").indexOf("px"))&&(S=uh(m,"x",o,"px"),E=uh(m,"y",a,"px")),(v||_||b||y)&&(S=Mr(S+v-(v*A+_*O)+b),E=Mr(E+_-(v*R+_*L)+y)),(r||s)&&(P=m.getBBox(),S=Mr(S+r/100*P.width),E=Mr(E+s/100*P.height)),P="matrix("+A+","+R+","+O+","+L+","+S+","+E+")",m.setAttribute("transform",P),M&&(m.style[tr]=P)},lee=function(t,e,n,r,s){var o=360,a=xs(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?cd:1),c=l-r,u=r+c+"deg",h,p;return a&&(h=s.split("_")[1],h==="short"&&(c%=o,c!==c%(o/2)&&(c+=c<0?o:-o)),h==="cw"&&c<0?c=(c+o*JO)%o-~~(c/o)*o:h==="ccw"&&c>0&&(c=(c-o*JO)%o-~~(c/o)*o)),t._pt=p=new Uo(t._pt,e,n,r,c,qte),p.e=u,p.u="deg",t._props.push(n),p},rD=function(t,e){for(var n in e)t[n]=e[n];return t},cee=function(t,e,n){var r=rD({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,l,c,u,h,p,m,v;r.svg?(c=n.getAttribute("transform"),n.setAttribute("transform",""),o[tr]=e,a=mv(n,1),pv(n,tr),n.setAttribute("transform",c)):(c=getComputedStyle(n)[tr],o[tr]=e,a=mv(n,1),o[tr]=c);for(l in nu)c=r[l],u=a[l],c!==u&&s.indexOf(l)<0&&(m=zs(c),v=zs(u),h=m!==v?uh(n,l,c,v):parseFloat(c),p=parseFloat(u),t._pt=new Uo(t._pt,a,l,h,p-h,qC),t._pt.u=v||0,t._props.push(l));rD(a,r)};zo("padding,margin,Width,Radius",function(i,t){var e="Top",n="Right",r="Bottom",s="Left",o=(t<3?[e,n,r,s]:[e+s,e+n,r+n,r+s]).map(function(a){return t<2?i+a:"border"+a+i});My[t>1?"border"+i:i]=function(a,l,c,u,h){var p,m;if(arguments.length<4)return p=o.map(function(v){return Gc(a,v,c)}),m=p.join(" "),m.split(p[0]).length===5?p[0]:m;p=(u+"").split(" "),m={},o.forEach(function(v,_){return m[v]=p[_]=p[_]||p[(_-1)/2|0]}),a.init(l,m,h)}});var YV={name:"css",register:jC,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,r,s){var o=this._props,a=t.style,l=n.vars.startAt,c,u,h,p,m,v,_,b,y,M,S,E,A,R,O,L;SA||jC(),this.styles=this.styles||HV(t),L=this.styles.props,this.tween=n;for(_ in e)if(_!=="autoRound"&&(u=e[_],!(aa[_]&&kV(_,e,n,r,t,s)))){if(m=typeof u,v=My[_],m==="function"&&(u=u.call(n,r,t,s),m=typeof u),m==="string"&&~u.indexOf("random(")&&(u=uv(u)),v)v(this,t,_,u,n)&&(O=1);else if(_.substr(0,2)==="--")c=(getComputedStyle(t).getPropertyValue(_)+"").trim(),u+="",Zu.lastIndex=0,Zu.test(c)||(b=zs(c),y=zs(u)),y?b!==y&&(c=uh(t,_,c,y)+y):b&&(u+=b),this.add(a,"setProperty",c,u,r,s,0,0,_),o.push(_),L.push(_,0,a[_]);else if(m!=="undefined"){if(l&&_ in l?(c=typeof l[_]=="function"?l[_].call(n,r,t,s):l[_],xs(c)&&~c.indexOf("random(")&&(c=uv(c)),zs(c+"")||(c+=va.units[_]||zs(Gc(t,_))||""),(c+"").charAt(1)==="="&&(c=Gc(t,_))):c=Gc(t,_),p=parseFloat(c),M=m==="string"&&u.charAt(1)==="="&&u.substr(0,2),M&&(u=u.substr(2)),h=parseFloat(u),_ in Xl&&(_==="autoAlpha"&&(p===1&&Gc(t,"visibility")==="hidden"&&h&&(p=0),L.push("visibility",0,a.visibility),Bu(this,a,"visibility",p?"inherit":"hidden",h?"inherit":"hidden",!h)),_!=="scale"&&_!=="transform"&&(_=Xl[_],~_.indexOf(",")&&(_=_.split(",")[0]))),S=_ in nu,S){if(this.styles.save(_),E||(A=t._gsap,A.renderTransform&&!e.parseTransform||mv(t,e.parseTransform),R=e.smoothOrigin!==!1&&A.smooth,E=this._pt=new Uo(this._pt,a,tr,0,1,A.renderTransform,A,0,-1),E.dep=1),_==="scale")this._pt=new Uo(this._pt,A,"scaleY",A.scaleY,(M?uf(A.scaleY,M+h):h)-A.scaleY||0,qC),this._pt.u=0,o.push("scaleY",_),_+="X";else if(_==="transformOrigin"){L.push(_l,0,a[_l]),u=ree(u),A.svg?XC(t,u,0,R,0,this):(y=parseFloat(u.split(" ")[2])||0,y!==A.zOrigin&&Bu(this,A,"zOrigin",A.zOrigin,y),Bu(this,a,_,Cy(c),Cy(u)));continue}else if(_==="svgOrigin"){XC(t,u,1,R,0,this);continue}else if(_ in WV){lee(this,A,_,p,M?uf(p,M+u):u);continue}else if(_==="smoothOrigin"){Bu(this,A,"smooth",A.smooth,u);continue}else if(_==="force3D"){A[_]=u;continue}else if(_==="transform"){cee(this,u,t);continue}}else _ in a||(_=Nf(_)||_);if(S||(h||h===0)&&(p||p===0)&&!Gte.test(u)&&_ in a)b=(c+"").substr((p+"").length),h||(h=0),y=zs(u)||(_ in va.units?va.units[_]:b),b!==y&&(p=uh(t,_,c,y)),this._pt=new Uo(this._pt,S?A:a,_,p,(M?uf(p,M+h):h)-p,!S&&(y==="px"||_==="zIndex")&&e.autoRound!==!1?jte:qC),this._pt.u=y||0,b!==y&&y!=="%"&&(this._pt.b=c,this._pt.r=Wte);else if(_ in a)iee.call(this,t,_,c,M?M+u:u);else if(_ in t)this.add(t,_,c||t[_],M?M+u:u,r,s);else if(_!=="parseTransform"){fA(_,u);continue}S||(_ in a?L.push(_,0,a[_]):L.push(_,1,c||t[_])),o.push(_)}}O&&zV(this)},render:function(t,e){if(e.tween._time||!MA())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:Gc,aliases:Xl,getSetter:function(t,e,n){var r=Xl[e];return r&&r.indexOf(",")<0&&(e=r),e in nu&&e!==_l&&(t._gsap.x||Gc(t,"x"))?n&&ZO===n?e==="scale"?Zte:Kte:(ZO=n||{})&&(e==="scale"?Jte:Qte):t.style&&!hA(t.style[e])?Xte:~e.indexOf("-")?Yte:xA(t,e)},core:{_removeProperty:pv,_getMatrix:EA}};Bo.utils.checkPrefix=Nf;Bo.core.getStyleSaver=HV;(function(i,t,e,n){var r=zo(i+","+t+","+e,function(s){nu[s]=1});zo(t,function(s){va.units[s]="deg",WV[s]=1}),Xl[r[13]]=i+","+t,zo(n,function(s){var o=s.split(":");Xl[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");zo("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){va.units[i]="px"});Bo.registerPlugin(YV);var TA=Bo.registerPlugin(YV)||Bo;TA.core.Tween;typeof window<"u"&&TA.registerPlugin(YQt.ScrollTrigger);var uee=function(){for(var t=0;t<arguments.length;t++)if(typeof arguments[t]<"u")return arguments[t]},hee=dee;function dee(i,t,e){if(typeof t!="number"||typeof e!="number")throw new TypeError('Must specify "to" and "from" arguments as numbers');if(t>e){var n=t;t=e,e=n}var r=e-t;return r===0?e:i-r*Math.floor((i-t)/r)}var gv=uee,pee=hee,KV=Number.EPSILON;function Ew(i,t,e){return t<e?i<t?t:i>e?e:i:i<e?e:i>t?t:i}function fee(i){return Ew(i,0,1)}function Tw(i,t,e){return i*(1-e)+t*e}function ZV(i,t,e){return Math.abs(i-t)<KV?0:(e-i)/(t-i)}function mee(i,t,e){var n=Ew(ZV(i,t,e),0,1);return n*n*(3-2*n)}function gee(i,t){return t=gv(t,0),typeof i=="number"&&isFinite(i)?i:t}function hM(i){if(typeof i!="number")throw new TypeError("Expected dims argument");return function(t,e){e=gv(e,0);var n;t==null?n=e:typeof t=="number"&&isFinite(t)&&(n=t);var r=[],s;if(n==null)for(s=0;s<i;s++)r[s]=gee(t[s],e);else for(s=0;s<i;s++)r[s]=n;return r}}function JV(i,t,e,n){if(n=n||[],i.length!==t.length)throw new TypeError("min and max array are expected to have the same length");for(var r=0;r<i.length;r++)n[r]=Tw(i[r],t[r],e);return n}function sD(i,t){if(i=gv(i,0),typeof i!="number")throw new TypeError("Expected n argument to be a number");for(var e=[],n=0;n<i;n++)e.push(t);return e}function vee(i,t){if(i=gv(i,0),typeof i!="number")throw new TypeError("Expected n argument to be a number");t=t||{},typeof t=="boolean"&&(t={endpoint:!0});var e=gv(t.offset,0);return t.endpoint?sD(i).map(function(n,r){return i<=1?0:(r+e)/(i-1)}):sD(i).map(function(n,r){return(r+e)/i})}function _ee(i,t,e){t=Ew(t,0,1);var n=i.length-1,r=t*n,s=Math.floor(r),o=r-s,a=Math.min(s+1,n),l=i[s%i.length],c=i[a%i.length];if(typeof l=="number"&&typeof c=="number")return Tw(l,c,o);if(Array.isArray(l)&&Array.isArray(c))return JV(l,c,o,e);throw new TypeError("Mismatch in value type of two array elements: "+s+" and "+a)}function QV(i,t){return(i%t+t)%t}function bee(i){return i*Math.PI/180}function yee(i){return i*180/Math.PI}function xee(i){return i-Math.floor(i)}function wee(i){return i>0?1:i<0?-1:0}function See(i,t){return i=QV(i,t*2),t-Math.abs(i-t)}function tB(i,t,e,n){return Tw(i,t,1-Math.exp(-e*n))}function Mee(i,t,e,n,r){r=r||[];for(var s=0;s<i.length;s++)r[s]=tB(i[s],t[s],e,n);return r}function Cee(i,t,e,n,r,s){if(Math.abs(t-e)<KV)return n;var o=(i-t)/(e-t)*(r-n)+n;return s&&(r<n?o<r?o=r:o>n&&(o=n):o>r?o=r:o<n&&(o=n)),o}hM(2),hM(3),hM(4);const dM=2,Eee=1;function Tee(i,t,e){let{view:n}=t;return n.matrix({bufferWidth:128,bufferHeight:64,width:64,height:32,live:!1,expr:(r,s,o,a)=>{let l=s/64*Cjt,c=(o/31-.5)*YU;r(Math.cos(l)*Math.cos(c),Math.sin(c),Math.sin(l)*Math.cos(c))},channels:3}).transform({scale:[dM,dM,dM]}).surface({points:"<",normals:"<",color:"#d6d3d1",shaded:!0,closedX:!0,zBias:Eee,lineX:!0,lineY:!0,width:.2,opacity:.5}),i.$$set=r=>{"view"in r&&e(0,n=r.view)},[n]}class Aee extends uo{constructor(t){super(),ho(this,t,Tee,null,co,{view:0})}}function Pee(i){let t,e,n,r,s,o;const a=[{axes:"xyz"},i[6]];let l={};for(let m=0;m<a.length;m+=1)l=vl(l,a[m]);t=new vS({props:l});const c=[{"position.y":yg},{axes:"xzy"},i[6],{fadeDistance:2}];let u={};for(let m=0;m<c.length;m+=1)u=vl(u,c[m]);n=new vS({props:u});const h=[{"position.x":yg},{axes:"zyx"},i[6],{fadeDistance:2}];let p={};for(let m=0;m<h.length;m+=1)p=vl(p,h[m]);return s=new vS({props:p}),{c(){Cr(t.$$.fragment),e=Ju(),Cr(n.$$.fragment),r=Ju(),Cr(s.$$.fragment)},l(m){Er(t.$$.fragment,m),e=Qu(m),Er(n.$$.fragment,m),r=Qu(m),Er(s.$$.fragment,m)},m(m,v){Tr(t,m,v),qa(m,e,v),Tr(n,m,v),qa(m,r,v),Tr(s,m,v),o=!0},p(m,v){const _=v&64?xg(a,[a[0],wg(m[6])]):{};t.$set(_);const b=v&64?xg(c,[v&0&&{"position.y":yg},c[1],v&64&&wg(m[6]),c[3]]):{};n.$set(b);const y=v&64?xg(h,[v&0&&{"position.x":yg},h[1],v&64&&wg(m[6]),h[3]]):{};s.$set(y)},i(m){o||(Pn(t.$$.fragment,m),Pn(n.$$.fragment,m),Pn(s.$$.fragment,m),o=!0)},o(m){Bn(t.$$.fragment,m),Bn(n.$$.fragment,m),Bn(s.$$.fragment,m),o=!1},d(m){m&&(An(e),An(r)),Ar(t,m),Ar(n,m),Ar(s,m)}}}function Ree(i){let t,e,n,r,s,o;return t=new XQt({props:{view:i[1]}}),n=new Tv.Group({props:{matrix:i[0].matrix,matrixAutoUpdate:!1,$$slots:{default:[Pee]},$$scope:{ctx:i}}}),s=new Aee({props:{view:i[1]}}),{c(){Cr(t.$$.fragment),e=Ju(),Cr(n.$$.fragment),r=Ju(),Cr(s.$$.fragment)},l(a){Er(t.$$.fragment,a),e=Qu(a),Er(n.$$.fragment,a),r=Qu(a),Er(s.$$.fragment,a)},m(a,l){Tr(t,a,l),qa(a,e,l),Tr(n,a,l),qa(a,r,l),Tr(s,a,l),o=!0},p(a,[l]){const c={};l&1&&(c.matrix=a[0].matrix),l&4194304&&(c.$$scope={dirty:l,ctx:a}),n.$set(c)},i(a){o||(Pn(t.$$.fragment,a),Pn(n.$$.fragment,a),Pn(s.$$.fragment,a),o=!0)},o(a){Bn(t.$$.fragment,a),Bn(n.$$.fragment,a),Bn(s.$$.fragment,a),o=!1},d(a){a&&(An(e),An(r)),Ar(t,a),Ar(n,a),Ar(s,a)}}}const jp=15,kee=.066,yg=.8;function Lee(i,t,e){let n,r,s,o,{mathbox:a}=t;a.set("focus",1.2);const l=[[-jp,jp],[-jp,jp],[-jp,jp]],u=a.cartesian({range:l}).transform(),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p={matrix:h,endMatrix:[...h]},{pane:m,action:v,addInput:_,addButton:b}=GQt({}),y=_({label:"x",value:{x:2,y:0,z:0},params:{y:{inverted:!0}}});pa(i,y,P=>e(10,s=P));const M=_({label:"y",value:{x:1,y:1,z:0},params:{y:{inverted:!0}}});pa(i,M,P=>e(9,r=P));const S=_({label:"z",value:{x:-1,y:1,z:1},params:{y:{inverted:!0}}});pa(i,S,P=>e(8,n=P));const E=_({label:"t",value:0,params:{min:0,max:1}});pa(i,E,P=>e(11,o=P)),b({title:"play",onClick:R});const A=TA.to(p.matrix,{ease:"power2.inOut",duration:2,paused:!0,endArray:p.endMatrix,onUpdate(){e(0,p),e(11,o),W$(E,o=this.progress(),o)},onComplete(){this.pause()}});function R(){A.play(),console.log("play")}function O(P,D,V){e(0,p.endMatrix[0]=P.x,p),e(0,p.endMatrix[1]=D.x,p),e(0,p.endMatrix[2]=V.x,p),e(0,p.endMatrix[4]=P.y,p),e(0,p.endMatrix[5]=D.y,p),e(0,p.endMatrix[6]=V.y,p),e(0,p.endMatrix[8]=P.z,p),e(0,p.endMatrix[9]=D.z,p),e(0,p.endMatrix[10]=V.z,p),A.invalidate(),console.log(A),e(0,p),e(11,o)}const L={cellSize:kee,cellColor:"#3f3f46",cellThickness:1.5,sectionSize:yg,sectionColor:"#52525b",sectionThickness:3,infiniteGrid:!0,fadeDistance:3,fadeStrength:3};return i.$$set=P=>{"mathbox"in P&&e(7,a=P.mathbox)},i.$$.update=()=>{i.$$.dirty&2049&&(A.progress(o),e(0,p),e(11,o)),i.$$.dirty&1&&u.set("matrix",p.matrix),i.$$.dirty&1792&&O(s,r,n)},[p,u,y,M,S,E,L,a,n,r,s,o]}class Oee extends uo{constructor(t){super(),ho(this,t,Lee,Ree,co,{mathbox:7})}}function Dee(i){let t,e;return t=new JY({props:{enableDamping:!0}}),{c(){Cr(t.$$.fragment)},l(n){Er(t.$$.fragment,n)},m(n,r){Tr(t,n,r),e=!0},p:Og,i(n){e||(Pn(t.$$.fragment,n),e=!0)},o(n){Bn(t.$$.fragment,n),e=!1},d(n){Ar(t,n)}}}function Iee(i){let t,e,n,r;return t=new Tv.PerspectiveCamera({props:{makeDefault:!0,position:[0,0,1.12],near:.01,$$slots:{default:[Dee]},$$scope:{ctx:i}}}),n=new Oee({props:{mathbox:i[2]}}),{c(){Cr(t.$$.fragment),e=Ju(),Cr(n.$$.fragment)},l(s){Er(t.$$.fragment,s),e=Qu(s),Er(n.$$.fragment,s)},m(s,o){Tr(t,s,o),qa(s,e,o),Tr(n,s,o),r=!0},p(s,[o]){const a={};o&256&&(a.$$scope={dirty:o,ctx:s}),t.$set(a)},i(s){r||(Pn(t.$$.fragment,s),Pn(n.$$.fragment,s),r=!0)},o(s){Bn(t.$$.fragment,s),Bn(n.$$.fragment,s),r=!1},d(s){s&&An(e),Ar(t,s),Ar(n,s)}}}function Nee(i,t,e){let n,r;const{size:s,scene:o,camera:a,renderer:l}=Gd();pa(i,s,h=>e(3,n=h)),pa(i,a,h=>e(4,r=h));const c=new KU(l,o,r).init(),u=c.api;return sN(()=>{c.frame()}),Ey(()=>{c.resize({viewWidth:n.width,viewHeight:n.height})}),[s,a,u]}class zee extends uo{constructor(t){super(),ho(this,t,Nee,Iee,co,{})}}function Uee(i){let t,e;return t=new zee({}),{c(){Cr(t.$$.fragment)},l(n){Er(t.$$.fragment,n)},m(n,r){Tr(t,n,r),e=!0},i(n){e||(Pn(t.$$.fragment,n),e=!0)},o(n){Bn(t.$$.fragment,n),e=!1},d(n){Ar(t,n)}}}function Fee(i){let t,e;return t=new NY({props:{colorManagementEnabled:!1,rendererParameters:{webgl1:!0},$$slots:{default:[Uee]},$$scope:{ctx:i}}}),{c(){Cr(t.$$.fragment)},l(n){Er(t.$$.fragment,n)},m(n,r){Tr(t,n,r),e=!0},p(n,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:n}),t.$set(s)},i(n){e||(Pn(t.$$.fragment,n),e=!0)},o(n){Bn(t.$$.fragment,n),e=!1},d(n){Ar(t,n)}}}function Vee(i){return qn.DEFAULT_UP.set(0,0,1),[]}class Bee extends uo{constructor(t){super(),ho(this,t,Vee,Fee,co,{})}}function Hee(i){let t,e,n;return e=new Bee({}),{c(){t=Hi("div"),Cr(e.$$.fragment),this.h()},l(r){t=$i(r,"DIV",{class:!0});var s=lD(t);Er(e.$$.fragment,s),s.forEach(An),this.h()},h(){Pe(t,"class","wrapper svelte-i6dxo4")},m(r,s){qa(r,t,s),Tr(e,t,null),n=!0},p:Og,i(r){n||(Pn(e.$$.fragment,r),n=!0)},o(r){Bn(e.$$.fragment,r),n=!1},d(r){r&&An(t),Ar(e)}}}class $ee extends uo{constructor(t){super(),ho(this,t,null,Hee,co,{})}}const Gee="Title TK",qee="Description tk.",oD={title:Gee,description:qee};function Wee(){console.log("--- --- --- --- --- ---"),console.log("svelte-starter: 5.11.2"),console.log("build: 2023-07-25-21:50"),console.log("--- --- --- --- --- ---")}function jee(i){let t,e,n,r;return t=new Q$({props:{title:i[1],description:i[2],url:i[3],preloadFont:i[0],keywords:i[4]}}),n=new $ee({}),{c(){Cr(t.$$.fragment),e=Ju(),Cr(n.$$.fragment)},l(s){Er(t.$$.fragment,s),e=Qu(s),Er(n.$$.fragment,s)},m(s,o){Tr(t,s,o),qa(s,e,o),Tr(n,s,o),r=!0},p:Og,i(s){r||(Pn(t.$$.fragment,s),Pn(n.$$.fragment,s),r=!0)},o(s){Bn(t.$$.fragment,s),Bn(n.$$.fragment,s),r=!1},d(s){s&&An(e),Ar(t,s),Ar(n,s)}}}function Xee(i,t,e){let{data:n}=t;Wee();const r=["https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Regular.woff2","https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Bold.woff2","https://pudding.cool/assets/fonts/national/National2Web-Regular.woff2","https://pudding.cool/assets/fonts/national/National2Web-Bold.woff2"],{title:s,description:o,url:a,keywords:l}=oD;return gl("copy",oD),gl("data",n.data),i.$$set=c=>{"data"in c&&e(5,n=c.data)},[r,s,o,a,l,n]}class Dne extends uo{constructor(t){super(),ho(this,t,Xee,jee,co,{data:5})}}export{Dne as component};
